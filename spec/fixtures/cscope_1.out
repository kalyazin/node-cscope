cscope 15 $HOME/dev/swap/swap-modules               0000648604
	@buffer/buffer_description.h

27 #i‚de‡
__BUFFER_DESCRIPTION_H__


28 
	#__BUFFER_DESCRIPTION_H__


	)

30 
	~"d©a_ty≥s.h
"

32 
	ssw≠_subbuf„r
 {

34 
sw≠_subbuf„r
 *
	m√xt_ö_queue
;

36 
size_t
 
	mfuŒ_buf„r_∑π
;

38 
sw≠_subbuf„r_±r
 
	md©a_buf„r
;

40 
sync_t
 
	mbuf„r_sync
;

	@buffer/buffer_queue.c

45 
	~"buf„r_queue.h
"

46 
	~"sw≠_buf„r_to_buf„r_queue.h
"

47 
	~"sw≠_buf„r_îr‹s.h
"

48 
	~"kî√l_›î©i⁄s.h
"

52 
	squeue_t
 {

53 
sw≠_subbuf„r
 *
	m°¨t_±r
;

54 
sw≠_subbuf„r
 *
	míd_±r
;

55 
	msubbuf„rs_cou¡
;

56 
sync_t
 
	mqueue_sync
;

60 
queue_t
 
	gwrôe_queue
 = {

61 .
°¨t_±r
 = 
NULL
,

62 .
	gíd_±r
 = 
NULL
,

63 .
	gsubbuf„rs_cou¡
 = 0,

64 .
	gqueue_sync
 = {

65 .
Êags
 = 0x0

70 
queue_t
 
	gªad_queue
 = {

71 .
°¨t_±r
 = 
NULL
,

72 .
	gíd_±r
 = 
NULL
,

73 .
	gsubbuf„rs_cou¡
 = 0,

74 .
	gqueue_sync
 = {

75 .
Êags
 = 0x0

80 
sw≠_subbuf„r
 **
	gqueue_busy
 = 
NULL
;

83 
	gqueue_busy_œ°_ñemít
;

86 
	gqueue_subbuf„r_cou¡
 = 0;

89 
size_t
 
	gqueue_subbuf„r_size
 = 0;

92 
sync_t
 
	gbuf„r_busy_sync
 = {

93 .
Êags
 = 0x0

97 
	g∑ges_‹dî_ö_subbuf„r
 = 0;

100 
	$buf„r_queue_Æloˇti⁄
(
size_t
 
subbuf„r_size
,

101 
subbuf„rs_cou¡
)

103 
i
 = 0;

104 
j
 = 0;

105 
Æloˇãd_buf„rs
 = 0;

106 
Æloˇãd_°ru˘s
 = 0;

107 
sw≠_subbuf„r
 *
˛ón_tmp_°ru˘
;

108 
ªsu…
;

111 
queue_subbuf„r_size
 = 
subbuf„r_size
;

112 
queue_subbuf„r_cou¡
 = 
subbuf„rs_cou¡
;

113 
queue_busy_œ°_ñemít
 = 0;

119 
	`£t_∑ges_‹dî_ö_subbuf„r
(
queue_subbuf„r_size
);

121 
	`sync_öô
(&
ªad_queue
.
queue_sync
);

122 
	`sync_öô
(&
wrôe_queue
.
queue_sync
);

123 
	`sync_öô
(&
buf„r_busy_sync
);

126 
queue_busy
 = 
	`mem‹y_Æloˇti⁄
((*queue_busyË* 
queue_subbuf„r_cou¡
);

128 i‡(!
queue_busy
) {

129 
ªsu…
 = -
E_SB_NO_MEM_QUEUE_BUSY
;

130 
buf„r_Æloˇti⁄_îr‹_ªt
;

136 
wrôe_queue
.
°¨t_±r
 = 
	`mem‹y_Æloˇti⁄
((*write_queue.start_ptr));

138 i‡(!
wrôe_queue
.
°¨t_±r
) {

139 
ªsu…
 = -
E_SB_NO_MEM_BUFFER_STRUCT
;

140 
buf„r_Æloˇti⁄_queue_busy_‰ì
;

142 
Æloˇãd_°ru˘s
++;

145 
wrôe_queue
.
íd_±r
 = wrôe_queue.
°¨t_±r
;

147 
wrôe_queue
.
íd_±r
->
√xt_ö_queue
 = 
NULL
;

148 
wrôe_queue
.
íd_±r
->
fuŒ_buf„r_∑π
 = 0;

149 
wrôe_queue
.
íd_±r
->
d©a_buf„r
 = 
	`buf„r_Æloˇti⁄
(
queue_subbuf„r_size
);

150 i‡(!
wrôe_queue
.
íd_±r
->
d©a_buf„r
) {

151 
	`¥öt_îr
("Cannotállocate memory for buffer 1\n");

152 
ªsu…
 = -
E_SB_NO_MEM_DATA_BUFFER
;

153 
buf„r_Æloˇti⁄_îr‹_‰ì
;

155 
Æloˇãd_buf„rs
++;

157 
	`sync_öô
(&
wrôe_queue
.
íd_±r
->
buf„r_sync
);

160 
	`mem£t
(
	`buf„r_addªss
(
wrôe_queue
.
íd_±r
->
d©a_buf„r
), 0, 
queue_subbuf„r_size
);

163 
i
 = 1; i < 
queue_subbuf„r_cou¡
; i++) {

164 
wrôe_queue
.
íd_±r
->
√xt_ö_queue
 =

165 
	`mem‹y_Æloˇti⁄
((*
wrôe_queue
.
íd_±r
->
√xt_ö_queue
));

166 i‡(!
wrôe_queue
.
íd_±r
->
√xt_ö_queue
) {

167 
ªsu…
 = -
E_SB_NO_MEM_BUFFER_STRUCT
;

168 
buf„r_Æloˇti⁄_îr‹_‰ì
;

170 
Æloˇãd_°ru˘s
++;

173 
wrôe_queue
.
íd_±r
 = wrôe_queue.íd_±r->
√xt_ö_queue
;

175 
wrôe_queue
.
íd_±r
->
√xt_ö_queue
 = 
NULL
;

176 
wrôe_queue
.
íd_±r
->
fuŒ_buf„r_∑π
 = 0;

177 
wrôe_queue
.
íd_±r
->
d©a_buf„r
 =

178 
	`buf„r_Æloˇti⁄
(
queue_subbuf„r_size
);

179 i‡(!
wrôe_queue
.
íd_±r
->
d©a_buf„r
) {

180 
ªsu…
 = -
E_SB_NO_MEM_DATA_BUFFER
;

181 
buf„r_Æloˇti⁄_îr‹_‰ì
;

183 
Æloˇãd_buf„rs
++;

185 
	`sync_öô
(&
wrôe_queue
.
íd_±r
->
buf„r_sync
);

188 
	`mem£t
(
	`buf„r_addªss
(
wrôe_queue
.
íd_±r
->
d©a_buf„r
), 0,

189 
queue_subbuf„r_size
);

193 
wrôe_queue
.
subbuf„rs_cou¡
 = subbuffers_count;

195  
E_SB_SUCCESS
;

199 
buf„r_Æloˇti⁄_îr‹_‰ì
:

200 
˛ón_tmp_°ru˘
 = 
wrôe_queue
.
°¨t_±r
;

202 
j
 = 0; j < 
Æloˇãd_°ru˘s
; j++) {

203 
˛ón_tmp_°ru˘
 = 
wrôe_queue
.
°¨t_±r
;

204 i‡(
Æloˇãd_buf„rs
) {

205 
	`buf„r_‰ì
(
˛ón_tmp_°ru˘
->
d©a_buf„r
, 
queue_subbuf„r_size
);

206 
Æloˇãd_buf„rs
--;

208 i‡(
wrôe_queue
.
°¨t_±r
 !wrôe_queue.
íd_±r
)

209 
wrôe_queue
.
°¨t_±r
 = wrôe_queue.°¨t_±r->
√xt_ö_queue
;

210 
	`mem‹y_‰ì
(
˛ón_tmp_°ru˘
);

212 
wrôe_queue
.
íd_±r
 = 
NULL
;

213 
wrôe_queue
.
°¨t_±r
 = 
NULL
;

215 
buf„r_Æloˇti⁄_queue_busy_‰ì
:

216 
	`mem‹y_‰ì
(
queue_busy
);

217 
queue_busy
 = 
NULL
;

219 
buf„r_Æloˇti⁄_îr‹_ªt
:

220  
ªsu…
;

221 
	}
}

223 
	$buf„r_queue_ª£t
()

225 
sw≠_subbuf„r
 *
buf„r
 = 
ªad_queue
.
°¨t_±r
;

228 i‡(
	`gë_busy_buf„rs_cou¡
())

229  -
E_SB_UNRELEASED_BUFFERS
;

232 
	`sync_lock
(&
ªad_queue
.
queue_sync
);

235 
ªad_queue
.
°¨t_±r
) {

239 
	`sync_lock
(&
buf„r
->
buf„r_sync
);

241 
buf„r
 = 
ªad_queue
.
°¨t_±r
;

244 i‡(
ªad_queue
.
°¨t_±r
 =ªad_queue.
íd_±r
) {

245 
ªad_queue
.
íd_±r
 = 
NULL
;

247 
ªad_queue
.
°¨t_±r
 =Ñód_queue.°¨t_±r->
√xt_ö_queue
;

250 
buf„r
->
fuŒ_buf„r_∑π
 = 0;

252 
	`add_to_wrôe_li°
(
buf„r
);

255 
	`sync_u∆ock
(&
buf„r
->
buf„r_sync
);

259 
	`sync_u∆ock
(&
ªad_queue
.
queue_sync
);

261  
E_SB_SUCCESS
;

262 
	}
}

264 
	$buf„r_queue_‰ì
()

266 
sw≠_subbuf„r
 *
tmp
 = 
NULL
;

269 
	`sync_lock
(&
wrôe_queue
.
queue_sync
);

270 
	`sync_lock
(&
ªad_queue
.
queue_sync
);

271 
	`sync_lock
(&
buf„r_busy_sync
);

274 
ªad_queue
.
°¨t_±r
) {

275 
tmp
 = 
ªad_queue
.
°¨t_±r
;

276 
ªad_queue
.
°¨t_±r
 =Ñód_queue.°¨t_±r->
√xt_ö_queue
;

277 
	`buf„r_‰ì
(
tmp
->
d©a_buf„r
, 
queue_subbuf„r_size
);

278 
	`mem‹y_‰ì
(
tmp
);

282 
wrôe_queue
.
°¨t_±r
) {

283 
tmp
 = 
wrôe_queue
.
°¨t_±r
;

284 
wrôe_queue
.
°¨t_±r
 = wrôe_queue.°¨t_±r->
√xt_ö_queue
;

285 
	`buf„r_‰ì
(
tmp
->
d©a_buf„r
, 
queue_subbuf„r_size
);

286 
	`mem‹y_‰ì
(
tmp
);

290 
	`mem‹y_‰ì
(
queue_busy
);

291 
queue_busy
 = 
NULL
;

293 
queue_subbuf„r_size
 = 0;

294 
queue_subbuf„r_cou¡
 = 0;

295 
ªad_queue
.
°¨t_±r
 = 
NULL
;

296 
ªad_queue
.
íd_±r
 = 
NULL
;

297 
wrôe_queue
.
°¨t_±r
 = 
NULL
;

298 
wrôe_queue
.
íd_±r
 = 
NULL
;

301 
	`sync_u∆ock
(&
buf„r_busy_sync
);

302 
	`sync_u∆ock
(&
ªad_queue
.
queue_sync
);

303 
	`sync_u∆ock
(&
wrôe_queue
.
queue_sync
);

304 
	}
}

306 
	$is_buf„r_íough
(
sw≠_subbuf„r
 *
subbuf„r
,

307 
size_t
 
size
)

312  ((
queue_subbuf„r_size
-
subbuf„r
->
fuŒ_buf„r_∑π
Ë>
size
) ? 1 : 0;

313 
	}
}

315 
	$√xt_queue_ñemít
(
queue_t
 *
queue
)

318 i‡(
queue
->
°¨t_±r
 =queue->
íd_±r
)

319 
queue
->
íd_±r
 = 
NULL
;

321 
queue
->
°¨t_±r
 = queue->°¨t_±r->
√xt_ö_queue
;

322 --
queue
->
subbuf„rs_cou¡
;

323 
	}
}

326 
sw≠_subbuf„r
 *
	$gë_‰om_ªad_li°
()

328 
sw≠_subbuf„r
 *
ªsu…
 = 
NULL
;

331 
	`sync_lock
(&
ªad_queue
.
queue_sync
);

333 i‡(
ªad_queue
.
°¨t_±r
 =
NULL
) {

334 
ªsu…
 = 
NULL
;

335 
gë_‰om_ªad_li°_u∆ock
;

338 
ªsu…
 = 
ªad_queue
.
°¨t_±r
;

340 
	`√xt_queue_ñemít
(&
ªad_queue
);

342 
gë_‰om_ªad_li°_u∆ock
:

344 
	`sync_u∆ock
(&
ªad_queue
.
queue_sync
);

346  
ªsu…
;

347 
	}
}

350 
	$add_to_ªad_li°
(
sw≠_subbuf„r
 *
subbuf„r
)

353 
	`sync_lock
(&
ªad_queue
.
queue_sync
);

355 i‡(!
ªad_queue
.
°¨t_±r
)

356 
ªad_queue
.
°¨t_±r
 = 
subbuf„r
;

358 i‡(
ªad_queue
.
íd_±r
) {

359 
ªad_queue
.
íd_±r
->
√xt_ö_queue
 = 
subbuf„r
;

361 
ªad_queue
.
íd_±r
 =Ñód_queue.íd_±r->
√xt_ö_queue
;

363 
ªad_queue
.
íd_±r
 = 
subbuf„r
;

365 
ªad_queue
.
íd_±r
->
√xt_ö_queue
 = 
NULL
;

366 ++
ªad_queue
.
subbuf„rs_cou¡
;

369 
	`sync_u∆ock
(&
ªad_queue
.
queue_sync
);

370 
	}
}

373 
	$add_to_ªad_li°_wôh_ˇŒback
(
sw≠_subbuf„r
 *
subbuf„r
)

375 
ªsu…
 = 0;

377 
	`add_to_ªad_li°
(
subbuf„r
);

379 
ªsu…
 = 
	`sw≠_buf„r_ˇŒback
(
subbuf„r
);

381  
ªsu…
;

382 
	}
}

385 
	$gë_ªadabÀ_buf_˙t
()

387  
ªad_queue
.
subbuf„rs_cou¡
;

388 
	}
}

392 
sw≠_subbuf„r
 *
	$gë_‰om_wrôe_li°
(
size_t
 
size
, **
±r_to_wrôe
)

394 
sw≠_subbuf„r
 *
ªsu…
 = 
NULL
;

397 
queue_t
 
ˇŒback_queue
 = {

398 .
°¨t_±r
 = 
NULL
,

399 .
íd_±r
 = 
NULL
,

400 .
queue_sync
 = {

401 .
Êags
 = 0x0

404 
sw≠_subbuf„r
 *
tmp_buf„r
 = 
NULL
;

407 *
±r_to_wrôe
 = 
NULL
;

410 
	`sync_lock
(&
wrôe_queue
.
queue_sync
);

412 
wrôe_queue
.
°¨t_±r
) {

415 i‡(
	`is_buf„r_íough
(
wrôe_queue
.
°¨t_±r
, 
size
)) {

417 
ªsu…
 = 
wrôe_queue
.
°¨t_±r
;

418 *
±r_to_wrôe
 = (*)(()

419 (
	`buf„r_addªss
(
ªsu…
->
d©a_buf„r
)) +

420 
ªsu…
->
fuŒ_buf„r_∑π
);

424 
wrôe_queue
.
°¨t_±r
->
fuŒ_buf„r_∑π
 +
size
;

427 
	`sync_lock
(&
ªsu…
->
buf„r_sync
);

431 
ªsu…
 = 
wrôe_queue
.
°¨t_±r
;

433 
	`√xt_queue_ñemít
(&
wrôe_queue
);

436 i‡(!
ˇŒback_queue
.
°¨t_±r
)

437 
ˇŒback_queue
.
°¨t_±r
 = 
ªsu…
;

439 i‡(
ˇŒback_queue
.
íd_±r
)

440 
ˇŒback_queue
.
íd_±r
->
√xt_ö_queue
 = 
ªsu…
;

441 
ˇŒback_queue
.
íd_±r
 = 
ªsu…
;

442 
ˇŒback_queue
.
íd_±r
->
√xt_ö_queue
 = 
NULL
;

443 
ªsu…
 = 
NULL
;

448 
	`sync_u∆ock
(&
wrôe_queue
.
queue_sync
);

451 
tmp_buf„r
 = 
NULL
; 
ˇŒback_queue
.
°¨t_±r
; ) {

452 i‡(
ˇŒback_queue
.
°¨t_±r
 =ˇŒback_queue.
íd_±r
)

453 
ˇŒback_queue
.
íd_±r
 = 
NULL
;

455 
tmp_buf„r
 = 
ˇŒback_queue
.
°¨t_±r
;

456 
ˇŒback_queue
.
°¨t_±r
 = cÆlback_queue.°¨t_±r->
√xt_ö_queue
;

458 
	`add_to_ªad_li°_wôh_ˇŒback
(
tmp_buf„r
);

461  
ªsu…
;

462 
	}
}

465 
	$add_to_wrôe_li°
(
sw≠_subbuf„r
 *
subbuf„r
)

467 
	`sync_lock
(&
wrôe_queue
.
queue_sync
);

470 
subbuf„r
->
fuŒ_buf„r_∑π
 = 0;

472 i‡(!
wrôe_queue
.
°¨t_±r
)

473 
wrôe_queue
.
°¨t_±r
 = 
subbuf„r
;

475 i‡(
wrôe_queue
.
íd_±r
) {

476 
wrôe_queue
.
íd_±r
->
√xt_ö_queue
 = 
subbuf„r
;

477 
wrôe_queue
.
íd_±r
 = wrôe_queue.íd_±r->
√xt_ö_queue
;

479 
wrôe_queue
.
íd_±r
 = 
subbuf„r
;

481 
wrôe_queue
.
íd_±r
->
√xt_ö_queue
 = 
NULL
;

482 ++
wrôe_queue
.
subbuf„rs_cou¡
;

484 
	`sync_u∆ock
(&
wrôe_queue
.
queue_sync
);

485 
	}
}

488 
	$gë_wrôabÀ_buf_˙t
()

490  
wrôe_queue
.
subbuf„rs_cou¡
;

491 
	}
}

495 
	$add_to_busy_li°
(
sw≠_subbuf„r
 *
subbuf„r
)

498 
	`sync_lock
(&
buf„r_busy_sync
);

500 
subbuf„r
->
√xt_ö_queue
 = 
NULL
;

501 
queue_busy
[
queue_busy_œ°_ñemít
] = 
subbuf„r
;

502 
queue_busy_œ°_ñemít
 += 1;

505 
	`sync_u∆ock
(&
buf„r_busy_sync
);

506 
	}
}

509 
	$ªmove_‰om_busy_li°
(
sw≠_subbuf„r
 *
subbuf„r
)

511 
ªsu…
 = -
E_SB_NO_SUBBUFFER_IN_BUSY
;

512 
i
;

515 
	`sync_lock
(&
buf„r_busy_sync
);

518 
i
 = 0; i < 
queue_busy_œ°_ñemít
; i++) {

519 i‡(
queue_busy
[
i
] =
subbuf„r
) {

521 
queue_busy
[
i
] = queue_busy[
queue_busy_œ°_ñemít
 - 1];

522 
queue_busy_œ°_ñemít
 -= 1;

523 
ªsu…
 = 
E_SB_SUCCESS
;

529 
	`sync_u∆ock
(&
buf„r_busy_sync
);

531  
ªsu…
;

532 
	}
}

535 
	$buf„r_queue_Êush
()

537 
sw≠_subbuf„r
 *
buf„r
 = 
wrôe_queue
.
°¨t_±r
;

540 
	`sync_lock
(&
wrôe_queue
.
queue_sync
);

542 
wrôe_queue
.
°¨t_±r
 &&

543 
wrôe_queue
.
°¨t_±r
->
fuŒ_buf„r_∑π
) {

547 
	`sync_lock
(&
buf„r
->
buf„r_sync
);

549 
buf„r
 = 
wrôe_queue
.
°¨t_±r
;

550 
	`√xt_queue_ñemít
(&
wrôe_queue
);

551 
	`add_to_ªad_li°
(
buf„r
);

554 
	`sync_u∆ock
(&
buf„r
->
buf„r_sync
);

558 
	`sync_u∆ock
(&
wrôe_queue
.
queue_sync
);

559 
	}
}

562 
	$gë_busy_buf„rs_cou¡
()

564 
ªsu…
;

566 
	`sync_lock
(&
buf„r_busy_sync
);

567 
ªsu…
 = 
queue_busy_œ°_ñemít
;

568 
	`sync_u∆ock
(&
buf„r_busy_sync
);

570  
ªsu…
;

571 
	}
}

574 
	$gë_∑ges_cou¡_ö_subbuf„r
()

577  (
∑ges_‹dî_ö_subbuf„r
) ? 2 << (pages_order_in_subbuffer - 1) : 1;

578 
	}
}

	@buffer/buffer_queue.h

27 #i‚de‡
__BUFFER_QUEUE_H__


28 
	#__BUFFER_QUEUE_H__


	)

30 
	~"buf„r_des¸ùti⁄.h
"

32 
buf„r_queue_Æloˇti⁄
(
size_t
 
subbuf„r_size
, 
subbuf„rs_cou¡
);

33 
buf„r_queue_‰ì
();

34 
buf„r_queue_ª£t
();

35 
buf„r_queue_Êush
();

36 
sw≠_subbuf„r
 *
gë_‰om_wrôe_li°
(
size_t
 
size
, **
±r_to_wrôe
);

37 
sw≠_subbuf„r
 *
gë_‰om_ªad_li°
();

38 
add_to_wrôe_li°
(
sw≠_subbuf„r
 *
subbuf„r
);

39 
add_to_ªad_li°
(
sw≠_subbuf„r
 *
subbuf„r
);

40 
add_to_busy_li°
(
sw≠_subbuf„r
 *
subbuf„r
);

41 
ªmove_‰om_busy_li°
(
sw≠_subbuf„r
 *
subbuf„r
);

43 
gë_ªadabÀ_buf_˙t
();

44 
gë_wrôabÀ_buf_˙t
();

45 
gë_busy_buf„rs_cou¡
();

46 
gë_∑ges_cou¡_ö_subbuf„r
();

	@buffer/data_types.h

25 #i‚de‡
__DATA_TYPES_H__


26 
	#__DATA_TYPES_H__


	)

29 
	~<löux/•ölock.h
>

32 
	g∑ge
;

35 
	ssync_t
 {

36 
•ölock_t
 
	m•ölock
;

37 
	mÊags
;

41 
∑ge
 *
	tsw≠_subbuf„r_±r
;

	@buffer/kernel_operations.h

27 #i‚de‡
__KERNEL_OPERATIONS_H__


28 
	#__KERNEL_OPERATIONS_H__


	)

30 
	~<löux/moduÀ.h
>

31 
	~<löux/¶ab.h
>

32 
	~<löux/£m≠h‹e.h
>

33 
	~<löux/•ölock.h
>

34 
	~<löux/°rög.h
>

35 
	~<löux/kî√l.h
>

36 
	~<löux/gÂ.h
>

37 
	~<löux/mm.h
>

39 
	~"d©a_ty≥s.h
"

43 
	#¥öt_debug
(
msg
, 
¨gs
...) \

44 
	`¥ötk
(
KERN_DEBUG
 "SWAP_BUFFER DEBUG : " 
msg
, ##
¨gs
)

	)

45 
	#¥öt_msg
(
msg
, 
¨gs
...) \

46 
	`¥ötk
(
KERN_INFO
 "SWAP_BUFFER : " 
msg
, ##
¨gs
)

	)

47 
	#¥öt_w¨n
(
msg
, 
¨gs
...) \

48 
	`¥ötk
(
KERN_WARNING
 "SWAP_BUFFER WARNING : " 
msg
, ##
¨gs
)

	)

49 
	#¥öt_îr
(
msg
, 
¨gs
...) \

50 
	`¥ötk
(
KERN_ERR
 "SWAP_BUFFER ERROR : " 
msg
, ##
¨gs
)

	)

51 
	#¥öt_¸ô
(
msg
, 
¨gs
...) \

52 
	`¥ötk
(
KERN_CRIT
 "SWAP_BUFFER CRITICAL : " 
msg
, ##
¨gs
)

	)

60 
ölöe
 
	$sync_öô
(
sync_t
 *
buf„r_sync
)

62 
	`•ö_lock_öô
(&
buf„r_sync
->
•ölock
);

63 
	}
}

66 
ölöe
 
	$sync_lock
(
sync_t
 *
buf„r_sync
)

68 
	`•ö_lock_úqßve
(&
buf„r_sync
->
•ölock
, buf„r_sync->
Êags
);

69 
	}
}

72 
ölöe
 
	$sync_u∆ock
(
sync_t
 *
buf„r_sync
)

74 
	`•ö_u∆ock_úqª°‹e
(&
buf„r_sync
->
•ölock
, buf„r_sync->
Êags
);

75 
	}
}

82 
	#mem‹y_Æloˇti⁄
(
mem‹y_size
Ë
	`kmÆloc
(mem‹y_size, 
GFP_KERNEL
)

	)

83 
	#mem‹y_‰ì
(
±r
Ë
	`k‰ì
’å)

	)

87 
	#buf„r_Æloˇti⁄
(
mem‹y_size
) \

88 
	`Æloc_∑ges
(
GFP_KERNEL
, (
∑ges_‹dî_ö_subbuf„r
 >= 0) ? \

89 
∑ges_‹dî_ö_subbuf„r
 : \

90 
	`gë_‹dî_f‹_Æloc_∑ges
(
mem‹y_size
))

	)

92 
	#buf„r_‰ì
(
±r
, 
subbuf_size
) \

93 
	`__‰ì_∑ges
(
±r
, (
∑ges_‹dî_ö_subbuf„r
 >= 0) ? \

94 
∑ges_‹dî_ö_subbuf„r
 : \

95 
	`gë_‹dî_f‹_Æloc_∑ges
(
subbuf_size
))

	)

97 
	#buf„r_addªss
(
buf„r_±r
Ë
	`∑ge_addªss
(buf„r_±r)

	)

98 
	#£t_∑ges_‹dî_ö_subbuf„r
(
mem‹y_size
) \

99 
∑ges_‹dî_ö_subbuf„r
 = 
	`gë_‹dî_f‹_Æloc_∑ges
(
mem‹y_size
)

	)

102 
ölöe
 
	$√¨e°_powî_of_two
(
numbî
)

104 
ªsu…
 = 0;

105 
two_to_the_powî
 = 1;

108 i‡(
numbî
 == 1)

109  
ªsu…
;

111 
two_to_the_powî
 < 
numbî
) {

112 
two_to_the_powî
 <<= 1;

113 
ªsu…
++;

116  
ªsu…
;

117 
	}
}

119 
ölöe
 
	$gë_‹dî_f‹_Æloc_∑ges
(
size_t
 
mem‹y_size
)

123 
size_t
 
ªmaödî
 = (
mem‹y_size
 % 
PAGE_SIZE
) ?

124 (
mem‹y_size
 % 
PAGE_SIZE
) : PAGE_SIZE;

127 
size_t
 
Æig√d_size
 = 
mem‹y_size
 + (
PAGE_SIZE
 - 
ªmaödî
);

129  
	`√¨e°_powî_of_two
(
Æig√d_size
 / 
PAGE_SIZE
);

130 
	}
}

	@buffer/swap_buffer.mod.c

1 
	~<löux/moduÀ.h
>

2 
	~<löux/vîmagic.h
>

3 
	~<löux/compûî.h
>

5 
MODULE_INFO
(
vîmagic
, 
VERMAGIC_STRING
);

7 
moduÀ
 
__this_moduÀ


8 
__©åibuã__
((
£˘i⁄
(".gnu.linkonce.this_module"))) = {

9 .
«me
 = 
KBUILD_MODNAME
,

10 .
	göô
 = 
öô_moduÀ
,

11 #ifde‡
CONFIG_MODULE_UNLOAD


12 .
	gexô
 = 
˛ónup_moduÀ
,

14 .
	g¨ch
 = 
MODULE_ARCH_INIT
,

17 c⁄° 
	g__moduÀ_dïíds
[]

18 
__u£d


19 
__©åibuã__
((
£˘i⁄
(".modinfo"))) =

23 
MODULE_INFO
(
§cvîsi⁄
, "ABD4EEA058808FD9FD3FD3E");

	@buffer/swap_buffer_errors.h

27 #i‚de‡
__SWAP_BUFFER_ERRORS_H__


28 
	#__SWAP_BUFFER_ERRORS_H__


	)

30 
	e_sw≠_buf„r_îr‹s
 {

31 
	mE_SB_SUCCESS
 = 0,

32 
	mE_SB_UNRELEASED_BUFFERS
 = 1,

34 
	mE_SB_NO_WRITABLE_BUFFERS
 = 2,

35 
	mE_SB_WRONG_DATA_SIZE
 = 3,

37 
	mE_SB_IS_STOPPED
 = 4,

39 
	mE_SB_OVERLAP
 = 5,

41 
	mE_SB_NO_READABLE_BUFFERS
 = 6,

42 
	mE_SB_NO_CALLBACK
 = 7,

43 
	mE_SB_NO_MEM_QUEUE_BUSY
 = 8,

44 
	mE_SB_NO_MEM_BUFFER_STRUCT
 = 9,

46 
	mE_SB_NO_MEM_DATA_BUFFER
 = 10,

48 
	mE_SB_NO_SUBBUFFER_IN_BUSY
 = 11,

49 
	mE_SB_NOT_ALLOC
 = 12,

50 
	mE_SB_WRONG_THRESHOLD
 = 13

	@buffer/swap_buffer_module.c

27 
	~"sw≠_buf„r_moduÀ.h
"

28 
	~"buf„r_queue.h
"

29 
	~"buf„r_des¸ùti⁄.h
"

30 
	~"sw≠_buf„r_îr‹s.h
"

31 
	~"kî√l_›î©i⁄s.h
"

34 
	e_sw≠_buf„r_°©us_mask
 {

35 
	mBUFFER_FREE
 = 0,

36 
	mBUFFER_ALLOC
 = 1,

37 
	mBUFFER_PAUSE
 = 2,

38 
	mBUFFER_WORK
 = 4

47 
	gsw≠_buf„r_°©us
 = 
BUFFER_FREE
;

50 (*
	tsubbuf„r_ˇŒback_ty≥
)();

53 
subbuf„r_ˇŒback_ty≥
 
subbuf„r_ˇŒback
 = 
NULL
;

56 
size_t
 
subbuf„rs_size
 = 0;

59 
subbuf„rs_num
 = 0;

61 
íough_wrôabÀ_bufs
 = 0;

62 
mö_wrôabÀ_bufs
 = 0;

63 (*
low_mem_cb
)(Ë
NULL
;

64 (*
íough_mem_cb
)(Ë
NULL
;

67 
ölöe
 
	$¨ós_ovîœp
(c⁄° *
¨ó1
,c⁄° *
¨ó2
, 
size_t
 
size
)

69 
i
;

71 
i
 = 0; i < 
size
; i++)

72 i‡((
¨ó1
 + 
i
 =
¨ó2
) || (area2 + i ==área1))

76 
	}
}

78 
ölöe
 
	$≥r˚¡_to_cou¡
(
≥r˚¡
,

79 
˙t
)

81  (
≥r˚¡
 * 
˙t
) / 100;

82 
	}
}

84 
	$sw≠_buf„r_öô
(
buf„r_öô_t
 *
buf_öô
)

86 
ªsu…
 = -1;

88 
sw≠_buf„r_°©us
 &~
BUFFER_WORK
;

89 
	`¥öt_debug
("°©u†buf„∏°› = %d\n", 
sw≠_buf„r_°©us
);

91 i‡((
buf_öô
->
t›_thªshﬁd
 > 100Ë|| (buf_öô->
lowî_thªshﬁd
 > 100) ||

92 (
buf_öô
->
t›_thªshﬁd
 < buf_öô->
lowî_thªshﬁd
))

93  -
E_SB_WRONG_THRESHOLD
;

95 
mö_wrôabÀ_bufs
 = 
	`≥r˚¡_to_cou¡
(
buf_öô
->
lowî_thªshﬁd
,

96 
buf_öô
->
ƒ_subbuf„rs
);

98 
íough_wrôabÀ_bufs
 = 
	`≥r˚¡_to_cou¡
(
buf_öô
->
t›_thªshﬁd
,

99 
buf_öô
->
ƒ_subbuf„rs
);

101 
low_mem_cb
 = 
buf_öô
->low_mem_cb;

102 
íough_mem_cb
 = 
buf_öô
->enough_mem_cb;

104 i‡((
sw≠_buf„r_°©us
 & 
BUFFER_ALLOC
) &&

105 (
subbuf„rs_size
 =
buf_öô
->
subbuf„r_size
) &&

106 (
subbuf„rs_num
 =
buf_öô
->
ƒ_subbuf„rs
) &&

107 ((
subbuf„r_ˇŒback_ty≥
)
subbuf„r_ˇŒback
 ==

108 
buf_öô
->
subbuf„r_fuŒ_cb
)) {

109 
ªsu…
 = 
	`buf„r_queue_ª£t
();

110 
sw≠_buf„r_öô_w‹k
;

113 
subbuf„r_ˇŒback
 = 
buf_öô
->
subbuf„r_fuŒ_cb
;

114 
subbuf„rs_size
 = 
buf_öô
->
subbuf„r_size
;

115 
subbuf„rs_num
 = 
buf_öô
->
ƒ_subbuf„rs
;

117 
ªsu…
 = 
	`buf„r_queue_Æloˇti⁄
(
subbuf„rs_size
, 
subbuf„rs_num
);

118 i‡(
ªsu…
 < 0)

119  
ªsu…
;

121 
ªsu…
 = 
	`gë_∑ges_cou¡_ö_subbuf„r
();

123 
sw≠_buf„r_°©us
 |
BUFFER_ALLOC
;

124 
	`¥öt_debug
("°©u†buf„∏Ælo¯%d\n", 
sw≠_buf„r_°©us
);

126 
sw≠_buf„r_öô_w‹k
:

127 
sw≠_buf„r_°©us
 |
BUFFER_WORK
;

128 
	`¥öt_debug
("°©u†buf„∏w‹k = %d\n", 
sw≠_buf„r_°©us
);

130  
ªsu…
;

131 
	}
}

132 
EXPORT_SYMBOL_GPL
(
sw≠_buf„r_öô
);

135 
	$sw≠_buf„r_unöô
()

138 i‡(!(
sw≠_buf„r_°©us
 & 
BUFFER_ALLOC
))

139  -
E_SB_NOT_ALLOC
;

142 
sw≠_buf„r_°©us
 &~
BUFFER_WORK
;

143 
	`¥öt_debug
("°©u†buf„∏°› = %d\n", 
sw≠_buf„r_°©us
);

146 i‡(
	`gë_busy_buf„rs_cou¡
())

147  -
E_SB_UNRELEASED_BUFFERS
;

150 
	`buf„r_queue_‰ì
();

152 
subbuf„r_ˇŒback
 = 
NULL
;

153 
subbuf„rs_size
 = 0;

154 
subbuf„rs_num
 = 0;

155 
mö_wrôabÀ_bufs
 = 0;

156 
íough_wrôabÀ_bufs
 = 0;

157 
low_mem_cb
 = 
NULL
;

158 
íough_mem_cb
 = 
NULL
;

160 
sw≠_buf„r_°©us
 &~
BUFFER_ALLOC
;

161 
	`¥öt_debug
("°©u†buf„∏dóŒo¯%d\n", 
sw≠_buf„r_°©us
);

163  
E_SB_SUCCESS
;

164 
	}
}

165 
EXPORT_SYMBOL_GPL
(
sw≠_buf„r_unöô
);

168 
ssize_t
 
	$sw≠_buf„r_wrôe
(*
d©a
, 
size_t
 
size
)

170 
ªsu…
 = 
E_SB_SUCCESS
;

171 
sw≠_subbuf„r
 *
buf„r_to_wrôe
 = 
NULL
;

172 *
±r_to_wrôe
 = 
NULL
;

175 i‡((
size
 > 
subbuf„rs_size
) || (size == 0))

176  -
E_SB_WRONG_DATA_SIZE
;

179 i‡(!(
sw≠_buf„r_°©us
 & 
BUFFER_WORK
))

180  -
E_SB_IS_STOPPED
;

183 
buf„r_to_wrôe
 = 
	`gë_‰om_wrôe_li°
(
size
, &
±r_to_wrôe
);

184 i‡(!
buf„r_to_wrôe
)

185  -
E_SB_NO_WRITABLE_BUFFERS
;

188 i‡(
	`¨ós_ovîœp
(
±r_to_wrôe
, 
d©a
, 
size
)) {

189 
ªsu…
 = -
E_SB_OVERLAP
;

190 
buf_wrôe_£m_po°
;

196 
	`mem˝y
(
±r_to_wrôe
, 
d©a
, 
size
);

198 
ªsu…
 = 
size
;

200 i‡((
	`gë_wrôabÀ_buf_˙t
(Ë< 
mö_wrôabÀ_bufs
) &&

201 !(
sw≠_buf„r_°©us
 & 
BUFFER_PAUSE
)) {

202 
sw≠_buf„r_°©us
 |
BUFFER_PAUSE
;

203 i‡(
low_mem_cb
 !
NULL
)

204 
	`low_mem_cb
();

208 
buf_wrôe_£m_po°
:

209 
	`sync_u∆ock
(&
buf„r_to_wrôe
->
buf„r_sync
);

211  
ªsu…
;

212 
	}
}

213 
EXPORT_SYMBOL_GPL
(
sw≠_buf„r_wrôe
);

216 
	$sw≠_buf„r_gë
(
sw≠_subbuf„r
 **
subbuf„r
)

218 
ªsu…
 = 0;

219 
sw≠_subbuf„r
 *
buf„r_to_ªad
 = 
NULL
;

222 i‡(!(
sw≠_buf„r_°©us
 & 
BUFFER_WORK
))

223  -
E_SB_IS_STOPPED
;

226 
buf„r_to_ªad
 = 
	`gë_‰om_ªad_li°
();

227 i‡(!
buf„r_to_ªad
)

228  -
E_SB_NO_READABLE_BUFFERS
;

231 
buf„r_to_ªad
->
√xt_ö_queue
 = 
NULL
;

232 
	`add_to_busy_li°
(
buf„r_to_ªad
);

234 *
subbuf„r
 = 
buf„r_to_ªad
;

236 
ªsu…
 = 
	`gë_∑ges_cou¡_ö_subbuf„r
();

238  
ªsu…
;

239 
	}
}

240 
EXPORT_SYMBOL_GPL
(
sw≠_buf„r_gë
);

243 
	$sw≠_buf„r_ªÀa£
(
sw≠_subbuf„r
 **
subbuf„r
)

245 
ªsu…
;

248 
ªsu…
 = 
	`ªmove_‰om_busy_li°
(*
subbuf„r
);

249 i‡(
ªsu…
 < 0)

250  
ªsu…
;

253 
	`add_to_wrôe_li°
(*
subbuf„r
);

255 i‡((
sw≠_buf„r_°©us
 & 
BUFFER_PAUSE
) &&

256 (
	`gë_wrôabÀ_buf_˙t
(Ë>
íough_wrôabÀ_bufs
)) {

257 
sw≠_buf„r_°©us
 &~
BUFFER_PAUSE
;

258 i‡(
íough_mem_cb
 !
NULL
)

259 
	`íough_mem_cb
();

262  
E_SB_SUCCESS
;

263 
	}
}

264 
EXPORT_SYMBOL_GPL
(
sw≠_buf„r_ªÀa£
);

267 
	$sw≠_buf„r_Êush
()

269 
ªsu…
;

272 
	`buf„r_queue_Êush
();

275 
ªsu…
 = 
	`gë_ªadabÀ_buf_˙t
();

277  
ªsu…
;

278 
	}
}

279 
EXPORT_SYMBOL_GPL
(
sw≠_buf„r_Êush
);

282 
	$sw≠_buf„r_ˇŒback
(*
buf„r
)

284 
ªsu…
;

286 i‡(!
subbuf„r_ˇŒback
) {

287  -
E_SB_NO_CALLBACK
;

290 
ªsu…
 = 
	`subbuf„r_ˇŒback
();

291 i‡(
ªsu…
 < 0)

292 
	`¥öt_îr
("CÆlbackÉº‹! Eº‹ code: %d\n", 
ªsu…
);

294  
ªsu…
;

295 
	}
}

297 
__öô
 
	$sw≠_buf„r_moduÀ_öô
()

299 
	`¥ötk
(
KERN_NOTICE
 "SWAP_BUFFER : Buffer module initialized\n");

300  
E_SB_SUCCESS
;

301 
	}
}

303 
__exô
 
	$sw≠_buf„r_moduÀ_exô
()

305 i‡(
sw≠_buf„r_°©us
 & 
BUFFER_ALLOC
)

306 
	`sw≠_buf„r_unöô
();

307 
	`¥ötk
(
KERN_NOTICE
 "SWAP_BUFFER : Buffer module unintialized\n");

308 
	}
}

310 
moduÀ_öô
(
sw≠_buf„r_moduÀ_öô
);

311 
moduÀ_exô
(
sw≠_buf„r_moduÀ_exô
);

313 
MODULE_LICENSE
("GPL");

314 
MODULE_DESCRIPTION
("SWAP buffer module");

315 
MODULE_AUTHOR
("Aksenov A.S.");

	@buffer/swap_buffer_module.h

27 #i‚de‡
__SWAP_BUFFER_MODULE_H__


28 
	#__SWAP_BUFFER_MODULE_H__


	)

30 
	~<löux/ty≥s.h
>

32 
	gsw≠_subbuf„r
;

34 
	sbuf„r_öô_t
 {

35 
size_t
 
	msubbuf„r_size
;

36 
	mƒ_subbuf„rs
;

37 (*
	msubbuf„r_fuŒ_cb
)();

41 
	mlowî_thªshﬁd
;

42 (*
	mlow_mem_cb
)();

46 
	mt›_thªshﬁd
;

47 (*
	míough_mem_cb
)();

53 
sw≠_buf„r_öô
(
buf„r_öô_t
 *
buf_öô
);

58 
sw≠_buf„r_unöô
();

62 
ssize_t
 
sw≠_buf„r_wrôe
(* 
d©a
, 
size_t
 
size
);

66 
sw≠_buf„r_gë
(
sw≠_subbuf„r
 **
subbuf„r
);

70 
sw≠_buf„r_ªÀa£
(
sw≠_subbuf„r
 **
subbuf„r
);

73 
sw≠_buf„r_Êush
();

	@buffer/swap_buffer_to_buffer_queue.h

27 #i‚de‡
__SWAP_BUFFER_TO_BUFFER_QUEUE_H__


28 
	#__SWAP_BUFFER_TO_BUFFER_QUEUE_H__


	)

30 
sw≠_buf„r_ˇŒback
(*
buf„r
);

	@driver/app_manage.h

26 #i‚de‡
__APP_MANAGE_H__


27 
	#__APP_MANAGE_H__


	)

29 
	~"us_öãø˘i⁄.h
"

30 
	~"us_öãø˘i⁄_msg.h
"

32 
ölöe
 
	$≠p_m™age_∑u£_≠ps
()

34 
us_öãø˘i⁄_k2u_msg_t
 
us_öt_msg
 = 
US_INT_PAUSE_APPS
;

36  
	`us_öãø˘i⁄_£nd_msg
(&
us_öt_msg
, (us_int_msg));

37 
	}
}

39 
ölöe
 
	$≠p_m™age_c⁄t_≠ps
()

41 
us_öãø˘i⁄_k2u_msg_t
 
us_öt_msg
 = 
US_INT_CONT_APPS
;

43  
	`us_öãø˘i⁄_£nd_msg
(&
us_öt_msg
, (us_int_msg));

44 
	}
}

	@driver/device_driver.c

25 
	~<löux/ty≥s.h
>

26 
	~<löux/fs.h
>

27 
	~<löux/cdev.h
>

28 
	~<löux/îr.h
>

29 
	~<löux/devi˚.h
>

30 
	~<löux/io˘l.h
>

31 
	~<löux/¶ab.h
>

32 
	~<löux/mm.h
>

33 
	~<löux/•li˚.h
>

34 
	~<löux/sched.h
>

35 
	~<löux/moduÀ.h
>

36 
	~<löux/waô.h
>

37 
	~<löux/w‹kqueue.h
>

38 
	~<asm/uac˚ss.h
>

40 
	~<ksyms/ksyms.h
>

42 
	~"devi˚_drivî.h
"

43 
	~"sw≠_drivî_îr‹s.h
"

44 
	~"drivî_to_buf„r.h
"

45 
	~"sw≠_io˘l.h
"

46 
	~"drivî_defs.h
"

47 
	~"devi˚_drivî_to_drivî_to_buf„r.h
"

48 
	~"drivî_to_buf„r.h
"

49 
	~"drivî_to_msg.h
"

51 
	#SWAP_DEVICE_NAME
 "sw≠_devi˚"

	)

53 
	#MAXIMUM_SUBBUFFER_SIZE
 (64 * 1024)

	)

56 
sw≠_devi˚_›í
(
öode
 *öode, 
fûe
 *
fûp
);

57 
sw≠_devi˚_ªÀa£
(
öode
 *öode, 
fûe
 *file);

58 
ssize_t
 
sw≠_devi˚_ªad
(
fûe
 *
fûp
, 
__u£r
 *
buf
,

59 
size_t
 
cou¡
, 
loff_t
 *
f_pos
);

60 
sw≠_devi˚_io˘l
(
fûe
 *
fûp
, 
cmd
,

61 
¨g
);

62 
ssize_t
 
sw≠_devi˚_•li˚_ªad
(
fûe
 *
fûp
, 
loff_t
 *
µos
,

63 
pùe_öode_öfo
 *
pùe
, 
size_t
 
Àn
,

64 
Êags
);

67 c⁄° 
fûe_›î©i⁄s
 
	gsw≠_devi˚_f›s
 = {

68 .
ow√r
 = 
THIS_MODULE
,

69 .
	gªad
 = 
sw≠_devi˚_ªad
,

70 .
	g›í
 = 
sw≠_devi˚_›í
,

71 .
	gªÀa£
 = 
sw≠_devi˚_ªÀa£
,

72 .
	gu∆ocked_io˘l
 = 
sw≠_devi˚_io˘l
,

73 .
	g•li˚_ªad
 = 
sw≠_devi˚_•li˚_ªad
,

77 
	$ssize_t
(*
	t•li˚_to_pùe_p_t
)(
	tpùe_öode_öfo
 *
	tpùe
,

78 
	t•li˚_pùe_desc
 *
	t•d
);

79 (*
	t•li˚_grow_•d_p_t
)(c⁄° 
	tpùe_öode_öfo
 *
	tpùe
,

80 
	t•li˚_pùe_desc
 *
	t•d
);

82 
•li˚_to_pùe_p_t
 
•li˚_to_pùe_p
 = 
NULL
;

83 
•li˚_grow_•d_p_t
 
•li˚_grow_•d_p
 = 
NULL
;

85 
msg_h™dÀr_t
 
msg_h™dÀr
 = 
NULL
;

88 
dev_t
 
sw≠_devi˚_no
 = 0;

91 
cdev
 *
sw≠_devi˚_cdev
 = 
NULL
;

94 
˛ass
 *
sw≠_devi˚_˛ass
 = 
NULL
;

97 
devi˚
 *
sw≠_devi˚_devi˚
 = 
NULL
;

100 
	`DECLARE_WAIT_QUEUE_HEAD
(
sw≠_devi˚_waô
);

103 
©omic_t
 
Êag_wake_up
 = 
	`ATOMIC_INIT
(0);

105 
	$__bŸtom_wake_up
()

107 i‡(
	`waôqueue_a˘ive
(&
sw≠_devi˚_waô
))

108 
	`wake_up_öãºu±ibÀ
(&
sw≠_devi˚_waô
);

109 
	}
}

111 
	$bŸtom_wake_up
(
w‹k_°ru˘
 *
w‹k
)

113 i‡(
	`©omic_ªad
(&
Êag_wake_up
)) {

114 
	`©omic_£t
(&
Êag_wake_up
, 0);

115 
	`__bŸtom_wake_up
();

117 
	}
}

119 
DECLARE_WORK
(
w_wake_up
, 
bŸtom_wake_up
);

121 
	$exô_w_wake_up
()

123 
	`Êush_scheduÀd_w‹k
();

124 
	`__bŸtom_wake_up
();

125 
	}
}

130 
	$sw≠_devi˚_•li˚_shrök_•d
(
pùe_öode_öfo
 *
pùe
,

131 
•li˚_pùe_desc
 *
•d
)

133 i‡(
pùe
->
buf„rs
 <
PIPE_DEF_BUFFERS
)

136 
	`k‰ì
(
•d
->
∑ges
);

137 
	`k‰ì
(
•d
->
∑πül
);

138 
	}
}

142 
	$sw≠_devi˚_öô
()

144 
ªsu…
;

147 
ªsu…
 = 
	`Æloc_chrdev_ªgi⁄
(&
sw≠_devi˚_no
, 0, 1, 
SWAP_DEVICE_NAME
);

148 i‡(
ªsu…
 < 0) {

149 
	`¥öt_¸ô
("MajorÇumberállocation has failed\n");

150 
ªsu…
 = -
E_SD_ALLOC_CHRDEV_FAIL
;

151 
öô_Áû
;

156 
sw≠_devi˚_˛ass
 = 
	`˛ass_¸óã
(
THIS_MODULE
, 
SWAP_DEVICE_NAME
);

157 i‡(
	`IS_ERR
(
sw≠_devi˚_˛ass
)) {

158 
	`¥öt_¸ô
("Class creation has failed\n");

159 
ªsu…
 = -
E_SD_CLASS_CREATE_FAIL
;

160 
öô_Áû
;

164 
sw≠_devi˚_cdev
 = 
	`cdev_Æloc
();

165 i‡(!
sw≠_devi˚_cdev
) {

166 
	`¥öt_¸ô
("Cdev structureállocation has failed\n");

167 
ªsu…
 = -
E_SD_CDEV_ALLOC_FAIL
;

168 
öô_Áû
;

172 
	`cdev_öô
(
sw≠_devi˚_cdev
, &
sw≠_devi˚_f›s
);

175 
ªsu…
 = 
	`cdev_add
(
sw≠_devi˚_cdev
, 
sw≠_devi˚_no
, 1);

176 i‡(
ªsu…
 < 0) {

177 
	`¥öt_¸ô
("Deviceádding has failed\n");

178 
ªsu…
 = -
E_SD_CDEV_ADD_FAIL
;

179 
öô_Áû
;

183 
sw≠_devi˚_devi˚
 = 
	`devi˚_¸óã
(
sw≠_devi˚_˛ass
, 
NULL
, 
sw≠_devi˚_no
,

184 "%s", 
SWAP_DEVICE_NAME
);

185 i‡(
	`IS_ERR
(
sw≠_devi˚_devi˚
)) {

186 
	`¥öt_¸ô
("Device struct creating has failed\n");

187 
ªsu…
 = -
E_SD_DEVICE_CREATE_FAIL
;

188 
öô_Áû
;

192 
•li˚_to_pùe_p
 = (
•li˚_to_pùe_p_t
)
	`sw≠_ksyms
("splice_to_pipe");

193 i‡(!
•li˚_to_pùe_p
) {

194 
	`¥öt_îr
("splice_to_pipe()Çot found!\n");

195 
ªsu…
 = -
E_SD_NO_SPLICE_FUNCS
;

196 
öô_Áû
;

199 
•li˚_grow_•d_p
 = (
•li˚_grow_•d_p_t
)
	`sw≠_ksyms
("splice_grow_spd");

200 i‡(!
•li˚_grow_•d_p
) {

201 
	`¥öt_îr
("splice_grow_spd()Çot found!\n");

202 
ªsu…
 = -
E_SD_NO_SPLICE_FUNCS
;

203 
öô_Áû
;

208 
öô_Áû
:

209 i‡(
sw≠_devi˚_cdev
) {

210 
	`cdev_dñ
(
sw≠_devi˚_cdev
);

212 i‡(
sw≠_devi˚_˛ass
) {

213 
	`˛ass_de°roy
(
sw≠_devi˚_˛ass
);

215 i‡(
sw≠_devi˚_no
) {

216 
	`uƒegi°î_chrdev_ªgi⁄
(
sw≠_devi˚_no
, 1);

218  
ªsu…
;

219 
	}
}

222 
	$sw≠_devi˚_exô
()

224 
	`exô_w_wake_up
();

226 
•li˚_to_pùe_p
 = 
NULL
;

227 
•li˚_grow_•d_p
 = 
NULL
;

229 
	`devi˚_de°roy
(
sw≠_devi˚_˛ass
, 
sw≠_devi˚_no
);

230 
	`cdev_dñ
(
sw≠_devi˚_cdev
);

231 
	`˛ass_de°roy
(
sw≠_devi˚_˛ass
);

232 
	`uƒegi°î_chrdev_ªgi⁄
(
sw≠_devi˚_no
, 1);

233 
	}
}

235 
	$sw≠_devi˚_›í
(
öode
 *öode, 
fûe
 *
fûp
)

239 
	}
}

241 
	$sw≠_devi˚_ªÀa£
(
öode
 *öode, 
fûe
 *
fûp
)

245 
	}
}

247 
ssize_t
 
	$sw≠_devi˚_ªad
(
fûe
 *
fûp
, 
__u£r
 *
buf
,

248 
size_t
 
cou¡
, 
loff_t
 *
f_pos
)

252 
	`DEFINE_WAIT
(
waô
);

253 
ªsu…
;

256 (
ªsu…
 = 
	`drivî_to_buf„r_√xt_buf„r_to_ªad
()Ë!
E_SD_SUCCESS
) {

262 
	`¥ï¨e_to_waô
(&
sw≠_devi˚_waô
, &
waô
, 
TASK_INTERRUPTIBLE
);

264 i‡(
ªsu…
 < 0) {

265 
ªsu…
 = 0;

266 
sw≠_devi˚_ªad_îr‹
;

267 } i‡(
ªsu…
 =
E_SD_NO_DATA_TO_READ
) {

270 i‡(
fûp
->
f_Êags
 & 
O_NONBLOCK
) {

271 
ªsu…
 = -
EAGAIN
;

272 
sw≠_devi˚_ªad_îr‹
;

274 i‡(
	`sig«l_≥ndög
(
cuºít
)) {

275 
ªsu…
 = -
ERESTARTSYS
;

276 
sw≠_devi˚_ªad_îr‹
;

278 
	`scheduÀ
();

279 
	`föish_waô
(&
sw≠_devi˚_waô
, &
waô
);

283 
ªsu…
 = 
	`drivî_to_buf„r_ªad
(
buf
, 
cou¡
);

285 i‡(
ªsu…
 < 0)

286 
ªsu…
 = 0;

289  
ªsu…
;

291 
sw≠_devi˚_ªad_îr‹
:

292 
	`föish_waô
(&
sw≠_devi˚_waô
, &
waô
);

294  
ªsu…
;

295 
	}
}

297 
	$sw≠_devi˚_io˘l
(
fûe
 *
fûp
, 
cmd
,

298 
¨g
)

300 
ªsu…
;

302 
cmd
) {

303 
SWAP_DRIVER_BUFFER_INITIALIZE
:

305 
buf„r_öôülize
 
öôülize_°ru˘
;

307 
ªsu…
 = 
	`c›y_‰om_u£r
(&
öôülize_°ru˘
, (*)
¨g
,

308 (
buf„r_öôülize
));

309 i‡(
ªsu…
) {

313 i‡(
öôülize_°ru˘
.
size
 > 
MAXIMUM_SUBBUFFER_SIZE
) {

314 
	`¥öt_îr
("Wrong subbuffer size\n");

315 
ªsu…
 = -
E_SD_WRONG_ARGS
;

319 
ªsu…
 = 
	`drivî_to_buf„r_öôülize
(
öôülize_°ru˘
.
size
,

320 
öôülize_°ru˘
.
cou¡
);

321 i‡(
ªsu…
 < 0) {

322 
	`¥öt_îr
("Buf„∏öôüliz©i⁄ faûed %d\n", 
ªsu…
);

325 
ªsu…
 = 
E_SD_SUCCESS
;

329 
SWAP_DRIVER_BUFFER_UNINITIALIZE
:

331 
ªsu…
 = 
	`drivî_to_buf„r_unöôülize
();

332 i‡(
ªsu…
 < 0)

333 
	`¥öt_îr
("Buf„∏unöôüliz©i⁄ faûed %d\n", 
ªsu…
);

336 
SWAP_DRIVER_NEXT_BUFFER_TO_READ
:

339 
ªsu…
 = 
	`drivî_to_buf„r_√xt_buf„r_to_ªad
();

340 i‡(
ªsu…
 =
E_SD_NO_DATA_TO_READ
) {

346 
SWAP_DRIVER_FLUSH_BUFFER
:

348 
ªsu…
 = 
	`drivî_to_buf„r_Êush
();

351 
SWAP_DRIVER_MSG
:

353 i‡(
msg_h™dÀr
) {

354 
ªsu…
 = 
	`msg_h™dÀr
((
__u£r
 *)
¨g
);

356 
	`¥öt_w¨n
("msg_handler() isÇotÑegister\n");

357 
ªsu…
 = -
EINVAL
;

361 
SWAP_DRIVER_WAKE_UP
:

363 
	`sw≠_devi˚_wake_up_¥o˚ss
();

364 
ªsu…
 = 
E_SD_SUCCESS
;

368 
	`¥öt_w¨n
("Unknow¿comm™d %d\n", 
cmd
);

369 
ªsu…
 = -
EINVAL
;

373  
ªsu…
;

374 
	}
}

376 
	$sw≠_devi˚_pùe_buf_ªÀa£
(
pùe_öode_öfo
 *
öode
,

377 
pùe_buf„r
 *
pùe
)

379 
	`__‰ì_∑ge
(
pùe
->
∑ge
);

380 
	}
}

382 
	$sw≠_devi˚_∑ge_ªÀa£
(
•li˚_pùe_desc
 *
•d
,

383 
i
)

385 
	`__‰ì_∑ge
(
•d
->
∑ges
[
i
]);

386 
	}
}

388 c⁄° 
pùe_buf_›î©i⁄s
 
	gsw≠_devi˚_pùe_buf_›s
 = {

389 .
ˇn_mîge
 = 0,

390 .
	gm≠
 = 
gíîic_pùe_buf_m≠
,

391 .
	gunm≠
 = 
gíîic_pùe_buf_unm≠
,

392 .
	gc⁄fúm
 = 
gíîic_pùe_buf_c⁄fúm
,

393 .
	gªÀa£
 = 
sw≠_devi˚_pùe_buf_ªÀa£
,

394 .
	g°ól
 = 
gíîic_pùe_buf_°ól
,

395 .
	ggë
 = 
gíîic_pùe_buf_gë


398 
ssize_t
 
	$sw≠_devi˚_•li˚_ªad
(
fûe
 *
fûp
, 
loff_t
 *
µos
,

399 
pùe_öode_öfo
 *
pùe
,

400 
size_t
 
Àn
, 
Êags
)

404 
	`DEFINE_WAIT
(
waô
);

406 
ªsu…
;

407 
∑ge
 *
∑ges
[
PIPE_DEF_BUFFERS
];

408 
∑πül_∑ge
 
∑πül
[
PIPE_DEF_BUFFERS
];

409 
•li˚_pùe_desc
 
•d
 = {

410 .
∑ges
 =Öages,

411 .
∑πül
 =Öartial,

412 #i‡(
LINUX_VERSION_CODE
 >
	`KERNEL_VERSION
(3, 4, 5))

413 .
ƒ_∑ges_max
 = 
PIPE_DEF_BUFFERS
,

415 .
ƒ_∑ges
 = 0,

416 .
Êags
 = flags,

417 .
›s
 = &
sw≠_devi˚_pùe_buf_›s
,

418 .
•d_ªÀa£
 = 
sw≠_devi˚_∑ge_ªÀa£
,

423 (
ªsu…
 = 
	`drivî_to_buf„r_√xt_buf„r_to_ªad
()Ë!
E_SD_SUCCESS
) {

429 
	`¥ï¨e_to_waô
(&
sw≠_devi˚_waô
, &
waô
, 
TASK_INTERRUPTIBLE
);

430 i‡(
ªsu…
 < 0) {

431 
	`¥öt_îr
("drivî_to_buf„r_√xt_buf„r_to_ªadÉº‹ %d\n", 
ªsu…
);

433 
ªsu…
 = 0;

434 
sw≠_devi˚_•li˚_ªad_îr‹
;

435 } i‡(
ªsu…
 =
E_SD_NO_DATA_TO_READ
) {

436 i‡(
fûp
->
f_Êags
 & 
O_NONBLOCK
) {

437 
ªsu…
 = -
EAGAIN
;

438 
sw≠_devi˚_•li˚_ªad_îr‹
;

440 i‡(
	`sig«l_≥ndög
(
cuºít
)) {

441 
ªsu…
 = -
ERESTARTSYS
;

442 
sw≠_devi˚_•li˚_ªad_îr‹
;

444 
	`scheduÀ
();

445 
	`föish_waô
(&
sw≠_devi˚_waô
, &
waô
);

449 i‡(
	`•li˚_grow_•d_p
(
pùe
, &
•d
)) {

450 
ªsu…
 = -
ENOMEM
;

451 
sw≠_devi˚_•li˚_ªad_out
;

454 
ªsu…
 = 
	`drivî_to_buf„r_fûl_•d
(&
•d
);

455 i‡(
ªsu…
 != 0) {

456 
	`¥öt_îr
("Cannot fill spd for splice\n");

457 
sw≠_devi˚_shrök_•d
;

460 
ªsu…
 = 
	`•li˚_to_pùe_p
(
pùe
, &
•d
);

462 
sw≠_devi˚_shrök_•d
:

463 
	`sw≠_devi˚_•li˚_shrök_•d
(
pùe
, &
•d
);

465 
sw≠_devi˚_•li˚_ªad_out
:

466  
ªsu…
;

468 
sw≠_devi˚_•li˚_ªad_îr‹
:

469 
	`föish_waô
(&
sw≠_devi˚_waô
, &
waô
);

471  
ªsu…
;

472 
	}
}

474 
	$sw≠_devi˚_wake_up_¥o˚ss
()

476 i‡(
	`©omic_ªad
(&
Êag_wake_up
) == 0) {

477 
	`©omic_£t
(&
Êag_wake_up
, 1);

478 
	`scheduÀ_w‹k
(&
w_wake_up
);

480 
	}
}

482 
	$£t_msg_h™dÀr
(
msg_h™dÀr_t
 
mh
)

484 
msg_h™dÀr
 = 
mh
;

485 
	}
}

486 
EXPORT_SYMBOL_GPL
(
£t_msg_h™dÀr
);

	@driver/device_driver.h

25 #i‚de‡
__SWAP_DRIVER_DEVICE_DRIVER_H__


26 
	#__SWAP_DRIVER_DEVICE_DRIVER_H__


	)

29 
sw≠_devi˚_öô
();

32 
sw≠_devi˚_exô
();

	@driver/device_driver_to_driver_to_buffer.h

27 #i‚de‡
__DEVICE_DRIVER_TO_DRIVER_TO_BUFFER_H__


28 
	#__DEVICE_DRIVER_TO_DRIVER_TO_BUFFER_H__


	)

30 
sw≠_devi˚_wake_up_¥o˚ss
();

	@driver/driver_defs.h

25 #i‚de‡
__SWAP_DRIVER_DEVICE_DEFS_H__


26 
	#__SWAP_DRIVER_DEVICE_DEFS_H__


	)

28 
	~<löux/kî√l.h
>

30 
	#¥öt_debug
(
msg
, 
¨gs
...) \

31 
	`¥ötk
(
KERN_DEBUG
 "SWAP_DRIVER DEBUG : " 
msg
, ##
¨gs
)

	)

32 
	#¥öt_msg
(
msg
, 
¨gs
...) \

33 
	`¥ötk
(
KERN_INFO
 "SWAP_DRIVER : " 
msg
, ##
¨gs
)

	)

34 
	#¥öt_w¨n
(
msg
, 
¨gs
...) \

35 
	`¥ötk
(
KERN_WARNING
 "SWAP_DRIVER WARNING : " 
msg
, ##
¨gs
)

	)

36 
	#¥öt_îr
(
msg
, 
¨gs
...) \

37 
	`¥ötk
(
KERN_ERR
 "SWAP_DRIVER ERROR : " 
msg
, ##
¨gs
)

	)

38 
	#¥öt_¸ô
(
msg
, 
¨gs
...) \

39 
	`¥ötk
(
KERN_CRIT
 "SWAP_DRIVER CRITICAL : " 
msg
, ##
¨gs
)

	)

	@driver/driver_to_buffer.c

25 
	~<löux/°rög.h
>

26 
	~<löux/¶ab.h
>

27 
	~<löux/•li˚.h
>

28 
	~<asm/uac˚ss.h
>

29 
	~<löux/•ölock.h
>

30 
	~<löux/mm.h
>

32 
	~<buf„r/sw≠_buf„r_moduÀ.h
>

33 
	~<buf„r/sw≠_buf„r_îr‹s.h
>

34 
	~<buf„r/buf„r_des¸ùti⁄.h
>

35 
	~<wrôî/sw≠_wrôî_moduÀ.h
>

37 
	~"drivî_defs.h
"

38 
	~"sw≠_drivî_îr‹s.h
"

39 
	~"devi˚_drivî_to_drivî_to_buf„r.h
"

40 
	~"≠p_m™age.h
"

43 
sw≠_subbuf„r
 *
	gbusy_buf„r
 = 
NULL
;

46 
	gbuf„rs_to_ªad
 = 0;

49 
	g∑ges_≥r_buf„r
 = 0;

52 
•ölock_t
 
	gbuf_to_ªad
;

55 
ölöe
 
	$öô_buf„rs_to_ªad
()

57 
	`•ö_lock_öô
(&
buf_to_ªad
);

58 
buf„rs_to_ªad
 = 0;

59 
	}
}

61 
ölöe
 
	$öc_buf„rs_to_ªad
()

63 
Êags
;

65 
	`•ö_lock_úqßve
(&
buf_to_ªad
, 
Êags
);

66 
buf„rs_to_ªad
++;

67 
	`•ö_u∆ock_úqª°‹e
(&
buf_to_ªad
, 
Êags
);

68 
	}
}

70 
ölöe
 
	$dec_buf„rs_to_ªad
()

72 
Êags
;

74 
	`•ö_lock_úqßve
(&
buf_to_ªad
, 
Êags
);

75 
buf„rs_to_ªad
--;

76 
	`•ö_u∆ock_úqª°‹e
(&
buf_to_ªad
, 
Êags
);

77 
	}
}

79 
ölöe
 
	$£t_buf„rs_to_ªad
(
cou¡
)

81 
Êags
;

83 
	`•ö_lock_úqßve
(&
buf_to_ªad
, 
Êags
);

84 
buf„rs_to_ªad
 = 
cou¡
;

85 
	`•ö_u∆ock_úqª°‹e
(&
buf_to_ªad
, 
Êags
);

86 
	}
}

88 
ölöe
 
	$somëhög_to_ªad
()

90 
Êags
;

91 
ªsu…
;

93 
	`•ö_lock_úqßve
(&
buf_to_ªad
, 
Êags
);

94 
ªsu…
 = 
buf„rs_to_ªad
;

95 
	`•ö_u∆ock_úqª°‹e
(&
buf_to_ªad
, 
Êags
);

97  
ªsu…
;

98 
	}
}

101 
size_t
 
	$drivî_to_buf„r_gë
()

103 
ªsu…
;

106 
ªsu…
 = 
	`sw≠_buf„r_gë
(&
busy_buf„r
);

107 i‡(
ªsu…
 =-
E_SB_NO_READABLE_BUFFERS
) {

108 
busy_buf„r
 = 
NULL
;

109  -
E_SD_NO_DATA_TO_READ
;

110 } i‡(
ªsu…
 < 0) {

111 
	`¥öt_îr
("sw≠_buf„r_gë unh™dÀÉº‹ %d\n", 
ªsu…
);

112  -
E_SD_BUFFER_ERROR
;

115  
busy_buf„r
->
fuŒ_buf„r_∑π
;

116 
	}
}

119 
	$drivî_to_buf„r_ªÀa£
()

121 
ªsu…
;

123 i‡(!
busy_buf„r
)

124  -
E_SD_NO_BUSY_SUBBUFFER
;

126 
ªsu…
 = 
	`sw≠_buf„r_ªÀa£
(&
busy_buf„r
);

127 i‡(
ªsu…
 =-
E_SB_NO_SUBBUFFER_IN_BUSY
) {

128  -
E_SD_WRONG_SUBBUFFER_PTR
;

129 } i‡(
ªsu…
 < 0) {

130 
	`¥öt_îr
("sw≠_buf„r_ªÀa£ unh™dÀÉº‹ %d\n", 
ªsu…
);

131  -
E_SD_BUFFER_ERROR
;

134 
busy_buf„r
 = 
NULL
;

136  
E_SD_SUCCESS
;

137 
	}
}

140 
	$drivî_to_buf„r_ˇŒback
()

143 
	`öc_buf„rs_to_ªad
();

144 
	`sw≠_devi˚_wake_up_¥o˚ss
();

146  
E_SD_SUCCESS
;

147 
	}
}

150 
ssize_t
 
	$drivî_to_buf„r_ªad
(
__u£r
 *
buf
, 
size_t
 
cou¡
)

152 
size_t
 
byãs_to_c›y
;

153 
size_t
 
byãs_to_ªad
 = 0;

154 
∑ge_cou¡î
 = 0;

160 i‡(!
busy_buf„r
 || !busy_buf„r->
fuŒ_buf„r_∑π
)

161  -
E_SD_NO_DATA_TO_READ
;

165 
byãs_to_c›y
 = (
cou¡
 > 
busy_buf„r
->
fuŒ_buf„r_∑π
) ?

166 
busy_buf„r
->
fuŒ_buf„r_∑π
 : 
cou¡
;

169 
byãs_to_c›y
 > 0) {

171 
size_t
 
ªad_‰om_this_∑ge
 = (
byãs_to_c›y
 > 
PAGE_SIZE
) ? PAGE_SIZE

172 : 
byãs_to_c›y
;

177 
byãs_to_ªad
 +
ªad_‰om_this_∑ge
 -

178 
	`c›y_to_u£r
(
buf
, 
	`∑ge_addªss
(
busy_buf„r
->
d©a_buf„r
) +

179 ((
∑ge
*) *

180 
∑ge_cou¡î
),

181 
ªad_‰om_this_∑ge
);

182 
byãs_to_c›y
 -
ªad_‰om_this_∑ge
;

183 
∑ge_cou¡î
++;

186  
byãs_to_ªad
;

187 
	}
}

190 
	$drivî_to_buf„r_Êush
()

192 
Êushed
;

194 
Êushed
 = 
	`sw≠_buf„r_Êush
();

195 
	`£t_buf„rs_to_ªad
(
Êushed
);

196 
	`sw≠_devi˚_wake_up_¥o˚ss
();

198  
E_SD_SUCCESS
;

199 
	}
}

202 
	$drivî_to_buf„r_fûl_•d
(
•li˚_pùe_desc
 *
•d
)

204 
size_t
 
d©a_to_•li˚
 = 
busy_buf„r
->
fuŒ_buf„r_∑π
;

205 
∑ge
 **
∑ges
 = 
•d
->pages;

206 
∑πül_∑ge
 *
∑πül
 = 
•d
->partial;

208 
d©a_to_•li˚
) {

209 
size_t
 
ªad_‰om_cuºít_∑ge
 = 
	`mö
(
d©a_to_•li˚
, (size_t)
PAGE_SIZE
);

211 
∑ges
[
•d
->
ƒ_∑ges
] = 
	`Æloc_∑ge
(
GFP_KERNEL
);

212 i‡(!
∑ges
[
•d
->
ƒ_∑ges
]) {

213 
	`¥öt_îr
("CannotállocÖage for splice\n");

214  -
ENOMEM
;

218 
	`mem˝y
(
	`∑ge_addªss
(
∑ges
[
•d
->
ƒ_∑ges
]),

219 
	`∑ge_addªss
(&
busy_buf„r
->
d©a_buf„r
[
•d
->
ƒ_∑ges
]),

220 
ªad_‰om_cuºít_∑ge
);

223 
∑πül
[
•d
->
ƒ_∑ges
].
off£t
 = 0;

224 
∑πül
[
•d
->
ƒ_∑ges
].
Àn
 = 
ªad_‰om_cuºít_∑ge
;

227 
∑πül
[
•d
->
ƒ_∑ges
].
¥iv©e
 = 0;

229 
•d
->
ƒ_∑ges
++;

230 
d©a_to_•li˚
 -
ªad_‰om_cuºít_∑ge
;

238 
	}
}

241 
	$drivî_to_buf„r_buf„r_to_ªad
()

243  
busy_buf„r
 ? 1 : 0;

244 
	}
}

247 
	$drivî_to_buf„r_öôülize
(
size_t
 
size
, 
cou¡
)

249 
ªsu…
;

250 
buf„r_öô_t
 
buf_öô
 = {

251 .
subbuf„r_size
 = 
size
,

252 .
ƒ_subbuf„rs
 = 
cou¡
,

253 .
subbuf„r_fuŒ_cb
 = 
drivî_to_buf„r_ˇŒback
,

254 .
lowî_thªshﬁd
 = 20,

255 .
low_mem_cb
 = 
≠p_m™age_∑u£_≠ps
,

256 .
t›_thªshﬁd
 = 80,

257 .
íough_mem_cb
 = 
≠p_m™age_c⁄t_≠ps
,

260 i‡(
size
 =0 && 
cou¡
 == 0) {

261  -
E_SD_WRONG_ARGS
;

264 
ªsu…
 = 
	`sw≠_buf„r_öô
(&
buf_öô
);

265 i‡(
ªsu…
 =-
E_SB_NO_MEM_QUEUE_BUSY


266 || 
ªsu…
 =-
E_SB_NO_MEM_BUFFER_STRUCT
) {

267  -
E_SD_NO_MEMORY
;

273 
∑ges_≥r_buf„r
 = 
ªsu…
;

274 
busy_buf„r
 = 
NULL
;

275 
	`öô_buf„rs_to_ªad
();

277  
E_SD_SUCCESS
;

278 
	}
}

281 
	$drivî_to_buf„r_unöôülize
()

283 
ªsu…
;

286 i‡(
busy_buf„r
) {

287 
ªsu…
 = 
	`drivî_to_buf„r_ªÀa£
();

289 i‡(
ªsu…
 < 0) {

290  
ªsu…
;

292 
busy_buf„r
 = 
NULL
;

295 
ªsu…
 = 
	`sw≠_buf„r_unöô
();

296 i‡(
ªsu…
 =-
E_SB_UNRELEASED_BUFFERS
) {

297 
	`¥öt_îr
("Can't uninit buffer! Thereáre busy subbuffers!\n");

298 
ªsu…
 = -
E_SD_BUFFER_ERROR
;

299 } i‡(
ªsu…
 < 0) {

300 
	`¥öt_îr
("sw≠_buf„r_unöôÉº‹ %d\n", 
ªsu…
);

301 
ªsu…
 = -
E_SD_BUFFER_ERROR
;

303 
ªsu…
 = 
E_SD_SUCCESS
;

307 
	`öô_buf„rs_to_ªad
();

308 
∑ges_≥r_buf„r
 = 0;

310  
ªsu…
;

311 
	}
}

314 
	$drivî_to_buf„r_√xt_buf„r_to_ªad
()

316 
ªsu…
;

319 i‡(
busy_buf„r
) {

320 
ªsu…
 = 
	`drivî_to_buf„r_ªÀa£
();

321 i‡(
ªsu…
)

322  
ªsu…
;

327 i‡(!
	`somëhög_to_ªad
()) {

328  
E_SD_NO_DATA_TO_READ
;

332 
ªsu…
 = 
	`drivî_to_buf„r_gë
();

333 i‡(
ªsu…
 < 0) {

334 
	`¥öt_îr
("buffer_to_reads > 0, butÅhereáreÇo buffersÅoÑead\n");

335  
ªsu…
;

339 
	`dec_buf„rs_to_ªad
();

341  
E_SD_SUCCESS
;

342 
	}
}

	@driver/driver_to_buffer.h

25 #i‚de‡
__SWAP_DRIVER_DRIVER_TO_BUFFER__


26 
	#__SWAP_DRIVER_DRIVER_TO_BUFFER__


	)

28 
drivî_to_buf„r_öôülize
(
size_t
 
size
, 
cou¡
);

29 
drivî_to_buf„r_unöôülize
();

30 
ssize_t
 
drivî_to_buf„r_ªad
(
__u£r
 *
buf
, 
size_t
 
cou¡
);

31 
drivî_to_buf„r_ˇŒback
();

32 
drivî_to_buf„r_fûl_•d
(
•li˚_pùe_desc
 *
•d
);

33 
drivî_to_buf„r_buf„r_to_ªad
();

34 
drivî_to_buf„r_√xt_buf„r_to_ªad
();

35 
drivî_to_buf„r_Êush
();

	@driver/driver_to_msg.h

25 #i‚de‡
__SWAP_DRIVER_DRIVER_TO_MSG__


26 
	#__SWAP_DRIVER_DRIVER_TO_MSG__


	)

29 (*
	tmsg_h™dÀr_t
)(
	t__u£r
 *
	td©a
);

32 
	`£t_msg_h™dÀr
(
msg_h™dÀr_t
 
mh
);

	@driver/kernel_operations.h

27 #i‚de‡
__KERNEL_OPERATIONS_H__


28 
	#__KERNEL_OPERATIONS_H__


	)

30 
	~<löux/kî√l.h
>

33 
	#¥öt_debug
(
msg
, 
¨gs
...) \

34 
	`¥ötk
(
KERN_DEBUG
 "SWAP_DRIVER DEBUG : " 
msg
, ##
¨gs
)

	)

35 
	#¥öt_msg
(
msg
, 
¨gs
...) \

36 
	`¥ötk
(
KERN_INFO
 "SWAP_DRIVER : " 
msg
, ##
¨gs
)

	)

37 
	#¥öt_w¨n
(
msg
, 
¨gs
...) \

38 
	`¥ötk
(
KERN_WARNING
 "SWAP_DRIVER WARNING : " 
msg
, ##
¨gs
)

	)

39 
	#¥öt_îr
(
msg
, 
¨gs
...) \

40 
	`¥ötk
(
KERN_ERR
 "SWAP_DRIVER ERROR : " 
msg
, ##
¨gs
)

	)

41 
	#¥öt_¸ô
(
msg
, 
¨gs
...) \

42 
	`¥ötk
(
KERN_CRIT
 "SWAP_DRIVER CRITICAL : " 
msg
, ##
¨gs
)

	)

	@driver/swap_debugfs.c

26 
	~<löux/moduÀ.h
>

27 
	~<löux/debugfs.h
>

30 
díåy
 *
	gsw≠_dú
 = 
NULL
;

33 
díåy
 *
	$gë_sw≠_debugfs_dú
()

35  
sw≠_dú
;

36 
	}
}

37 
EXPORT_SYMBOL_GPL
(
gë_sw≠_debugfs_dú
);

39 
	$sw≠_debugfs_öô
()

41 
sw≠_dú
 = 
	`debugfs_¸óã_dú
("sw≠", 
NULL
);

42 i‡(
sw≠_dú
 =
NULL
)

43  -
ENOMEM
;

46 
	}
}

48 
	$sw≠_debugfs_exô
()

50 
díåy
 *
dú
 = 
sw≠_dú
;

52 
sw≠_dú
 = 
NULL
;

53 
	`debugfs_ªmove_ªcursive
(
dú
);

54 
	}
}

	@driver/swap_debugfs.h

1 #i‚de‡
_SWAP_DEBUG_FS_H


2 
	#_SWAP_DEBUG_FS_H


	)

29 
	gdíåy
;

32 
díåy
 *
gë_sw≠_debugfs_dú
();

33 
sw≠_debugfs_öô
();

34 
sw≠_debugfs_exô
();

	@driver/swap_driver.mod.c

1 
	~<löux/moduÀ.h
>

2 
	~<löux/vîmagic.h
>

3 
	~<löux/compûî.h
>

5 
MODULE_INFO
(
vîmagic
, 
VERMAGIC_STRING
);

7 
moduÀ
 
__this_moduÀ


8 
__©åibuã__
((
£˘i⁄
(".gnu.linkonce.this_module"))) = {

9 .
«me
 = 
KBUILD_MODNAME
,

10 .
	göô
 = 
öô_moduÀ
,

11 #ifde‡
CONFIG_MODULE_UNLOAD


12 .
	gexô
 = 
˛ónup_moduÀ
,

14 .
	g¨ch
 = 
MODULE_ARCH_INIT
,

17 c⁄° 
	g__moduÀ_dïíds
[]

18 
__u£d


19 
__©åibuã__
((
£˘i⁄
(".modinfo"))) =

23 
MODULE_INFO
(
§cvîsi⁄
, "F55FDC81E7D97F33F3F7D52");

	@driver/swap_driver_errors.h

25 #i‚de‡
__SWAP_DRIVER_ERRORS_H__


26 
	#__SWAP_DRIVER_ERRORS_H__


	)

30 
	e_sw≠_drivî_îr‹s
 {

31 
	mE_SD_SUCCESS
 = 0,

32 
	mE_SD_ALLOC_CHRDEV_FAIL
 = 1,

33 
	mE_SD_CDEV_ALLOC_FAIL
 = 2,

34 
	mE_SD_CDEV_ADD_FAIL
 = 3,

35 
	mE_SD_CLASS_CREATE_FAIL
 = 4,

36 
	mE_SD_DEVICE_CREATE_FAIL
 = 5,

37 
	mE_SD_NO_SPLICE_FUNCS
 = 6,

38 
	mE_SD_NO_DATA_TO_READ
 = 7,

40 
	mE_SD_NO_BUSY_SUBBUFFER
 = 8,

41 
	mE_SD_WRONG_SUBBUFFER_PTR
 = 9,

43 
	mE_SD_BUFFER_ERROR
 = 10,

44 
	mE_SD_WRITE_ERROR
 = 11,

45 
	mE_SD_WRONG_ARGS
 = 12,

47 
	mE_SD_NO_MEMORY
 = 13,

48 
	mE_SD_UNINIT_ERROR
 = 14,

49 
	mE_SD_NL_INIT_ERR
 = 15,

50 
	mE_SD_NL_MSG_ERR
 = 16,

51 
	mE_SD_NO_DAEMON_PID
 = 17

	@driver/swap_driver_module.c

25 
	~<löux/moduÀ.h
>

27 
	~"drivî_defs.h
"

28 
	~"devi˚_drivî.h
"

29 
	~"sw≠_debugfs.h
"

30 
	~"us_öãø˘i⁄.h
"

32 
__öô
 
	$sw≠_drivî_öô
()

34 
ªt
;

36 
ªt
 = 
	`sw≠_debugfs_öô
();

37 i‡(
ªt
)

38  
ªt
;

40 
ªt
 = 
	`sw≠_devi˚_öô
();

41 i‡(
ªt
)

42 
dev_öô_Áû
;

44 
ªt
 = 
	`us_öãø˘i⁄_¸óã
();

45 i‡(
ªt
)

46 
	`¥öt_îr
("Cannot initializeÇetlink socket\n");

48 
	`¥öt_msg
("Driver module initialized\n");

52 
dev_öô_Áû
:

53 
	`sw≠_debugfs_exô
();

54 
	`sw≠_devi˚_exô
();

56  
ªt
;

57 
	}
}

59 
__exô
 
	$sw≠_drivî_exô
()

61 
	`us_öãø˘i⁄_de°roy
();

62 
	`sw≠_devi˚_exô
();

63 
	`sw≠_debugfs_exô
();

64 
	`¥öt_msg
("Driver module uninitialized\n");

65 
	}
}

67 
moduÀ_öô
(
sw≠_drivî_öô
);

68 
moduÀ_exô
(
sw≠_drivî_exô
);

70 
MODULE_LICENSE
("GPL");

71 
MODULE_DESCRIPTION
("SWAP device driver");

72 
MODULE_AUTHOR
("Aksenov A.S.");

	@driver/swap_ioctl.h

25 #i‚de‡
__SWAP_IOCTL_H__


26 
	#__SWAP_IOCTL_H__


	)

28 
	~<löux/io˘l.h
>

30 
	#SWAP_DRIVER_IOC_MAGIC
 0xAF

	)

32 
	sbuf„r_öôülize
 {

33 
size_t
 
	msize
;

34 
	mcou¡
;

39 
	#SWAP_DRIVER_BUFFER_INITIALIZE
 
	`_IOW
(
SWAP_DRIVER_IOC_MAGIC
, 1, \

40 
buf„r_öôülize
 *)

	)

41 
	#SWAP_DRIVER_BUFFER_UNINITIALIZE
 
	`_IO
(
SWAP_DRIVER_IOC_MAGIC
, 2)

	)

42 
	#SWAP_DRIVER_NEXT_BUFFER_TO_READ
 
	`_IO
(
SWAP_DRIVER_IOC_MAGIC
, 3)

	)

43 
	#SWAP_DRIVER_FLUSH_BUFFER
 
	`_IO
(
SWAP_DRIVER_IOC_MAGIC
, 4)

	)

44 
	#SWAP_DRIVER_MSG
 
	`_IOW
(
SWAP_DRIVER_IOC_MAGIC
, 5, \

45 *)

	)

46 
	#SWAP_DRIVER_WAKE_UP
 
	`_IO
(
SWAP_DRIVER_IOC_MAGIC
, 6)

	)

	@driver/us_interaction.c

27 
	~<löux/moduÀ.h
>

28 
	~<löux/skbuff.h
>

29 
	~<löux/ty≥s.h
>

30 
	~<löux/c⁄√˘‹.h
>

31 
	~<löux/¶ab.h
>

33 
	~"us_öãø˘i⁄.h
"

34 
	~"us_öãø˘i⁄_msg.h
"

35 
	~"sw≠_drivî_îr‹s.h
"

36 
	~"kî√l_›î©i⁄s.h
"

40 
cb_id
 
	g˙_sw≠_id
 = {
CN_SWAP_IDX
, 
CN_SWAP_VAL
};

43 c⁄° 
	g˙_sw≠_«me
[] = "cn_swap";

46 
u32
 
	gmsg_cou¡î
 = 0;

49 
	$us_öãø˘i⁄_£nd_msg
(c⁄° *
d©a
, 
size_t
 
size
)

51 
˙_msg
 *
msg
;

52 
ªt
;

54 
msg
 = 
	`kzÆloc
((*msgË+ 
size
, 
GFP_ATOMIC
);

55 i‡(
msg
 =
NULL
)

56  -
E_SD_NO_MEMORY
;

58 
	`mem˝y
(&
msg
->
id
, &
˙_sw≠_id
, (msg->id));

59 
msg
->
£q
 = 
msg_cou¡î
;

60 
msg
->
Àn
 = 
size
;

61 
	`mem˝y
(
msg
->
d©a
, d©a, msg->
Àn
);

63 
ªt
 = 
	`˙_√éök_£nd
(
msg
, 
CN_DAEMON_GROUP
, 
GFP_ATOMIC
);

64 i‡(
ªt
 < 0)

65 
Áû_£nd
;

66 
	`k‰ì
(
msg
);

68 
msg_cou¡î
++;

70  
E_SD_SUCCESS
;

72 
Áû_£nd
:

73 
	`k‰ì
(
msg
);

75  
ªt
;

76 
	}
}

78 
	$us_öãø˘i⁄_ªcv_msg
(
˙_msg
 *
msg
,

79 
√éök_skb_∑rms
 *
n•
)

81 
	}
}

83 
	$us_öãø˘i⁄_¸óã
()

85 
ªs
;

87 
ªs
 = 
	`˙_add_ˇŒback
(&
˙_sw≠_id
, 
˙_sw≠_«me
, 
us_öãø˘i⁄_ªcv_msg
);

88 i‡(
ªs
)

89  -
E_SD_NL_INIT_ERR
;

91  
E_SD_SUCCESS
;

92 
	}
}

94 
	$us_öãø˘i⁄_de°roy
()

96 
	`˙_dñ_ˇŒback
(&
˙_sw≠_id
);

97 
	}
}

	@driver/us_interaction.h

26 #i‚de‡
__US_INTERACTION_H__


27 
	#__US_INTERACTION_H__


	)

29 #ifde‡
CONFIG_CONNECTOR


31 
us_öãø˘i⁄_¸óã
();

32 
us_öãø˘i⁄_de°roy
();

33 
us_öãø˘i⁄_£nd_msg
(c⁄° *
d©a
, 
size_t
 
size
);

37 
ölöe
 
	$us_öãø˘i⁄_¸óã
()

39  -
EPERM
;

40 
	}
}

42 
ölöe
 
	$us_öãø˘i⁄_de°roy
()

44 
	}
}

46 
ölöe
 
	$us_öãø˘i⁄_£nd_msg
(c⁄° *
d©a
, 
size_t
 
size
)

48  -
EPERM
;

49 
	}
}

	@driver/us_interaction_msg.h

26 #i‚de‡
__US_INTERACTION_MSG_H__


27 
	#__US_INTERACTION_MSG_H__


	)

29 
	#CN_SWAP_IDX
 0x22

	)

30 
	#CN_SWAP_VAL
 0x1

	)

31 
	#CN_DAEMON_GROUP
 0x1

	)

34 
	eus_öãø˘i⁄_k2u_msg_t
 {

35 
	mUS_INT_PAUSE_APPS
 = 1,

36 
	mUS_INT_CONT_APPS
 = 2

	@energy/debugfs_energy.c

26 
	~<löux/fs.h
>

27 
	~<löux/moduÀ.h
>

28 
	~<löux/debugfs.h
>

29 
	~<löux/m©h64.h
>

30 
	~<drivî/sw≠_debugfs.h
>

31 
	~"íîgy.h
"

32 
	~"øti⁄Æ_debugfs.h
"

33 
	~"lcd/lcd_debugfs.h
"

37 
DEFINE_RATIONAL
(
˝u0_ru¬ög_c€f
);

38 
DEFINE_RATIONAL
(
˝uN_ru¬ög_c€f
);

40 
u64
 
	$__íîgy_˝u
(
∑ømëî_íîgy
 
≥
)

42 
u64
 
times
[
NR_CPUS
] = { 0 };

43 
u64
 
vÆ
 = 0;

44 
i
;

46 i‡(
	`gë_∑ømëî_íîgy
(
≥
, 
times
, (times)) == 0) {

47 
vÆ
 = 
	`div_u64
(
times
[0] * 
˝u0_ru¬ög_c€f
.
num
,

48 
˝u0_ru¬ög_c€f
.
díom
);

49 
i
 = 1; i < 
NR_CPUS
; i++)

50 
vÆ
 +
	`div_u64
(
times
[
i
] * 
˝uN_ru¬ög_c€f
.
num
,

51 
˝uN_ru¬ög_c€f
.
díom
);

54  
vÆ
;

55 
	}
}

57 
u64
 
	$˝u_sy°em
()

59  
	`__íîgy_˝u
(
PE_TIME_SYSTEM
);

60 
	}
}

62 
u64
 
	$˝u_≠ps
()

64  
	`__íîgy_˝u
(
PE_TIME_APPS
);

65 
	}
}

69 
DEFINE_RATIONAL
(
˝u_idÀ_c€f
);

71 
u64
 
	$˝u_idÀ_sy°em
()

73 
u64
 
time
 = 0;

75 
	`gë_∑ømëî_íîgy
(
PE_TIME_IDLE
, &
time
, (time));

76  
	`div_u64
(
time
 * 
˝u_idÀ_c€f
.
num
, cpu_idÀ_c€f.
díom
);

77 
	}
}

81 
DEFINE_RATIONAL
(
‰_c€f
);

83 
u64
 
	$‰_sy°em
()

85 
u64
 
byã
 = 0;

87 
	`gë_∑ømëî_íîgy
(
PE_READ_SYSTEM
, &
byã
, (byte));

88  
	`div_u64
(
byã
 * 
‰_c€f
.
num
, fr_c€f.
díom
);

89 
	}
}

91 
u64
 
	$‰_≠ps
()

93 
u64
 
byã
 = 0;

95 
	`gë_∑ømëî_íîgy
(
PE_READ_APPS
, &
byã
, (byte));

96  
	`div_u64
(
byã
 * 
‰_c€f
.
num
, fr_c€f.
díom
);

97 
	}
}

101 
DEFINE_RATIONAL
(
fw_c€f
);

103 
u64
 
	$fw_sy°em
()

105 
u64
 
byã
 = 0;

107 
	`gë_∑ømëî_íîgy
(
PE_WRITE_SYSTEM
, &
byã
, (byte));

108  
	`div_u64
(
byã
 * 
fw_c€f
.
num
, fw_c€f.
díom
);

109 
	}
}

111 
u64
 
	$fw_≠ps
()

113 
u64
 
byã
 = 0;

115 
	`gë_∑ømëî_íîgy
(
PE_WRITE_APPS
, &
byã
, (byte));

116  
	`div_u64
(
byã
 * 
fw_c€f
.
num
, fw_c€f.
díom
);

117 
	}
}

127 
	$gë_func_u64
(*
d©a
, 
u64
 *
vÆ
)

129 
	`u64
 (*
func
)(Ë
d©a
;

130 *
vÆ
 = 
	`func
();

132 
	}
}

134 
DEFINE_SIMPLE_ATTRIBUTE
(
f›s_gë_u64
, 
gë_func_u64
, 
NULL
, "%llu\n");

137 
	s∑øm_d©a
 {

138 *
	m«me
;

139 
øti⁄Æ
 *
	mc€f
;

140 
u64
 (*
sy°em
)();

141 
u64
 (*
≠ps
)();

144 
díåy
 *
	$¸óã_∑ømëî
(
díåy
 *
∑ª¡
,

145 
∑øm_d©a
 *
∑øm
)

147 
díåy
 *
«me
, *
sy°em
, *
≠ps
 = 
NULL
;

149 
«me
 = 
	`debugfs_¸óã_dú
(
∑øm
->«me, 
∑ª¡
);

150 i‡(
«me
 =
NULL
)

151  
NULL
;

153 
sy°em
 = 
	`debugfs_¸óã_fûe
("sy°em", 0600, 
«me
, 
∑øm
->system,

154 &
f›s_gë_u64
);

155 i‡(
sy°em
 =
NULL
)

156 
rm_«me
;

158 i‡(
∑øm
->
≠ps
) {

159 
≠ps
 = 
	`debugfs_¸óã_fûe
("≠ps", 0600, 
«me
, 
∑øm
->apps,

160 &
f›s_gë_u64
);

161 i‡(
≠ps
 =
NULL
)

162 
rm_sy°em
;

165 i‡(
	`¸óã_øti⁄Æ_fûes
(
«me
, 
∑øm
->
c€f
,

167 
rm_≠ps
;

169  
«me
;

171 
rm_≠ps
:

172 i‡(
∑øm
->
≠ps
)

173 
	`debugfs_ªmove
(
≠ps
);

174 
rm_sy°em
:

175 
	`debugfs_ªmove
(
sy°em
);

176 
rm_«me
:

177 
	`debugfs_ªmove
(
«me
);

179  
NULL
;

180 
	}
}

182 
∑øm_d©a
 
	g∑ømëîs
[] = {

184 .
«me
 = "cpu_running",

185 .
	gc€f
 = &
˝u0_ru¬ög_c€f
,

186 .
	gsy°em
 = 
˝u_sy°em
,

187 .
	g≠ps
 = 
˝u_≠ps


190 .
	g«me
 = "cpuN_running",

191 .
	gc€f
 = &
˝uN_ru¬ög_c€f
,

192 .
	gsy°em
 = 
˝u_sy°em
,

193 .
	g≠ps
 = 
˝u_≠ps


196 .
	g«me
 = "cpu_idle",

197 .
	gc€f
 = &
˝u_idÀ_c€f
,

198 .
	gsy°em
 = 
˝u_idÀ_sy°em
,

199 .
	g≠ps
 = 
NULL


202 .
	g«me
 = "flash_read",

203 .
	gc€f
 = &
‰_c€f
,

204 .
	gsy°em
 = 
‰_sy°em
,

205 .
	g≠ps
 = 
‰_≠ps


208 .
	g«me
 = "flash_write",

209 .
	gc€f
 = &
fw_c€f
,

210 .
	gsy°em
 = 
fw_sy°em
,

211 .
	g≠ps
 = 
fw_≠ps


216 
	m∑ømëîs_˙t
 = (
∑ømëîs
Ë/ (
∑øm_d©a
)

227 
díåy
 *
	gíîgy_dú
 = 
NULL
;

229 
díåy
 *
	$gë_íîgy_dú
()

231  
íîgy_dú
;

232 
	}
}

234 
	$exô_debugfs_íîgy
()

236 i‡(
íîgy_dú
)

237 
	`debugfs_ªmove_ªcursive
(
íîgy_dú
);

239 
íîgy_dú
 = 
NULL
;

240 
	}
}

242 
	$öô_debugfs_íîgy
()

244 
i
;

245 
díåy
 *
sw≠_dú
, *dentry;

247 
sw≠_dú
 = 
	`gë_sw≠_debugfs_dú
();

248 i‡(
sw≠_dú
 =
NULL
)

249  -
ENOENT
;

251 
íîgy_dú
 = 
	`debugfs_¸óã_dú
("íîgy", 
sw≠_dú
);

252 i‡(
íîgy_dú
 =
NULL
)

253  -
ENOMEM
;

255 
i
 = 0; i < 
∑ømëîs_˙t
; ++i) {

256 
díåy
 = 
	`¸óã_∑ømëî
(
íîgy_dú
, &
∑ømëîs
[
i
]);

257 i‡(
díåy
 =
NULL
)

258 
Áû
;

263 
Áû
:

264 
	`exô_debugfs_íîgy
();

265  -
ENOMEM
;

266 
	}
}

	@energy/debugfs_energy.h

1 #i‚de‡
_DEBUGFS_ENERGY_H


2 
	#_DEBUGFS_ENERGY_H


	)

29 
	gdíåy
;

32 
öô_debugfs_íîgy
();

33 
exô_debugfs_íîgy
();

35 
díåy
 *
gë_íîgy_dú
();

	@energy/energy.c

27 
	~<löux/moduÀ.h
>

28 
	~<löux/fûe.h
>

29 
	~<löux/•ölock.h
>

30 
	~<löux/magic.h
>

31 
	~<löux/¶ab.h
>

32 
	~<löux/•ölock.h
>

33 
	~<k¥obe/dbi_k¥obes.h
>

34 
	~<ksyms/ksyms.h
>

35 
	~<us_m™agî/s•t/s•t_¥oc.h
>

36 
	~<us_m™agî/s•t/s•t_„©uª.h
>

37 
	~<löux/©omic.h
>

38 
	~"íîgy.h
"

39 
	~"lcd/lcd_ba£.h
"

40 
	~"tm_°©.h
"

47 
	s˝us_time
 {

48 
•ölock_t
 
	mlock
;

49 
tm_°©
 
	mtm
[
NR_CPUS
];

52 
	#˝us_time_lock
(
˘
, 
Êags
Ë
	`•ö_lock_úqßve
(&(˘)->
lock
, fœgs)

	)

53 
	#˝us_time_u∆ock
(
˘
, 
Êags
Ë
	`•ö_u∆ock_úqª°‹e
(&(˘)->
lock
, fœgs)

	)

55 
	$˝us_time_öô
(
˝us_time
 *
˘
, 
u64
 
time
)

57 
˝u
;

59 
	`•ö_lock_öô
(&
˘
->
lock
);

61 
˝u
 = 0; cpu < 
NR_CPUS
; ++cpu) {

62 
	`tm_°©_öô
(&
˘
->
tm
[
˝u
]);

63 
	`tm_°©_£t_time°amp
(&
˘
->
tm
[
˝u
], 
time
);

65 
	}
}

67 
ölöe
 
u64
 
	$˝u_time_gë_ru¬ög
(
˝us_time
 *
˘
, 
˝u
, 
u64
 
now
)

69  
	`tm_°©_cuºít_ru¬ög
(&
˘
->
tm
[
˝u
], 
now
);

70 
	}
}

72 *
	$˝us_time_gë_ru¬ög_Æl
(
˝us_time
 *
˘
, 
u64
 *
buf
, u64 
now
)

74 
˝u
;

76 
˝u
 = 0; cpu < 
NR_CPUS
; ++cpu)

77 
buf
[
˝u
] = 
	`tm_°©_cuºít_ru¬ög
(&
˘
->
tm
[˝u], 
now
);

79  
buf
;

80 
	}
}

82 *
	$˝us_time_sum_ru¬ög_Æl
(
˝us_time
 *
˘
, 
u64
 *
buf
, u64 
now
)

84 
˝u
;

86 
˝u
 = 0; cpu < 
NR_CPUS
; ++cpu)

87 
buf
[
˝u
] +
	`tm_°©_cuºít_ru¬ög
(&
˘
->
tm
[˝u], 
now
);

89  
buf
;

90 
	}
}

92 
	$˝us_time_ßve_íåy
(
˝us_time
 *
˘
, 
˝u
, 
u64
 
time
)

94 
tm_°©
 *
tm
 = &
˘
->tm[
˝u
];

96 i‡(
	`u∆ikñy
(
	`tm_°©_time°amp
(
tm
)))

97 
	`¥ötk
("XXX %s[%d/%d]: WARNINGÅmstamp(%p) set on cpu(%d)\n",

98 
cuºít
->
comm
, cuºít->
tgid
, cuºít->
pid
, 
tm
, 
˝u
);

99 
	`tm_°©_£t_time°amp
(&
˘
->
tm
[
˝u
], 
time
);

100 
	}
}

102 
	$˝us_time_upd©e_ru¬ög
(
˝us_time
 *
˘
, 
˝u
, 
u64
 
now
,

103 
u64
 
°¨t_time
)

105 
tm_°©
 *
tm
 = &
˘
->tm[
˝u
];

107 i‡(
	`u∆ikñy
(
	`tm_°©_time°amp
(
tm
) == 0)) {

109 
	`¥ötk
("XXX %s[%d/%d]:ÇnitializingÅmstamp(%p) on cpu(%d)\n",

110 
cuºít
->
comm
, cuºít->
tgid
, cuºít->
pid
, 
tm
, 
˝u
);

111 
	`tm_°©_£t_time°amp
(
tm
, 
°¨t_time
);

114 
	`tm_°©_upd©e
(
tm
, 
now
);

115 
	`tm_°©_£t_time°amp
(
tm
, 0);

116 
	}
}

122 
	síîgy_d©a
 {

124 
˝us_time
 
	m˘
;

127 
©omic64_t
 
	mbyãs_ªad
;

130 
©omic64_t
 
	mbyãs_wrôãn
;

134 
s•t_„©uª_id_t
 
	g„©uª_id
 = 
SSPT_FEATURE_ID_BAD
;

136 
	$öô_ed
(
íîgy_d©a
 *
ed
)

141 
	`˝us_time_öô
(&
ed
->
˘
, 0);

142 
	`©omic64_£t
(&
ed
->
byãs_ªad
, 0);

143 
	`©omic64_£t
(&
ed
->
byãs_wrôãn
, 0);

144 
	}
}

146 
	$unöô_ed
(
íîgy_d©a
 *
ed
)

148 
	`˝us_time_öô
(&
ed
->
˘
, 0);

149 
	`©omic64_£t
(&
ed
->
byãs_ªad
, 0);

150 
	`©omic64_£t
(&
ed
->
byãs_wrôãn
, 0);

151 
	}
}

153 *
	$¸óã_ed
()

155 
íîgy_d©a
 *
ed
;

157 
ed
 = 
	`kmÆloc
((*ed), 
GFP_ATOMIC
);

158 i‡(
ed
)

159 
	`öô_ed
(
ed
);

161  (*)
ed
;

162 
	}
}

164 
	$de°roy_ed
(*
d©a
)

166 
íîgy_d©a
 *
ed
 = (íîgy_d©®*)
d©a
;

167 
	`k‰ì
(
ed
);

168 
	}
}

171 
	$öô_„©uª
()

173 
„©uª_id
 = 
	`s•t_ªgi°î_„©uª
(
¸óã_ed
, 
de°roy_ed
);

175 i‡(
„©uª_id
 =
SSPT_FEATURE_ID_BAD
)

176  -
EPERM
;

179 
	}
}

181 
	$unöô_„©uª
()

183 
	`s•t_uƒegi°î_„©uª
(
„©uª_id
);

184 
„©uª_id
 = 
SSPT_FEATURE_ID_BAD
;

185 
	}
}

187 
íîgy_d©a
 *
	$gë_íîgy_d©a
(
èsk_°ru˘
 *
èsk
)

189 *
d©a
 = 
NULL
;

190 
s•t_¥oc
 *
¥oc
;

192 
¥oc
 = 
	`s•t_¥oc_gë_by_èsk
(
èsk
);

193 i‡(
¥oc
)

194 
d©a
 = 
	`s•t_gë_„©uª_d©a
(
¥oc
->
„©uª
, 
„©uª_id
);

196  (
íîgy_d©a
 *)
d©a
;

197 
	}
}

199 
	$check_fs
(
magic
)

201 
magic
) {

202 
EXT2_SUPER_MAGIC
:

203 
MSDOS_SUPER_MAGIC
:

208 
	}
}

210 
	$check_·y≥
(
fd
)

212 
îr
, 
ªt
 = 0;

213 
k°©
 kstat;

215 
îr
 = 
	`vfs_f°©
(
fd
, &
k°©
);

216 i‡(
îr
 =0 && 
	`S_ISREG
(
k°©
.
mode
))

217 
ªt
 = 1;

219  
ªt
;

220 
	}
}

222 
	$check_fûe
(
fd
)

224 
fûe
 *file;

226 
fûe
 = 
	`fgë
(
fd
);

227 i‡(
fûe
) {

228 
magic
 = 0;

229 i‡(
fûe
->
f_díåy
 && fûe->f_díåy->
d_sb
)

230 
magic
 = 
fûe
->
f_díåy
->
d_sb
->
s_magic
;

232 
	`Âut
(
fûe
);

234 i‡(
	`check_fs
(
magic
Ë&& 
	`check_·y≥
(
fd
))

239 
	}
}

241 
	$gë_¨g0
(
±_ªgs
 *
ªgs
)

243 #i‡
	`deföed
(
CONFIG_ARM
)

244  
ªgs
->
ARM_r0
;

245 #ñi‡
	`deföed
(
CONFIG_X86_32
)

246  
ªgs
->
bx
;

250 
	}
}

256 
˝us_time
 
	g˘_idÀ
;

257 
íîgy_d©a
 
	ged_sy°em
;

258 
u64
 
	g°¨t_time
;

260 
	$öô_d©a_íîgy
()

262 
°¨t_time
 = 
	`gë_¡ime
();

263 
	`öô_ed
(&
ed_sy°em
);

264 
	`˝us_time_öô
(&
˘_idÀ
, 0);

265 
	}
}

267 
	$unöô_d©a_íîgy
()

269 
°¨t_time
 = 0;

270 
	`unöô_ed
(&
ed_sy°em
);

271 
	`˝us_time_öô
(&
˘_idÀ
, 0);

272 
	}
}

282 
	$íåy_h™dÀr_swôch
(
kªçrobe_ö°™˚
 *
ri
, 
±_ªgs
 *
ªgs
)

284 
˝u
;

285 
˝us_time
 *
˘
;

286 
íîgy_d©a
 *
ed
;

287 
Êags
;

289 
˝u
 = 
	`smp_¥o˚ss‹_id
();

291 
˘
 = 
cuºít
->
tgid
 ? &
ed_sy°em
.˘: &
˘_idÀ
;

292 
	`˝us_time_lock
(
˘
, 
Êags
);

293 
	`˝us_time_upd©e_ru¬ög
(
˘
, 
˝u
, 
	`gë_¡ime
(), 
°¨t_time
);

294 
	`˝us_time_u∆ock
(
˘
, 
Êags
);

296 
ed
 = 
	`gë_íîgy_d©a
(
cuºít
);

297 i‡(
ed
) {

298 
˘
 = &
ed
->ct;

299 
	`˝us_time_lock
(
˘
, 
Êags
);

300 
	`˝us_time_upd©e_ru¬ög
(
˘
, 
˝u
, 
	`gë_¡ime
(), 
°¨t_time
);

301 
	`˝us_time_u∆ock
(
˘
, 
Êags
);

305 
	}
}

307 
	$ªt_h™dÀr_swôch
(
kªçrobe_ö°™˚
 *
ri
, 
±_ªgs
 *
ªgs
)

309 
˝u
;

310 
˝us_time
 *
˘
;

311 
íîgy_d©a
 *
ed
;

312 
Êags
;

314 
˝u
 = 
	`smp_¥o˚ss‹_id
();

316 
˘
 = 
cuºít
->
tgid
 ? &
ed_sy°em
.˘: &
˘_idÀ
;

317 
	`˝us_time_lock
(
˘
, 
Êags
);

318 
	`˝us_time_ßve_íåy
(
˘
, 
˝u
, 
	`gë_¡ime
());

319 
	`˝us_time_u∆ock
(
˘
, 
Êags
);

321 
ed
 = 
	`gë_íîgy_d©a
(
cuºít
);

322 i‡(
ed
) {

323 
˘
 = &
ed
->ct;

324 
	`˝us_time_lock
(
˘
, 
Êags
);

325 
	`˝us_time_ßve_íåy
(
˘
, 
˝u
, 
	`gë_¡ime
());

326 
	`˝us_time_u∆ock
(
˘
, 
Êags
);

330 
	}
}

332 
kªçrobe
 
	gswôch_to_kΩ
 = {

333 .
íåy_h™dÀr
 = 
íåy_h™dÀr_swôch
,

334 .
	gh™dÀr
 = 
ªt_h™dÀr_swôch
,

345 
	ssys_ªad_d©a
 {

346 
	mfd
;

349 
	$íåy_h™dÀr_sys_ªad
(
kªçrobe_ö°™˚
 *
ri
, 
±_ªgs
 *
ªgs
)

351 
sys_ªad_d©a
 *
§d
 = (sys_ªad_d©®*)
ri
->
d©a
;

353 
§d
->
fd
 = ()
	`gë_¨g0
(
ªgs
);

356 
	}
}

358 
	$ªt_h™dÀr_sys_ªad
(
kªçrobe_ö°™˚
 *
ri
,

359 
±_ªgs
 *
ªgs
)

361 
ªt
 = 
	`ªgs_ªtu∫_vÆue
(
ªgs
);

363 i‡(
ªt
 > 0) {

364 
sys_ªad_d©a
 *
§d
;

366 
§d
 = (
sys_ªad_d©a
 *)
ri
->
d©a
;

367 i‡(
	`check_fûe
(
§d
->
fd
)) {

368 
íîgy_d©a
 *
ed
;

370 
ed
 = 
	`gë_íîgy_d©a
(
cuºít
);

371 i‡(
ed
)

372 
	`©omic64_add
(
ªt
, &
ed
->
byãs_ªad
);

374 
	`©omic64_add
(
ªt
, &
ed_sy°em
.
byãs_ªad
);

379 
	}
}

381 
kªçrobe
 
	gsys_ªad_kΩ
 = {

382 .
íåy_h™dÀr
 = 
íåy_h™dÀr_sys_ªad
,

383 .
	gh™dÀr
 = 
ªt_h™dÀr_sys_ªad
,

384 .
	gd©a_size
 = (
sys_ªad_d©a
)

395 
	$íåy_h™dÀr_sys_wrôe
(
kªçrobe_ö°™˚
 *
ri
, 
±_ªgs
 *
ªgs
)

397 
sys_ªad_d©a
 *
§d
 = (sys_ªad_d©®*)
ri
->
d©a
;

399 
§d
->
fd
 = ()
	`gë_¨g0
(
ªgs
);

402 
	}
}

404 
	$ªt_h™dÀr_sys_wrôe
(
kªçrobe_ö°™˚
 *
ri
, 
±_ªgs
 *
ªgs
)

406 
ªt
 = 
	`ªgs_ªtu∫_vÆue
(
ªgs
);

408 i‡(
ªt
 > 0) {

409 
sys_ªad_d©a
 *
§d
;

411 
§d
 = (
sys_ªad_d©a
 *)
ri
->
d©a
;

412 i‡(
	`check_fûe
(
§d
->
fd
)) {

413 
íîgy_d©a
 *
ed
;

415 
ed
 = 
	`gë_íîgy_d©a
(
cuºít
);

416 i‡(
ed
)

417 
	`©omic64_add
(
ªt
, &
ed
->
byãs_wrôãn
);

419 
	`©omic64_add
(
ªt
, &
ed_sy°em
.
byãs_wrôãn
);

424 
	}
}

426 
kªçrobe
 
	gsys_wrôe_kΩ
 = {

427 .
íåy_h™dÀr
 = 
íåy_h™dÀr_sys_wrôe
,

428 .
	gh™dÀr
 = 
ªt_h™dÀr_sys_wrôe
,

429 .
	gd©a_size
 = (
sys_ªad_d©a
)

436 
	e∑ømëî_ty≥
 {

437 
	mPT_CPU
,

438 
	mPT_READ
,

439 
	mPT_WRITE


442 
	scmd_±
 {

443 
∑ømëî_ty≥
 
	m±
;

444 *
	mbuf
;

445 
	msz
;

448 
	$ˇŒback_f‹_¥oc
(
s•t_¥oc
 *
¥oc
, *
d©a
)

450 *
f_d©a
 = 
	`s•t_gë_„©uª_d©a
(
¥oc
->
„©uª
, 
„©uª_id
);

451 
íîgy_d©a
 *
ed
 = (íîgy_d©®*)
f_d©a
;

453 i‡(
ed
) {

454 
Êags
;

455 
cmd_±
 *
cmdp
 = (cmd_± *)
d©a
;

456 
u64
 *
vÆ
 = 
cmdp
->
buf
;

458 
cmdp
->
±
) {

459 
PT_CPU
:

460 
	`˝us_time_lock
(&
ed
->
˘
, 
Êags
);

461 
	`˝us_time_sum_ru¬ög_Æl
(&
ed
->
˘
, 
vÆ
, 
	`gë_¡ime
());

462 
	`˝us_time_u∆ock
(&
ed
->
˘
, 
Êags
);

464 
PT_READ
:

465 *
vÆ
 +
	`©omic64_ªad
(&
ed
->
byãs_ªad
);

467 
PT_WRITE
:

468 *
vÆ
 +
	`©omic64_ªad
(&
ed
->
byãs_wrôãn
);

474 
	}
}

476 
	$cuºít_∑ømëî_≠ps
(
∑ømëî_ty≥
 
±
, *
buf
, 
sz
)

478 
cmd_±
 
cmdp
;

480 
cmdp
.
±
 =Öt;

481 
cmdp
.
buf
 = buf;

482 
cmdp
.
sz
 = sz;

484 
	`⁄_óch_¥oc
(
ˇŒback_f‹_¥oc
, (*)&
cmdp
);

487 
	}
}

489 
	$gë_∑ømëî_íîgy
(
∑ømëî_íîgy
 
≥
, *
buf
, 
size_t
 
sz
)

491 
Êags
;

492 
u64
 *
vÆ
 = 
buf
;

493 
ªt
 = 0;

495 
≥
) {

496 
PE_TIME_IDLE
:

497 
	`˝us_time_lock
(&
˘_idÀ
, 
Êags
);

499 *
vÆ
 = 
	`˝u_time_gë_ru¬ög
(&
˘_idÀ
, 0, 
	`gë_¡ime
());

500 
	`˝us_time_u∆ock
(&
˘_idÀ
, 
Êags
);

502 
PE_TIME_SYSTEM
:

503 
	`˝us_time_lock
(&
ed_sy°em
.
˘
, 
Êags
);

504 
	`˝us_time_gë_ru¬ög_Æl
(&
ed_sy°em
.
˘
, 
vÆ
, 
	`gë_¡ime
());

505 
	`˝us_time_u∆ock
(&
ed_sy°em
.
˘
, 
Êags
);

507 
PE_TIME_APPS
:

508 
	`cuºít_∑ømëî_≠ps
(
PT_CPU
, 
buf
, 
sz
);

510 
PE_READ_SYSTEM
:

511 *
vÆ
 = 
	`©omic64_ªad
(&
ed_sy°em
.
byãs_ªad
);

513 
PE_WRITE_SYSTEM
:

514 *
vÆ
 = 
	`©omic64_ªad
(&
ed_sy°em
.
byãs_wrôãn
);

516 
PE_READ_APPS
:

517 
	`cuºít_∑ømëî_≠ps
(
PT_READ
, 
buf
, 
sz
);

519 
PE_WRITE_APPS
:

520 
	`cuºít_∑ømëî_≠ps
(
PT_WRITE
, 
buf
, 
sz
);

523 
ªt
 = -
EINVAL
;

527  
ªt
;

528 
	}
}

530 
	$do_£t_íîgy
()

532 
ªt
 = 0;

534 
	`öô_d©a_íîgy
();

536 
ªt
 = 
	`dbi_ªgi°î_kªçrobe
(&
sys_ªad_kΩ
);

537 i‡(
ªt
) {

538 
	`¥ötk
("dbi_ªgi°î_kªçrobe(sys_ªadËªsu…=%d!\n", 
ªt
);

539  
ªt
;

542 
ªt
 = 
	`dbi_ªgi°î_kªçrobe
(&
sys_wrôe_kΩ
);

543 i‡(
ªt
 != 0) {

544 
	`¥ötk
("dbi_ªgi°î_kªçrobe(sys_wrôeËªsu…=%d!\n", 
ªt
);

545 
uƒegi°î_sys_ªad
;

548 
ªt
 = 
	`dbi_ªgi°î_kªçrobe
(&
swôch_to_kΩ
);

549 i‡(
ªt
) {

550 
	`¥ötk
("dbi_ªgi°î_kªçrobe(__swôch_toËªsu…=%d!\n", 
ªt
);

551 
uƒegi°î_sys_wrôe
;

555 
	`lcd_£t_íîgy
();

557  
ªt
;

559 
uƒegi°î_sys_ªad
:

560 
	`dbi_uƒegi°î_kªçrobe
(&
sys_ªad_kΩ
);

562 
uƒegi°î_sys_wrôe
:

563 
	`dbi_uƒegi°î_kªçrobe
(&
sys_wrôe_kΩ
);

565  
ªt
;

566 
	}
}

568 
	$do_un£t_íîgy
()

570 
	`lcd_un£t_íîgy
();

572 
	`dbi_uƒegi°î_kªçrobe
(&
swôch_to_kΩ
);

573 
	`dbi_uƒegi°î_kªçrobe
(&
sys_wrôe_kΩ
);

574 
	`dbi_uƒegi°î_kªçrobe
(&
sys_ªad_kΩ
);

576 
	`unöô_d©a_íîgy
();

577 
	}
}

579 
DEFINE_MUTEX
(
muãx_íabÀ
);

580 
	gíîgy_íabÀ
 = 0;

582 
	$£t_íîgy
()

584 
ªt
 = -
EINVAL
;

586 
	`muãx_lock
(&
muãx_íabÀ
);

587 i‡(
íîgy_íabÀ
) {

588 
	`¥ötk
("energyÖrofiling isálreadyÑun!\n");

589 
u∆ock
;

592 
ªt
 = 
	`do_£t_íîgy
();

593 i‡(
ªt
 == 0)

594 
íîgy_íabÀ
 = 1;

596 
u∆ock
:

597 
	`muãx_u∆ock
(&
muãx_íabÀ
);

599  
ªt
;

600 
	}
}

601 
EXPORT_SYMBOL_GPL
(
£t_íîgy
);

603 
	$un£t_íîgy
()

605 
ªt
 = 0;

607 
	`muãx_lock
(&
muãx_íabÀ
);

608 i‡(
íîgy_íabÀ
 == 0) {

609 
	`¥ötk
("energyÖrofiling isÇotÑunning!\n");

610 
ªt
 = -
EINVAL
;

611 
u∆ock
;

614 
	`do_un£t_íîgy
();

616 
íîgy_íabÀ
 = 0;

617 
u∆ock
:

618 
	`muãx_u∆ock
(&
muãx_íabÀ
);

620  
ªt
;

621 
	}
}

622 
EXPORT_SYMBOL_GPL
(
un£t_íîgy
);

624 
	$íîgy_öô
()

626 
ªt
;

627 
addr
;

629 
addr
 = 
	`sw≠_ksyms
("__switch_to");

630 i‡(
addr
 == 0) {

631 
	`¥ötk
("Cannot findáddress for __switch_to function!\n");

632  -
EINVAL
;

634 
swôch_to_kΩ
.
kp
.
addr
 = (
k¥obe_›code_t
 *)addr;

636 
addr
 = 
	`sw≠_ksyms
("sys_read");

637 i‡(
addr
 == 0) {

638 
	`¥ötk
("Cannot findáddress for sys_read function!\n");

639  -
EINVAL
;

641 
sys_ªad_kΩ
.
kp
.
addr
 = (
k¥obe_›code_t
 *)addr;

643 
addr
 = 
	`sw≠_ksyms
("sys_write");

644 i‡(
addr
 == 0) {

645 
	`¥ötk
("Cannot findáddress for sys_write function!\n");

646  -
EINVAL
;

648 
sys_wrôe_kΩ
.
kp
.
addr
 = (
k¥obe_›code_t
 *)addr;

650 
ªt
 = 
	`öô_„©uª
();

651 i‡(
ªt
) {

652 
	`¥ötk
("Cannot init feature\n");

653  
ªt
;

656 
ªt
 = 
	`lcd_öô
();

657 i‡(
ªt
)

658 
	`¥ötk
("C™nŸ inô LCD,Ñë=%d\n", 
ªt
);

661 
	}
}

663 
	$íîgy_unöô
()

665 
	`lcd_exô
();

666 
	`unöô_„©uª
();

668 i‡(
íîgy_íabÀ
)

669 
	`do_un£t_íîgy
();

670 
	}
}

	@energy/energy.h

1 #i‚de‡
_ENERGY_H


2 
	#_ENERGY_H


	)

29 
	~<löux/ty≥s.h
>

32 
	e∑ømëî_íîgy
 {

33 
	mPE_TIME_IDLE
,

34 
	mPE_TIME_SYSTEM
,

35 
	mPE_TIME_APPS
,

36 
	mPE_READ_SYSTEM
,

37 
	mPE_WRITE_SYSTEM
,

38 
	mPE_READ_APPS
,

39 
	mPE_WRITE_APPS


43 
íîgy_öô
();

44 
íîgy_unöô
();

46 
£t_íîgy
();

47 
un£t_íîgy
();

49 
gë_∑ømëî_íîgy
(
∑ømëî_íîgy
 
≥
, *
buf
, 
size_t
 
sz
);

	@energy/energy_module.c

26 
	~<löux/moduÀ.h
>

27 
	~"íîgy.h
"

28 
	~"debugfs_íîgy.h
"

31 
__öô
 
	$sw≠_íîgy_öô
()

33 
ªt
;

35 
ªt
 = 
	`öô_debugfs_íîgy
();

36 i‡(
ªt
) {

37 
	`¥ötk
("Cannot init debugfs forÉnergy\n");

38  
ªt
;

41 
ªt
 = 
	`íîgy_öô
();

42 i‡(
ªt
) {

43 
	`¥ötk
("Cannot initÉnergy\n");

44 
	`exô_debugfs_íîgy
();

47  
ªt
;

48 
	}
}

50 
__exô
 
	$sw≠_íîgy_exô
()

52 
	`íîgy_unöô
();

53 
	`exô_debugfs_íîgy
();

54 
	}
}

56 
moduÀ_öô
(
sw≠_íîgy_öô
);

57 
moduÀ_exô
(
sw≠_íîgy_exô
);

59 
MODULE_LICENSE
("GPL");

	@energy/lcd/lcd_base.c

26 
	~<löux/moduÀ.h
>

27 
	~<löux/¶ab.h
>

28 
	~<löux/fs.h
>

29 
	~<löux/fb.h
>

30 
	~<íîgy/tm_°©.h
>

31 
	~<íîgy/debugfs_íîgy.h
>

32 
	~"lcd_ba£.h
"

33 
	~"lcd_debugfs.h
"

36 
	$ªad_vÆ
(c⁄° *
∑th
)

38 
ªt
;

39 
fûe
 *
f
;

40 
vÆ
;

41 íum { 
buf_Àn
 = 32 };

42 
buf
[
buf_Àn
];

44 
f
 = 
	`fûp_›í
(
∑th
, 
O_RDONLY
, 0);

45 i‡(
	`IS_ERR
(
f
)) {

46 
	`¥ötk
("ˇ¬Ÿ o≥¿fûê\'%s\'", 
∑th
);

47  
	`PTR_ERR
(
f
);

50 
ªt
 = 
	`kî√l_ªad
(
f
, 0, 
buf
, (buf));

51 
	`fûp_˛o£
(
f
, 
NULL
);

52 i‡(
ªt
 < 0)

53  
ªt
;

55 
buf
[
ªt
 >
buf_Àn
 ? buf_len - 1 :Ñet] = '\0';

57 
ªt
 = 
	`°ri˘_°πoul
(
buf
, 0, &
vÆ
);

58 i‡(
ªt
)

59  
ªt
;

61  ()
vÆ
;

62 
	}
}

65 
	mbπ_no_öô
 = -1,

66 
	mbπ_˙t
 = 10

69 
	epowî_t
 {

70 
	mPW_ON
,

71 
	mPW_OFF


74 
	slcd_¥iv_d©a
 {

75 
	mmö_bπ
;

76 
	mmax_bπ
;

78 
size_t
 
	mtms_bπ_˙t
;

79 
tm_°©
 *
	mtms_bπ
;

80 
•ölock_t
 
	mlock_tms
;

81 
	mbπ_ﬁd
;

82 
powî_t
 
	mpowî
;

84 
u64
 
	mmö_díom
;

85 
u64
 
	mmö_num
;

86 
u64
 
	mmax_díom
;

87 
u64
 
	mmax_num
;

90 *
	$¸óã_lcd_¥iv
(
lcd_›s
 *
›s
, 
size_t
 
tms_bπ_˙t
)

92 
i
;

93 
lcd_¥iv_d©a
 *
lcd
;

95 i‡(
tms_bπ_˙t
 <= 0) {

96 
	`¥ötk
("îr‹ v¨übÀÅms_bπ_˙t=%d\n", 
tms_bπ_˙t
);

97  
NULL
;

100 
lcd
 = 
	`kmÆloc
((*lcdË+ (*lcd->
tms_bπ
Ë* 
tms_bπ_˙t
,

101 
GFP_KERNEL
);

102 i‡(
lcd
 =
NULL
) {

103 
	`¥ötk
("îr‹: %†- ouào‡mem‹y\n", 
__func__
);

104  
NULL
;

107 
lcd
->
tms_bπ
 = (*)lcd + (*lcd);

108 
lcd
->
tms_bπ_˙t
 =Åms_brt_cnt;

110 
lcd
->
mö_bπ
 = 
›s
->
	`gë
(›s, 
LPD_MIN_BRIGHTNESS
);

111 
lcd
->
max_bπ
 = 
›s
->
	`gë
(›s, 
LPD_MAX_BRIGHTNESS
);

113 
i
 = 0; i < 
tms_bπ_˙t
; ++i)

114 
	`tm_°©_öô
(&
lcd
->
tms_bπ
[
i
]);

116 
	`•ö_lock_öô
(&
lcd
->
lock_tms
);

118 
lcd
->
bπ_ﬁd
 = 
bπ_no_öô
;

119 
lcd
->
powî
 = 
PW_OFF
;

121 
lcd
->
mö_díom
 = 1;

122 
lcd
->
mö_num
 = 1;

123 
lcd
->
max_díom
 = 1;

124 
lcd
->
max_num
 = 1;

126  (*)
lcd
;

127 
	}
}

129 
	$de°roy_lcd_¥iv
(*
d©a
)

131 
	`k‰ì
(
d©a
);

132 
	}
}

134 
lcd_¥iv_d©a
 *
	$gë_lcd_¥iv
(
lcd_›s
 *
›s
)

136  (
lcd_¥iv_d©a
 *)
›s
->
¥iv
;

137 
	}
}

139 
	$˛ón_brighäess
(
lcd_›s
 *
›s
)

141 
lcd_¥iv_d©a
 *
lcd
 = 
	`gë_lcd_¥iv
(
›s
);

142 
i
;

144 
	`•ö_lock
(&
lcd
->
lock_tms
);

145 
i
 = 0; i < 
lcd
->
tms_bπ_˙t
; ++i)

146 
	`tm_°©_öô
(&
lcd
->
tms_bπ
[
i
]);

148 
lcd
->
bπ_ﬁd
 = 
bπ_no_öô
;

149 
	`•ö_u∆ock
(&
lcd
->
lock_tms
);

150 
	}
}

152 
	$gë_bπ_num_of_¨øy
(
lcd_¥iv_d©a
 *
lcd
, 
bπ
)

154 i‡(
bπ
 > 
lcd
->
max_bπ
 || bπ <Ücd->
mö_bπ
) {

155 
	`¥ötk
("LCDÉnergyÉrror: set brightness=%d, "

157 
bπ
, 
lcd
->
mö_bπ
,Ücd->
max_bπ
);

158 
bπ
 = bπ > 
lcd
->
max_bπ
 ?Ücd->max_bπ :Ücd->
mö_bπ
;

161  
lcd
->
tms_bπ_˙t
 * (
bπ
 -Ücd->
mö_bπ
) /

162 (
lcd
->
max_bπ
 -Ücd->
mö_bπ
 + 1);

163 
	}
}

165 
	$£t_brighäess
(
lcd_›s
 *
›s
, 
bπ
)

167 
lcd_¥iv_d©a
 *
lcd
 = 
	`gë_lcd_¥iv
(
›s
);

168 
n
 = 
	`gë_bπ_num_of_¨øy
(
lcd
, 
bπ
);

170 
	`•ö_lock
(&
lcd
->
lock_tms
);

172 i‡(
lcd
->
powî
 =
PW_ON
 &&Ücd->
bπ_ﬁd
 !
n
) {

173 
u64
 
time
 = 
	`gë_¡ime
();

174 i‡(
lcd
->
bπ_ﬁd
 !
bπ_no_öô
)

175 
	`tm_°©_upd©e
(&
lcd
->
tms_bπ
[lcd->
bπ_ﬁd
], 
time
);

177 
	`tm_°©_£t_time°amp
(&
lcd
->
tms_bπ
[
n
], 
time
);

179 
lcd
->
bπ_ﬁd
 = 
n
;

181 
	`•ö_u∆ock
(&
lcd
->
lock_tms
);

182 
	}
}

184 
	$£t_powî_⁄_£t_bπ
(
lcd_¥iv_d©a
 *
lcd
)

186 i‡(
lcd
->
bπ_ﬁd
 !
bπ_no_öô
) {

187 
u64
 
time
 = 
	`gë_¡ime
();

188 
	`tm_°©_£t_time°amp
(&
lcd
->
tms_bπ
[lcd->
bπ_ﬁd
], 
time
);

190 
	}
}

192 
	$£t_powî_⁄
(
lcd_¥iv_d©a
 *
lcd
)

194 i‡(
lcd
->
powî
 =
PW_OFF
)

195 
	`£t_powî_⁄_£t_bπ
(
lcd
);

197 
lcd
->
powî
 = 
PW_ON
;

198 
	}
}

200 
	$£t_powî_off_upd©e_bπ
(
lcd_¥iv_d©a
 *
lcd
)

202 i‡(
lcd
->
bπ_ﬁd
 !
bπ_no_öô
) {

203 
u64
 
time
 = 
	`gë_¡ime
();

204 
	`tm_°©_upd©e
(&
lcd
->
tms_bπ
[lcd->
bπ_ﬁd
], 
time
);

205 
lcd
->
bπ_ﬁd
 = 
bπ_no_öô
;

207 
	}
}

209 
	$£t_powî_off
(
lcd_¥iv_d©a
 *
lcd
)

211 i‡(
lcd
->
powî
 =
PW_ON
)

212 
	`£t_powî_off_upd©e_bπ
(
lcd
);

214 
lcd
->
powî
 = 
PW_OFF
;

215 
	}
}

217 
	$£t_powî
(
lcd_›s
 *
›s
, 
vÆ
)

219 
lcd_¥iv_d©a
 *
lcd
 = 
	`gë_lcd_¥iv
(
›s
);

221 
	`•ö_lock
(&
lcd
->
lock_tms
);

223 
vÆ
) {

224 
FB_BLANK_UNBLANK
:

225 
	`£t_powî_⁄
(
lcd
);

227 
FB_BLANK_POWERDOWN
:

228 
	`£t_powî_off
(
lcd
);

231 
	`¥ötk
("LCDÉ√rgyÉº‹: sëÖowî=%d\n", 
vÆ
);

235 
	`•ö_u∆ock
(&
lcd
->
lock_tms
);

236 
	}
}

238 
	$func_nŸifõr_lcd
(
lcd_›s
 *
›s
, 
lcd_a˘i⁄_ty≥
 
a˘i⁄
,

239 *
d©a
)

241 
a˘i⁄
) {

242 
LAT_BRIGHTNESS
:

243 
	`£t_brighäess
(
›s
, ()
d©a
);

245 
LAT_POWER
:

246 
	`£t_powî
(
›s
, ()
d©a
);

249 
	`¥ötk
("LCDÉ√rgyÉº‹:á˘i⁄=%d\n", 
a˘i⁄
);

250  -
EINVAL
;

254 
	}
}

256 
size_t
 
	$gë_lcd_size_¨øy
(
lcd_›s
 *
›s
)

258 
lcd_¥iv_d©a
 *
lcd
 = 
	`gë_lcd_¥iv
(
›s
);

260  
lcd
->
tms_bπ_˙t
;

261 
	}
}

263 
	$gë_lcd_¨øy_time
(
lcd_›s
 *
›s
, 
u64
 *
¨øy_time
)

265 
lcd_¥iv_d©a
 *
lcd
 = 
	`gë_lcd_¥iv
(
›s
);

266 
i
;

268 
	`•ö_lock
(&
lcd
->
lock_tms
);

269 
i
 = 0; i < 
lcd
->
tms_bπ_˙t
; ++i)

270 
¨øy_time
[
i
] = 
	`tm_°©_ru¬ög
(&
lcd
->
tms_bπ
[i]);

272 i‡(
lcd
->
powî
 =
PW_ON
 &&Ücd->
bπ_ﬁd
 !
bπ_no_öô
) {

273 
ﬁd
 = 
lcd
->
bπ_ﬁd
;

274 
tm_°©
 *
tm
 = &
lcd
->
tms_bπ
[
ﬁd
];

276 
¨øy_time
[
ﬁd
] +
	`gë_¡ime
(Ë- 
	`tm_°©_time°amp
(
tm
);

278 
	`•ö_u∆ock
(&
lcd
->
lock_tms
);

279 
	}
}

281 
	$ªgi°î_lcd
(
lcd_›s
 *
›s
)

283 
ªt
 = 0;

285 
›s
->
¥iv
 = 
	`¸óã_lcd_¥iv
(›s, 
bπ_˙t
);

288 
›s
->
mö_c€f
.
num
 = 1;

289 
›s
->
mö_c€f
.
díom
 = 1;

290 
›s
->
max_c€f
.
num
 = 1;

291 
›s
->
max_c€f
.
díom
 = 1;

293 
›s
->
nŸifõr
 = 
func_nŸifõr_lcd
;

295 
ªt
 = 
	`ªgi°î_lcd_debugfs
(
›s
);

296 i‡(
ªt
)

297 
	`de°roy_lcd_¥iv
(
›s
->
¥iv
);

299  
ªt
;

300 
	}
}

302 
	$uƒegi°î_lcd
(
lcd_›s
 *
›s
)

304 
	`uƒegi°î_lcd_debugfs
(
›s
);

305 
	`de°roy_lcd_¥iv
(
›s
->
¥iv
);

306 
	}
}

315 
	glcd_›s
 *(*
	tgë_›s_t
)();

317 
	gDEFINITION_LCD_FUNC
;

319 
gë_›s_t
 
	glcd_›s
[] = 
DEFINITION_LCD_ARRAY
;

320 íum { 
	mlcd_›s_˙t
 = (
lcd_›s
Ë/ (
gë_›s_t
) };

322 
	eST_LCD_OPS
 {

323 
	mSLO_REGISTER
 = 1 << 0,

324 
	mSLO_SET
 = 1 << 1

327 
DEFINE_MUTEX
(
lcd_lock
);

328 
ST_LCD_OPS
 
	g°©_lcd_›s
[
lcd_›s_˙t
];

330 
	$do_lcd_exô
()

332 
i
;

333 
lcd_›s
 *
›s
;

335 
	`muãx_lock
(&
lcd_lock
);

336 
i
 = 0; i < 
lcd_›s_˙t
; ++i) {

337 
›s
 = 
lcd_›s
[
i
]();

339 i‡(
°©_lcd_›s
[
i
] & 
SLO_SET
) {

340 
›s
->
	`un£t
(ops);

341 
°©_lcd_›s
[
i
] &~
SLO_SET
;

344 i‡(
°©_lcd_›s
[
i
] & 
SLO_REGISTER
) {

345 
	`uƒegi°î_lcd
(
›s
);

346 
°©_lcd_›s
[
i
] &~
SLO_REGISTER
;

349 
	`muãx_u∆ock
(&
lcd_lock
);

350 
	}
}

352 
	$lcd_exô
()

354 
	`do_lcd_exô
();

355 
	`exô_lcd_debugfs
();

356 
	}
}

358 
	$do_lcd_öô
()

360 
i
, 
ªt
, 
cou¡
 = 0;

361 
lcd_›s
 *
›s
;

363 
	`muãx_lock
(&
lcd_lock
);

364 
i
 = 0; i < 
lcd_›s_˙t
; ++i) {

365 
›s
 = 
lcd_›s
[
i
]();

366 i‡(
›s
 =
NULL
) {

367 
	`¥ötk
("îr‹ %†[›†=NULL]\n", 
__func__
);

371 i‡(0 =
›s
->
	`check
(ops)) {

372 
	`¥ötk
("îr‹ checkög %s\n", 
›s
->
«me
);

376 
ªt
 = 
	`ªgi°î_lcd
(
›s
);

377 i‡(
ªt
) {

378 
	`¥ötk
("îr‹Ñegi°î_lcd %s\n", 
›s
->
«me
);

382 
°©_lcd_›s
[
i
] |
SLO_REGISTER
;

383 ++
cou¡
;

385 
	`muãx_u∆ock
(&
lcd_lock
);

387  
cou¡
 ? 0 : -
EPERM
;

388 
	}
}

390 
	$lcd_öô
()

392 
ªt
;

393 
díåy
 *
íîgy_dú
;

395 
íîgy_dú
 = 
	`gë_íîgy_dú
();

396 i‡(
íîgy_dú
 =
NULL
) {

397 
	`¥ötk
("CannotÉnergy_dir\n");

398  -
ENOENT
;

401 
ªt
 = 
	`öô_lcd_debugfs
(
íîgy_dú
);

402 i‡(
ªt
)

403  
ªt
;

405 
ªt
 = 
	`do_lcd_öô
();

406 i‡(
ªt
) {

407 
	`¥ötk
("LCD isÇot supported\n");

408 
	`exô_lcd_debugfs
();

411  
ªt
;

412 
	}
}

420 
	$lcd_£t_íîgy
()

422 
i
, 
ªt
, 
cou¡
 = 0;

423 
lcd_›s
 *
›s
;

425 
	`muãx_lock
(&
lcd_lock
);

426 
i
 = 0; i < 
lcd_›s_˙t
; ++i) {

427 
›s
 = 
lcd_›s
[
i
]();

428 i‡(
°©_lcd_›s
[
i
] & 
SLO_REGISTER
) {

429 
ªt
 = 
›s
->
	`£t
(ops);

430 i‡(
ªt
) {

431 
	`¥ötk
("îr‹ %†£àLCDÉ√rgy", 
›s
->
«me
);

435 
	`£t_brighäess
(
›s
, ops->
	`gë
(›s, 
LPD_BRIGHTNESS
));

436 
	`£t_powî
(
›s
, ops->
	`gë
(›s, 
LPD_POWER
));

438 
°©_lcd_›s
[
i
] |
SLO_SET
;

439 ++
cou¡
;

442 
	`muãx_u∆ock
(&
lcd_lock
);

444  
cou¡
 ? 0 : -
EPERM
;

445 
	}
}

447 
	$lcd_un£t_íîgy
()

449 
i
, 
ªt
;

450 
lcd_›s
 *
›s
;

452 
	`muãx_lock
(&
lcd_lock
);

453 
i
 = 0; i < 
lcd_›s_˙t
; ++i) {

454 
›s
 = 
lcd_›s
[
i
]();

455 i‡(
°©_lcd_›s
[
i
] & 
SLO_SET
) {

456 
ªt
 = 
›s
->
	`un£t
(ops);

457 i‡(
ªt
)

458 
	`¥ötk
("îr‹ %†un£àLCDÉ√rgy", 
›s
->
«me
);

460 
	`˛ón_brighäess
(
›s
);

461 
°©_lcd_›s
[
i
] &~
SLO_SET
;

464 
	`muãx_u∆ock
(&
lcd_lock
);

465 
	}
}

	@energy/lcd/lcd_base.h

1 #i‚de‡
_LCD_BASE_H


2 
	#_LCD_BASE_H


	)

29 
	~<löux/î∫o.h
>

30 
	~<íîgy/øti⁄Æ_debugfs.h
>

33 
	elcd_a˘i⁄_ty≥
 {

34 
	mLAT_BRIGHTNESS
,

35 
	mLAT_POWER


38 
	elcd_∑ømëî_ty≥
 {

39 
	mLPD_MIN_BRIGHTNESS
,

40 
	mLPD_MAX_BRIGHTNESS
,

41 
	mLPD_BRIGHTNESS
,

43 
	mLPD_POWER


46 
	glcd_›s
;

48 (*
	tˇŒ_lcd
)(
	tlcd_›s
 *
	t›s
);

49 (*
	tnŸifõr_lcd
)(
	tlcd_›s
 *
	t›s
, 
	tlcd_a˘i⁄_ty≥
 
	ta˘i⁄
,

50 *
	td©a
);

51 (*
	tgë_∑ømëî_lcd
)(
	tlcd_›s
 *
	t›s
,

52 
	tlcd_∑ømëî_ty≥
 
	tty≥
);

55 
	slcd_›s
 {

56 *
«me
;

57 
nŸifõr_lcd
 
nŸifõr
;

58 
gë_∑ømëî_lcd
 
gë
;

60 
ˇŒ_lcd
 
check
;

61 
ˇŒ_lcd
 
£t
;

62 
ˇŒ_lcd
 
un£t
;

65 
díåy
 *dentry;

66 
øti⁄Æ
 
mö_c€f
;

67 
øti⁄Æ
 
max_c€f
;

69 *
¥iv
;

72 
size_t
 
	`gë_lcd_size_¨øy
(
lcd_›s
 *
›s
);

73 
	`gë_lcd_¨øy_time
(
lcd_›s
 *
›s
, 
u64
 *
¨øy_time
);

75 
	`ªad_vÆ
(c⁄° *
∑th
);

77 
	`lcd_£t_íîgy
();

78 
	`lcd_un£t_íîgy
();

80 
	`lcd_öô
();

81 
	`lcd_exô
();

	@energy/lcd/lcd_debugfs.c

26 
	~<löux/debugfs.h
>

27 
	~<löux/exp‹t.h
>

28 
	~<löux/¶ab.h
>

29 
	~<íîgy/lcd/lcd_ba£.h
>

30 
	~<íîgy/øti⁄Æ_debugfs.h
>

33 
	$gë_sy°em
(*
d©a
, 
u64
 *
vÆ
)

35 
lcd_›s
 *
›s
 = (lcd_›†*)
d©a
;

36 c⁄° 
size_t
 
size
 = 
	`gë_lcd_size_¨øy
(
›s
);

37 c⁄° 
size_t
 
size_1
 = 
size
 - 1;

38 
u64
 
i_max
, 
j_mö
, 
t
, 
e
 = 0;

39 
u64
 *
¨øy_time
;

40 
i
, 
j
;

42 
¨øy_time
 = 
	`kmÆloc
((*¨øy_timeË* 
size
, 
GFP_KERNEL
);

43 i‡(
¨øy_time
 =
NULL
)

44  -
ENOMEM
;

46 
	`gë_lcd_¨øy_time
(
›s
, 
¨øy_time
);

48 
i
 = 0; i < 
size
; ++i) {

49 
t
 = 
¨øy_time
[
i
];

52 
j
 = 
size_1
 - 
i
;

53 
i_max
 = 
	`div_u64
(
i
 * 
›s
->
max_c€f
.
num
 * 
t
,

54 
›s
->
max_c€f
.
díom
);

55 
j_mö
 = 
	`div_u64
(
j
 * 
›s
->
mö_c€f
.
num
 * 
t
,

56 
›s
->
mö_c€f
.
díom
);

57 
e
 +
	`div_u64
(
i_max
 + 
j_mö
, 
size_1
);

60 
	`k‰ì
(
¨øy_time
);

62 *
vÆ
 = 
e
;

65 
	}
}

67 
DEFINE_SIMPLE_ATTRIBUTE
(
f›s_gë_sy°em
, 
gë_sy°em
, 
NULL
, "%llu\n");

70 
díåy
 *
	glcd_dú
 = 
NULL
;

72 
	$ªgi°î_lcd_debugfs
(
lcd_›s
 *
›s
)

74 
ªt
;

75 
díåy
 *díåy, *
sy°em
;

77 i‡(
lcd_dú
 =
NULL
)

78  -
EINVAL
;

80 
díåy
 = 
	`debugfs_¸óã_dú
(
›s
->
«me
, 
lcd_dú
);

81 i‡(
díåy
 =
NULL
)

82  -
ENOMEM
;

84 
ªt
 = 
	`¸óã_øti⁄Æ_fûes
(
díåy
, &
›s
->
mö_c€f
,

86 i‡(
ªt
)

87 
Áû
;

89 
ªt
 = 
	`¸óã_øti⁄Æ_fûes
(
díåy
, &
›s
->
max_c€f
,

91 i‡(
ªt
)

92 
Áû
;

94 
sy°em
 = 
	`debugfs_¸óã_fûe
("sy°em", 0600, 
díåy
, (*)
›s
,

95 &
f›s_gë_sy°em
);

96 i‡(
sy°em
 =
NULL
)

97 
Áû
;

99 
›s
->
díåy
 = dentry;

102 
Áû
:

103 
	`debugfs_ªmove_ªcursive
(
díåy
);

104  -
ENOMEM
;

105 
	}
}

107 
	$uƒegi°î_lcd_debugfs
(
lcd_›s
 *
›s
)

109 
	`debugfs_ªmove_ªcursive
(
›s
->
díåy
);

110 
	}
}

112 
	$exô_lcd_debugfs
()

114 i‡(
lcd_dú
)

115 
	`debugfs_ªmove_ªcursive
(
lcd_dú
);

117 
lcd_dú
 = 
NULL
;

118 
	}
}

120 
	$öô_lcd_debugfs
(
díåy
 *
íîgy_dú
)

122 
lcd_dú
 = 
	`debugfs_¸óã_dú
("lcd", 
íîgy_dú
);

123 i‡(
lcd_dú
 =
NULL
)

124  -
ENOMEM
;

127 
	}
}

	@energy/lcd/lcd_debugfs.h

1 #i‚de‡
_LCD_DEBUGFS_H


2 
	#_LCD_DEBUGFS_H


	)

29 
	gdíåy
;

30 
	glcd_›s
;

32 
ªgi°î_lcd_debugfs
(
lcd_›s
 *
›s
);

33 
uƒegi°î_lcd_debugfs
(
lcd_›s
 *
›s
);

35 
öô_lcd_debugfs
(
díåy
 *
íîgy_dú
);

36 
exô_lcd_debugfs
();

	@energy/lcd/maru.c

26 
	~<k¥obe/dbi_k¥obes.h
>

27 
	~<löux/backlight.h
>

28 
	~"lcd_ba£.h
"

32 c⁄° 
	g∑th_backlight
[] = "/sys/class/backlight/emulator/brightness";

33 c⁄° 
	g∑th_backlight_mö
[] = "/sys/class/backlight/emulator/min_brightness";

34 c⁄° 
	g∑th_backlight_max
[] = "/sys/class/backlight/emulator/max_brightness";

35 c⁄° 
	g∑th_powî
[] = "/sys/class/lcd/emulator/lcd_power";

37 c⁄° *
	gÆl_∑th
[] = {

38 
∑th_backlight
,

39 
∑th_backlight_mö
,

40 
∑th_backlight_max
,

41 
∑th_powî


45 
	mÆl_∑th_˙t
 = (
Æl_∑th
) / (*)

49 
	$m¨u_check
(
lcd_›s
 *
›s
)

51 
i
;

53 
i
 = 0; i < 
Æl_∑th_˙t
; ++i) {

54 
ªt
 = 
	`ªad_vÆ
(
Æl_∑th
[
i
]);

56 i‡(
	`IS_ERR_VALUE
(
ªt
))

61 
	}
}

63 
	$m¨u_gë_∑ømëî
(
lcd_›s
 *
›s
,

64 
lcd_∑ømëî_ty≥
 
ty≥
)

66 
ty≥
) {

67 
LPD_MIN_BRIGHTNESS
:

68  
	`ªad_vÆ
(
∑th_backlight_mö
);

69 
LPD_MAX_BRIGHTNESS
:

70  
	`ªad_vÆ
(
∑th_backlight_max
);

71 
LPD_BRIGHTNESS
:

72  
	`ªad_vÆ
(
∑th_backlight
);

73 
LPD_POWER
:

74  
	`ªad_vÆ
(
∑th_powî
);

76  -
EINVAL
;

78 
	}
}

84 
íåy_h™dÀr_£t_backlight
(
kªçrobe_ö°™˚
 *
ri
,

85 
±_ªgs
 *
ªgs
);

86 
ªt_h™dÀr_£t_backlight
(
kªçrobe_ö°™˚
 *
ri
,

87 
±_ªgs
 *
ªgs
);

89 
kªçrobe
 
	g£t_backlight_kΩ
 = {

90 .
kp
.
symbﬁ_«me
 = "marubl_send_intensity",

91 .
	gíåy_h™dÀr
 = 
íåy_h™dÀr_£t_backlight
,

92 .
	gh™dÀr
 = 
ªt_h™dÀr_£t_backlight
,

93 .
	gd©a_size
 = ()

100 
	$m¨u_£t
(
lcd_›s
 *
›s
)

102  
	`dbi_ªgi°î_kªçrobe
(&
£t_backlight_kΩ
);

103 
	}
}

105 
	$m¨u_un£t
(
lcd_›s
 *
›s
)

107 
	`dbi_uƒegi°î_kªçrobe
(&
£t_backlight_kΩ
);

109 
	}
}

111 
lcd_›s
 
	gm¨u_›s
 = {

112 .
«me
 = "maru",

113 .
	gcheck
 = 
m¨u_check
,

114 .
	g£t
 = 
m¨u_£t
,

115 .
	gun£t
 = 
m¨u_un£t
,

116 .
	ggë
 = 
m¨u_gë_∑ømëî


119 
lcd_›s
 *
	$LCD_MAKE_FNAME
(
m¨u
)()

121  &
m¨u_›s
;

122 
	}
}

128 
	$íåy_h™dÀr_£t_backlight
(
kªçrobe_ö°™˚
 *
ri
,

129 
±_ªgs
 *
ªgs
)

131 *
brighäess
 = (*)
ri
->
d©a
;

132 
backlight_devi˚
 *
bd
;

134 
bd
 = (
backlight_devi˚
 *)
	`sw≠_gë_k¨g
(
ªgs
, 0);

135 *
brighäess
 = 
bd
->
¥›s
.brightness;

138 
	}
}

140 
	$ªt_h™dÀr_£t_backlight
(
kªçrobe_ö°™˚
 *
ri
,

141 
±_ªgs
 *
ªgs
)

143 
ªt
 = 
	`ªgs_ªtu∫_vÆue
(
ªgs
);

144 *
brighäess
 = (*)
ri
->
d©a
;

146 i‡(!
ªt
 && 
m¨u_›s
.
nŸifõr
)

147 
m¨u_›s
.
	`nŸifõr
(&m¨u_›s, 
LAT_BRIGHTNESS
,

148 (*)*
brighäess
);

151 
	}
}

	@energy/lcd/s6e8aa0.c

1 
	~<k¥obe/dbi_k¥obes.h
>

2 
	~"lcd_ba£.h
"

5 c⁄° 
	g∑th_backlight
[] = "/sys/class/backlight/s6e8aa0-bl/brightness";

6 c⁄° 
	g∑th_backlight_mö
[] = "/sys/class/backlight/s6e8aa0-bl/min_brightness";

7 c⁄° 
	g∑th_backlight_max
[] = "/sys/class/backlight/s6e8aa0-bl/max_brightness";

8 c⁄° 
	g∑th_powî
[] = "/sys/class/lcd/s6e8aa0/lcd_power";

10 c⁄° *
	gÆl_∑th
[] = {

11 
∑th_backlight
,

12 
∑th_backlight_mö
,

13 
∑th_backlight_max
,

14 
∑th_powî


18 
	mÆl_∑th_˙t
 = (
Æl_∑th
) / (*)

23 
	$s6e8Ø0_check
(
lcd_›s
 *
›s
)

25 
i
;

27 
i
 = 0; i < 
Æl_∑th_˙t
; ++i) {

28 
ªt
 = 
	`ªad_vÆ
(
Æl_∑th
[
i
]);

30 i‡(
	`IS_ERR_VALUE
(
ªt
))

35 
	}
}

37 
	$s6e8Ø0_gë_∑ømëî
(
lcd_›s
 *
›s
,

38 
lcd_∑ømëî_ty≥
 
ty≥
)

40 
ty≥
) {

41 
LPD_MIN_BRIGHTNESS
:

42  
	`ªad_vÆ
(
∑th_backlight_mö
);

43 
LPD_MAX_BRIGHTNESS
:

44  
	`ªad_vÆ
(
∑th_backlight_max
);

45 
LPD_BRIGHTNESS
:

46  
	`ªad_vÆ
(
∑th_backlight
);

47 
LPD_POWER
:

48  
	`ªad_vÆ
(
∑th_powî
);

50  -
EINVAL
;

52 
	}
}

56 
íåy_h™dÀr_£t_powî
(
kªçrobe_ö°™˚
 *
ri
,

57 
±_ªgs
 *
ªgs
);

58 
ªt_h™dÀr_£t_powî
(
kªçrobe_ö°™˚
 *
ri
,

59 
±_ªgs
 *
ªgs
);

61 
kªçrobe
 
	g£t_powî_kΩ
 = {

62 .
kp
.
symbﬁ_«me
 = "s6e8aa0_set_power",

63 .
	gíåy_h™dÀr
 = 
íåy_h™dÀr_£t_powî
,

64 .
	gh™dÀr
 = 
ªt_h™dÀr_£t_powî
,

65 .
	gd©a_size
 = ()

69 
íåy_h™dÀr_£t_backlight
(
kªçrobe_ö°™˚
 *
ri
,

70 
±_ªgs
 *
ªgs
);

71 
ªt_h™dÀr_£t_backlight
(
kªçrobe_ö°™˚
 *
ri
,

72 
±_ªgs
 *
ªgs
);

74 
kªçrobe
 
	g£t_backlight_kΩ
 = {

75 .
kp
.
symbﬁ_«me
 = "s6e8aa0_gamma_ctrl",

76 .
	gíåy_h™dÀr
 = 
íåy_h™dÀr_£t_backlight
,

77 .
	gh™dÀr
 = 
ªt_h™dÀr_£t_backlight
,

78 .
	gd©a_size
 = ()

81 
	$s6e8Ø0_£t
(
lcd_›s
 *
›s
)

83 
ªt
;

85 
ªt
 = 
	`dbi_ªgi°î_kªçrobe
(&
£t_powî_kΩ
);

86 i‡(
ªt
)

87  
ªt
;

89 
ªt
 = 
	`dbi_ªgi°î_kªçrobe
(&
£t_backlight_kΩ
);

90 i‡(
ªt
)

91 
	`dbi_uƒegi°î_kªçrobe
(&
£t_powî_kΩ
);

93  
ªt
;

94 
	}
}

96 
	$s6e8Ø0_un£t
(
lcd_›s
 *
›s
)

98 
	`dbi_uƒegi°î_kªçrobe
(&
£t_backlight_kΩ
);

99 
	`dbi_uƒegi°î_kªçrobe
(&
£t_powî_kΩ
);

102 
	}
}

104 
lcd_›s
 
	gs6e8Ø0_›s
 = {

105 .
«me
 = "s6e8aa0",

106 .
	gcheck
 = 
s6e8Ø0_check
,

107 .
	g£t
 = 
s6e8Ø0_£t
,

108 .
	gun£t
 = 
s6e8Ø0_un£t
,

109 .
	ggë
 = 
s6e8Ø0_gë_∑ømëî


112 
lcd_›s
 *
	$LCD_MAKE_FNAME
(
s6e8Ø0
)()

114  &
s6e8Ø0_›s
;

115 
	}
}

125 
	$íåy_h™dÀr_£t_powî
(
kªçrobe_ö°™˚
 *
ri
,

126 
±_ªgs
 *
ªgs
)

128 *
powî
 = (*)
ri
->
d©a
;

130 *
powî
 = ()
	`sw≠_gë_k¨g
(
ªgs
, 1);

133 
	}
}

135 
	$ªt_h™dÀr_£t_powî
(
kªçrobe_ö°™˚
 *
ri
,

136 
±_ªgs
 *
ªgs
)

138 
ªt
 = 
	`ªgs_ªtu∫_vÆue
(
ªgs
);

139 *
powî
 = (*)
ri
->
d©a
;

141 i‡(!
ªt
 && 
s6e8Ø0_›s
.
nŸifõr
)

142 
s6e8Ø0_›s
.
	`nŸifõr
(&s6e8Ø0_›s, 
LAT_POWER
, (*)*
powî
);

145 
	}
}

155 
	$íåy_h™dÀr_£t_backlight
(
kªçrobe_ö°™˚
 *
ri
,

156 
±_ªgs
 *
ªgs
)

158 *
brighäess
 = (*)
ri
->
d©a
;

159 *
brighäess
 = ()
	`sw≠_gë_k¨g
(
ªgs
, 1);

162 
	}
}

164 
	$ªt_h™dÀr_£t_backlight
(
kªçrobe_ö°™˚
 *
ri
,

165 
±_ªgs
 *
ªgs
)

167 
ªt
 = 
	`ªgs_ªtu∫_vÆue
(
ªgs
);

168 *
brighäess
 = (*)
ri
->
d©a
;

170 i‡(!
ªt
 && 
s6e8Ø0_›s
.
nŸifõr
)

171 
s6e8Ø0_›s
.
	`nŸifõr
(&s6e8Ø0_›s, 
LAT_BRIGHTNESS
,

172 (*)*
brighäess
);

175 
	}
}

	@energy/lcd/s6e8aa0_panel.c

1 
	~<k¥obe/dbi_k¥obes.h
>

2 
	~<löux/backlight.h
>

3 
	~"lcd_ba£.h
"

6 c⁄° 
	g∑th_backlight
[] = "/sys/class/backlight/s6e8aa0-bl/brightness";

7 c⁄° 
	g∑th_backlight_max
[] = "/sys/class/backlight/s6e8aa0-bl/max_brightness";

8 c⁄° 
	g∑th_powî
[] = "/sys/class/lcd/s6e8aa0/lcd_power";

10 c⁄° *
	gÆl_∑th
[] = {

11 
∑th_backlight
,

12 
∑th_backlight_max
,

13 
∑th_powî


17 
	mÆl_∑th_˙t
 = (
Æl_∑th
) / (*)

22 
	$s6e8Ø0_check
(
lcd_›s
 *
›s
)

24 
i
;

26 
i
 = 0; i < 
Æl_∑th_˙t
; ++i) {

27 
ªt
 = 
	`ªad_vÆ
(
Æl_∑th
[
i
]);

29 i‡(
	`IS_ERR_VALUE
(
ªt
))

34 
	}
}

36 
	$s6e8Ø0_gë_∑ømëî
(
lcd_›s
 *
›s
,

37 
lcd_∑ømëî_ty≥
 
ty≥
)

39 
ty≥
) {

40 
LPD_MIN_BRIGHTNESS
:

42 
LPD_MAX_BRIGHTNESS
:

43  
	`ªad_vÆ
(
∑th_backlight_max
);

44 
LPD_BRIGHTNESS
:

45  
	`ªad_vÆ
(
∑th_backlight
);

46 
LPD_POWER
:

47  
	`ªad_vÆ
(
∑th_powî
);

50  -
EINVAL
;

51 
	}
}

55 
íåy_h™dÀr_£t_powî
(
kªçrobe_ö°™˚
 *
ri
,

56 
±_ªgs
 *
ªgs
);

57 
ªt_h™dÀr_£t_powî
(
kªçrobe_ö°™˚
 *
ri
,

58 
±_ªgs
 *
ªgs
);

60 
kªçrobe
 
	g£t_powî_kΩ
 = {

61 .
kp
.
symbﬁ_«me
 = "s6e8aa0_set_power",

62 .
	gíåy_h™dÀr
 = 
íåy_h™dÀr_£t_powî
,

63 .
	gh™dÀr
 = 
ªt_h™dÀr_£t_powî
,

64 .
	gd©a_size
 = ()

68 
íåy_h™dÀr_£t_backlight
(
kªçrobe_ö°™˚
 *
ri
,

69 
±_ªgs
 *
ªgs
);

70 
ªt_h™dÀr_£t_backlight
(
kªçrobe_ö°™˚
 *
ri
,

71 
±_ªgs
 *
ªgs
);

73 
kªçrobe
 
	g£t_backlight_kΩ
 = {

74 .
kp
.
symbﬁ_«me
 = "s6e8aa0_update_status",

75 .
	gíåy_h™dÀr
 = 
íåy_h™dÀr_£t_backlight
,

76 .
	gh™dÀr
 = 
ªt_h™dÀr_£t_backlight
,

77 .
	gd©a_size
 = ()

80 
	$s6e8Ø0_£t
(
lcd_›s
 *
›s
)

82 
ªt
;

84 
ªt
 = 
	`dbi_ªgi°î_kªçrobe
(&
£t_powî_kΩ
);

85 i‡(
ªt
)

86  
ªt
;

88 
ªt
 = 
	`dbi_ªgi°î_kªçrobe
(&
£t_backlight_kΩ
);

89 i‡(
ªt
)

90 
	`dbi_uƒegi°î_kªçrobe
(&
£t_powî_kΩ
);

92  
ªt
;

93 
	}
}

95 
	$s6e8Ø0_un£t
(
lcd_›s
 *
›s
)

97 
	`dbi_uƒegi°î_kªçrobe
(&
£t_backlight_kΩ
);

98 
	`dbi_uƒegi°î_kªçrobe
(&
£t_powî_kΩ
);

101 
	}
}

103 
lcd_›s
 
	gs6e8Ø0_›s
 = {

104 .
«me
 = "s6e8aa0_panel",

105 .
	gcheck
 = 
s6e8Ø0_check
,

106 .
	g£t
 = 
s6e8Ø0_£t
,

107 .
	gun£t
 = 
s6e8Ø0_un£t
,

108 .
	ggë
 = 
s6e8Ø0_gë_∑ømëî


111 
lcd_›s
 *
	$LCD_MAKE_FNAME
(
s6e8Ø0_∑√l
)()

113  &
s6e8Ø0_›s
;

114 
	}
}

124 
	$íåy_h™dÀr_£t_powî
(
kªçrobe_ö°™˚
 *
ri
,

125 
±_ªgs
 *
ªgs
)

127 *
powî
 = (*)
ri
->
d©a
;

129 *
powî
 = ()
	`sw≠_gë_k¨g
(
ªgs
, 1);

132 
	}
}

134 
	$ªt_h™dÀr_£t_powî
(
kªçrobe_ö°™˚
 *
ri
,

135 
±_ªgs
 *
ªgs
)

137 
ªt
 = 
	`ªgs_ªtu∫_vÆue
(
ªgs
);

138 *
powî
 = (*)
ri
->
d©a
;

140 i‡(!
ªt
 && 
s6e8Ø0_›s
.
nŸifõr
)

141 
s6e8Ø0_›s
.
	`nŸifõr
(&s6e8Ø0_›s, 
LAT_POWER
,

142 (*)*
powî
);

145 
	}
}

155 
	$íåy_h™dÀr_£t_backlight
(
kªçrobe_ö°™˚
 *
ri
,

156 
±_ªgs
 *
ªgs
)

158 *
brighäess
 = (*)
ri
->
d©a
;

159 
backlight_devi˚
 *
bd
;

161 
bd
 = (
backlight_devi˚
 *)
	`sw≠_gë_k¨g
(
ªgs
, 0);

162 *
brighäess
 = 
bd
->
¥›s
.brightness;

165 
	}
}

167 
	$ªt_h™dÀr_£t_backlight
(
kªçrobe_ö°™˚
 *
ri
,

168 
±_ªgs
 *
ªgs
)

170 
ªt
 = 
	`ªgs_ªtu∫_vÆue
(
ªgs
);

171 *
brighäess
 = (*)
ri
->
d©a
;

173 i‡(!
ªt
 && 
s6e8Ø0_›s
.
nŸifõr
)

174 
s6e8Ø0_›s
.
	`nŸifõr
(&s6e8Ø0_›s, 
LAT_BRIGHTNESS
,

175 (*)*
brighäess
);

178 
	}
}

	@energy/rational_debugfs.c

26 
	~<löux/dˇche.h
>

27 
	~<löux/debugfs.h
>

28 
	~<löux/exp‹t.h
>

29 
	~"øti⁄Æ_debugfs.h
"

32 
	$díom_£t
(*
d©a
, 
u64
 
vÆ
)

34 i‡(
vÆ
 == 0)

35  -
EINVAL
;

37 *(
u64
 *)
d©a
 = 
vÆ
;

39 
	}
}

41 
	$díom_gë
(*
d©a
, 
u64
 *
vÆ
)

43 *
vÆ
 = *(
u64
 *)
d©a
;

45 
	}
}

47 
DEFINE_SIMPLE_ATTRIBUTE
(
f›s_díom
, 
díom_gë
, 
díom_£t
, "%llu\n");

49 
	$¸óã_øti⁄Æ_fûes
(
díåy
 *
∑ª¡
, 
øti⁄Æ
 *
r
,

50 c⁄° *
num_«me
, c⁄° *
díom_«me
)

52 
díåy
 *
d_num
, *
d_díom
;

54 
d_num
 = 
	`debugfs_¸óã_u64
(
num_«me
, 0600, 
∑ª¡
, &
r
->
num
);

55 i‡(
d_num
 =
NULL
)

56  -
ENOMEM
;

58 
d_díom
 = 
	`debugfs_¸óã_fûe
(
díom_«me
, 0600, 
∑ª¡
, &
r
->
díom
,

59 &
f›s_díom
);

60 i‡(
d_díom
 =
NULL
) {

61 
	`debugfs_ªmove
(
d_num
);

62  -
ENOMEM
;

66 
	}
}

	@energy/rational_debugfs.h

1 #i‚de‡
_RATIONAL_DEBUGFS_H


2 
	#_RATIONAL_DEBUGFS_H


	)

29 
	~<löux/ty≥s.h
>

32 
	søti⁄Æ
 {

33 
u64
 
	mnum
;

34 
u64
 
	mdíom
;

38 
	#DEFINE_RATIONAL
(
øti⁄Æ_«me
) \

39 
øti⁄Æ
 
øti⁄Æ_«me
 = { \

40 .
num
 = 1, \

41 .
díom
 = 1 \

42 }

	)

45 
	gdíåy
;

48 
¸óã_øti⁄Æ_fûes
(
díåy
 *
∑ª¡
, 
øti⁄Æ
 *
r
,

49 c⁄° *
num_«me
, c⁄° *
díom_«me
);

	@energy/swap_energy.mod.c

1 
	~<löux/moduÀ.h
>

2 
	~<löux/vîmagic.h
>

3 
	~<löux/compûî.h
>

5 
MODULE_INFO
(
vîmagic
, 
VERMAGIC_STRING
);

7 
moduÀ
 
__this_moduÀ


8 
__©åibuã__
((
£˘i⁄
(".gnu.linkonce.this_module"))) = {

9 .
«me
 = 
KBUILD_MODNAME
,

10 .
	göô
 = 
öô_moduÀ
,

11 #ifde‡
CONFIG_MODULE_UNLOAD


12 .
	gexô
 = 
˛ónup_moduÀ
,

14 .
	g¨ch
 = 
MODULE_ARCH_INIT
,

17 c⁄° 
	g__moduÀ_dïíds
[]

18 
__u£d


19 
__©åibuã__
((
£˘i⁄
(".modinfo"))) =

23 
MODULE_INFO
(
§cvîsi⁄
, "8688F54BD35885BF3962B2C");

	@energy/tm_stat.h

1 #i‚de‡
_TM_STAT_H


2 
	#_TM_STAT_H


	)

29 
	~<löux/ty≥s.h
>

30 
	~<löux/time.h
>

33 
	stm_°©
 {

34 
u64
 
	mtime°amp
;

35 
u64
 
	mru¬ög
;

39 
	#DEFINE_TM_STAT
(
tm_«me
) \

40 
tm_°©
 
tm_«me
 = { \

41 .
time°amp
 = 0, \

42 .
ru¬ög
 = 0 \

43 }

	)

46 
ölöe
 
u64
 
	$gë_¡ime
()

48 
time•ec
 
ts
;

49 
	`gën°imeofday
(&
ts
);

50  
	`time•ec_to_ns
(&
ts
);

51 
	}
}

53 
ölöe
 
	$tm_°©_öô
(
tm_°©
 *
tm
)

55 
tm
->
time°amp
 = 0;

56 
tm
->
ru¬ög
 = 0;

57 
	}
}

59 
ölöe
 
	$tm_°©_£t_time°amp
(
tm_°©
 *
tm
, 
u64
 
time
)

61 
tm
->
time°amp
 = 
time
;

62 
	}
}

64 
ölöe
 
u64
 
	$tm_°©_time°amp
(
tm_°©
 *
tm
)

66  
tm
->
time°amp
;

67 
	}
}

69 
ölöe
 
	$tm_°©_upd©e
(
tm_°©
 *
tm
, 
u64
 
time
)

71 
tm
->
ru¬ög
 +
time
 -Åm->
time°amp
;

72 
	}
}

74 
ölöe
 
u64
 
	$tm_°©_ru¬ög
(
tm_°©
 *
tm
)

76  
tm
->
ru¬ög
;

77 
	}
}

79 
ölöe
 
u64
 
	$tm_°©_cuºít_ru¬ög
(
tm_°©
 *
tm
, 
u64
 
now
)

81 i‡(
	`u∆ikñy
(
now
 < 
tm
->
time°amp
))

82 
	`¥ötk
("XXX %p WARNINGÇow(%llu) <Åmstmp(%llu)\n",

83 
tm
, 
now
,Åm->
time°amp
);

84  
tm
->
time°amp
 ?Åm->
ru¬ög
 + 
now
 -Åm->timestamp:Åm->running;

85 
	}
}

	@kprobe/arch/asm-arm/dbi_kprobes.c

32 
	~<löux/moduÀ.h
>

33 
	~<löux/mm.h
>

35 
	~"dbi_k¥obes.h
"

36 
	~"åampﬁöe_¨m.h
"

37 
	~<k¥obe/dbi_k¥obes.h
>

39 
	~<k¥obe/dbi_kdebug.h
>

40 
	~<k¥obe/dbi_ö¢_¶Ÿs.h
>

41 
	~<k¥obe/dbi_k¥obes_dïs.h
>

42 
	~<ksyms/ksyms.h
>

44 
	~<asm/ˇcheÊush.h
>

45 
	~<asm/å≠s.h
>

46 
	~<asm/±ø˚.h
>

47 
	~<löux/li°.h
>

48 
	~<löux/hash.h
>

50 
	#SUPRESS_BUG_MESSAGES


	)

52 
	#sign_exãnd
(
x
, 
signbô
Ë((xË| (0 - ((xË& (1 << (signbô)))))

	)

53 
	#bønch_di•œ˚mít
(
ö¢
Ë
	`sign_exãnd
(((ö¢Ë& 0xffffffË<< 2, 25)

	)

55 
k¥obe
 * 
≥r_˝u__cuºít_k¥obe
;

56 
hli°_hód
 
k¥obe_èbÀ
[
KPROBE_TABLE_SIZE
];

58 (*
__sw≠_ªgi°î_undef_hook
)(
undef_hook
 *
hook
);

59 (*
__sw≠_uƒegi°î_undef_hook
)(
undef_hook
 *
hook
);

61 
	$gë_addr_b
(
ö¢
, 
addr
)

64  (
k¥obe_›code_t
)(()
addr
 + 8 + 
	`bønch_di•œ˚mít
(
ö¢
));

65 
	}
}

67 
	$¥ï_pc_dï_ö¢_execbuf
(
k¥obe_›code_t
 *
ö¢s
,

68 
k¥obe_›code_t
 
ö¢
, 
uªgs
)

70 
i
;

72 i‡(
uªgs
 & 0x10) {

73 
ªg_mask
 = 0x1;

75 
i
 = 0; i < 13; i++, 
ªg_mask
 <<= 1) {

76 i‡(!(
ö¢
 & 
ªg_mask
))

80 
i
 = 0; i < 13; i++) {

81 i‡((
uªgs
 & 0x1Ë&& (
	`ARM_INSN_REG_RN
(
ö¢
Ë=
i
))

83 i‡((
uªgs
 & 0x2Ë&& (
	`ARM_INSN_REG_RD
(
ö¢
Ë=
i
))

85 i‡((
uªgs
 & 0x4Ë&& (
	`ARM_INSN_REG_RS
(
ö¢
Ë=
i
))

87 i‡((
uªgs
 & 0x8Ë&& (
	`ARM_INSN_REG_RM
(
ö¢
Ë=
i
))

93 i‡(
i
 == 13) {

94 
	`DBPRINTF
 ("thîê¨ênÿ‰ìÑegi°î %x i¿ö¢ %lx!", 
uªgs
, 
ö¢
);

95  -
EINVAL
;

97 
	`DBPRINTF
 ("¥ï_pc_dï_ö¢_execbuf: usög R%d, ch™gögÑeg†%x", 
i
, 
uªgs
);

100 
	`ARM_INSN_REG_SET_RD
(
ö¢s
[0], 
i
);

102 
	`ARM_INSN_REG_SET_RD
(
ö¢s
[1], 
i
);

104 i‡(
uªgs
 & 0x10) {

105 
	`ARM_INSN_REG_CLEAR_MR
(
ö¢
, 15);

106 
	`ARM_INSN_REG_SET_MR
(
ö¢
, 
i
);

108 i‡((
uªgs
 & 0x1Ë&& (
	`ARM_INSN_REG_RN
(
ö¢
) == 15))

109 
	`ARM_INSN_REG_SET_RN
(
ö¢
, 
i
);

110 i‡((
uªgs
 & 0x2Ë&& (
	`ARM_INSN_REG_RD
(
ö¢
) == 15))

111 
	`ARM_INSN_REG_SET_RD
(
ö¢
, 
i
);

112 i‡((
uªgs
 & 0x4Ë&& (
	`ARM_INSN_REG_RS
(
ö¢
) == 15))

113 
	`ARM_INSN_REG_SET_RS
(
ö¢
, 
i
);

114 i‡((
uªgs
 & 0x8Ë&& (
	`ARM_INSN_REG_RM
(
ö¢
) == 15))

115 
	`ARM_INSN_REG_SET_RM
(
ö¢
, 
i
);

118 
ö¢s
[
UPROBES_TRAMP_INSN_IDX
] = 
ö¢
;

120 
	`ARM_INSN_REG_SET_RD
(
ö¢s
[3], 
i
);

123 
	}
}

125 
	$¨ch_check_ö¢_¨m
(
ö¢
)

130 
	`ARM_INSN_MATCH
(
AUNDEF
, 
ö¢
) ||

131 
	`ARM_INSN_MATCH
(
SWI
, 
ö¢
) ||

132 
	`ARM_INSN_MATCH
(
BREAK
, 
ö¢
) ||

133 
	`ARM_INSN_MATCH
(
BXJ
, 
ö¢
)) {

134 
bad_ö¢
;

135 #i‚de‡
CONFIG_CPU_V7


137 } i‡((
	`ARM_INSN_MATCH
(
DPIS
, 
ö¢
) ||

138 
	`ARM_INSN_MATCH
(
DPRS
, 
ö¢
) ||

139 
	`ARM_INSN_MATCH
(
DPI
, 
ö¢
) ||

140 
	`ARM_INSN_MATCH
(
LIO
, 
ö¢
) ||

141 
	`ARM_INSN_MATCH
(
LRO
, 
ö¢
)) &&

142 (
	`ARM_INSN_REG_RD
(
ö¢
) == 15)) {

143 
bad_ö¢
;

146 } i‡((
	`ARM_INSN_MATCH
(
LM
, 
ö¢
Ë|| ARM_INSN_MATCH(
SM
, insn)) &&

148 (
	`ARM_INSN_REG_MR
(
ö¢
, 15) ||

150 ((
	`ARM_INSN_REG_RN
(
ö¢
) == 15) && (insn & 0x200000)))) {

151 
bad_ö¢
;

156 
bad_ö¢
:

157 
	`¥ötk
("Bad in¢árch_check_ö¢_¨m: %lx\n", 
ö¢
);

158  -
EFAULT
;

159 
	}
}

161 
	$make_bønch_èrmpﬁöe
(
addr
, 
ö¢
,

162 *
åamp
)

164 
ok
 = 0;

167 i‡(
	`ARM_INSN_MATCH
(
B
, 
ö¢
) &&

168 !
	`ARM_INSN_MATCH
(
BLX1
, 
ö¢
)) {

170 
	`mem˝y
(
åamp
, 
b_c⁄d_ö¢_execbuf
, 
KPROBES_TRAMP_LEN
);

171 
åamp
[
KPROBES_TRAMP_RET_BREAK_IDX
] = 
BREAKPOINT_INSTRUCTION
;

172 
åamp
[0] |
ö¢
 & 0xf0000000;

173 
åamp
[6] = 
	`gë_addr_b
(
ö¢
, 
addr
);

174 
åamp
[7] = 
addr
 + 4;

175 
ok
 = 1;

177 } i‡(
	`ARM_INSN_MATCH
(
BX
, 
ö¢
) ||

178 
	`ARM_INSN_MATCH
(
BLX2
, 
ö¢
)) {

179 
	`mem˝y
(
åamp
, 
b_r_ö¢_execbuf
, 
KPROBES_TRAMP_LEN
);

180 
åamp
[0] = 
ö¢
;

181 
åamp
[
KPROBES_TRAMP_RET_BREAK_IDX
] = 
BREAKPOINT_INSTRUCTION
;

182 
åamp
[7] = 
addr
 + 4;

183 
ok
 = 1;

185 } i‡(
	`ARM_INSN_MATCH
(
BLX1
, 
ö¢
)) {

186 
	`mem˝y
(
åamp
, 
blx_off_ö¢_execbuf
, 
KPROBES_TRAMP_LEN
);

187 
åamp
[0] |= 0xe0000000;

188 
åamp
[1] |= 0xe0000000;

189 
åamp
[
KPROBES_TRAMP_RET_BREAK_IDX
] = 
BREAKPOINT_INSTRUCTION
;

190 
åamp
[6] = 
	`gë_addr_b
(
ö¢
, 
addr
) +

191 2 * (
ö¢
 & 01000000) + 1;

192 
åamp
[7] = 
addr
 + 4;

193 
ok
 = 1;

195 } i‡(
	`ARM_INSN_MATCH
(
BL
, 
ö¢
)) {

196 
	`mem˝y
(
åamp
, 
blx_off_ö¢_execbuf
, 
KPROBES_TRAMP_LEN
);

197 
åamp
[0] |
ö¢
 & 0xf0000000;

198 
åamp
[1] |
ö¢
 & 0xf0000000;

199 
åamp
[
KPROBES_TRAMP_RET_BREAK_IDX
] = 
BREAKPOINT_INSTRUCTION
;

200 
åamp
[6] = 
	`gë_addr_b
(
ö¢
, 
addr
);

201 
åamp
[7] = 
addr
 + 4;

202 
ok
 = 1;

205  
ok
;

206 
	}
}

208 
	$¨ch_make_åampﬁöe_¨m
(
addr
, 
ö¢
,

209 *
åamp
)

211 
ªt
, 
uªgs
, 
pc_dï
;

213 i‡(
addr
 & 0x03) {

214 
	`¥ötk
("Error in %sát %d:áttemptÅoÑegister uprobe "

215 "©á¿u«lig√dáddªss\n", 
__FILE__
, 
__LINE__
);

216  -
EINVAL
;

219 
ªt
 = 
	`¨ch_check_ö¢_¨m
(
ö¢
);

220 i‡(
ªt
)

221  
ªt
;

223 i‡(
	`make_bønch_èrmpﬁöe
(
addr
, 
ö¢
, 
åamp
))

226 
uªgs
 = 
pc_dï
 = 0;

228 i‡(
	`ARM_INSN_MATCH
(
DPIS
, 
ö¢
Ë|| ARM_INSN_MATCH(
LRO
, insn) ||

229 
	`ARM_INSN_MATCH
(
SRO
, 
ö¢
)) {

230 
uªgs
 = 0xb;

231 i‡((
	`ARM_INSN_REG_RN
(
ö¢
) == 15) ||

232 (
	`ARM_INSN_REG_RM
(
ö¢
) == 15) ||

233 (
	`ARM_INSN_MATCH
(
SRO
, 
ö¢
) &&

234 (
	`ARM_INSN_REG_RD
(
ö¢
) == 15))) {

235 
pc_dï
 = 1;

238 } i‡(
	`ARM_INSN_MATCH
(
DPI
, 
ö¢
Ë|| ARM_INSN_MATCH(
LIO
, insn) ||

239 
	`ARM_INSN_MATCH
(
SIO
, 
ö¢
)) {

240 
uªgs
 = 0x3;

241 i‡((
	`ARM_INSN_REG_RN
(
ö¢
) == 15) ||

242 (
	`ARM_INSN_MATCH
(
SIO
, 
ö¢
) &&

243 (
	`ARM_INSN_REG_RD
(
ö¢
) == 15))) {

244 
pc_dï
 = 1;

247 } i‡(
	`ARM_INSN_MATCH
(
DPRS
, 
ö¢
)) {

248 
uªgs
 = 0xd;

249 i‡((
	`ARM_INSN_REG_RN
(
ö¢
) == 15) ||

250 (
	`ARM_INSN_REG_RM
(
ö¢
) == 15) ||

251 (
	`ARM_INSN_REG_RS
(
ö¢
) == 15)) {

252 
pc_dï
 = 1;

255 } i‡(
	`ARM_INSN_MATCH
(
SM
, 
ö¢
)) {

256 
uªgs
 = 0x10;

257 i‡(
	`ARM_INSN_REG_MR
(
ö¢
, 15)) {

258 
pc_dï
 = 1;

263 i‡(
pc_dï
 && (
	`ARM_INSN_REG_RD
(
ö¢
) == 13)) {

264 
	`¥ötk
("Error in %sát %d: instruction check failed (arm)\n",

265 
__FILE__
, 
__LINE__
);

266  -
EFAULT
;

269 i‡(
	`u∆ikñy
(
uªgs
 && 
pc_dï
)) {

270 
	`mem˝y
(
åamp
, 
pc_dï_ö¢_execbuf
, 
KPROBES_TRAMP_LEN
);

271 i‡(
	`¥ï_pc_dï_ö¢_execbuf
(
åamp
, 
ö¢
, 
uªgs
) != 0) {

272 
	`¥ötk
("Error in %sát %d: failed "

274 
__FILE__
, 
__LINE__
, 
ö¢
);

275  -
EINVAL
;

278 
åamp
[6] = 
addr
 + 8;

280 
	`mem˝y
(
åamp
, 
gí_ö¢_execbuf
, 
KPROBES_TRAMP_LEN
);

281 
åamp
[
KPROBES_TRAMP_INSN_IDX
] = 
ö¢
;

285 
åamp
[
KPROBES_TRAMP_RET_BREAK_IDX
] = 
BREAKPOINT_INSTRUCTION
;

286 
åamp
[7] = 
addr
 + 4;

289 
	}
}

290 
EXPORT_SYMBOL_GPL
(
¨ch_make_åampﬁöe_¨m
);

292 
	$¨ch_¥ï¨e_k¥obe
(
k¥obe
 *
p
, 
¶Ÿ_m™agî
 *
sm
)

294 
addr
 = ()
p
->addr;

295 
ö¢
 = 
p
->
›code
 = *p->
addr
;

296 *
åamp
;

297 
ªt
;

299 
åamp
 = 
	`Æloc_ö¢_¶Ÿ
(
sm
);

300 i‡(
åamp
 =
NULL
)

301  -
ENOMEM
;

303 
ªt
 = 
	`¨ch_make_åampﬁöe_¨m
(
addr
, 
ö¢
, 
åamp
);

304 i‡(
ªt
) {

305 
	`‰ì_ö¢_¶Ÿ
(
sm
, 
åamp
);

306  
ªt
;

309 
	`Êush_iˇche_ønge
(()
åamp
,

310 ()
åamp
 + 
KPROBES_TRAMP_LEN
);

312 
p
->
aö¢
.
ö¢
 = 
åamp
;

315 
	}
}

317 
	$¥ï¨e_sögÀ°ï
(
k¥obe
 *
p
, 
±_ªgs
 *
ªgs
)

319 i‡(
p
->
ss_addr
) {

320 
ªgs
->
ARM_pc
 = ()
p
->
ss_addr
;

321 
p
->
ss_addr
 = 
NULL
;

323 
ªgs
->
ARM_pc
 = ()
p
->
aö¢
.
ö¢
;

325 
	}
}

326 
EXPORT_SYMBOL_GPL
(
¥ï¨e_sögÀ°ï
);

328 
	$ßve_¥evious_k¥obe
(
k¥obe_˘lblk
 *
kcb
, 
k¥obe
 *
p_run
)

330 
kcb
->
¥ev_k¥obe
.
kp
 = 
	`k¥obe_ru¬ög
();

331 
kcb
->
¥ev_k¥obe
.
°©us
 = kcb->
k¥obe_°©us
;

332 
	}
}

334 
	$ª°‹e_¥evious_k¥obe
(
k¥obe_˘lblk
 *
kcb
)

336 
	`__gë_˝u_v¨
(
cuºít_k¥obe
Ë
kcb
->
¥ev_k¥obe
.
kp
;

337 
kcb
->
k¥obe_°©us
 = kcb->
¥ev_k¥obe
.
°©us
;

338 
	}
}

340 
	$£t_cuºít_k¥obe
(
k¥obe
 *
p
, 
±_ªgs
 *
ªgs
, 
k¥obe_˘lblk
 *
kcb
)

342 
	`__gë_˝u_v¨
(
cuºít_k¥obe
Ë
p
;

343 
	`DBPRINTF
 ("£t_cuºít_k¥obe:Ö=%∞addr=%p\n", 
p
,Ö->
addr
);

344 
	}
}

346 
	$k¥obe_h™dÀr
(
±_ªgs
 *
ªgs
)

348 
k¥obe
 *
p
, *
cur
;

349 
k¥obe_˘lblk
 *
kcb
;

351 
kcb
 = 
	`gë_k¥obe_˘lblk
();

352 
cur
 = 
	`k¥obe_ru¬ög
();

353 
p
 = 
	`gë_k¥obe
((*)
ªgs
->
ARM_pc
);

355 i‡(
p
) {

356 i‡(
cur
) {

358 
kcb
->
k¥obe_°©us
) {

359 
KPROBE_HIT_ACTIVE
:

360 
KPROBE_HIT_SSDONE
:

362 
	`k¥obes_öc_nmis£d_cou¡
(
p
);

363 
	`ßve_¥evious_k¥obe
(
kcb
, 
NULL
);

364 
	`£t_cuºít_k¥obe
(
p
, 0, 0);

365 
kcb
->
k¥obe_°©us
 = 
KPROBE_REENTER
;

366 
	`¥ï¨e_sögÀ°ï
(
p
, 
ªgs
);

367 
	`ª°‹e_¥evious_k¥obe
(
kcb
);

371 
	`BUG
();

374 
	`£t_cuºít_k¥obe
(
p
, 0, 0);

375 
kcb
->
k¥obe_°©us
 = 
KPROBE_HIT_ACTIVE
;

377 i‡(!
p
->
¥e_h™dÀr
 || !p->
	`¥e_h™dÀr
’, 
ªgs
)) {

378 
kcb
->
k¥obe_°©us
 = 
KPROBE_HIT_SS
;

379 
	`¥ï¨e_sögÀ°ï
(
p
, 
ªgs
);

380 
	`ª£t_cuºít_k¥obe
();

384 
no_k¥obe
;

389 
no_k¥obe
:

390 
	`¥ötk
("no_kprobe: Not one of ours:Üet kernel handle it %p\n",

391 (*)
ªgs
->
ARM_pc
);

393 
	}
}

395 
	$k¥obe_å≠_h™dÀr
(
±_ªgs
 *
ªgs
, 
ö°r
)

397 
ªt
;

398 
Êags
;

400 #ifde‡
SUPRESS_BUG_MESSAGES


401 
sw≠_o›s_ö_¥ogªss
;

404 
sw≠_o›s_ö_¥ogªss
 = 
o›s_ö_¥ogªss
;

405 
o›s_ö_¥ogªss
 = 1;

408 
	`loˇl_úq_ßve
(
Êags
);

409 
	`¥ìm±_dißbÀ
();

410 
ªt
 = 
	`k¥obe_h™dÀr
(
ªgs
);

411 
	`¥ìm±_íabÀ_no_ªsched
();

412 
	`loˇl_úq_ª°‹e
(
Êags
);

414 #ifde‡
SUPRESS_BUG_MESSAGES


415 
o›s_ö_¥ogªss
 = 
sw≠_o›s_ö_¥ogªss
;

418  
ªt
;

419 
	}
}

421 
	$£tjmp_¥e_h™dÀr
(
k¥obe
 *
p
, 
±_ªgs
 *
ªgs
)

423 
j¥obe
 *
jp
 = 
	`c⁄èöî_of
(
p
, j¥obe, 
kp
);

424 
k¥obe_¥e_íåy_h™dÀr_t
 
¥e_íåy
 = (k¥obe_¥e_íåy_h™dÀr_t)
jp
->pre_entry;

425 
íåy_poöt_t
 
íåy
 = (íåy_poöt_t)
jp
->entry;

426 
¥e_íåy
 = (
k¥obe_¥e_íåy_h™dÀr_t
)
jp
->pre_entry;

428 i‡(
¥e_íåy
) {

429 
p
->
ss_addr
 = (*)
	`¥e_íåy
 (
jp
->
¥iv_¨g
, 
ªgs
);

432 i‡(
íåy
) {

433 
	`íåy
(
ªgs
->
ARM_r0
,Ñegs->
ARM_r1
,Ñegs->
ARM_r2
,

434 
ªgs
->
ARM_r3
,Ñegs->
ARM_r4
,Ñegs->
ARM_r5
);

436 
	`dbi_j¥obe_ªtu∫
();

440 
	}
}

442 
	$dbi_j¥obe_ªtu∫
 ()

444 
	}
}

446 
	$l⁄gjmp_bªak_h™dÀr
 (
k¥obe
 *
p
, 
±_ªgs
 *
ªgs
)

449 
	}
}

450 
EXPORT_SYMBOL_GPL
(
l⁄gjmp_bªak_h™dÀr
);

452 #ifde‡
CONFIG_STRICT_MEMORY_RWX


453 
mem_ãxt_wrôe_kî√l_w‹d
(*
addr
, 
w‹d
);

456 
	$¨ch_¨m_k¥obe
(
k¥obe
 *
p
)

458 #ifde‡
CONFIG_STRICT_MEMORY_RWX


459 
	`mem_ãxt_wrôe_kî√l_w‹d
(
p
->
addr
, 
BREAKPOINT_INSTRUCTION
);

461 *
p
->
addr
 = 
BREAKPOINT_INSTRUCTION
;

462 
	`Êush_iˇche_ønge
(()
p
->
addr
, (Ì->add∏+ (
k¥obe_›code_t
));

464 
	}
}

466 
	$¨ch_dißrm_k¥obe
(
k¥obe
 *
p
)

468 #ifde‡
CONFIG_STRICT_MEMORY_RWX


469 
	`mem_ãxt_wrôe_kî√l_w‹d
(
p
->
addr
,Ö->
›code
);

471 *
p
->
addr
 =Ö->
›code
;

472 
	`Êush_iˇche_ønge
(()
p
->
addr
, (Ì->add∏+ (
k¥obe_›code_t
));

474 
	}
}

476 
__«ked
 
	$kªçrobe_åampﬁöe
()

478 
__asm__
 
	`__vﬁ©ûe__
 (

487 
	}
}

489 
	$¨ch_¥ï¨e_kªçrobe
(
kªçrobe_ö°™˚
 *
ri
, 
±_ªgs
 *
ªgs
)

491 *
±r_ªt_addr
;

494 i‡(()
ri
->
Ω
->
kp
.
addr
 =
sched_addr
) {

495 
thªad_öfo
 *
töfo
 = (thªad_öfÿ*)
ªgs
->
ARM_r2
;

497 
±r_ªt_addr
 = (*)&
töfo
->
˝u_c⁄ãxt
.
pc
;

498 
ri
->
•
 = 
NULL
;

499 
ri
->
èsk
 = 
töfo
->task;

501 
±r_ªt_addr
 = (*)&
ªgs
->
ARM_Ã
;

502 
ri
->
•
 = (*)
ªgs
->
ARM_•
;

506 
ri
->
ªt_addr
 = (*)*
±r_ªt_addr
;

509 *
±r_ªt_addr
 = ()&
kªçrobe_åampﬁöe
;

510 
	}
}

512 
	$sw≠_ªgi°î_undef_hook
(
undef_hook
 *
hook
)

514 
	`__sw≠_ªgi°î_undef_hook
(
hook
);

515 
	}
}

516 
EXPORT_SYMBOL_GPL
(
sw≠_ªgi°î_undef_hook
);

518 
	$sw≠_uƒegi°î_undef_hook
(
undef_hook
 *
hook
)

520 
	`__sw≠_uƒegi°î_undef_hook
(
hook
);

521 
	}
}

522 
EXPORT_SYMBOL_GPL
(
sw≠_uƒegi°î_undef_hook
);

525 
undef_hook
 
	gundef_ho_k
 = {

526 .
ö°r_mask
 = 0xffffffff,

527 .
	gö°r_vÆ
 = 
BREAKPOINT_INSTRUCTION
,

528 .
	g˝§_mask
 = 
MODE_MASK
,

529 .
	g˝§_vÆ
 = 
SVC_MODE
,

530 .
	g‚
 = 
k¥obe_å≠_h™dÀr


533 
	$¨ch_öô_k¥obes
()

536 
__sw≠_ªgi°î_undef_hook
 = (*)
	`sw≠_ksyms
("register_undef_hook");

537 i‡(
__sw≠_ªgi°î_undef_hook
 =
NULL
) {

538 
	`¥ötk
("noÑegister_undef_hook symbol found!\n");

543 
__sw≠_uƒegi°î_undef_hook
 = (*)
	`sw≠_ksyms
("unregister_undef_hook");

544 i‡(
__sw≠_uƒegi°î_undef_hook
 =
NULL
) {

545 
	`¥ötk
("no unregister_undef_hook symbol found!\n");

549 
	`sw≠_ªgi°î_undef_hook
(&
undef_ho_k
);

552 
	}
}

554 
	$¨ch_exô_k¥obes
()

556 
	`sw≠_uƒegi°î_undef_hook
(&
undef_ho_k
);

557 
	}
}

560 
EXPORT_SYMBOL_GPL
(
gí_ö¢_execbuf
);

561 
EXPORT_SYMBOL_GPL
(
pc_dï_ö¢_execbuf
);

562 
EXPORT_SYMBOL_GPL
(
b_r_ö¢_execbuf
);

563 
EXPORT_SYMBOL_GPL
(
b_c⁄d_ö¢_execbuf
);

564 
EXPORT_SYMBOL_GPL
(
blx_off_ö¢_execbuf
);

	@kprobe/arch/asm-arm/dbi_kprobes.h

1 #i‚de‡
_DBI_ASM_ARM_KPROBES_H


2 
	#_DBI_ASM_ARM_KPROBES_H


	)

32 
	~<löux/sched.h
>

33 
	~<löux/compûî.h
>

35 
	tk¥obe_›code_t
;

37 #ifde‡
CONFIG_CPU_S3C2443


38 
	#BREAKPOINT_INSTRUCTION
 0xe1200070

	)

40 
	#BREAKPOINT_INSTRUCTION
 0xffffdeff

	)

43 #i‚de‡
KPROBES_RET_PROBE_TRAMP


45 #ifde‡
CONFIG_CPU_S3C2443


46 
	#UNDEF_INSTRUCTION
 0xe1200071

	)

48 
	#UNDEF_INSTRUCTION
 0xffffff„

	)

53 
	#MAX_INSN_SIZE
 1

	)

55 
	#UPROBES_TRAMP_LEN
 9 * 4

	)

56 
	#UPROBES_TRAMP_INSN_IDX
 2

	)

57 
	#UPROBES_TRAMP_SS_BREAK_IDX
 4

	)

58 
	#UPROBES_TRAMP_RET_BREAK_IDX
 5

	)

59 
	#KPROBES_TRAMP_LEN
 9 * 4

	)

60 
	#KPROBES_TRAMP_INSN_IDX
 
UPROBES_TRAMP_INSN_IDX


	)

61 
	#KPROBES_TRAMP_SS_BREAK_IDX
 
UPROBES_TRAMP_SS_BREAK_IDX


	)

64 
	#KPROBES_TRAMP_RET_BREAK_IDX
 
UPROBES_TRAMP_RET_BREAK_IDX


	)

66 
	#UREGS_OFFSET
 8

	)

68 
	s¥ev_k¥obe
 {

69 
k¥obe
 *
	mkp
;

70 
	m°©us
;

73 
ölöe
 
	$¨ch_gë_èsk_pc
(
èsk_°ru˘
 *
p
)

75  
	`èsk_thªad_öfo
(
p
)->
˝u_c⁄ãxt
.
pc
;

76 
	}
}

78 
ölöe
 
	$¨ch_£t_èsk_pc
(
èsk_°ru˘
 *
p
, 
vÆ
)

80 
	`èsk_thªad_öfo
(
p
)->
˝u_c⁄ãxt
.
pc
 = 
vÆ
;

81 
	}
}

83 
ölöe
 
±_ªgs
 *
	$dbi_gë_sysˇŒ_uªgs
(
•
)

85  (
±_ªgs
 *)(
•
 + 
UREGS_OFFSET
);

86 
	}
}

88 
ölöe
 
	$dbi_gë_°ack_±r
(
±_ªgs
 *
ªgs
)

90  
ªgs
->
ARM_•
;

91 
	}
}

93 
ölöe
 
	$dbi_gë_ö°r_±r
(
±_ªgs
 *
ªgs
)

95  
ªgs
->
ARM_pc
;

96 
	}
}

98 
ölöe
 
	$dbi_£t_ö°r_±r
(
±_ªgs
 *
ªgs
, 
vÆ
)

100 
ªgs
->
ARM_pc
 = 
vÆ
;

101 
	}
}

103 
ölöe
 
	$dbi_gë_ªt_addr
(
±_ªgs
 *
ªgs
)

105  
ªgs
->
ARM_Ã
;

106 
	}
}

108 
ölöe
 
	$dbi_£t_ªt_addr
(
±_ªgs
 *
ªgs
, 
vÆ
)

110 
ªgs
->
ARM_Ã
 = 
vÆ
;

111 
	}
}

113 
ölöe
 
	$dbi_gë_¨g
(
±_ªgs
 *
ªgs
, 
num
)

115  
ªgs
->
uªgs
[
num
];

116 
	}
}

118 
ölöe
 
	$dbi_£t_¨g
(
±_ªgs
 *
ªgs
, 
num
, 
vÆ
)

120 
ªgs
->
uªgs
[
num
] = 
vÆ
;

121 
	}
}

124 
	#MASK_ARM_INSN_UNDEF
 0x0FF00000

125 
	#PTRN_ARM_INSN_UNDEF
 0x03000000

126 

	)

127 
	#MASK_THUMB_INSN_UNDEF
 0xFE00

128 
	#PTRN_THUMB_INSN_UNDEF
 0xDE00

129 

	)

131 
	#MASK_ARM_INSN_AUNDEF
 0x0FF000F0

	)

132 
	#PTRN_ARM_INSN_AUNDEF
 0x07F000F0

	)

135 
	#MASK_ARM_INSN_B
 0x0F000000

136 
	#PTRN_ARM_INSN_B
 0x0A000000

137 

	)

138 
	#MASK_THUMB_INSN_B1
 0xF000

139 
	#PTRN_THUMB_INSN_B1
 0xD000

140 

	)

141 
	#MASK_THUMB_INSN_B2
 0xF800

142 
	#PTRN_THUMB_INSN_B2
 0xE000

143 

	)

144 
	#MASK_THUMB_INSN_CBZ
 0xF500

145 
	#PTRN_THUMB_INSN_CBZ
 0xB100

146 

	)

147 
	#MASK_THUMB2_INSN_B1
 0xD000F800

148 
	#PTRN_THUMB2_INSN_B1
 0x8000F000

149 

	)

150 
	#MASK_THUMB2_INSN_B2
 0xD000F800

151 
	#PTRN_THUMB2_INSN_B2
 0x9000F000

152 

	)

153 
	#MASK_ARM_INSN_BL
 0x0F000000

154 
	#PTRN_ARM_INSN_BL
 0x0B000000

155 

	)

160 
	#MASK_THUMB2_INSN_BL
 0xD000F800

161 
	#PTRN_THUMB2_INSN_BL
 0xD000F000

162 

	)

163 
	#MASK_ARM_INSN_BLX1
 0xFE000000

164 
	#PTRN_ARM_INSN_BLX1
 0xFA000000

165 

	)

169 
	#MASK_THUMB2_INSN_BLX1
 0xD001F800

170 
	#PTRN_THUMB2_INSN_BLX1
 0xC000F000

171 

	)

172 
	#MASK_ARM_INSN_BLX2
 0x0FF000F0

173 
	#PTRN_ARM_INSN_BLX2
 0x01200030

174 

	)

175 
	#MASK_THUMB_INSN_BLX2
 0xFF80

176 
	#PTRN_THUMB_INSN_BLX2
 0x4780

177 

	)

178 
	#MASK_ARM_INSN_BX
 0x0FF000F0

179 
	#PTRN_ARM_INSN_BX
 0x01200010

180 

	)

181 
	#MASK_THUMB_INSN_BX
 0xFF80

182 
	#PTRN_THUMB_INSN_BX
 0x4700

183 

	)

184 
	#MASK_ARM_INSN_BXJ
 0x0FF000F0

185 
	#PTRN_ARM_INSN_BXJ
 0x01200020

186 

	)

187 
	#MASK_THUMB2_INSN_BXJ
 0xD000FFF0

188 
	#PTRN_THUMB2_INSN_BXJ
 0x8000F3C0

189 

	)

192 
	#MASK_ARM_INSN_SWI
 0x0F000000

193 
	#PTRN_ARM_INSN_SWI
 0x0F000000

194 

	)

195 
	#MASK_THUMB_INSN_SWI
 0xFF00

196 
	#PTRN_THUMB_INSN_SWI
 0xDF00

197 

	)

199 
	#MASK_ARM_INSN_BREAK
 0xFFF000F0

200 
	#PTRN_ARM_INSN_BREAK
 0xE1200070

201 

	)

202 
	#MASK_THUMB_INSN_BREAK
 0xFF00

203 
	#PTRN_THUMB_INSN_BREAK
 0xBE00

204 

	)

206 
	#MASK_ARM_INSN_DPIS
 0x0E000010

	)

207 
	#PTRN_ARM_INSN_DPIS
 0x00000000

	)

209 
	#MASK_ARM_INSN_DPRS
 0x0E000090

	)

210 
	#PTRN_ARM_INSN_DPRS
 0x00000010

	)

212 
	#MASK_THUMB2_INSN_DPRS
 0xFFE00000

213 
	#PTRN_THUMB2_INSN_DPRS
 0xEA000000

214 

	)

216 
	#MASK_ARM_INSN_DPI
 0x0E000000

	)

217 
	#PTRN_ARM_INSN_DPI
 0x02000000

	)

219 
	#MASK_THUMB_INSN_DP
 0xFC00

220 
	#PTRN_THUMB_INSN_DP
 0x4000

221 

	)

222 
	#MASK_THUMB_INSN_APC
 0xF800

223 
	#PTRN_THUMB_INSN_APC
 0xA000

224 

	)

225 
	#MASK_THUMB2_INSN_DPI
 0xFBE08000

227 
	#PTRN_THUMB2_INSN_DPI
 0xF2000000

228 

	)

229 
	#MASK_THUMB_INSN_MOV3
 0xFF00

230 
	#PTRN_THUMB_INSN_MOV3
 0x4600

231 

	)

232 
	#MASK_THUMB2_INSN_RSBW
 0x8000fbe0

233 
	#PTRN_THUMB2_INSN_RSBW
 0x0000f1c0

234 

	)

235 
	#MASK_THUMB2_INSN_RORW
 0xf0f0ffe0

236 
	#PTRN_THUMB2_INSN_RORW
 0xf000fa60

237 

	)

238 
	#MASK_THUMB2_INSN_ROR
 0x0030ffef

239 
	#PTRN_THUMB2_INSN_ROR
 0x0030ea4f

240 

	)

241 
	#MASK_THUMB2_INSN_LSLW1
 0xf0f0ffe0

242 
	#PTRN_THUMB2_INSN_LSLW1
 0xf000fa00

243 

	)

244 
	#MASK_THUMB2_INSN_LSLW2
 0x0030ffef

245 
	#PTRN_THUMB2_INSN_LSLW2
 0x0000ea4f

246 

	)

247 
	#MASK_THUMB2_INSN_LSRW1
 0xf0f0ffe0

248 
	#PTRN_THUMB2_INSN_LSRW1
 0xf000fa20

249 

	)

250 
	#MASK_THUMB2_INSN_LSRW2
 0x0030ffef

251 
	#PTRN_THUMB2_INSN_LSRW2
 0x0010ea4f

252 

	)

253 
	#MASK_THUMB2_INSN_TEQ1
 0x8f00fbf0

254 
	#PTRN_THUMB2_INSN_TEQ1
 0x0f00f090

255 

	)

256 
	#MASK_THUMB2_INSN_TEQ2
 0x0f00fff0

257 
	#PTRN_THUMB2_INSN_TEQ2
 0x0f00ea90

258 

	)

259 
	#MASK_THUMB2_INSN_TST1
 0x8f00fbf0

260 
	#PTRN_THUMB2_INSN_TST1
 0x0f00f010

261 

	)

262 
	#MASK_THUMB2_INSN_TST2
 0x0f00fff0

263 
	#PTRN_THUMB2_INSN_TST2
 0x0f00ea10

264 

	)

267 
	#MASK_ARM_INSN_LIO
 0x0E100000

	)

268 
	#PTRN_ARM_INSN_LIO
 0x04100000

	)

270 
	#MASK_THUMB_INSN_LIO1
 0xF800

271 
	#PTRN_THUMB_INSN_LIO1
 0x6800

272 

	)

273 
	#MASK_THUMB_INSN_LIO2
 
MASK_THUMB_INSN_LIO1


	)

274 
	#PTRN_THUMB_INSN_LIO2
 0x7800

275 

	)

276 
	#MASK_THUMB_INSN_LIO3
 
MASK_THUMB_INSN_LIO1


	)

277 
	#PTRN_THUMB_INSN_LIO3
 0x8800

278 

	)

279 
	#MASK_THUMB_INSN_LIO4
 
MASK_THUMB_INSN_LIO1


	)

280 
	#PTRN_THUMB_INSN_LIO4
 0x9800

281 

	)

282 
	#MASK_THUMB2_INSN_LDRW
 0x0000fff0

283 
	#PTRN_THUMB2_INSN_LDRW
 0x0000f850

284 

	)

285 
	#MASK_THUMB2_INSN_LDRW1
 
MASK_THUMB2_INSN_LDRW


	)

286 
	#PTRN_THUMB2_INSN_LDRW1
 0x0000f8d0

287 

	)

288 
	#MASK_THUMB2_INSN_LDRBW
 
MASK_THUMB2_INSN_LDRW


	)

289 
	#PTRN_THUMB2_INSN_LDRBW
 0x0000f810

290 

	)

291 
	#MASK_THUMB2_INSN_LDRBW1
 
MASK_THUMB2_INSN_LDRW


	)

292 
	#PTRN_THUMB2_INSN_LDRBW1
 0x0000f890

293 

	)

294 
	#MASK_THUMB2_INSN_LDRHW
 
MASK_THUMB2_INSN_LDRW


	)

295 
	#PTRN_THUMB2_INSN_LDRHW
 0x0000f830

296 

	)

297 
	#MASK_THUMB2_INSN_LDRHW1
 
MASK_THUMB2_INSN_LDRW


	)

298 
	#PTRN_THUMB2_INSN_LDRHW1
 0x0000f8b0

299 

	)

300 
	#MASK_THUMB2_INSN_LDRD
 0x0000fed0

301 
	#PTRN_THUMB2_INSN_LDRD
 0x0000e850

302 

	)

303 
	#MASK_THUMB2_INSN_LDRD1
 
MASK_THUMB2_INSN_LDRD


	)

304 
	#PTRN_THUMB2_INSN_LDRD1
 0x0000e8d0

305 

	)

306 
	#MASK_THUMB2_INSN_LDRWL
 0x0fc0fff0

307 
	#PTRN_THUMB2_INSN_LDRWL
 0x0000f850

308 

	)

309 
	#MASK_THUMB2_INSN_LDREX
 0x0f00ffff

310 
	#PTRN_THUMB2_INSN_LDREX
 0x0f00e85f

311 

	)

312 
	#MASK_THUMB2_INSN_MUL
 0xf0f0fff0

313 
	#PTRN_THUMB2_INSN_MUL
 0xf000fb00

314 

	)

315 
	#MASK_THUMB2_INSN_DP
 0x0000ff00

316 
	#PTRN_THUMB2_INSN_DP
 0x0000eb00

317 

	)

322 
	#MASK_ARM_INSN_SIO
 
MASK_ARM_INSN_LIO


	)

323 
	#PTRN_ARM_INSN_SIO
 0x04000000

	)

325 
	#MASK_THUMB_INSN_SIO1
 
MASK_THUMB_INSN_LIO1


	)

326 
	#PTRN_THUMB_INSN_SIO1
 0x6000

327 

	)

328 
	#MASK_THUMB_INSN_SIO2
 
MASK_THUMB_INSN_LIO1


	)

329 
	#PTRN_THUMB_INSN_SIO2
 0x7000

330 

	)

331 
	#MASK_THUMB_INSN_SIO3
 
MASK_THUMB_INSN_LIO1


	)

332 
	#PTRN_THUMB_INSN_SIO3
 0x8000

333 

	)

334 
	#MASK_THUMB_INSN_SIO4
 
MASK_THUMB_INSN_LIO1


	)

335 
	#PTRN_THUMB_INSN_SIO4
 0x9000

336 

	)

337 
	#MASK_THUMB2_INSN_STRW
 0x0fc0fff0

338 
	#PTRN_THUMB2_INSN_STRW
 0x0000f840

339 

	)

340 
	#MASK_THUMB2_INSN_STRW1
 0x0000fff0

341 
	#PTRN_THUMB2_INSN_STRW1
 0x0000f8c0

342 

	)

343 
	#MASK_THUMB2_INSN_STRHW
 
MASK_THUMB2_INSN_STRW


	)

344 
	#PTRN_THUMB2_INSN_STRHW
 0x0000f820

345 

	)

346 
	#MASK_THUMB2_INSN_STRHW1
 0x0000fff0

347 
	#PTRN_THUMB2_INSN_STRHW1
 0x0000f8a0

348 

	)

349 
	#MASK_THUMB2_INSN_STRHT
 0x0f00fff0

350 
	#PTRN_THUMB2_INSN_STRHT
 0x0e00f820

351 

	)

352 
	#MASK_THUMB2_INSN_STRT
 0x0f00fff0

353 
	#PTRN_THUMB2_INSN_STRT
 0x0e00f840

354 

	)

355 
	#MASK_THUMB2_INSN_STRBW
 
MASK_THUMB2_INSN_STRW


356 
	#PTRN_THUMB2_INSN_STRBW
 0x0000f800

357 

	)

358 
	#MASK_THUMB2_INSN_STRBW1
 0x0000fff0

359 
	#PTRN_THUMB2_INSN_STRBW1
 0x0000f880

360 

	)

361 
	#MASK_THUMB2_INSN_STRBT
 0x0f00fff0

362 
	#PTRN_THUMB2_INSN_STRBT
 0x0e00f800

363 

	)

364 
	#MASK_THUMB2_INSN_STRD
 0x0000fe50

365 
	#PTRN_THUMB2_INSN_STRD
 0x0000e840

366 

	)

369 
	#MASK_ARM_INSN_LRO
 0x0E100010

	)

370 
	#PTRN_ARM_INSN_LRO
 0x06100000

	)

372 
	#MASK_THUMB_INSN_LRO1
 0xFE00

373 
	#PTRN_THUMB_INSN_LRO1
 0x5600

374 

	)

375 
	#MASK_THUMB_INSN_LRO2
 
MASK_THUMB_INSN_LRO1


	)

376 
	#PTRN_THUMB_INSN_LRO2
 0x5800

377 

	)

378 
	#MASK_THUMB_INSN_LRO3
 0xf800

379 
	#PTRN_THUMB_INSN_LRO3
 0x4800

380 

	)

381 
	#MASK_THUMB_INSN_LRO4
 
MASK_THUMB_INSN_LRO1


	)

382 
	#PTRN_THUMB_INSN_LRO4
 0x5A00

383 

	)

384 
	#MASK_THUMB_INSN_LRO5
 
MASK_THUMB_INSN_LRO1


	)

385 
	#PTRN_THUMB_INSN_LRO5
 0x5C00

386 

	)

387 
	#MASK_THUMB_INSN_LRO6
 
MASK_THUMB_INSN_LRO1


	)

388 
	#PTRN_THUMB_INSN_LRO6
 0x5E00

389 

	)

390 
	#MASK_THUMB2_INSN_ADR
 0x8000fa1f

391 
	#PTRN_THUMB2_INSN_ADR
 0x0000f20f

392 

	)

396 
	#MASK_ARM_INSN_SRO
 
MASK_ARM_INSN_LRO


	)

397 
	#PTRN_ARM_INSN_SRO
 0x06000000

	)

399 
	#MASK_THUMB_INSN_SRO1
 
MASK_THUMB_INSN_LRO1


	)

400 
	#PTRN_THUMB_INSN_SRO1
 0x5000

401 

	)

402 
	#MASK_THUMB_INSN_SRO2
 
MASK_THUMB_INSN_LRO1


	)

403 
	#PTRN_THUMB_INSN_SRO2
 0x5200

404 

	)

405 
	#MASK_THUMB_INSN_SRO3
 
MASK_THUMB_INSN_LRO1


	)

406 
	#PTRN_THUMB_INSN_SRO3
 0x5400

407 

	)

409 
	#MASK_ARM_INSN_LM
 0x0E100000

	)

410 
	#PTRN_ARM_INSN_LM
 0x08100000

	)

412 
	#MASK_THUMB2_INSN_LDMIA
 0x8000ffd0

413 
	#PTRN_THUMB2_INSN_LDMIA
 0x8000e890

414 

	)

415 
	#MASK_THUMB2_INSN_LDMDB
 0x8000ffd0

416 
	#PTRN_THUMB2_INSN_LDMDB
 0x8000e910

417 

	)

419 
	#MASK_ARM_INSN_SM
 
MASK_ARM_INSN_LM


	)

420 
	#PTRN_ARM_INSN_SM
 0x08000000

	)

424 
	#MASK_ARM_INSN_CLS
 0x0E000000

	)

425 
	#PTRN_ARM_INSN_CLS
 0x0C000000

	)

427 
	#MASK_ARM_INSN_CRT
 0x0F000010

	)

428 
	#PTRN_ARM_INSN_CRT
 0x0E000010

	)

430 
	#ARM_INSN_MATCH
(
«me
, 
ö¢
Ë((ö¢ & 
MASK_ARM_INSN_
##«meË=
PTRN_ARM_INSN_
##«me)

	)

431 
	#THUMB_INSN_MATCH
(
«me
, 
ö¢
Ë(((ö¢ & 0x0000FFFFË& 
MASK_THUMB_INSN_
##«meË=
PTRN_THUMB_INSN_
##«me)

	)

432 
	#THUMB2_INSN_MATCH
(
«me
, 
ö¢
Ë((ö¢ & 
MASK_THUMB2_INSN_
##«meË=
PTRN_THUMB2_INSN_
##«me)

	)

434 
	#ARM_INSN_REG_RN
(
ö¢
Ë((ö¢ & 0x000F0000)>>16)

	)

436 
	#ARM_INSN_REG_SET_RN
(
ö¢
, 
ƒeg
Ë{ö¢ &~0x000F0000; in¢ |ƒeg<<16;}

	)

438 
	#ARM_INSN_REG_RD
(
ö¢
Ë((ö¢ & 0x0000F000)>>12)

	)

440 
	#ARM_INSN_REG_SET_RD
(
ö¢
, 
ƒeg
Ë{ö¢ &~0x0000F000; in¢ |ƒeg<<12;}

	)

442 
	#ARM_INSN_REG_RS
(
ö¢
Ë((ö¢ & 0x00000F00)>>8)

	)

444 
	#ARM_INSN_REG_SET_RS
(
ö¢
, 
ƒeg
Ë{ö¢ &~0x00000F00; in¢ |ƒeg<<8;}

	)

446 
	#ARM_INSN_REG_RM
(
ö¢
Ë(ö¢ & 0x0000000F)

	)

448 
	#ARM_INSN_REG_SET_RM
(
ö¢
, 
ƒeg
Ë{ö¢ &~0x0000000F; in¢ |ƒeg;}

	)

450 
	#ARM_INSN_REG_MR
(
ö¢
, 
ƒeg
Ë(ö¢ & (1 <<Çªg))

	)

452 
	#ARM_INSN_REG_SET_MR
(
ö¢
, 
ƒeg
Ë{ö¢ |(1 <<Çªg);}

	)

454 
	#ARM_INSN_REG_CLEAR_MR
(
ö¢
, 
ƒeg
Ë{ö¢ &~(1 <<Çªg);}

	)

456 
	#THUMB2_INSN_REG_RT
(
ö¢
Ë((ö¢ & 0xf0000000Ë>> 28)

	)

457 
	#THUMB2_INSN_REG_RT2
(
ö¢
Ë((ö¢ & 0x0f000000Ë>> 24)

	)

458 
	#THUMB2_INSN_REG_RN
(
ö¢
Ë(ö¢ & 0x0000000f)

	)

459 
	#THUMB2_INSN_REG_RD
(
ö¢
Ë((ö¢ & 0x0f000000Ë>> 24)

	)

460 
	#THUMB2_INSN_REG_RM
(
ö¢
Ë((ö¢ & 0x000f0000Ë>> 16)

	)

464 
	sk¥obe_˘lblk
 {

465 
	mk¥obe_°©us
;

466 
¥ev_k¥obe
 
	m¥ev_k¥obe
;

470 
	s¨ch_•ecific_ö¢
 {

472 
k¥obe_›code_t
 *
	mö¢
;

475 
	$k¥obe_›code_t
 (*
	tíåy_poöt_t
) (, , , , , );

477 
undef_hook
;

479 
	`sw≠_ªgi°î_undef_hook
(
undef_hook
 *
hook
);

480 
	`sw≠_uƒegi°î_undef_hook
(
undef_hook
 *
hook
);

482 
ölöe
 
	$¨ch_öô_moduÀ_dïs
()

485 
	}
}

487 
¨ch_make_åampﬁöe_¨m
(
addr
, 
ö¢
,

488 *
åamp
);

490 
	g¶Ÿ_m™agî
;

491 
	gkªçrobe
;

492 
	gkªçrobe_ö°™˚
;

493 
¨ch_¥ï¨e_k¥obe
(
k¥obe
 *
p
, 
¶Ÿ_m™agî
 *
sm
);

494 
¨ch_¥ï¨e_kªçrobe
(
kªçrobe_ö°™˚
 *
ri
, 
±_ªgs
 *
ªgs
);

496 
¨ch_¨m_k¥obe
(
k¥obe
 *
p
);

497 
¨ch_dißrm_k¥obe
(
k¥obe
 *
p
);

499 
£tjmp_¥e_h™dÀr
(
k¥obe
 *
p
, 
±_ªgs
 *
ªgs
);

500 
l⁄gjmp_bªak_h™dÀr
(
k¥obe
 *
p
, 
±_ªgs
 *
ªgs
);

502 
ßve_¥evious_k¥obe
(
k¥obe_˘lblk
 *
kcb
, 
k¥obe
 *
cur_p
);

503 
ª°‹e_¥evious_k¥obe
(
k¥obe_˘lblk
 *
kcb
);

504 
£t_cuºít_k¥obe
(
k¥obe
 *
p
, 
±_ªgs
 *
ªgs
, 
k¥obe_˘lblk
 *
kcb
);

506 
__«ked
 
kªçrobe_åampﬁöe
();

508 
ölöe
 
	$sw≠_gë_k¨g
(
±_ªgs
 *
ªgs
, 
n
)

510 
n
) {

512  
ªgs
->
ARM_r0
;

514  
ªgs
->
ARM_r1
;

516  
ªgs
->
ARM_r2
;

518  
ªgs
->
ARM_r3
;

521  *((*)
ªgs
->
ARM_•
 + 
n
 - 4);

522 
	}
}

524 
ölöe
 
	$sw≠_gë_ßrg
(
±_ªgs
 *
ªgs
, 
n
)

526  
	`sw≠_gë_k¨g
(
ªgs
, 
n
);

527 
	}
}

529 
¨ch_öô_k¥obes
();

530 
¨ch_exô_k¥obes
();

	@kprobe/arch/asm-arm/trampoline_arm.h

29 #i‚de‡
__ASM_ARM_TRAMPOLINE_ARM_H


30 
	#__ASM_ARM_TRAMPOLINE_ARM_H


	)

32 
gí_ö¢_execbuf
();

33 
pc_dï_ö¢_execbuf
();

34 
b_r_ö¢_execbuf
();

35 
b_c⁄d_ö¢_execbuf
();

36 
blx_off_ö¢_execbuf
();

	@kprobe/arch/asm-mips/dbi_kprobes.c

28 
	~"dbi_k¥obes.h
"

29 
	~<k¥obe/dbi_k¥obes.h
>

31 
	~<k¥obe/dbi_kdebug.h
>

32 
	~<k¥obe/dbi_ö¢_¶Ÿs.h
>

33 
	~<k¥obe/dbi_k¥obes_dïs.h
>

34 
	~<k¥obe/dbi_u¥obes.h
>

35 
	~<ksyms/ksyms.h
>

37 
	#SUPRESS_BUG_MESSAGES


	)

39 *
	g¨r_å≠s_‹igöÆ
;

41 
k¥obe
 * 
≥r_˝u__cuºít_k¥obe
;

43 
	g¨r_å≠s_ãm∂©e
[] = { 0x3c010000,

50 
k¥obe
 
	gåampﬁöe_p
 =

52 .
addr
 = (
k¥obe_›code_t
 *Ë& 
kªçrobe_åampﬁöe
,

53 .
	g¥e_h™dÀr
 = 
åampﬁöe_¥obe_h™dÀr


56 
gí_ö¢_execbuf
();

58 
	$gí_ö¢_execbuf_hﬁdî
 ()

60 
asm
 volatile (".global gen_insn_execbuf\n"

65 
	}
}

68 
	$¨ch_check_ö¢
 (
¨ch_•ecific_ö¢
 *
aö¢
)

70 
ªt
 = 0;

72 
	`MIPS_INSN_OPCODE
 (
aö¢
->
ö¢
[0]))

74 
MIPS_BEQ_OPCODE
:

75 
MIPS_BEQL_OPCODE
:

76 
MIPS_BNE_OPCODE
:

77 
MIPS_BNEL_OPCODE
:

78 
MIPS_BGTZ_OPCODE
:

79 
MIPS_BGTZL_OPCODE
:

80 
MIPS_BLEZ_OPCODE
:

81 
MIPS_BLEZL_OPCODE
:

82 
MIPS_J_OPCODE
:

83 
MIPS_JAL_OPCODE
:

84 
	`DBPRINTF
 ("arch_check_insn: opcode");

85 
ªt
 = -
EFAULT
;

87 
MIPS_REGIMM_OPCODE
:

89 
	`MIPS_INSN_RT
 (
aö¢
->
ö¢
[0]))

91 
MIPS_BLTZ_RT
:

92 
MIPS_BGEZ_RT
:

93 
MIPS_BLTZL_RT
:

94 
MIPS_BGEZL_RT
:

95 
MIPS_BLTZAL_RT
:

96 
MIPS_BGEZAL_RT
:

97 
MIPS_BLTZALL_RT
:

98 
MIPS_BGEZALL_RT
:

99 
	`DBPRINTF
 ("arch_check_insn: REGIMM opcode\n");

100 
ªt
 = -
EFAULT
;

105 
MIPS_COP1_OPCODE
:

107 
MIPS_COP2_OPCODE
:

108 i‡(
	`MIPS_INSN_RS
 (
aö¢
->
ö¢
[0]Ë=
MIPS_BC_RS
)

110 
	`DBPRINTF
 ("arch_check_insn: COP1 opcode\n");

111 
ªt
 = -
EFAULT
;

114 
MIPS_SPECIAL_OPCODE
:

116 
	`MIPS_INSN_FUNC
 (
aö¢
->
ö¢
[0]))

118 
MIPS_JR_FUNC
:

119 
MIPS_JALR_FUNC
:

120 
MIPS_BREAK_FUNC
:

121 
MIPS_SYSCALL_FUNC
:

122 
	`DBPRINTF
 ("arch_check_insn: SPECIAL opcode\n");

123 
ªt
 = -
EFAULT
;

128  
ªt
;

129 
	}
}

131 
	$¨ch_¥ï¨e_k¥obe
 (
k¥obe
 *
p
)

133 
k¥obe_›code_t
 
ö¢s
[
KPROBES_TRAMP_LEN
];

135 
ªt
 = 0;

136 i‡(!
ªt
)

138 
k¥obe_›code_t
 
ö¢
[
MAX_INSN_SIZE
];

139 
¨ch_•ecific_ö¢
 
aö¢
;

141 
p
->
aö¢
.
ö¢
 = 
	`gë_ö¢_¶Ÿ
 (
NULL
, 0);

142 i‡(!
p
->
aö¢
.
ö¢
)

143  -
ENOMEM
;

144 
	`mem˝y
 (
ö¢
, 
p
->
addr
, 
MAX_INSN_SIZE
 *  (
k¥obe_›code_t
));

145 
aö¢
.
ö¢
 = insn;

146 
ªt
 = 
	`¨ch_check_ö¢
 (&
aö¢
);

147 i‡(!
ªt
)

149 
p
->
›code
 = *p->
addr
;

150 
p
->
aö¢
.
boo°abÀ
 = 0;

151 
	`mem˝y
 (
ö¢s
, 
gí_ö¢_execbuf
,  (insns));

152 
ö¢s
[
KPROBES_TRAMP_INSN_IDX
] = 
ö¢
[0];

153 
ö¢s
[
KPROBES_TRAMP_SS_BREAK_IDX
] = 
BREAKPOINT_INSTRUCTION
;

154 
ö¢s
[
KPROBES_TRAMP_RET_BREAK_IDX
] = 
UNDEF_INSTRUCTION
;

155 
	`DBPRINTF
 ("¨ch_¥ï¨e_k¥obe: in¢ %lx", 
ö¢
[0]);

156 
	`DBPRINTF
 ("arch_prepare_kprobe:Åo %p - %lx %lx %lx",

157 
p
->
aö¢
.
ö¢
, 
ö¢s
[0], insns[1], insns[2]);

158 
	`mem˝y
 (
p
->
aö¢
.
ö¢
, 
ö¢s
, (insns));

162 
	`‰ì_ö¢_¶Ÿ
(&
k¥obe_ö¢_∑ges
, 
NULL
, 
p
->
aö¢
.
ö¢
);

166  
ªt
;

167 
	}
}

169 
	$¨ch_¥ï¨e_u¥obe
 (
k¥obe
 *
p
, 
èsk_°ru˘
 *
èsk
, 
©omic
)

171 
ªt
 = 0;

172 
k¥obe_›code_t
 
ö¢s
[
UPROBES_TRAMP_LEN
];

174 i‡((Ë
p
->
addr
 & 0x01)

176 
	`DBPRINTF
 ("AttemptÅoÑegister kprobeátán unalignedáddress");

177 
ªt
 = -
EINVAL
;

180 i‡(!
ªt
)

182 
k¥obe_›code_t
 
ö¢
[
MAX_INSN_SIZE
];

183 
¨ch_•ecific_ö¢
 
aö¢
;

185 i‡(!
	`ªad_¥oc_vm_©omic
 (
èsk
, (Ë
p
->
addr
, &
ö¢
, 
MAX_INSN_SIZE
 * (
k¥obe_›code_t
)))

186 
	`∑nic
 ("ÁûedÅÿªad mem‹y %p!\n", 
p
->
addr
);

187 
aö¢
.
ö¢
 = insn;

188 
ªt
 = 
	`¨ch_check_ö¢
 (&
aö¢
);

189 i‡(!
ªt
)

191 
p
->
›code
 = 
ö¢
[0];

192 
p
->
aö¢
.
ö¢
 = 
	`gë_ö¢_¶Ÿ
(
èsk
, 
©omic
);

193 i‡(!
p
->
aö¢
.
ö¢
)

194  -
ENOMEM
;

195 
p
->
aö¢
.
boo°abÀ
 = 0;

196 
	`mem˝y
 (
ö¢s
, 
gí_ö¢_execbuf
,  (insns));

197 
ö¢s
[
UPROBES_TRAMP_INSN_IDX
] = 
ö¢
[0];

198 
ö¢s
[
UPROBES_TRAMP_SS_BREAK_IDX
] = 
BREAKPOINT_INSTRUCTION
;

199 
ö¢s
[
UPROBES_TRAMP_RET_BREAK_IDX
] = 
UNDEF_INSTRUCTION
;

200 
	`DBPRINTF
 ("¨ch_¥ï¨e_u¥obe: in¢ %lx", 
ö¢
[0]);

201 
	`DBPRINTF
 ("arch_prepare_uprobe:Åo %p - %lx %lx %lx",

202 
p
->
aö¢
.
ö¢
, 
ö¢s
[0], insns[1], insns[2]);

204 i‡(!
	`wrôe_¥oc_vm_©omic
 (
èsk
, (Ë
p
->
aö¢
.
ö¢
, 
ö¢s
,  (insns)))

206 
	`∑nic
("ÁûedÅÿwrôêmem‹y %p!\n", 
p
->
aö¢
.
ö¢
);

207 
	`DBPRINTF
 ("ÁûedÅÿwrôêö¢ slŸÅÿ¥o˚s†mem‹y: in¢ %p,ádd∏%p,Örobê%p!", 
ö¢
, 
p
->
aö¢
.ö¢,Ö->
addr
);

210 
	`‰ì_ö¢_¶Ÿ
(&
u¥obe_ö¢_∑ges
, 
èsk
, 
p
->
aö¢
.
ö¢
);

211  -
EINVAL
;

216  
ªt
;

217 
	}
}

219 
	$¥ï¨e_sögÀ°ï
 (
k¥obe
 *
p
, 
±_ªgs
 *
ªgs
)

221 if(
p
->
ss_addr
)

223 
ªgs
->
˝0_ïc
 = (Ë
p
->
ss_addr
;

224 
p
->
ss_addr
 = 
NULL
;

227 
ªgs
->
˝0_ïc
 = (Ë
p
->
aö¢
.
ö¢
;

228 
	}
}

231 
	$ßve_¥evious_k¥obe
 (
k¥obe_˘lblk
 *
kcb
, 
k¥obe
 *
cur_p
)

233 i‡(
kcb
->
¥ev_k¥obe
.
kp
 !
NULL
)

235 
	`∑nic
 ("no spaceÅo saveÇewÖrobe[]:Åask = %d/%s,Örev %d/%p, current %d/%p,Çew %d/%p,",

236 
cuºít
->
pid
, cuºít->
comm
, 
kcb
->
¥ev_k¥obe
.
kp
->
tgid
, kcb->¥ev_k¥obe.kp->
addr
,

237 
	`k¥obe_ru¬ög
()->
tgid
, k¥obe_ru¬ög()->
addr
, 
cur_p
->tgid, cur_p->addr);

240 
kcb
->
¥ev_k¥obe
.
kp
 = 
	`k¥obe_ru¬ög
 ();

241 
kcb
->
¥ev_k¥obe
.
°©us
 = kcb->
k¥obe_°©us
;

242 
	}
}

244 
	$ª°‹e_¥evious_k¥obe
 (
k¥obe_˘lblk
 *
kcb
)

246 
	`__gë_˝u_v¨
 (
cuºít_k¥obe
Ë
kcb
->
¥ev_k¥obe
.
kp
;

247 
kcb
->
k¥obe_°©us
 = kcb->
¥ev_k¥obe
.
°©us
;

248 
kcb
->
¥ev_k¥obe
.
kp
 = 
NULL
;

249 
kcb
->
¥ev_k¥obe
.
°©us
 = 0;

250 
	}
}

252 
	$£t_cuºít_k¥obe
 (
k¥obe
 *
p
, 
±_ªgs
 *
ªgs
, 
k¥obe_˘lblk
 *
kcb
)

254 
	`__gë_˝u_v¨
 (
cuºít_k¥obe
Ë
p
;

255 
	`DBPRINTF
 ("£t_cuºít_k¥obe[]:Ö=%∞addr=%p\n", 
p
,Ö->
addr
);

256 
	}
}

258 
	$k¥obe_h™dÀr
 (
±_ªgs
 *
ªgs
)

260 
k¥obe
 *
p
 = 0;

261 
ªt
 = 0, 
pid
 = 0, 
ªçrobe
 = 0, 
ªíãr
 = 0;

262 
k¥obe_›code_t
 *
addr
 = 
NULL
, *
sßddr
 = 0;

263 
k¥obe_˘lblk
 *
kcb
;

264 #ifde‡
SUPRESS_BUG_MESSAGES


265 
sw≠_o›s_ö_¥ogªss
;

270 
addr
 = (
k¥obe_›code_t
 *Ë
ªgs
->
˝0_ïc
;

271 
	`DBPRINTF
 ("ªgs->ªgs[ 31 ] = 0x%lx\n", 
ªgs
->regs[31]);

273 #ifde‡
SUPRESS_BUG_MESSAGES


275 
sw≠_o›s_ö_¥ogªss
 = 
o›s_ö_¥ogªss
;

276 
o›s_ö_¥ogªss
 = 1;

278 
	`¥ìm±_dißbÀ
 ();

280 
kcb
 = 
	`gë_k¥obe_˘lblk
 ();

282 i‡(
	`u£r_mode
 (
ªgs
))

285 
pid
 = 
cuºít
->
tgid
;

289 i‡(
	`k¥obe_ru¬ög
 ())

291 
	`DBPRINTF
 ("lock???");

292 
p
 = 
	`gë_k¥obe
(
addr
, 
pid
);

293 i‡(
p
)

295 if(!
pid
 && (
addr
 =(
k¥obe_›code_t
 *)
kªçrobe_åampﬁöe
)){

296 
	`ßve_¥evious_k¥obe
 (
kcb
, 
p
);

297 
kcb
->
k¥obe_°©us
 = 
KPROBE_REENTER
;

298 
ªíãr
 = 1;

307 if(!
p
->
aö¢
.
boo°abÀ
){

308 
	`ßve_¥evious_k¥obe
 (
kcb
, 
p
);

309 
	`£t_cuºít_k¥obe
 (
p
, 
ªgs
, 
kcb
);

311 
	`k¥obes_öc_nmis£d_cou¡
 (
p
);

312 
	`¥ï¨e_sögÀ°ï
 (
p
, 
ªgs
);

313 if(!
p
->
aö¢
.
boo°abÀ
)

314 
kcb
->
k¥obe_°©us
 = 
KPROBE_REENTER
;

315 
	`¥ìm±_íabÀ_no_ªsched
 ();

316 #ifde‡
SUPRESS_BUG_MESSAGES


317 
o›s_ö_¥ogªss
 = 
sw≠_o›s_ö_¥ogªss
;

324 if(
pid
) {

325 
	`DBPRINTF
 ("check f‹ UNDEF_INSTRUCTION %p\n", 
addr
);

327 
p
 = 
	`gë_k¥obe_by_ö¢_¶Ÿ
 (
addr
-
UPROBES_TRAMP_RET_BREAK_IDX
, 
pid
, 
cuºít
);

328 i‡(
p
) {

329 
	`ßve_¥evious_k¥obe
 (
kcb
, 
p
);

330 
kcb
->
k¥obe_°©us
 = 
KPROBE_REENTER
;

331 
ªíãr
 = 1;

332 
ªçrobe
 = 1;

333 
	`DBPRINTF
 ("uªçrobê%p\n", 
addr
);

336 if(!
p
) {

337 
p
 = 
	`__gë_˝u_v¨
 (
cuºít_k¥obe
);

338 
	`DBPRINTF
 ("k¥obe_ru¬ög !!!Ö = 0x%∞p->bªak_h™dÀ∏0x%p", 
p
,Ö->
bªak_h™dÀr
);

343 
	`DBPRINTF
 ("unknow¿u¥obê© %∞cu∏© %p/%p\n", 
addr
, 
p
->addr,Ö->
aö¢
.
ö¢
);

344 if(
pid
)

345 
sßddr
 = 
p
->
aö¢
.
ö¢
 + 
UPROBES_TRAMP_SS_BREAK_IDX
;

347 
sßddr
 = 
p
->
aö¢
.
ö¢
 + 
KPROBES_TRAMP_SS_BREAK_IDX
;

348 i‡(
addr
 =
sßddr
)

350 
ªgs
->
˝0_ïc
 = (Ë(
p
->
addr
 + 1);

351 
	`DBPRINTF
 ("föish sã∞© %∞cu∏© %p/%p,Ñedúe˘Åÿ%lx\n", 
addr
, 
p
->addr,Ö->
aö¢
.
ö¢
, 
ªgs
->
˝0_ïc
);

353 i‡(
kcb
->
k¥obe_°©us
 =
KPROBE_REENTER
) {

354 
	`ª°‹e_¥evious_k¥obe
 (
kcb
);

357 
	`ª£t_cuºít_k¥obe
 ();

360 
	`DBPRINTF
 ("kprobe_running !!! gotoÇo");

361 
ªt
 = 1;

363 
	`DBPRINTF
 ("no_kprobe");

364 
no_k¥obe
;

370 
	`DBPRINTF
 ("gë_k¥obê%p-%d", 
addr
, 
pid
);

371 i‡(!
p
)

372 
p
 = 
	`gë_k¥obe
(
addr
, 
pid
);

373 i‡(!
p
)

375 if(
pid
) {

376 
	`DBPRINTF
 ("£¨ch UNDEF_INSTRUCTION %p\n", 
addr
);

378 
p
 = 
	`gë_k¥obe_by_ö¢_¶Ÿ
 (
addr
-
UPROBES_TRAMP_RET_BREAK_IDX
, 
pid
, 
cuºít
);

379 i‡(!
p
) {

381 
	`DBPRINTF
 ("no_kprobe");

383 
no_k¥obe
;

385 
ªçrobe
 = 1;

386 
	`DBPRINTF
 ("uªçrobê%p\n", 
addr
);

390 
	`DBPRINTF
 ("no_kprobe");

392 
no_k¥obe
;

396 
	`£t_cuºít_k¥obe
 (
p
, 
ªgs
, 
kcb
);

397 if(!
ªíãr
)

398 
kcb
->
k¥obe_°©us
 = 
KPROBE_HIT_ACTIVE
;

400 i‡(
ªçrobe
)

401 
ªt
 = 
	`åampﬁöe_¥obe_h™dÀr
 (
p
, 
ªgs
);

402 i‡(
p
->
¥e_h™dÀr
)

404 
ªt
 = 
p
->
	`¥e_h™dÀr
 (p, 
ªgs
);

405 if(!
p
->
aö¢
.
boo°abÀ
)

406 
kcb
->
k¥obe_°©us
 = 
KPROBE_HIT_SS
;

407 if(
p
->
¥e_h™dÀr
 !
åampﬁöe_¥obe_h™dÀr
) {

408 #ifde‡
SUPRESS_BUG_MESSAGES


409 
	`¥ìm±_dißbÀ
();

411 
	`ª£t_cuºít_k¥obe
 ();

412 #ifde‡
SUPRESS_BUG_MESSAGES


413 
	`¥ìm±_íabÀ_no_ªsched
();

418 i‡(
ªt
)

420 
	`DBPRINTF
 ("p->pre_handler[] 1");

421 #ifde‡
SUPRESS_BUG_MESSAGES


422 
o›s_ö_¥ogªss
 = 
sw≠_o›s_ö_¥ogªss
;

427 
	`DBPRINTF
 ("p->pre_handler 0");

429 
no_k¥obe
:

430 
	`¥ìm±_íabÀ_no_ªsched
 ();

431 #ifde‡
SUPRESS_BUG_MESSAGES


432 
o›s_ö_¥ogªss
 = 
sw≠_o›s_ö_¥ogªss
;

434  
ªt
;

435 
	}
}

437 
	$∑tch_su•íded_èsk_ªt_addr
(
èsk_°ru˘
 *
p
, 
kªçrobe
 *
Ω
)

439 
	`DBPRINTF
("patch_suspended_task_ret_addr isÇot implemented");

440 
	}
}

442 
	$£tjmp_¥e_h™dÀr
 (
k¥obe
 *
p
, 
±_ªgs
 *
ªgs
)

444 
j¥obe
 *
jp
 = 
	`c⁄èöî_of
 (
p
, j¥obe, 
kp
);

445 
k¥obe_¥e_íåy_h™dÀr_t
 
¥e_íåy
;

446 
íåy_poöt_t
 
íåy
;

448 
	`DBPRINTF
 ("pj∞0x%∞jp->íåy = 0x%p", 
jp
, jp->
íåy
);

449 
íåy
 = (
íåy_poöt_t
Ë
jp
->entry;

450 
¥e_íåy
 = (
k¥obe_¥e_íåy_h™dÀr_t
Ë
jp
->pre_entry;

453 
	`DBPRINTF
 ("íåy = 0x%∞jp->íåy = 0x%p", 
íåy
, 
jp
->entry);

456 i‡(!
p
->
tgid
 || (p->tgid =
cuºít
->tgid))

458 if(!
p
->
tgid
 && (p->
addr
 =
sched_addr
Ë&& 
sched_Ω
){

459 
èsk_°ru˘
 *
p
, *
g
;

460 
	`rcu_ªad_lock
();

462 if(
cuºít
 !&
öô_èsk
)

463 
	`∑tch_su•íded_èsk_ªt_addr
(&
öô_èsk
, 
sched_Ω
);

465 
	`do_óch_thªad
(
g
, 
p
){

466 if(
p
 =
cuºít
)

468 
	`∑tch_su•íded_èsk_ªt_addr
(
p
, 
sched_Ω
);

469 } 
	`whûe_óch_thªad
(
g
, 
p
);

470 
	`rcu_ªad_u∆ock
();

472 i‡(
¥e_íåy
)

473 
p
->
ss_addr
 = (*)
	`¥e_íåy
 (
jp
->
¥iv_¨g
, 
ªgs
);

474 i‡(
íåy
){

475 
	`íåy
 (
ªgs
->regs[4],Ñegs->regs[5],Ñegs->regs[6],Ñegs->regs[7],Ñegs->regs[8],Ñegs->regs[9]);

478 i‡(
p
->
tgid
)

479 
	`¨ch_uj¥obe_ªtu∫
();

481 
	`dbi_j¥obe_ªtu∫
 ();

484 i‡(
p
->
tgid
)

485 
	`¨ch_uj¥obe_ªtu∫
();

487 
	`¥ï¨e_sögÀ°ï
 (
p
, 
ªgs
);

490 
	}
}

493 
	$dbi_j¥obe_ªtu∫
 ()

495 
	`¥ìm±_íabÀ_no_ªsched
();

496 
	}
}

498 
	$¨ch_uj¥obe_ªtu∫
()

500 
	`¥ìm±_íabÀ_no_ªsched
();

501 
	}
}

503 
	$l⁄gjmp_bªak_h™dÀr
 (
k¥obe
 *
p
, 
±_ªgs
 *
ªgs
)

506 
	}
}

508 
	$¨ch_¨m_k¥obe
 (
k¥obe
 *
p
)

510 *
p
->
addr
 = 
BREAKPOINT_INSTRUCTION
;

511 
	`Êush_iˇche_ønge
 ((Ë
p
->
addr
, (Ëp->add∏+  (
k¥obe_›code_t
));

512 
	}
}

514 
	$¨ch_dißrm_k¥obe
 (
k¥obe
 *
p
)

516 *
p
->
addr
 =Ö->
›code
;

517 
	`Êush_iˇche_ønge
 ((Ë
p
->
addr
, (Ëp->add∏+  (
k¥obe_›code_t
));

518 
	}
}

520 
	$åampﬁöe_¥obe_h™dÀr
 (
k¥obe
 *
p
, 
±_ªgs
 *
ªgs
)

522 
kªçrobe_ö°™˚
 *
ri
 = 
NULL
;

523 
hli°_hód
 *
hód
, 
em±y_Ω
;

524 
hli°_node
 *
node
, *
tmp
;

525 
Êags
, 
‹ig_ªt_addªss
 = 0;

526 
åampﬁöe_addªss
 = (Ë&
kªçrobe_åampﬁöe
;

527 
kªçrobe
 *
¸p
 = 
NULL
;

528 
k¥obe_˘lblk
 *
kcb
 = 
	`gë_k¥obe_˘lblk
 ();

530 
	`DBPRINTF
 ("start");

532 i‡(
p
 &&Ö->
tgid
){

534 
åampﬁöe_addªss
 = ()(
p
->
aö¢
.
ö¢
 + 
UPROBES_TRAMP_RET_BREAK_IDX
);

537 
	`INIT_HLIST_HEAD
 (&
em±y_Ω
);

538 
	`•ö_lock_úqßve
 (&
kªçrobe_lock
, 
Êags
);

539 
hód
 = 
	`kªçrobe_ö°_èbÀ_hód
 (
cuºít
);

554 
	`hli°_f‹_óch_íåy_ß„
 (
ri
, 
node
, 
tmp
, 
hód
, 
hli°
)

556 i‡(
ri
->
èsk
 !
cuºít
)

559 i‡(
ri
->
Ω
 &&Ñi->Ω->
h™dÀr
){

560 
ri
->
Ω
->
	`h™dÀr
 (ri, 
ªgs
,Ñi->Ω->
¥iv_¨g
);

564 
‹ig_ªt_addªss
 = (Ë
ri
->
ªt_addr
;

565 
	`ªcy˛e_Ω_ö°
 (
ri
);

566 i‡(
‹ig_ªt_addªss
 !
åampﬁöe_addªss
)

574 
	`kªçrobe_as£π
 (
ri
, 
‹ig_ªt_addªss
, 
åampﬁöe_addªss
);

576 i‡(
åampﬁöe_addªss
 !(Ë&
kªçrobe_åampﬁöe
){

577 i‡(
ri
->
Ω
Ë
	`BUG_ON
 (ri->Ω->
kp
.
tgid
 == 0);

579 i‡(
ri
->
Ω
 &&Ñi->Ω->
kp
.
tgid
)

580 
	`BUG_ON
 (
åampﬁöe_addªss
 =(Ë&
kªçrobe_åampﬁöe
);

582 
ªgs
->ªgs[31] = 
‹ig_ªt_addªss
;

583 
	`DBPRINTF
 ("ªgs->˝0_ï¯0x%lx", 
ªgs
->
˝0_ïc
);

584 i‡(
åampﬁöe_addªss
 !(Ë&
kªçrobe_åampﬁöe
)

585 
ªgs
->
˝0_ïc
 = 
‹ig_ªt_addªss
;

587 
ªgs
->
˝0_ïc
 =Ñegs->cp0_epc + 4;

588 
	`DBPRINTF
 ("ªgs->˝0_ï¯0x%lx", 
ªgs
->
˝0_ïc
);

589 
	`DBPRINTF
 ("ªgs->˝0_°©u†0x%lx", 
ªgs
->
˝0_°©us
);

591 if(
p
){

592 i‡(
kcb
->
k¥obe_°©us
 =
KPROBE_REENTER
)

593 
	`ª°‹e_¥evious_k¥obe
 (
kcb
);

595 
	`ª£t_cuºít_k¥obe
 ();

598 
	`•ö_u∆ock_úqª°‹e
 (&
kªçrobe_lock
, 
Êags
);

599 
	`hli°_f‹_óch_íåy_ß„
 (
ri
, 
node
, 
tmp
, &
em±y_Ω
, 
hli°
)

601 
	`hli°_dñ
 (&
ri
->
hli°
);

602 
	`k‰ì
 (
ri
);

604 
	`¥ìm±_íabÀ_no_ªsched
 ();

611 
	}
}

613 
	$¨ch_¥ï¨e_kªçrobe
(
kªçrobe
 *
Ω
, 
±_ªgs
 *
ªgs
)

616 
kªçrobe_ö°™˚
 *
ri
;

618 
	`DBPRINTF
 ("start\n");

620 i‡((
ri
 = 
	`gë_‰ì_Ω_ö°
 (
Ω
)Ë!
NULL
)

622 
ri
->
Ω
 =Ñp;

623 
ri
->
èsk
 = 
cuºít
;

624 
ri
->
ªt_addr
 = (
k¥obe_›code_t
 *Ë
ªgs
->regs[31];

625 i‡(
Ω
->
kp
.
tgid
)

626 
ªgs
->ªgs[31] = (Ë(
Ω
->
kp
.
aö¢
.
ö¢
 + 
UPROBES_TRAMP_RET_BREAK_IDX
);

628 
ªgs
->ªgs[31] = (Ë&
kªçrobe_åampﬁöe
;

629 
	`add_Ω_ö°
 (
ri
);

632 
	`DBPRINTF
 ("WARNING: mis£dÑë¥obê%p\n", 
Ω
->
kp
.
addr
);

633 
Ω
->
nmis£d
++;

635 
	}
}

637 
DECLARE_MOD_CB_DEP
(
Êush_iˇche_ønge
, \

638 , 
__u£r
 
°¨t
, __u£∏
íd
);

639 
DECLARE_MOD_CB_DEP
(
Êush_iˇche_∑ge
, \

640 , 
vm_¨ó_°ru˘
 * 
vma
, 
∑ge
 *Öage);

641 
DECLARE_MOD_CB_DEP
(
Êush_ˇche_∑ge
, \

642 , 
vm_¨ó_°ru˘
 * 
vma
, 
∑ge
);

644 
	$¨ch_öô_moduÀ_dïs
()

646 
	`INIT_MOD_DEP_CB
(
Êush_iˇche_ønge
, 
r4k_Êush_iˇche_ønge
);

647 
	`INIT_MOD_DEP_CB
(
Êush_iˇche_∑ge
, 
r4k_Êush_iˇche_∑ge
);

648 
	`INIT_MOD_DEP_CB
(
Êush_ˇche_∑ge
, 
r4k_Êush_ˇche_∑ge
);

651 
	}
}

654 
__öô
 
	$¨ch_öô_k¥obes
 ()

656 
do_bp_h™dÀr
;

657 
k¥obe_h™dÀr_addr
;

659 
ö¢s_num
 = 0;

660 
code_size
 = 0;

662 
ªg_hi
;

663 
ªg_lo
;

665 
ªt
;

667 i‡(
	`¨ch_öô_moduÀ_dïídícõs
())

669 
	`DBPRINTF
 ("UnableÅo init module dependencies\n");

673 
do_bp_h™dÀr
 = ()
	`sw≠_ksyms
("do_bp");

675 
k¥obe_h™dÀr_addr
 = (Ë&
k¥obe_h™dÀr
;

676 
ö¢s_num
 =  (
¨r_å≠s_ãm∂©e
) /  (arr_traps_template[0]);

677 
code_size
 = 
ö¢s_num
 *  ();

678 
	`DBPRINTF
 ("ö¢s_num = %d\n", 
ö¢s_num
);

680 
¨r_å≠s_‹igöÆ
 = 
	`kmÆloc
 (
code_size
, 
GFP_KERNEL
);

681 i‡(!
¨r_å≠s_‹igöÆ
)

683 
	`DBPRINTF
 ("UnableÅoállocate space for original code of <do_bp>!\n");

686 
	`mem˝y
 (
¨r_å≠s_‹igöÆ
, (*Ë
do_bp_h™dÀr
, 
code_size
);

688 
ªg_hi
 = 
	`HIWORD
 (
k¥obe_h™dÀr_addr
);

689 
ªg_lo
 = 
	`LOWORD
 (
k¥obe_h™dÀr_addr
);

690 i‡(
ªg_lo
 >= 0x8000)

691 
ªg_hi
 += 0x0001;

692 
¨r_å≠s_ãm∂©e
[
REG_HI_INDEX
] |
ªg_hi
;

693 
¨r_å≠s_ãm∂©e
[
REG_LO_INDEX
] |
ªg_lo
;

696 
	`mem˝y
 ((*Ë
do_bp_h™dÀr
, 
¨r_å≠s_ãm∂©e
, 
code_size
);

697 
	`Êush_iˇche_ønge
 (
do_bp_h™dÀr
, do_bp_h™dÀ∏+ 
code_size
);

698 if((
ªt
 = 
	`dbi_ªgi°î_k¥obe
 (&
åampﬁöe_p
)) != 0){

700  
ªt
;

702 
	}
}

704 
__exô
 
	$dbi_¨ch_exô_k¥obes
 ()

706 
do_bp_h™dÀr
;

708 
ö¢s_num
 = 0;

709 
code_size
 = 0;

712 
do_bp_h™dÀr
 = ()
	`sw≠_ksyms
("do_undefinstr");

718 
ö¢s_num
 =  (
¨r_å≠s_ãm∂©e
) /  (arr_traps_template[0]);

719 
code_size
 = 
ö¢s_num
 *  ();

720 
	`mem˝y
 ((*Ë
do_bp_h™dÀr
, 
¨r_å≠s_‹igöÆ
, 
code_size
);

721 
	`Êush_iˇche_ønge
 (
do_bp_h™dÀr
, do_bp_h™dÀ∏+ 
code_size
);

722 
	`k‰ì
 (
¨r_å≠s_‹igöÆ
);

723 
¨r_å≠s_‹igöÆ
 = 
NULL
;

724 
	}
}

	@kprobe/arch/asm-mips/dbi_kprobes.h

1 #i‚de‡
_SRC_ASM_MIPS_KPROBES_H


2 
	#_SRC_ASM_MIPS_KPROBES_H


	)

31 
	~<k¥obe/dbi_k¥obes_dïs.h
>

32 
	~<k¥obe/dbi_k¥obes.h
>

34 
	tk¥obe_›code_t
;

36 
	#BREAKPOINT_INSTRUCTION
 0x0000000d

	)

38 #i‚de‡
KPROBES_RET_PROBE_TRAMP


39 
	#UNDEF_INSTRUCTION
 0x0000004d

	)

42 
	#MAX_INSN_SIZE
 1

	)

44 
	#UPROBES_TRAMP_LEN
 3

	)

45 
	#UPROBES_TRAMP_INSN_IDX
 0

	)

46 
	#UPROBES_TRAMP_SS_BREAK_IDX
 1

	)

47 
	#UPROBES_TRAMP_RET_BREAK_IDX
 2

	)

48 
	#KPROBES_TRAMP_LEN
 
UPROBES_TRAMP_LEN


	)

49 
	#KPROBES_TRAMP_INSN_IDX
 
UPROBES_TRAMP_INSN_IDX


	)

50 
	#KPROBES_TRAMP_SS_BREAK_IDX
 
UPROBES_TRAMP_SS_BREAK_IDX


	)

51 
	#KPROBES_TRAMP_RET_BREAK_IDX
 
UPROBES_TRAMP_RET_BREAK_IDX


	)

53 
	#REG_HI_INDEX
 0

	)

54 
	#REG_LO_INDEX
 1

	)

55 
	#NOTIFIER_CALL_CHAIN_INDEX
 0

	)

58 
	#MIPS_INSN_OPCODE_MASK
 0xFC000000

	)

59 
	#MIPS_INSN_RS_MASK
 0x03E00000

	)

60 
	#MIPS_INSN_RT_MASK
 0x001F0000

	)

62 
	#MIPS_INSN_FUNC_MASK
 0x0000003F

	)

63 
	#MIPS_INSN_OPCODE
(
ö¢
Ë(ö¢ & 
MIPS_INSN_OPCODE_MASK
)

	)

64 
	#MIPS_INSN_RS
(
ö¢
Ë(ö¢ & 
MIPS_INSN_RS_MASK
)

	)

65 
	#MIPS_INSN_RT
(
ö¢
Ë(ö¢ & 
MIPS_INSN_RT_MASK
)

	)

66 
	#MIPS_INSN_FUNC
(
ö¢
Ë(ö¢ & 
MIPS_INSN_FUNC_MASK
)

	)

68 
	#MIPS_BEQ_OPCODE
 0x10000000

	)

69 
	#MIPS_BNE_OPCODE
 0x14000000

	)

70 
	#MIPS_BLEZ_OPCODE
 0x18000000

	)

71 
	#MIPS_BGTZ_OPCODE
 0x1C000000

	)

72 
	#MIPS_BEQL_OPCODE
 0x50000000

	)

73 
	#MIPS_BNEL_OPCODE
 0x54000000

	)

74 
	#MIPS_BLEZL_OPCODE
 0x58000000

	)

75 
	#MIPS_BGTZL_OPCODE
 0x5C000000

	)

76 
	#MIPS_REGIMM_OPCODE
 0x04000000

	)

77 
	#MIPS_SPECIAL_OPCODE
 0x00000000

	)

78 
	#MIPS_COP1_OPCODE
 0x44000000

	)

79 
	#MIPS_COP2_OPCODE
 0x48000000

	)

80 
	#MIPS_J_OPCODE
 0x08000000

	)

81 
	#MIPS_JAL_OPCODE
 0x0C000000

	)

82 
	#MIPS_JALX_OPCODE
 0x74000000

	)

84 
	#MIPS_BC_RS
 0x01000000

	)

86 
	#MIPS_BLTZ_RT
 0x00000000

	)

87 
	#MIPS_BGEZ_RT
 0x00010000

	)

88 
	#MIPS_BLTZL_RT
 0x00020000

	)

89 
	#MIPS_BGEZL_RT
 0x00030000

	)

90 
	#MIPS_BLTZAL_RT
 0x00100000

	)

91 
	#MIPS_BGEZAL_RT
 0x00110000

	)

92 
	#MIPS_BLTZALL_RT
 0x00120000

	)

93 
	#MIPS_BGEZALL_RT
 0x00130000

	)

96 
	#MIPS_JR_FUNC
 0x00000008

	)

97 
	#MIPS_JALR_FUNC
 0x00000009

	)

98 
	#MIPS_BREAK_FUNC
 0x0000000D

	)

99 
	#MIPS_SYSCALL_FUNC
 0x0000000C

	)

103 
	sk¥obe_˘lblk
 {

104 
	mk¥obe_°©us
;

105 
¥ev_k¥obe
 
	m¥ev_k¥obe
;

109 
	s¨ch_•ecific_ö¢
 {

111 
k¥obe_›code_t
 *
	mö¢
;

116 
	mboo°abÀ
;

119 
	$k¥obe_›code_t
 (*
	tíåy_poöt_t
) (, , , , , );

122 
	`gí_ö¢_execbuf_hﬁdî
 ();

124 
	`∑tch_su•íded_èsk_ªt_addr
(
èsk_°ru˘
 *
p
, 
kªçrobe
 *
Ω
);

125 
	`¨ch_öô_moduÀ_dïs
();

	@kprobe/arch/asm-x86/dbi_kprobes.c

48 
	~<löux/moduÀ.h
>

49 
	~<löux/kdebug.h
>

51 
	~"dbi_k¥obes.h
"

52 
	~<k¥obe/dbi_k¥obes.h
>

54 
	~<k¥obe/dbi_kdebug.h
>

55 
	~<k¥obe/dbi_ö¢_¶Ÿs.h
>

56 
	~<k¥obe/dbi_k¥obes_dïs.h
>

57 
	#SUPRESS_BUG_MESSAGES


	)

59 
k¥obe
 * 
≥r_˝u__cuºít_k¥obe
;

60 
k¥obe
 * 
≥r_˝u__cuºít_k¥obe
;

61 
k¥obe
 * 
cuºít_k¥obe
;

63 
DECLARE_MOD_FUNC_DEP
(
moduÀ_Æloc
, *, 
size
);

64 
DECLARE_MOD_FUNC_DEP
(
moduÀ_‰ì
, , 
moduÀ
 *
mod
, *
moduÀ_ªgi⁄
);

65 
DECLARE_MOD_FUNC_DEP
(
fixup_ex˚±i⁄
, , 
±_ªgs
 * 
ªgs
);

67 
DECLARE_MOD_FUNC_DEP
(
‰ìze_¥o˚s£s
, , );

68 
DECLARE_MOD_FUNC_DEP
(
thaw_¥o˚s£s
, , );

70 #i‡(
LINUX_VERSION_CODE
 < 
KERNEL_VERSION
(2, 6, 26))

71 
DECLARE_MOD_FUNC_DEP
(
ãxt_poke
, , *
addr
, *
›code
, 
Àn
);

73 
DECLARE_MOD_FUNC_DEP
(
ãxt_poke
, *, *
addr
, c⁄° *
›code
, 
size_t
 
Àn
);

75 
DECLARE_MOD_FUNC_DEP
(
show_ªgi°îs
, , 
±_ªgs
 * 
ªgs
);

77 
	$DECLARE_MOD_DEP_WRAPPER
 (
moduÀ_Æloc
, *, 
size
)

78 
	$IMP_MOD_DEP_WRAPPER
 (
moduÀ_Æloc
, 
size
)

80 
	$DECLARE_MOD_DEP_WRAPPER
 (
moduÀ_‰ì
, , 
moduÀ
 *
mod
, *
moduÀ_ªgi⁄
)

81 
	$IMP_MOD_DEP_WRAPPER
 (
moduÀ_‰ì
, 
mod
, 
moduÀ_ªgi⁄
)

83 
	$DECLARE_MOD_DEP_WRAPPER
 (
fixup_ex˚±i⁄
, , 
±_ªgs
 * 
ªgs
)

84 
	$IMP_MOD_DEP_WRAPPER
 (
fixup_ex˚±i⁄
, 
ªgs
)

86 #i‡(
LINUX_VERSION_CODE
 < 
	`KERNEL_VERSION
(2, 6, 26))

87 
	`DECLARE_MOD_DEP_WRAPPER
(
ãxt_poke
, \

88 , *
addr
, *
›code
, 
Àn
)

90 
	`DECLARE_MOD_DEP_WRAPPER
(
ãxt_poke
, \

91 *, *
addr
, c⁄° *
›code
, 
size_t
 
Àn
)

93 
	$IMP_MOD_DEP_WRAPPER
(
ãxt_poke
, 
addr
, 
›code
, 
Àn
)

95 
	$DECLARE_MOD_DEP_WRAPPER
(
show_ªgi°îs
, , 
±_ªgs
 * 
ªgs
)

96 
	$IMP_MOD_DEP_WRAPPER
(
show_ªgi°îs
, 
ªgs
)

98 
	#°ack_addr
(
ªgs
Ë((*)
	`kî√l_°ack_poöãr
‘egs))

	)

106 
__u£d
 
	$kªçrobe_åampﬁöe_hﬁdî
()

108 
asm
 volatile(".global kretprobe_trampoline\n"

141 
	}
}

143 
kªçrobe_åampﬁöe
();

146 
__Æways_ölöe
 
	$£t_jmp_›
 (*
‰om
, *
to
)

148 
	s__¨ch_jmp_›


150 
›
;

151 
øddr
;

152 } 
	`__©åibuã__
 ((
∑cked
)Ë* 
j›
;

153 
j›
 = (
__¨ch_jmp_›
 *Ë
‰om
;

154 
j›
->
øddr
 = (Ë(
to
Ë- ((Ë(
‰om
) + 5);

155 
j›
->
›
 = 
RELATIVEJUMP_INSTRUCTION
;

156 
	}
}

161 
	$ˇn_boo°
(
k¥obe_›code_t
 *
›codes
)

163 
	#W
(
row
,
b0
,
b1
,
b2
,
b3
,
b4
,
b5
,
b6
,
b7
,
b8
,
b9
,
ba
,
bb
,
bc
,
bd
,
be
,
bf
) \

164 (((
b0
##
UL
 << 0x0)|(
b1
##UL << 0x1)|(
b2
##UL << 0x2)|(
b3
##UL << 0x3) | \

165 (
b4
##
UL
 << 0x4)|(
b5
##UL << 0x5)|(
b6
##UL << 0x6)|(
b7
##UL << 0x7) | \

166 (
b8
##
UL
 << 0x8)|(
b9
##UL << 0x9)|(
ba
##UL << 0xa)|(
bb
##UL << 0xb) | \

167 (
bc
##
UL
 << 0xc)|(
bd
##UL << 0xd)|(
be
##UL << 0xe)|(
bf
##UL << 0xf)) \

168 << (
row
 % 32))

	)

173 c⁄° 
twobyã_is_boo°abÀ
[256 / 32] = {

176 
	`W
 (0x00, 0, 0, 1, 1, 0, 0, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0) |

177 
	`W
 (0x10, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0),

178 
	`W
 (0x20, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0) |

179 
	`W
 (0x30, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0),

180 
	`W
 (0x40, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1) |

181 
	`W
 (0x50, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0),

182 
	`W
 (0x60, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1) |

183 
	`W
 (0x70, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 1, 1),

184 
	`W
 (0x80, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0) |

185 
	`W
 (0x90, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1),

186 
	`W
 (0xa0, 1, 1, 0, 1, 1, 1, 0, 0, 1, 1, 0, 1, 1, 1, 0, 1) |

187 
	`W
 (0xb0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 1, 1),

188 
	`W
 (0xc0, 1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1) |

189 
	`W
 (0xd0, 0, 1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 1, 1, 1, 0, 1),

190 
	`W
 (0xe0, 0, 1, 1, 0, 0, 1, 0, 0, 1, 1, 0, 1, 1, 1, 0, 1) |

191 
	`W
 (0xf0, 0, 1, 1, 1, 0, 1, 0, 0, 1, 1, 1, 0, 1, 1, 1, 0)

195 #unde‡
W


196 
k¥obe_›code_t
 
›code
;

197 
k¥obe_›code_t
 *
‹ig_›codes
 = 
›codes
;

198 
ªåy
:

199 i‡(
›codes
 - 
‹ig_›codes
 > 
MAX_INSN_SIZE
 - 1)

201 
›code
 = *(
›codes
++);

204 i‡(
›code
 == 0x0f)

206 i‡(
›codes
 - 
‹ig_›codes
 > 
MAX_INSN_SIZE
 - 1)

208  
	`ã°_bô
 (*
›codes
, 
twobyã_is_boo°abÀ
);

211 
›code
 & 0xf0)

214 i‡(0x63 < 
›code
 && opcode < 0x67)

215 
ªåy
;

217  (
›code
 != 0x62 && opcode != 0x67);

222  (0xc1 < 
›code
 && opcode < 0xcc) || opcode == 0xcf;

225  (
›code
 == 0xd4 || opcode == 0xd5 || opcode == 0xd7);

228  ((
›code
 & 0x04) || opcode == 0xea);

230 i‡((
›code
 & 0x0c) == 0 && opcode != 0xf1)

231 
ªåy
;

233  (
›code
 == 0xf5 || (0xf7 < opcode && opcode < 0xfe));

235 i‡(
›code
 == 0x26 || opcode == 0x36 || opcode == 0x3e)

236 
ªåy
;

238  (
›code
 != 0x2e && opcode != 0x9a);

240 
	}
}

241 
EXPORT_SYMBOL_GPL
(
ˇn_boo°
);

246 
	$is_IF_modifõr
 (
k¥obe_›code_t
 
›code
)

248 
›code
)

257 
	}
}

259 
	$¨ch_¥ï¨e_k¥obe
(
k¥obe
 *
p
, 
¶Ÿ_m™agî
 *
sm
)

262 
p
->
aö¢
.
ö¢
 = 
	`Æloc_ö¢_¶Ÿ
(
sm
);

263 i‡(
p
->
aö¢
.
ö¢
 =
NULL
)

264  -
ENOMEM
;

266 
	`mem˝y
(
p
->
aö¢
.
ö¢
,Ö->
addr
, 
MAX_INSN_SIZE
);

268 
p
->
›code
 = *p->
addr
;

269 
p
->
aö¢
.
boo°abÀ
 = 
	`ˇn_boo°
’->
addr
) ? 0 : -1;

272 
	}
}

274 
	$¥ï¨e_sögÀ°ï
 (
k¥obe
 *
p
, 
±_ªgs
 *
ªgs
)

276 if(
p
->
ss_addr
)

278 
ªgs
->
	`EREG
 (
ù
Ë()
p
->
ss_addr
;

279 
p
->
ss_addr
 = 
NULL
;

283 
ªgs
->
	`EREG
 (
Êags
Ë|
TF_MASK
;

284 
ªgs
->
	`EREG
 (
Êags
Ë&~
IF_MASK
;

286 i‡(
p
->
›code
 =
BREAKPOINT_INSTRUCTION
){

287 
ªgs
->
	`EREG
 (
ù
Ë(Ë
p
->
addr
;

291 
ªgs
->
	`EREG
 (
ù
Ë(Ë
p
->
aö¢
.
ö¢
;

293 
	}
}

294 
EXPORT_SYMBOL_GPL
(
¥ï¨e_sögÀ°ï
);

296 
	$ßve_¥evious_k¥obe
 (
k¥obe_˘lblk
 *
kcb
, 
k¥obe
 *
cur_p
)

298 i‡(
kcb
->
¥ev_k¥obe
.
kp
 !
NULL
)

300 
	`∑nic
("no spaceÅo saveÇewÖrobe[]:Åask = %d/%s,Örev %p, current %p,Çew %p,",

301 
cuºít
->
pid
, cuºít->
comm
, 
kcb
->
¥ev_k¥obe
.
kp
->
addr
,

302 
	`k¥obe_ru¬ög
()->
addr
, 
cur_p
->addr);

306 
kcb
->
¥ev_k¥obe
.
kp
 = 
	`k¥obe_ru¬ög
();

307 
kcb
->
¥ev_k¥obe
.
°©us
 = kcb->
k¥obe_°©us
;

309 
	}
}

311 
	$ª°‹e_¥evious_k¥obe
 (
k¥obe_˘lblk
 *
kcb
)

313 
	`__gë_˝u_v¨
 (
cuºít_k¥obe
Ë
kcb
->
¥ev_k¥obe
.
kp
;

314 
kcb
->
k¥obe_°©us
 = kcb->
¥ev_k¥obe
.
°©us
;

315 
kcb
->
¥ev_k¥obe
.
kp
 = 
NULL
;

316 
kcb
->
¥ev_k¥obe
.
°©us
 = 0;

317 
	}
}

319 
	$£t_cuºít_k¥obe
 (
k¥obe
 *
p
, 
±_ªgs
 *
ªgs
, 
k¥obe_˘lblk
 *
kcb
)

321 
	`__gë_˝u_v¨
 (
cuºít_k¥obe
Ë
p
;

322 
	`DBPRINTF
 ("£t_cuºít_k¥obe[]:Ö=%∞addr=%p\n", 
p
,Ö->
addr
);

323 
kcb
->
k¥obe_ßved_eÊags
 = kcb->
k¥obe_ﬁd_eÊags
 = (
ªgs
->
	`EREG
 (
Êags
Ë& (
TF_MASK
 | 
IF_MASK
));

324 i‡(
	`is_IF_modifõr
 (
p
->
›code
))

325 
kcb
->
k¥obe_ßved_eÊags
 &~
IF_MASK
;

326 
	}
}

328 
	$k¥obe_h™dÀr
 (
±_ªgs
 *
ªgs
)

330 
k¥obe
 *
p
 = 0;

331 
ªt
 = 0, 
ªíãr
 = 0;

332 
k¥obe_›code_t
 *
addr
 = 
NULL
;

333 
k¥obe_˘lblk
 *
kcb
;

334 #ifde‡
SUPRESS_BUG_MESSAGES


335 
sw≠_o›s_ö_¥ogªss
;

339 
addr
 = (
k¥obe_›code_t
 *Ë(
ªgs
->
	`EREG
 (
ù
) -  (kprobe_opcode_t));

340 
	`DBPRINTF
 ("KPROBE:Ñegs->eù = 0x%lxádd∏0x%p\n", 
ªgs
->
	`EREG
 (
ù
), 
addr
);

341 #ifde‡
SUPRESS_BUG_MESSAGES


343 
sw≠_o›s_ö_¥ogªss
 = 
o›s_ö_¥ogªss
;

344 
o›s_ö_¥ogªss
 = 1;

346 
	`¥ìm±_dißbÀ
 ();

348 
kcb
 = 
	`gë_k¥obe_˘lblk
 ();

351 i‡(
	`k¥obe_ru¬ög
()) {

352 
p
 = 
	`gë_k¥obe
(
addr
);

353 i‡(
p
) {

354 i‡(
kcb
->
k¥obe_°©us
 =
KPROBE_HIT_SS
 && *
p
->
aö¢
.
ö¢
 =
BREAKPOINT_INSTRUCTION
) {

355 
ªgs
->
	`EREG
(
Êags
Ë&~
TF_MASK
;

356 
ªgs
->
	`EREG
(
Êags
Ë|
kcb
->
k¥obe_ßved_eÊags
;

357 
no_k¥obe
;

367 
	`ßve_¥evious_k¥obe
 (
kcb
, 
p
);

368 
	`£t_cuºít_k¥obe
 (
p
, 
ªgs
, 
kcb
);

369 
	`k¥obes_öc_nmis£d_cou¡
 (
p
);

370 
	`¥ï¨e_sögÀ°ï
 (
p
, 
ªgs
);

371 
kcb
->
k¥obe_°©us
 = 
KPROBE_REENTER
;

374 #ifde‡
SUPRESS_BUG_MESSAGES


375 
o›s_ö_¥ogªss
 = 
sw≠_o›s_ö_¥ogªss
;

379 i‡(*
addr
 !
BREAKPOINT_INSTRUCTION
) {

384 
ªgs
->
	`EREG
(
ù
Ë-(
k¥obe_›code_t
);

385 
ªt
 = 1;

386 
no_k¥obe
;

389 
p
 = 
	`__gë_˝u_v¨
(
cuºít_k¥obe
);

390 i‡(
p
->
bªak_h™dÀr
 &&Ö->
	`bªak_h™dÀr
’, 
ªgs
))

391 
ss_¥obe
;

393 
no_k¥obe
;

397 
	`DBPRINTF
 ("gë_k¥obê%p", 
addr
);

398 i‡(!
p
)

399 
p
 = 
	`gë_k¥obe
(
addr
);

401 i‡(!
p
) {

402 i‡(*
addr
 !
BREAKPOINT_INSTRUCTION
) {

412 
ªgs
->
	`EREG
(
ù
Ë-(
k¥obe_›code_t
);

413 
ªt
 = 1;

416 i‡(!
p
) {

418 
	`DBPRINTF
 ("no_kprobe");

419 
no_k¥obe
;

423 
	`£t_cuºít_k¥obe
 (
p
, 
ªgs
, 
kcb
);

425 if(!
ªíãr
)

426 
kcb
->
k¥obe_°©us
 = 
KPROBE_HIT_ACTIVE
;

428 i‡(
p
->
¥e_h™dÀr
)

429 
ªt
 = 
p
->
	`¥e_h™dÀr
’, 
ªgs
);

431 i‡(
ªt
)

433 i‡(
ªt
 == 2) {

434 
	`DBPRINTF
 ("p->pre_handler[] 2");

435 
ss_¥obe
;

437 
	`DBPRINTF
 ("p->pre_handler[] 1");

440 #ifde‡
SUPRESS_BUG_MESSAGES


441 
o›s_ö_¥ogªss
 = 
sw≠_o›s_ö_¥ogªss
;

444 
	`¥ï¨e_sögÀ°ï
(
p
, 
ªgs
);

447 
	`DBPRINTF
 ("p->pre_handler[] 0");

449 
ss_¥obe
:

450 
	`DBPRINTF
 ("∞%p\n", 
p
);

451 
	`DBPRINTF
 ("p->›codê0x%lx *p->add∏0x%lxÖ->add∏0x%p\n", (Ë
p
->
›code
,Ö->
tgid
 ? 0 : (Ë(*p->
addr
),Ö->addr);

453 #i‡!
	`deföed
(
CONFIG_PREEMPT
Ë|| deföed(
CONFIG_PM
)

454 i‡(
p
->
aö¢
.
boo°abÀ
 =1 && !p->
po°_h™dÀr
)

457 
	`ª£t_cuºít_k¥obe
 ();

458 
ªgs
->
	`EREG
 (
ù
Ë(Ë
p
->
aö¢
.
ö¢
;

459 
	`¥ìm±_íabÀ_no_ªsched
 ();

460 #ifde‡
SUPRESS_BUG_MESSAGES


461 
o›s_ö_¥ogªss
 = 
sw≠_o›s_ö_¥ogªss
;

466 
	`¥ï¨e_sögÀ°ï
 (
p
, 
ªgs
);

467 
kcb
->
k¥obe_°©us
 = 
KPROBE_HIT_SS
;

470 #ifde‡
SUPRESS_BUG_MESSAGES


471 
o›s_ö_¥ogªss
 = 
sw≠_o›s_ö_¥ogªss
;

475 
no_k¥obe
:

477 
	`¥ìm±_íabÀ_no_ªsched
 ();

478 #ifde‡
SUPRESS_BUG_MESSAGES


479 
o›s_ö_¥ogªss
 = 
sw≠_o›s_ö_¥ogªss
;

481  
ªt
;

482 
	}
}

484 
	$£tjmp_¥e_h™dÀr
 (
k¥obe
 *
p
, 
±_ªgs
 *
ªgs
)

486 
j¥obe
 *
jp
 = 
	`c⁄èöî_of
 (
p
, j¥obe, 
kp
);

487 
k¥obe_¥e_íåy_h™dÀr_t
 
¥e_íåy
;

488 
íåy_poöt_t
 
íåy
;

490 
addr
;

491 
k¥obe_˘lblk
 *
kcb
 = 
	`gë_k¥obe_˘lblk
 ();

493 
	`DBPRINTF
 ("£tjmp_¥e_h™dÀ∏%p:%d", 
p
->
addr
,Ö->
tgid
);

494 
¥e_íåy
 = (
k¥obe_¥e_íåy_h™dÀr_t
Ë
jp
->pre_entry;

495 
íåy
 = (
íåy_poöt_t
Ë
jp
->entry;

497 
kcb
->
j¥obe_ßved_ªgs
 = *
ªgs
;

498 
kcb
->
j¥obe_ßved_e•
 = 
	`°ack_addr
(
ªgs
);

499 
addr
 = ()(
kcb
->
j¥obe_ßved_e•
);

506 
	`mem˝y
(
kcb
->
j¥obes_°ack
, (
k¥obe_›code_t
 *)
addr
, 
	`MIN_STACK_SIZE
 (addr));

507 
ªgs
->
	`EREG
(
Êags
Ë&~
IF_MASK
;

508 #i‡
LINUX_VERSION_CODE
 >
	`KERNEL_VERSION
(2, 6, 18)

509 
	`åa˚_h¨dúqs_off
();

511 i‡(
¥e_íåy
)

512 
p
->
ss_addr
 = (
k¥obe_›code_t
 *)
	`¥e_íåy
(
jp
->
¥iv_¨g
, 
ªgs
);

514 
ªgs
->
	`EREG
(
ù
Ë()(
jp
->
íåy
);

517 
	}
}

519 
	$dbi_j¥obe_ªtu∫
 ()

521 
k¥obe_˘lblk
 *
kcb
 = 
	`gë_k¥obe_˘lblk
 ();

523 
asm
 volatile(" xchgl %%ebx,%%esp \n"

527 "Ç› \n"::"b" (
kcb
->
j¥obe_ßved_e•
):"memory");

528 
	}
}

530 
	$¨ch_uj¥obe_ªtu∫
()

532 
	}
}

558 
	$ªsume_executi⁄
 (
k¥obe
 *
p
, 
±_ªgs
 *
ªgs
, 
k¥obe_˘lblk
 *
kcb
)

560 *
tos
;

561 
c›y_eù
 = (Ë
p
->
aö¢
.
ö¢
;

562 
‹ig_eù
 = (Ë
p
->
addr
;

563 
k¥obe_›code_t
 
ö¢s
[2];

565 
ªgs
->
	`EREG
 (
Êags
Ë&~
TF_MASK
;

567 
tos
 = 
	`°ack_addr
(
ªgs
);

568 
ö¢s
[0] = 
p
->
aö¢
.
ö¢
[0];

569 
ö¢s
[1] = 
p
->
aö¢
.
ö¢
[1];

571 
ö¢s
[0])

574 *
tos
 &~(
TF_MASK
 | 
IF_MASK
);

575 *
tos
 |
kcb
->
k¥obe_ﬁd_eÊags
;

584 
p
->
aö¢
.
boo°abÀ
 = 1;

585 
no_ch™ge
;

587 *
tos
 = 
‹ig_eù
 + (*to†- 
c›y_eù
);

590 *
tos
 = 
‹ig_eù
 + (*to†- 
c›y_eù
);

591 
no_ch™ge
;

593 i‡((
ö¢s
[1] & 0x30) == 0x10)

600 *
tos
 = 
‹ig_eù
 + (*to†- 
c›y_eù
);

601 
no_ch™ge
;

603 i‡(((
ö¢s
[1] & 0x31) == 0x20) ||

604 ((
ö¢s
[1] & 0x31) == 0x21))

607 
p
->
aö¢
.
boo°abÀ
 = 1;

608 
no_ch™ge
;

614 i‡(
p
->
aö¢
.
boo°abÀ
 == 0)

616 i‡((
ªgs
->
	`EREG
 (
ù
Ë> 
c›y_eù
Ë&& (ªgs->EREG (ùË- c›y_eùË+ 5 < 
MAX_INSN_SIZE
)

622 
	`£t_jmp_›
((*)
ªgs
->
	`EREG
(
ù
), (*)
‹ig_eù
 + (ªgs->EREG(ùË- 
c›y_eù
));

623 
p
->
aö¢
.
boo°abÀ
 = 1;

627 
p
->
aö¢
.
boo°abÀ
 = -1;

631 
ªgs
->
	`EREG
 (
ù
Ë
‹ig_eù
 + (ªgs->EREG (ùË- 
c›y_eù
);

633 
no_ch™ge
:

635 
	}
}

641 
	$po°_k¥obe_h™dÀr
 (
±_ªgs
 *
ªgs
)

643 
k¥obe
 *
cur
 = 
	`k¥obe_ru¬ög
 ();

644 
k¥obe_˘lblk
 *
kcb
 = 
	`gë_k¥obe_˘lblk
 ();

646 i‡(!
cur
)

648 i‡((
kcb
->
k¥obe_°©us
 !
KPROBE_REENTER
Ë&& 
cur
->
po°_h™dÀr
)

650 
kcb
->
k¥obe_°©us
 = 
KPROBE_HIT_SSDONE
;

651 
cur
->
	`po°_h™dÀr
 (cur, 
ªgs
, 0);

654 
	`ªsume_executi⁄
 (
cur
, 
ªgs
, 
kcb
);

655 
ªgs
->
	`EREG
 (
Êags
Ë|
kcb
->
k¥obe_ßved_eÊags
;

656 #i‚de‡
CONFIG_X86


657 
	`åa˚_h¨dúqs_fixup_Êags
 (
ªgs
->
	`EREG
 (
Êags
));

660 i‡(
kcb
->
k¥obe_°©us
 =
KPROBE_REENTER
)

662 
	`ª°‹e_¥evious_k¥obe
 (
kcb
);

663 
out
;

665 
	`ª£t_cuºít_k¥obe
 ();

666 
out
:

667 
	`¥ìm±_íabÀ_no_ªsched
 ();

674 i‡(
ªgs
->
	`EREG
 (
Êags
Ë& 
TF_MASK
)

678 
	}
}

680 
	$k¥obe_Áu…_h™dÀr
 (
±_ªgs
 *
ªgs
, 
å≠ƒ
)

682 
k¥obe
 *
cur
 = 
	`k¥obe_ru¬ög
 ();

683 
k¥obe_˘lblk
 *
kcb
 = 
	`gë_k¥obe_˘lblk
 ();

685 
kcb
->
k¥obe_°©us
)

687 
KPROBE_HIT_SS
:

688 
KPROBE_REENTER
:

696 
ªgs
->
	`EREG
 (
ù
Ë(Ë
cur
->
addr
;

697 
ªgs
->
	`EREG
 (
Êags
Ë|
kcb
->
k¥obe_ﬁd_eÊags
;

698 i‡(
kcb
->
k¥obe_°©us
 =
KPROBE_REENTER
)

699 
	`ª°‹e_¥evious_k¥obe
 (
kcb
);

701 
	`ª£t_cuºít_k¥obe
 ();

702 
	`¥ìm±_íabÀ_no_ªsched
 ();

704 
KPROBE_HIT_ACTIVE
:

705 
KPROBE_HIT_SSDONE
:

711 
	`k¥obes_öc_nmis£d_cou¡
 (
cur
);

720 i‡(
cur
->
Áu…_h™dÀr
 && cur->
	`Áu…_h™dÀr
 (cur, 
ªgs
, 
å≠ƒ
))

727 i‡(
	`fixup_ex˚±i⁄
 (
ªgs
))

739 
	}
}

741 
	$k¥obe_ex˚±i⁄s_nŸify
 (
nŸifõr_block
 *
£lf
, 
vÆ
, *
d©a
)

743 
dõ_¨gs
 *
¨gs
 = (dõ_¨g†*Ë
d©a
;

744 
ªt
 = 
NOTIFY_DONE
;

746 
	`DBPRINTF
 ("vÆ = %ld, d©®0x%X", 
vÆ
, (Ë
d©a
);

748 i‡(
¨gs
->
ªgs
 =
NULL
 || 
	`u£r_mode_vm
(args->regs))

749  
ªt
;

751 
	`DBPRINTF
 ("swôch (vÆË%lu %d %d", 
vÆ
, 
DIE_INT3
, 
DIE_TRAP
);

752 
vÆ
)

754 #ifde‡
CONFIG_KPROBES


755 
DIE_INT3
:

757 
DIE_TRAP
:

759 
	`DBPRINTF
 ("bef‹êk¥obe_h™dÀ∏ªt=%d %p", 
ªt
, 
¨gs
->
ªgs
);

760 i‡(
	`k¥obe_h™dÀr
 (
¨gs
->
ªgs
))

761 
ªt
 = 
NOTIFY_STOP
;

762 
	`DBPRINTF
 ("a·î k¥obe_h™dÀ∏ªt=%d %p", 
ªt
, 
¨gs
->
ªgs
);

764 
DIE_DEBUG
:

765 i‡(
	`po°_k¥obe_h™dÀr
 (
¨gs
->
ªgs
))

766 
ªt
 = 
NOTIFY_STOP
;

768 
DIE_GPF
:

770 
	`¥ìm±_dißbÀ
 ();

771 i‡(
	`k¥obe_ru¬ög
 (Ë&& 
	`k¥obe_Áu…_h™dÀr
 (
¨gs
->
ªgs
,árgs->
å≠ƒ
))

772 
ªt
 = 
NOTIFY_STOP
;

773 
	`¥ìm±_íabÀ
 ();

778 
	`DBPRINTF
 ("ªt=%d", 
ªt
);

782  
ªt
;

783 
	}
}

785 
nŸifõr_block
 
	gk¥obe_ex˚±i⁄s_nb
 = {

786 .
nŸifõr_ˇŒ
 = 
k¥obe_ex˚±i⁄s_nŸify
,

787 .
	g¥i‹ôy
 = 
INT_MAX


790 
	$l⁄gjmp_bªak_h™dÀr
 (
k¥obe
 *
p
, 
±_ªgs
 *
ªgs
)

792 
k¥obe_˘lblk
 *
kcb
 = 
	`gë_k¥obe_˘lblk
 ();

793 
u8
 *
addr
 = (u8 *Ë(
ªgs
->
	`EREG
 (
ù
) - 1);

794 
°ack_addr
 = (Ë(
kcb
->
j¥obe_ßved_e•
);

795 
j¥obe
 *
jp
 = 
	`c⁄èöî_of
 (
p
, j¥obe, 
kp
);

797 
	`DBPRINTF
 ("∞%p\n", 
p
);

799 i‡((
addr
 > (
u8
 *Ë
dbi_j¥obe_ªtu∫
Ë&& (add∏< (u8 *Ë
dbi_j¥obe_ªtu∫_íd
))

801 i‡(
	`°ack_addr
(
ªgs
Ë!
kcb
->
j¥obe_ßved_e•
) {

802 
±_ªgs
 *
ßved_ªgs
 = &
kcb
->
j¥obe_ßved_ªgs
;

803 
	`¥ötk
("currentÉsp %p doesÇot match savedÉsp %p\n",

804 
	`°ack_addr
(
ªgs
), 
kcb
->
j¥obe_ßved_e•
);

805 
	`¥ötk
 ("SavedÑegi°î†f‹ j¥obê%p\n", 
jp
);

806 
	`show_ªgi°îs
 (
ßved_ªgs
);

807 
	`¥ötk
 ("CurrentÑegisters\n");

808 
	`show_ªgi°îs
 (
ªgs
);

809 
	`∑nic
("BUG");

812 *
ªgs
 = 
kcb
->
j¥obe_ßved_ªgs
;

813 
	`mem˝y
 ((
k¥obe_›code_t
 *Ë
°ack_addr
, 
kcb
->
j¥obes_°ack
, 
	`MIN_STACK_SIZE
 (stack_addr));

814 
	`¥ìm±_íabÀ_no_ªsched
 ();

819 
	}
}

821 
	$¨ch_¨m_k¥obe
 (
k¥obe
 *
p
)

823 
	`ãxt_poke
 (
p
->
addr
, (([])

824 {
BREAKPOINT_INSTRUCTION
}), 1);

825 
	}
}

827 
	$¨ch_dißrm_k¥obe
 (
k¥obe
 *
p
)

829 
	`ãxt_poke
 (
p
->
addr
, &p->
›code
, 1);

830 
	}
}

832 
__u£d
 *
	$åampﬁöe_¥obe_h™dÀr_x86
(
±_ªgs
 *
ªgs
)

834  (*)
	`åampﬁöe_¥obe_h™dÀr
(
NULL
, 
ªgs
);

835 
	}
}

837 
	$¨ch_¥ï¨e_kªçrobe
(
kªçrobe_ö°™˚
 *
ri
, 
±_ªgs
 *
ªgs
)

839 *
±r_ªt_addr
 = 
	`°ack_addr
(
ªgs
);

842 i‡(()
ri
->
Ω
->
kp
.
addr
 =
sched_addr
) {

843 
ri
->
•
 = 
NULL
;

844 
ri
->
èsk
 = (
èsk_°ru˘
 *)
ªgs
->
dx
;

846 
ri
->
•
 = 
±r_ªt_addr
;

850 
ri
->
ªt_addr
 = (*)*
±r_ªt_addr
;

853 *
±r_ªt_addr
 = ()&
kªçrobe_åampﬁöe
;

854 
	}
}

856 
	$¨ch_öô_moduÀ_dïs
()

858 
	`INIT_MOD_DEP_VAR
(
moduÀ_Æloc
, module_alloc);

859 
	`INIT_MOD_DEP_VAR
(
moduÀ_‰ì
, module_free);

860 
	`INIT_MOD_DEP_VAR
(
fixup_ex˚±i⁄
, fixup_exception);

861 #i‡
LINUX_VERSION_CODE
 < 
	`KERNEL_VERSION
(2, 6, 23)

862 #îr‹ 
this
 
kî√l
 
vîsi⁄
 
has
 
no
 
ãxt_poke
 
fun˘i⁄
 
which
 
is
 
√˚sßryf
 
x86
 
ach
!!!

864 
	`INIT_MOD_DEP_VAR
(
ãxt_poke
,Åext_poke);

866 
	`INIT_MOD_DEP_VAR
(
show_ªgi°îs
, show_registers);

867 #i‡
	`deföed
(
CONFIG_PREEMPT
Ë&& deföed(
CONFIG_PM
)

868 
	`INIT_MOD_DEP_VAR
(
‰ìze_¥o˚s£s
, freeze_processes);

869 
	`INIT_MOD_DEP_VAR
(
thaw_¥o˚s£s
,Åhaw_processes);

873 
	}
}

875 
	$¨ch_öô_k¥obes
()

877  
	`ªgi°î_dõ_nŸifõr
 (&
k¥obe_ex˚±i⁄s_nb
);

878 
	}
}

880 
	$¨ch_exô_k¥obes
()

882 
	`uƒegi°î_dõ_nŸifõr
 (&
k¥obe_ex˚±i⁄s_nb
);

883 
	}
}

	@kprobe/arch/asm-x86/dbi_kprobes.h

1 #i‚de‡
_SRC_ASM_X86_KPROBES_H


2 
	#_SRC_ASM_X86_KPROBES_H


	)

52 
	~<löux/vîsi⁄.h
>

53 
	~<k¥obe/dbi_k¥obes_dïs.h
>

55 
u8
 
	tk¥obe_›code_t
;

57 
	#BREAKPOINT_INSTRUCTION
 0xcc

	)

58 
	#RELATIVEJUMP_INSTRUCTION
 0xe9

	)

60 
	#BP_INSN_SIZE
 1

	)

61 
	#MAX_INSN_SIZE
 16

	)

62 
	#MAX_STACK_SIZE
 64

	)

64 
	#MIN_STACK_SIZE
(
ADDR
Ë(((
MAX_STACK_SIZE
) < \

65 ((()
	`cuºít_thªad_öfo
()) \

66 + 
THREAD_SIZE
 - (
ADDR
))) \

67 ? (
MAX_STACK_SIZE
) \

68 : ((()
	`cuºít_thªad_öfo
()) \

69 + 
THREAD_SIZE
 - (
ADDR
)))

	)

71 #i‡
LINUX_VERSION_CODE
 < 
KERNEL_VERSION
(2, 6, 25)

73 
	#EREG
(
rg
Ë
e
##
	)
rg

74 
	#XREG
(
rg
Ë
x
##
	)
rg

75 
	#ORIG_EAX_REG
 
‹ig_óx


	)

79 
	#EREG
(
rg
Ë
	)
rg

80 
	#XREG
(
rg
Ë
	)
rg

81 
	#ORIG_EAX_REG
 
‹ig_ax


	)

85 #i‡
LINUX_VERSION_CODE
 >
KERNEL_VERSION
(2, 6, 26)

86 
	#TF_MASK
 
X86_EFLAGS_TF


	)

87 
	#IF_MASK
 
X86_EFLAGS_IF


	)

89 
	#UPROBES_TRAMP_LEN
 (
MAX_INSN_SIZE
+(
k¥obe_›code_t
))

	)

90 
	#UPROBES_TRAMP_INSN_IDX
 0

	)

91 
	#UPROBES_TRAMP_RET_BREAK_IDX
 
MAX_INSN_SIZE


	)

92 
	#KPROBES_TRAMP_LEN
 
MAX_INSN_SIZE


	)

93 
	#KPROBES_TRAMP_INSN_IDX
 0

	)

95 
ölöe
 
	$¨ch_gë_èsk_pc
(
èsk_°ru˘
 *
p
)

99 
	}
}

101 
ölöe
 
	$¨ch_£t_èsk_pc
(
èsk_°ru˘
 *
p
, 
vÆ
)

104 
	}
}

106 
ölöe
 
±_ªgs
 *
	$dbi_gë_sysˇŒ_uªgs
(
•
)

108  
NULL
;

109 
	}
}

111 
ölöe
 
	$dbi_gë_°ack_±r
(
±_ªgs
 *
ªgs
)

113  
ªgs
->
	`EREG
(
•
);

114 
	}
}

116 
ölöe
 
	$dbi_gë_ö°r_±r
(
±_ªgs
 *
ªgs
)

118  
ªgs
->
	`EREG
(
ù
);

119 
	}
}

121 
ölöe
 
	$dbi_£t_ö°r_±r
(
±_ªgs
 *
ªgs
, 
vÆ
)

123 
ªgs
->
	`EREG
(
ù
Ë
vÆ
;

124 
	}
}

126 
ölöe
 
	$dbi_gë_ªt_addr
(
±_ªgs
 *
ªgs
)

128 
addr
 = 0;

129 
	`ªad_¥oc_vm_©omic
(
cuºít
, 
ªgs
->
	`EREG
(
•
), &
addr
, (addr));

130  
addr
;

131 
	}
}

133 
ölöe
 
	$dbi_£t_ªt_addr
(
±_ªgs
 *
ªgs
, 
vÆ
)

135 
	`wrôe_¥oc_vm_©omic
(
cuºít
, 
ªgs
->
	`EREG
(
•
), &
vÆ
, (val));

136 
	}
}

138 
ölöe
 
	$dbi_gë_¨g
(
±_ªgs
 *
ªgs
, 
num
)

140 
¨g
 = 0;

141 
	`ªad_¥oc_vm_©omic
(
cuºít
, 
ªgs
->
	`EREG
(
•
Ë+ (1 + 
num
) * 4,

142 &
¨g
, (arg));

143  
¨g
;

144 
	}
}

146 
ölöe
 
	$dbi_£t_¨g
(
±_ªgs
 *
ªgs
, 
num
, 
vÆ
)

148 
	`wrôe_¥oc_vm_©omic
(
cuºít
, 
ªgs
->
	`EREG
(
•
Ë+ (1 + 
num
) * 4,

149 &
vÆ
, (val));

150 
	}
}

152 
ölöe
 
	$dbi_Â_backåa˚
(
èsk_°ru˘
 *
èsk
, *
buf
,

153 
max_˙t
)

155 
i
 = 0;

156 
±_ªgs
 *
ªgs
;

159 
√xt
;

160 
øddr
;

161 } 
‰ame
;

164 
ªgs
 = 
	`èsk_±_ªgs
(
èsk
);

165 
‰ame
.
√xt
 = 
ªgs
->
	`EREG
(
bp
);

166 
‰ame
.
øddr
 = 
	`dbi_gë_ªt_addr
(
ªgs
);

168 
‰ame
.
√xt
 && 
i
 < 
max_˙t
) {

169 i‡(
	`ªad_¥oc_vm_©omic
(
èsk
, 
‰ame
.
√xt
, &frame, (frame))

170 =(
‰ame
))

171 
buf
[
i
++] = 
‰ame
.
øddr
;

176  
i
;

177 
	}
}

179 
k¥obe_ex˚±i⁄s_nŸify
 (
nŸifõr_block
 *
£lf
, 
vÆ
, *
d©a
);

181 
	s¥ev_k¥obe
 {

182 
k¥obe
 *
	mkp
;

183 
	m°©us
;

187 
	sk¥obe_˘lblk
 {

188 
	mk¥obe_°©us
;

189 
¥ev_k¥obe
 
	m¥ev_k¥obe
;

190 
±_ªgs
 
	mj¥obe_ßved_ªgs
;

191 
	mk¥obe_ﬁd_eÊags
;

192 
	mk¥obe_ßved_eÊags
;

193 *
	mj¥obe_ßved_e•
;

194 
k¥obe_›code_t
 
	mj¥obes_°ack
[
MAX_STACK_SIZE
];

198 
k¥obe_Áu…_h™dÀr
 (
±_ªgs
 *
ªgs
, 
å≠ƒ
);

201 
	s¨ch_•ecific_ö¢
 {

203 
k¥obe_›code_t
 *
	mö¢
;

208 
	mboo°abÀ
;

211 
	$k¥obe_›code_t
 (*
	tíåy_poöt_t
) (, , , , , );

213 
	`¨ch_öô_moduÀ_dïs
();

215 
¶Ÿ_m™agî
;

216 
kªçrobe_ö°™˚
;

218 
	`¨ch_¥ï¨e_k¥obe
(
k¥obe
 *
p
, 
¶Ÿ_m™agî
 *
sm
);

219 
	`¨ch_¨m_k¥obe
(
k¥obe
 *
p
);

220 
	`¨ch_dißrm_k¥obe
(
k¥obe
 *
p
);

221 
	`¨ch_¥ï¨e_kªçrobe
(
kªçrobe_ö°™˚
 *
ri
, 
±_ªgs
 *
ªgs
);

222 
	`kªçrobe_åampﬁöe
();

224 
	`ª°‹e_¥evious_k¥obe
(
k¥obe_˘lblk
 *
kcb
);

225 
	`ˇn_boo°
(
k¥obe_›code_t
 *
›codes
);

226 
ölöe
 
	$¨ch_check_ö¢
(
¨ch_•ecific_ö¢
 *
aö¢
)

229 
	}
}

231 
ölöe
 
	$sw≠_gë_k¨g
(
±_ªgs
 *
ªgs
, 
n
)

233 
n
) {

235  
ªgs
->
ax
;

237  
ªgs
->
dx
;

239  
ªgs
->
cx
;

247  *((*)
	`kî√l_°ack_poöãr
(
ªgs
Ë+ 
n
 - 2);

248 
	}
}

250 
ölöe
 
	$sw≠_gë_ßrg
(
±_ªgs
 *
ªgs
, 
n
)

253  *((*)
	`kî√l_°ack_poöãr
(
ªgs
Ë+ 
n
 + 1);

254 
	}
}

256 
¨ch_öô_k¥obes
();

257 
¨ch_exô_k¥obes
();

	@kprobe/arch/asm-x86/dbi_kprobes_deps.c

48 
	~<k¥obe/dbi_k¥obes_dïs.h
>

50 
	$DECLARE_MOD_DEP_WRAPPER
 (
moduÀ_Æloc
, *, 
size
)

51 
	$IMP_MOD_DEP_WRAPPER
 (
moduÀ_Æloc
, 
size
)

53 
	$DECLARE_MOD_DEP_WRAPPER
 (
moduÀ_‰ì
, , 
moduÀ
 *
mod
, *
moduÀ_ªgi⁄
)

54 
	$IMP_MOD_DEP_WRAPPER
 (
moduÀ_‰ì
, 
mod
, 
moduÀ_ªgi⁄
)

56 
	$DECLARE_MOD_DEP_WRAPPER
 (
fixup_ex˚±i⁄
, , 
±_ªgs
 * 
ªgs
)

57 
	$IMP_MOD_DEP_WRAPPER
 (
fixup_ex˚±i⁄
, 
ªgs
)

59 #i‡(
LINUX_VERSION_CODE
 < 
	`KERNEL_VERSION
(2, 6, 26))

60 
	`DECLARE_MOD_DEP_WRAPPER
(
ãxt_poke
, \

61 , *
addr
, *
›code
, 
Àn
)

63 
	`DECLARE_MOD_DEP_WRAPPER
(
ãxt_poke
, \

64 *, *
addr
, c⁄° *
›code
, 
size_t
 
Àn
)

66 
	$IMP_MOD_DEP_WRAPPER
(
ãxt_poke
, 
addr
, 
›code
, 
Àn
)

68 
	$DECLARE_MOD_DEP_WRAPPER
(
show_ªgi°îs
, , 
±_ªgs
 * 
ªgs
)

69 
	`IMP_MOD_DEP_WRAPPER
(
show_ªgi°îs
, 
ªgs
)

	@kprobe/dbi_insn_slots.c

48 
	~"dbi_ö¢_¶Ÿs.h
"

49 
	~<löux/moduÀ.h
>

50 
	~<löux/rculi°.h
>

51 
	~<löux/¶ab.h
>

52 
	~<löux/•ölock.h
>

53 
	~<k¥obe/dbi_k¥obes_dïs.h
>

55 
	schunk
 {

56 *
	md©a
;

57 
	mfú°_avaûabÀ
;

58 
	mcou¡_avaûabÀ
;

60 
•ölock_t
 
	mlock
;

61 
	msize
;

62 *
	mödex
;

65 
	sfixed_Æloc


67 
hli°_node
 
	mhli°
;

68 
chunk
 
	mchunk
;

71 
	$chunk_öô
(
chunk
 *chunk, *
d©a
, 
size_t
 
size
, size_à
size_block
)

73 
i
;

74 *
p
;

76 
	`•ö_lock_öô
(&
chunk
->
lock
);

77 
chunk
->
d©a
 = (*)data;

78 
chunk
->
fú°_avaûabÀ
 = 0;

79 
chunk
->
cou¡_avaûabÀ
 = 
size
 / 
size_block
;

80 
chunk
->
size
 = chunk->
cou¡_avaûabÀ
;

82 
chunk
->
ödex
 = 
	`kmÆloc
((*chunk->ödex)*chunk->
cou¡_avaûabÀ
, 
GFP_ATOMIC
);

84 
p
 = 
chunk
->
ödex
;

85 
i
 = 0; i !
chunk
->
cou¡_avaûabÀ
; ++
p
) {

86 *
p
 = ++
i
;

88 
	}
}

90 
	$chunk_unöô
(
chunk
 *chunk)

92 
	`k‰ì
(
chunk
->
ödex
);

93 
	}
}

95 * 
	$chunk_Æloˇã
(
chunk
 *chunk, 
size_t
 
size_block
)

97 *
ªt
;

99 i‡(!
chunk
->
cou¡_avaûabÀ
) {

100  
NULL
;

103 
	`•ö_lock
(&
chunk
->
lock
);

104 
ªt
 = 
chunk
->
d©a
 + chunk->
fú°_avaûabÀ
*
size_block
;

105 
chunk
->
fú°_avaûabÀ
 = chunk->
ödex
[chunk->first_available];

106 --
chunk
->
cou¡_avaûabÀ
;

107 
	`•ö_u∆ock
(&
chunk
->
lock
);

109  
ªt
;

110 
	}
}

112 
	$chunk_dóŒoˇã
(
chunk
 *chunk, *
p
, 
size_t
 
size_block
)

114 
idx
 = ((*)
p
 - 
chunk
->
d©a
)/
size_block
;

116 
	`•ö_lock
(&
chunk
->
lock
);

117 
chunk
->
ödex
[
idx
] = chunk->
fú°_avaûabÀ
;

118 
chunk
->
fú°_avaûabÀ
 = 
idx
;

119 ++
chunk
->
cou¡_avaûabÀ
;

120 
	`•ö_u∆ock
(&
chunk
->
lock
);

121 
	}
}

123 
ölöe
 
	$chunk_check_±r
(
chunk
 *chunk, *
p
, 
size_t
 
size
)

125 i‡(–
chunk
->
d©a
 <(*)
p
) &&

126 ((
chunk
->
d©a
 + 
size
/(chunk->d©a)Ë> (*)
p
)) {

131 
	}
}

133 
ölöe
 
	$chunk_‰ì
(
chunk
 *chunk)

135  (
chunk
->
cou¡_avaûabÀ
 =chunk->
size
);

136 
	}
}

138 
fixed_Æloc
 *
	$¸óã_fixed_Æloc
(
¶Ÿ_m™agî
 *
sm
)

140 *
d©a
;

141 
fixed_Æloc
 *
Á
;

143 
Á
 = 
	`kmÆloc
((*Á), 
GFP_ATOMIC
);

144 i‡(
Á
 =
NULL
) {

145  
NULL
;

148 
d©a
 = 
sm
->
	`Æloc
(sm);

149 if(
d©a
 =
NULL
) {

150 
	`k‰ì
(
Á
);

151  
NULL
;

154 
	`chunk_öô
(&
Á
->
chunk
, 
d©a
, 
PAGE_SIZE
/(), 
sm
->
¶Ÿ_size
);

156  
Á
;

157 
	}
}

159 
	$‰ì_fixed_Æloc
(
¶Ÿ_m™agî
 *
sm
, 
fixed_Æloc
 *
Á
)

161 
	`chunk_unöô
(&
Á
->
chunk
);

162 
sm
->
	`‰ì
(sm, 
Á
->
chunk
.
d©a
);

163 
	`k‰ì
(
Á
);

164 
	}
}

167 *
	$Æloc_ö¢_¶Ÿ
(
¶Ÿ_m™agî
 *
sm
)

169 *
‰ì_¶Ÿ
;

170 
fixed_Æloc
 *
Á
;

171 
	`DECLARE_NODE_PTR_FOR_HLIST
(
pos
);

173 
	`sw≠_hli°_f‹_óch_íåy_rcu
(
Á
, 
pos
, &
sm
->
∑ge_li°
, 
hli°
) {

174 
‰ì_¶Ÿ
 = 
	`chunk_Æloˇã
(&
Á
->
chunk
, 
sm
->
¶Ÿ_size
);

175 i‡(
‰ì_¶Ÿ
)

176  
‰ì_¶Ÿ
;

179 
Á
 = 
	`¸óã_fixed_Æloc
(
sm
);

180 if(
Á
 =
NULL
)

181  
NULL
;

183 
	`INIT_HLIST_NODE
(&
Á
->
hli°
);

184 
	`hli°_add_hód_rcu
(&
Á
->
hli°
, &
sm
->
∑ge_li°
);

186  
	`chunk_Æloˇã
(&
Á
->
chunk
, 
sm
->
¶Ÿ_size
);

187 
	}
}

188 
EXPORT_SYMBOL_GPL
(
Æloc_ö¢_¶Ÿ
);

190 
	$‰ì_ö¢_¶Ÿ
(
¶Ÿ_m™agî
 *
sm
, *
¶Ÿ
)

192 
fixed_Æloc
 *
Á
;

193 
	`DECLARE_NODE_PTR_FOR_HLIST
(
pos
);

195 i‡(
¶Ÿ
 =
NULL
)

198 
	`sw≠_hli°_f‹_óch_íåy_rcu
(
Á
, 
pos
, &
sm
->
∑ge_li°
, 
hli°
) {

199 i‡(!
	`chunk_check_±r
(&
Á
->
chunk
, 
¶Ÿ
, 
PAGE_SIZE
))

202 
	`chunk_dóŒoˇã
(&
Á
->
chunk
, 
¶Ÿ
, 
sm
->
¶Ÿ_size
);

204 i‡(
	`chunk_‰ì
(&
Á
->
chunk
)) {

205 
	`hli°_dñ_rcu
(&
Á
->
hli°
);

206 
	`‰ì_fixed_Æloc
(
sm
, 
Á
);

212 
	`∑nic
("‰ì_ö¢_¶Ÿ: slŸ=%∞i†nŸ d©®ba£\n", 
¶Ÿ
);

213 
	}
}

214 
EXPORT_SYMBOL_GPL
(
‰ì_ö¢_¶Ÿ
);

	@kprobe/dbi_insn_slots.h

1 #i‚de‡
_DBI_INSNS_SLOTS_H


2 
	#_DBI_INSNS_SLOTS_H


	)

51 
	~<löux/ty≥s.h
>

53 
	s¶Ÿ_m™agî
 {

54 
	m¶Ÿ_size
;

55 *(*
	mÆloc
)(
¶Ÿ_m™agî
 *
	msm
);

56 (*
	m‰ì
)(
¶Ÿ_m™agî
 *
	msm
, *
	m±r
);

57 
hli°_hód
 
	m∑ge_li°
;

58 *
	md©a
;

61 *
Æloc_ö¢_¶Ÿ
(
¶Ÿ_m™agî
 *
sm
);

62 
‰ì_ö¢_¶Ÿ
(
¶Ÿ_m™agî
 *
sm
, *
¶Ÿ
);

	@kprobe/dbi_kdebug.h

1 #i‚de‡
_DBI_KPROBE_DEBUG_H


2 
	#_DBI_KPROBE_DEBUG_H


	)

32 #ifde‡
_DEBUG


33 
	#DBPRINTF
(
f‹m©
, 
¨gs
...) do { \

35 *
f
 = 
__FILE__
; \

36 *
n
 = 
	`°ºchr
(
f
, '/'); \

37 
	`¥ötk
("%†: %u : %†: " 
f‹m©
 "\n" , (
n
Ë?Ç+1 : 
f
, 
__LINE__
, 
__FUNCTION__
, ##
¨gs
); \

39 } 0)

	)

41 
	#DBPRINTF
(
f‹m©
, 
¨gs
...)

	)

	@kprobe/dbi_kprobes.c

49 
	~"dbi_k¥obes.h
"

50 
	~<k¥obe/¨ch/asm/dbi_k¥obes.h
>

52 
	~"dbi_kdebug.h
"

53 
	~"dbi_k¥obes_dïs.h
"

54 
	~"dbi_ö¢_¶Ÿs.h
"

55 
	~<ksyms/ksyms.h
>

57 
	~<löux/vîsi⁄.h
>

58 #i‡
LINUX_VERSION_CODE
 < 
KERNEL_VERSION
(2,6,19)

59 
	~<löux/c⁄fig.h
>

62 
	~<löux/hash.h
>

63 
	~<löux/moduÀ.h
>

64 
	~<löux/mm.h
>

65 
	~<löux/∑gem≠.h
>

67 
	gsched_addr
;

68 
	gexô_addr
;

69 
	gdo_group_exô_addr
;

70 
	gsys_exô_group_addr
;

71 
	gsys_exô_addr
;

73 
¶Ÿ_m™agî
 
	gsm
;

75 
DEFINE_PER_CPU
(
k¥obe
 *, 
cuºít_k¥obe
Ë
NULL
;

76 
DEFINE_PER_CPU
(
k¥obe_˘lblk
, kprobe_ctlblk);

78 
DEFINE_SPINLOCK
(
kªçrobe_lock
);

79 
DEFINE_PER_CPU
(
k¥obe
 *, 
k¥obe_ö°™˚
Ë
NULL
;

81 
hli°_hód
 
	gk¥obe_èbÀ
[
KPROBE_TABLE_SIZE
];

82 
hli°_hód
 
	gkªçrobe_ö°_èbÀ
[
KPROBE_TABLE_SIZE
];

84 
©omic_t
 
	gk¥obe_cou¡
;

85 
EXPORT_SYMBOL_GPL
(
k¥obe_cou¡
);

88 *(*
	gmoduÀ_Æloc
)(
	gsize
Ë
NULL
;

89 *(*
	gmoduÀ_‰ì
)(
moduÀ
 *
	gmod
, *
	gmoduÀ_ªgi⁄
Ë
NULL
;

91 *
	$__wøµî_moduÀ_Æloc
(
size
)

93  
	`moduÀ_Æloc
(
size
);

94 
	}
}

96 *
	$__wøµî_moduÀ_‰ì
(*
moduÀ_ªgi⁄
)

98  
	`moduÀ_‰ì
(
NULL
, 
moduÀ_ªgi⁄
);

99 
	}
}

101 *
	$sm_Æloc
(
¶Ÿ_m™agî
 *
sm
)

103  
	`__wøµî_moduÀ_Æloc
(
PAGE_SIZE
);

104 
	}
}

106 
	$sm_‰ì
(
¶Ÿ_m™agî
 *
sm
, *
±r
)

108 
	`__wøµî_moduÀ_‰ì
(
±r
);

109 
	}
}

111 
	$öô_sm
()

113 
sm
.
¶Ÿ_size
 = 
KPROBES_TRAMP_LEN
;

114 
sm
.
Æloc
 = 
sm_Æloc
;

115 
sm
.
‰ì
 = 
sm_‰ì
;

116 
	`INIT_HLIST_HEAD
(&
sm
.
∑ge_li°
);

117 
	}
}

119 
	$exô_sm
()

122 
	}
}

124 
	$kªçrobe_as£π
(
kªçrobe_ö°™˚
 *
ri
, 
‹ig_ªt_addªss
, 
åampﬁöe_addªss
)

126 i‡(!
‹ig_ªt_addªss
 || (‹ig_ªt_addªs†=
åampﬁöe_addªss
)) {

127 
èsk_°ru˘
 *
èsk
;

128 i‡(
ri
 =
NULL
) {

129 
	`∑nic
("kretprobe BUG!:Ñi = NULL\n");

132 
èsk
 = 
ri
->task;

134 i‡(
èsk
 =
NULL
) {

135 
	`∑nic
("kretprobe BUG!:Åask = NULL\n");

138 i‡(
ri
->
Ω
 =
NULL
) {

139 
	`∑nic
("kretprobe BUG!:Ñi->rp = NULL\n");

142 
	`∑nic
("kretprobe BUG!: Processing kretprobe %p @ %p (%d/%d - %s)\n",

143 
ri
->
Ω
,Ñi->Ω->
kp
.
addr
,Ñi->
èsk
->
tgid
,Ñi->èsk->
pid
,Ñi->èsk->
comm
);

145 
	}
}

148 
ölöe
 
	$£t_k¥obe_ö°™˚
(
k¥obe
 *
kp
)

150 
	`__gë_˝u_v¨
(
k¥obe_ö°™˚
Ë
kp
;

151 
	}
}

153 
ölöe
 
	$ª£t_k¥obe_ö°™˚
()

155 
	`__gë_˝u_v¨
(
k¥obe_ö°™˚
Ë
NULL
;

156 
	}
}

159 
k¥obe
 *
	$k¥obe_ru¬ög
()

161  
	`__gë_˝u_v¨
(
cuºít_k¥obe
);

162 
	}
}

164 
	$ª£t_cuºít_k¥obe
()

166 
	`__gë_˝u_v¨
(
cuºít_k¥obe
Ë
NULL
;

167 
	}
}

169 
k¥obe_˘lblk
 *
	$gë_k¥obe_˘lblk
()

171  &
	`__gë_˝u_v¨
(
k¥obe_˘lblk
);

172 
	}
}

180 
k¥obe
 *
	$gë_k¥obe
(*
addr
)

182 
hli°_hód
 *
hód
;

183 
k¥obe
 *
p
;

184 
	`DECLARE_NODE_PTR_FOR_HLIST
(
node
);

186 
hód
 = &
k¥obe_èbÀ
[
	`hash_±r
 (
addr
, 
KPROBE_HASH_BITS
)];

187 
	`sw≠_hli°_f‹_óch_íåy_rcu
(
p
, 
node
, 
hód
, 
hli°
) {

188 i‡(
p
->
addr
 ==áddr) {

189  
p
;

193  
NULL
;

194 
	}
}

200 
	$aggr_¥e_h™dÀr
(
k¥obe
 *
p
, 
±_ªgs
 *
ªgs
)

202 
k¥obe
 *
kp
;

203 
ªt
;

205 
	`li°_f‹_óch_íåy_rcu
(
kp
, &
p
->
li°
,Üist) {

206 i‡(
kp
->
¥e_h™dÀr
) {

207 
	`£t_k¥obe_ö°™˚
(
kp
);

208 
ªt
 = 
kp
->
	`¥e_h™dÀr
(kp, 
ªgs
);

209 i‡(
ªt
)

210  
ªt
;

212 
	`ª£t_k¥obe_ö°™˚
();

216 
	}
}

218 
	$aggr_po°_h™dÀr
(
k¥obe
 *
p
, 
±_ªgs
 *
ªgs
, 
Êags
)

220 
k¥obe
 *
kp
;

222 
	`li°_f‹_óch_íåy_rcu
(
kp
, &
p
->
li°
,Üist) {

223 i‡(
kp
->
po°_h™dÀr
) {

224 
	`£t_k¥obe_ö°™˚
(
kp
);

225 
kp
->
	`po°_h™dÀr
(kp, 
ªgs
, 
Êags
);

226 
	`ª£t_k¥obe_ö°™˚
();

229 
	}
}

231 
	$aggr_Áu…_h™dÀr
(
k¥obe
 *
p
, 
±_ªgs
 *
ªgs
, 
å≠ƒ
)

233 
k¥obe
 *
cur
 = 
	`__gë_˝u_v¨
(
k¥obe_ö°™˚
);

239 i‡(
cur
 && cur->
Áu…_h™dÀr
) {

240 i‡(
cur
->
	`Áu…_h™dÀr
(cur, 
ªgs
, 
å≠ƒ
))

245 
	}
}

247 
	$aggr_bªak_h™dÀr
(
k¥obe
 *
p
, 
±_ªgs
 *
ªgs
)

249 
k¥obe
 *
cur
 = 
	`__gë_˝u_v¨
(
k¥obe_ö°™˚
);

250 
ªt
 = 0;

251 
	`DBPRINTF
 ("cu∏0x%p\n", 
cur
);

252 i‡(
cur
)

253 
	`DBPRINTF
 ("cu∏0x%∞cur->bªak_h™dÀ∏0x%p\n", 
cur
, cur->
bªak_h™dÀr
);

255 i‡(
cur
 && cur->
bªak_h™dÀr
) {

256 i‡(
cur
->
	`bªak_h™dÀr
(cur, 
ªgs
))

257 
ªt
 = 1;

259 
	`ª£t_k¥obe_ö°™˚
();

261  
ªt
;

262 
	}
}

265 
	$k¥obes_öc_nmis£d_cou¡
(
k¥obe
 *
p
)

267 
k¥obe
 *
kp
;

268 i‡(
p
->
¥e_h™dÀr
 !
aggr_¥e_h™dÀr
) {

269 
p
->
nmis£d
++;

271 
	`li°_f‹_óch_íåy_rcu
(
kp
, &
p
->
li°
,Üist) {

272 ++
kp
->
nmis£d
;

275 
	}
}

278 
kªçrobe_ö°™˚
 *
	$gë_‰ì_Ω_ö°
(
kªçrobe
 *
Ω
)

280 
kªçrobe_ö°™˚
 *
ri
;

281 
	`DECLARE_NODE_PTR_FOR_HLIST
(
node
);

283 
	`sw≠_hli°_f‹_óch_íåy
(
ri
, 
node
, &
Ω
->
‰ì_ö°™˚s
, 
uÊi°
) {

284  
ri
;

287 i‡(!
	`Æloc_nodes_kªçrobe
(
Ω
)) {

288 
	`sw≠_hli°_f‹_óch_íåy
(
ri
, 
node
, &
Ω
->
‰ì_ö°™˚s
, 
uÊi°
) {

289  
ri
;

293  
NULL
;

294 
	}
}

295 
EXPORT_SYMBOL_GPL
(
gë_‰ì_Ω_ö°
);

298 
kªçrobe_ö°™˚
 *
	$gë_‰ì_Ω_ö°_no_Æloc
(
kªçrobe
 *
Ω
)

300 
kªçrobe_ö°™˚
 *
ri
;

301 
	`DECLARE_NODE_PTR_FOR_HLIST
(
node
);

303 
	`sw≠_hli°_f‹_óch_íåy
(
ri
, 
node
, &
Ω
->
‰ì_ö°™˚s
, 
uÊi°
) {

304  
ri
;

307  
NULL
;

308 
	}
}

311 
kªçrobe_ö°™˚
 *
	$gë_u£d_Ω_ö°
(
kªçrobe
 *
Ω
)

313 
kªçrobe_ö°™˚
 *
ri
;

314 
	`DECLARE_NODE_PTR_FOR_HLIST
(
node
);

316 
	`sw≠_hli°_f‹_óch_íåy
(
ri
, 
node
, &
Ω
->
u£d_ö°™˚s
, 
uÊi°
) {

317  
ri
;

320  
NULL
;

321 
	}
}

322 
EXPORT_SYMBOL_GPL
(
gë_u£d_Ω_ö°
);

325 
	$add_Ω_ö°
 (
kªçrobe_ö°™˚
 *
ri
)

331 
	`hli°_dñ
(&
ri
->
uÊi°
);

334 
	`INIT_HLIST_NODE
(&
ri
->
hli°
);

336 
	`hli°_add_hód
(&
ri
->
hli°
, &
kªçrobe_ö°_èbÀ
[
	`hash_±r
‘i->
èsk
, 
KPROBE_HASH_BITS
)]);

339 
	`INIT_HLIST_NODE
(&
ri
->
uÊi°
);

340 
	`hli°_add_hód
(&
ri
->
uÊi°
, &ri->
Ω
->
u£d_ö°™˚s
);

341 
	}
}

342 
EXPORT_SYMBOL_GPL
(
add_Ω_ö°
);

345 
	$ªcy˛e_Ω_ö°
(
kªçrobe_ö°™˚
 *
ri
)

347 i‡(
ri
->
Ω
) {

348 
	`hli°_dñ
(&
ri
->
hli°
);

350 
	`hli°_dñ
(&
ri
->
uÊi°
);

352 
	`INIT_HLIST_NODE
(&
ri
->
uÊi°
);

353 
	`hli°_add_hód
(&
ri
->
uÊi°
, &ri->
Ω
->
‰ì_ö°™˚s
);

355 
	}
}

356 
EXPORT_SYMBOL_GPL
(
ªcy˛e_Ω_ö°
);

358 
hli°_hód
 *
	$kªçrobe_ö°_èbÀ_hód
(*
hash_key
)

360  &
kªçrobe_ö°_èbÀ
[
	`hash_±r
(
hash_key
, 
KPROBE_HASH_BITS
)];

361 
	}
}

362 
EXPORT_SYMBOL_GPL
(
kªçrobe_ö°_èbÀ_hód
);

364 
	$‰ì_Ω_ö°
(
kªçrobe
 *
Ω
)

366 
kªçrobe_ö°™˚
 *
ri
;

367 (
ri
 = 
	`gë_‰ì_Ω_ö°_no_Æloc
(
Ω
)Ë!
NULL
) {

368 
	`hli°_dñ
(&
ri
->
uÊi°
);

369 
	`k‰ì
(
ri
);

371 
	}
}

372 
EXPORT_SYMBOL_GPL
(
‰ì_Ω_ö°
);

377 
ölöe
 
	$c›y_k¥obe
(
k¥obe
 *
ﬁd_p
, k¥obê*
p
)

379 
	`mem˝y
(&
p
->
›code
, &
ﬁd_p
->›code, (
k¥obe_›code_t
));

380 
	`mem˝y
(&
p
->
aö¢
, &
ﬁd_p
->aö¢, (
¨ch_•ecific_ö¢
));

381 
p
->
ss_addr
 = 
ﬁd_p
->ss_addr;

382 #ifde‡
CONFIG_ARM


383 
p
->
ß„_¨m
 = 
ﬁd_p
->safe_arm;

384 
p
->
ß„_thumb
 = 
ﬁd_p
->safe_thumb;

386 
	}
}

392 
	$add_√w_k¥obe
(
k¥obe
 *
ﬁd_p
, k¥obê*
p
)

394 i‡(
p
->
bªak_h™dÀr
) {

395 i‡(
ﬁd_p
->
bªak_h™dÀr
) {

396  -
EEXIST
;

399 
	`li°_add_èû_rcu
(&
p
->
li°
, &
ﬁd_p
->list);

400 
ﬁd_p
->
bªak_h™dÀr
 = 
aggr_bªak_h™dÀr
;

402 
	`li°_add_rcu
(&
p
->
li°
, &
ﬁd_p
->list);

405 i‡(
p
->
po°_h™dÀr
 && !
ﬁd_p
->post_handler) {

406 
ﬁd_p
->
po°_h™dÀr
 = 
aggr_po°_h™dÀr
;

410 
	}
}

419 
ölöe
 
	$dbi_hli°_ª∂a˚_rcu
(
hli°_node
 *
ﬁd
, hli°_nodê*
√w
)

421 
hli°_node
 *
√xt
 = 
ﬁd
->next;

423 
√w
->
√xt
 =Çext;

424 
√w
->
µªv
 = 
ﬁd
->pprev;

425 
	`smp_wmb
();

426 i‡(
√xt
)

427 
√w
->
√xt
->
µªv
 = &new->next;

428 i‡(
√w
->
µªv
)

429 *
√w
->
µªv
 =Çew;

430 
ﬁd
->
µªv
 = 
LIST_POISON2
;

431 
	}
}

437 
ölöe
 
	$add_aggr_k¥obe
(
k¥obe
 *
≠
, k¥obê*
p
)

439 
	`c›y_k¥obe
(
p
, 
≠
);

440 
≠
->
addr
 = 
p
->addr;

441 
≠
->
¥e_h™dÀr
 = 
aggr_¥e_h™dÀr
;

442 
≠
->
Áu…_h™dÀr
 = 
aggr_Áu…_h™dÀr
;

443 i‡(
p
->
po°_h™dÀr
)

444 
≠
->
po°_h™dÀr
 = 
aggr_po°_h™dÀr
;

445 i‡(
p
->
bªak_h™dÀr
)

446 
≠
->
bªak_h™dÀr
 = 
aggr_bªak_h™dÀr
;

448 
	`INIT_LIST_HEAD
(&
≠
->
li°
);

449 
	`li°_add_rcu
(&
p
->
li°
, &
≠
->list);

451 
	`dbi_hli°_ª∂a˚_rcu
(&
p
->
hli°
, &
≠
->hlist);

452 
	}
}

458 
	$ªgi°î_aggr_k¥obe
(
k¥obe
 *
ﬁd_p
, k¥obê*
p
)

460 
ªt
 = 0;

461 
k¥obe
 *
≠
;

462 
	`DBPRINTF
 ("start\n");

464 
	`DBPRINTF
 ("∞%∞ﬁd_∞%∞\n", 
p
, 
ﬁd_p
);

465 i‡(
ﬁd_p
->
¥e_h™dÀr
 =
aggr_¥e_h™dÀr
) {

466 
	`DBPRINTF
 ("aggr_pre_handler \n");

468 
	`c›y_k¥obe
(
ﬁd_p
, 
p
);

469 
ªt
 = 
	`add_√w_k¥obe
(
ﬁd_p
, 
p
);

471 
	`DBPRINTF
 ("kzalloc\n");

472 #ifde‡
kzÆloc


473 
≠
 = 
	`kzÆloc
((
k¥obe
), 
GFP_KERNEL
);

475 
≠
 = 
	`kmÆloc
((
k¥obe
), 
GFP_KERNEL
);

476 i‡(
≠
)

477 
	`mem£t
(
≠
, 0, (
k¥obe
));

479 i‡(!
≠
)

480  -
ENOMEM
;

481 
	`add_aggr_k¥obe
(
≠
, 
ﬁd_p
);

482 
	`c›y_k¥obe
(
≠
, 
p
);

483 
	`DBPRINTF
 ("≠ = %∞∞%∞ﬁd_∞%∞\n", 
≠
, 
p
, 
ﬁd_p
);

484 
ªt
 = 
	`add_√w_k¥obe
(
≠
, 
p
);

487  
ªt
;

488 
	}
}

489 
EXPORT_SYMBOL_GPL
(
ªgi°î_aggr_k¥obe
);

491 
	$ªmove_k¥obe
(
k¥obe
 *
p
)

494 
	`‰ì_ö¢_¶Ÿ
(&
sm
, 
p
->
aö¢
.
ö¢
);

495 
	}
}

497 
	$dbi_ªgi°î_k¥obe
(
k¥obe
 *
p
)

499 
k¥obe
 *
ﬁd_p
;

500 
ªt
 = 0;

506 i‡(
p
->
symbﬁ_«me
) {

507 i‡(
p
->
addr
)

508  -
EINVAL
;

509 
p
->
addr
 = (
k¥obe_›code_t
 *)
	`sw≠_ksyms
’->
symbﬁ_«me
);

512 i‡(!
p
->
addr
)

513  -
EINVAL
;

514 
	`DBPRINTF
 ("p->add∏0x%p\n", 
p
->
addr
);

515 
p
->
addr
 = (
k¥obe_›code_t
 *)(((*Ì->addrË+Ö->
off£t
);

516 
	`DBPRINTF
 ("p->add∏0x%∞∞0x%p\n", 
p
->
addr
,Ö);

518 #ifde‡
KPROBES_PROFILE


519 
p
->
°¨t_tm
.
tv_£c
 =Ö->°¨t_tm.
tv_u£c
 = 0;

520 
p
->
hnd_tm_sum
.
tv_£c
 =Ö->hnd_tm_sum.
tv_u£c
 = 0;

521 
p
->
cou¡
 = 0;

523 
p
->
mod_ªfcou¡ed
 = 0;

524 
p
->
nmis£d
 = 0;

525 
	`INIT_LIST_HEAD
(&
p
->
li°
);

527 
ﬁd_p
 = 
	`gë_k¥obe
(
p
->
addr
);

528 i‡(
ﬁd_p
) {

529 
ªt
 = 
	`ªgi°î_aggr_k¥obe
(
ﬁd_p
, 
p
);

530 i‡(!
ªt
)

531 
	`©omic_öc
(&
k¥obe_cou¡
);

532 
out
;

535 i‡((
ªt
 = 
	`¨ch_¥ï¨e_k¥obe
(
p
, &
sm
)) != 0)

536 
out
;

538 
	`DBPRINTF
 ("bef‹êouàªà0x%x\n", 
ªt
);

539 
	`INIT_HLIST_NODE
(&
p
->
hli°
);

540 
	`hli°_add_hód_rcu
(&
p
->
hli°
, &
k¥obe_èbÀ
[
	`hash_±r
’->
addr
, 
KPROBE_HASH_BITS
)]);

541 
	`¨ch_¨m_k¥obe
(
p
);

543 
out
:

544 
	`DBPRINTF
 ("ouàªà0x%x\n", 
ªt
);

545  
ªt
;

546 
	}
}

548 
	$dbi_uƒegi°î_vÆid_k¥obe
(
k¥obe
 *
p
, k¥obê*
ﬁd_p
)

550 
k¥obe
 *
li°_p
;

552 i‡((
ﬁd_p
 =
p
Ë|| ((ﬁd_p->
¥e_h™dÀr
 =
aggr_¥e_h™dÀr
) &&

553 (
p
->
li°
.
√xt
 =&
ﬁd_p
->li°Ë&& (p->li°.
¥ev
 == &old_p->list))) {

555 
	`¨ch_dißrm_k¥obe
(
p
);

556 
	`hli°_dñ_rcu
(&
ﬁd_p
->
hli°
);

558 i‡(
p
 !
ﬁd_p
)

559 
	`k‰ì
(
ﬁd_p
);

562 
	`li°_dñ_rcu
(&
p
->
li°
);

564 i‡(
p
->
bªak_h™dÀr
)

565 
ﬁd_p
->
bªak_h™dÀr
 = 
NULL
;

566 i‡(
p
->
po°_h™dÀr
) {

567 
	`li°_f‹_óch_íåy_rcu
(
li°_p
, &
ﬁd_p
->
li°
,Üist)

568 i‡(
li°_p
->
po°_h™dÀr
)

571 
ﬁd_p
->
po°_h™dÀr
 = 
NULL
;

575 i‡(
p
->
symbﬁ_«me
)

576 
p
->
addr
 = 
NULL
;

577 
	}
}

579 
	$dbi_uƒegi°î_k¥obe
(
k¥obe
 *
kp
)

581 
k¥obe
 *
ﬁd_p
, *
li°_p
;

583 
ﬁd_p
 = 
	`gë_k¥obe
(
kp
->
addr
);

584 i‡(
	`u∆ikñy
 (!
ﬁd_p
))

587 i‡(
kp
 !
ﬁd_p
) {

588 
	`li°_f‹_óch_íåy_rcu
(
li°_p
, &
ﬁd_p
->
li°
,Üist)

589 i‡(
li°_p
 =
kp
)

591 
	`dbi_uƒegi°î_vÆid_k¥obe
(
kp
, 
ﬁd_p
);

595 
	`dbi_uƒegi°î_vÆid_k¥obe
(
kp
, 
ﬁd_p
);

596 
	}
}

598 
	$dbi_ªgi°î_j¥obe
(
j¥obe
 *
jp
)

601 
jp
->
kp
.
¥e_h™dÀr
 = 
£tjmp_¥e_h™dÀr
;

602 
jp
->
kp
.
bªak_h™dÀr
 = 
l⁄gjmp_bªak_h™dÀr
;

604  
	`dbi_ªgi°î_k¥obe
(&
jp
->
kp
);

605 
	}
}

607 
	$dbi_uƒegi°î_j¥obe
(
j¥obe
 *
jp
)

609 
	`dbi_uƒegi°î_k¥obe
(&
jp
->
kp
);

610 
	}
}

616 
	$¥e_h™dÀr_kªçrobe
(
k¥obe
 *
p
, 
±_ªgs
 *
ªgs
)

618 
kªçrobe
 *
Ω
 = 
	`c⁄èöî_of
(
p
, kªçrobe, 
kp
);

619 
kªçrobe_ö°™˚
 *
ri
;

620 
Êags
 = 0;

623 
	`•ö_lock_úqßve
(&
kªçrobe_lock
, 
Êags
);

626 i‡((
ri
 = 
	`gë_‰ì_Ω_ö°
(
Ω
)Ë!
NULL
) {

627 
ri
->
Ω
 =Ñp;

628 
ri
->
èsk
 = 
cuºít
;

630 i‡(
Ω
->
íåy_h™dÀr
) {

631 
Ω
->
	`íåy_h™dÀr
(
ri
, 
ªgs
);

634 
	`¨ch_¥ï¨e_kªçrobe
(
ri
, 
ªgs
);

636 
	`add_Ω_ö°
(
ri
);

638 ++
Ω
->
nmis£d
;

641 
	`•ö_u∆ock_úqª°‹e
(&
kªçrobe_lock
, 
Êags
);

644 
	}
}

646 
	$åampﬁöe_¥obe_h™dÀr
(
k¥obe
 *
p
, 
±_ªgs
 *
ªgs
)

648 
kªçrobe_ö°™˚
 *
ri
 = 
NULL
;

649 
hli°_hód
 *
hód
;

650 
Êags
, 
‹ig_ªt_addªss
 = 0;

651 
åampﬁöe_addªss
 = ()&
kªçrobe_åampﬁöe
;

653 
k¥obe_˘lblk
 *
kcb
;

655 
hli°_node
 *
tmp
;

656 
	`DECLARE_NODE_PTR_FOR_HLIST
(
node
);

658 
	`¥ìm±_dißbÀ
();

659 
kcb
 = 
	`gë_k¥obe_˘lblk
();

661 
	`•ö_lock_úqßve
(&
kªçrobe_lock
, 
Êags
);

669 
hód
 = 
	`kªçrobe_ö°_èbÀ_hód
(
cuºít
);

671 #ifde‡
CONFIG_X86


672 
ªgs
->
	`XREG
(
cs
Ë
__KERNEL_CS
 | 
	`gë_kî√l_Ωl
();

673 
ªgs
->
	`EREG
(
ù
Ë
åampﬁöe_addªss
;

674 
ªgs
->
ORIG_EAX_REG
 = 0xffffffff;

690 
	`sw≠_hli°_f‹_óch_íåy_ß„
(
ri
, 
node
, 
tmp
, 
hód
, 
hli°
) {

691 i‡(
ri
->
èsk
 !
cuºít
)

694 i‡(
ri
->
Ω
 &&Ñi->Ω->
h™dÀr
) {

695 
	`__gë_˝u_v¨
(
cuºít_k¥obe
Ë&
ri
->
Ω
->
kp
;

696 
	`gë_k¥obe_˘lblk
()->
k¥obe_°©us
 = 
KPROBE_HIT_ACTIVE
;

697 
ri
->
Ω
->
	`h™dÀr
‘i, 
ªgs
);

698 
	`__gë_˝u_v¨
(
cuºít_k¥obe
Ë
NULL
;

701 
‹ig_ªt_addªss
 = ()
ri
->
ªt_addr
;

702 
	`ªcy˛e_Ω_ö°
(
ri
);

703 i‡(
‹ig_ªt_addªss
 !
åampﬁöe_addªss
)

711 
	`kªçrobe_as£π
(
ri
, 
‹ig_ªt_addªss
, 
åampﬁöe_addªss
);

713 i‡(
kcb
->
k¥obe_°©us
 =
KPROBE_REENTER
) {

714 
	`ª°‹e_¥evious_k¥obe
(
kcb
);

716 
	`ª£t_cuºít_k¥obe
();

719 
	`•ö_u∆ock_úqª°‹e
(&
kªçrobe_lock
, 
Êags
);

720 
	`¥ìm±_íabÀ_no_ªsched
();

728  ()
‹ig_ªt_addªss
;

729 
	}
}

731 
	#SCHED_RP_NR
 200

	)

732 
	#COMMON_RP_NR
 10

	)

734 
	$Æloc_nodes_kªçrobe
(
kªçrobe
 *
Ω
)

736 
Æloc_nodes
;

737 
kªçrobe_ö°™˚
 *
ö°
;

738 
i
;

740 
	`DBPRINTF
("Allocáditional mem forÑetprobes");

742 i‡(()
Ω
->
kp
.
addr
 =
sched_addr
) {

743 
Ω
->
maxa˘ive
 +
SCHED_RP_NR
;

744 
Æloc_nodes
 = 
SCHED_RP_NR
;

747 
Ω
->
maxa˘ive
 +
	`max
 (
COMMON_RP_NR
, 2 * 
NR_CPUS
);

749 
Ω
->
maxa˝±ive
 +
NR_CPUS
;

751 
Æloc_nodes
 = 
COMMON_RP_NR
;

754 
i
 = 0; i < 
Æloc_nodes
; i++) {

755 
ö°
 = 
	`kmÆloc
((*ö°Ë+ 
Ω
->
d©a_size
, 
GFP_ATOMIC
);

756 i‡(
ö°
 =
NULL
) {

757 
	`‰ì_Ω_ö°
(
Ω
);

758  -
ENOMEM
;

760 
	`INIT_HLIST_NODE
(&
ö°
->
uÊi°
);

761 
	`hli°_add_hód
(&
ö°
->
uÊi°
, &
Ω
->
‰ì_ö°™˚s
);

764 
	`DBPRINTF
 ("addr=%p, *addr=[%lx %lx %lx]", 
Ω
->
kp
.
addr
, () (*(rp->kp.addr)), () (*(rp->kp.addr + 1)), () (*(rp->kp.addr + 2)));

766 
	}
}

768 
	$dbi_ªgi°î_kªçrobe
(
kªçrobe
 *
Ω
)

770 
ªt
 = 0;

771 
kªçrobe_ö°™˚
 *
ö°
;

772 
i
;

773 
	`DBPRINTF
 ("START");

775 
Ω
->
kp
.
¥e_h™dÀr
 = 
¥e_h™dÀr_kªçrobe
;

776 
Ω
->
kp
.
po°_h™dÀr
 = 
NULL
;

777 
Ω
->
kp
.
Áu…_h™dÀr
 = 
NULL
;

778 
Ω
->
kp
.
bªak_h™dÀr
 = 
NULL
;

781 i‡(()
Ω
->
kp
.
addr
 =
exô_addr
) {

782 
Ω
->
kp
.
¥e_h™dÀr
 = 
NULL
;

783 
Ω
->
maxa˘ive
 = 0;

784 } i‡(()
Ω
->
kp
.
addr
 =
do_group_exô_addr
) {

785 
Ω
->
kp
.
¥e_h™dÀr
 = 
NULL
;

786 
Ω
->
maxa˘ive
 = 0;

787 } i‡(()
Ω
->
kp
.
addr
 =
sys_exô_group_addr
) {

788 
Ω
->
kp
.
¥e_h™dÀr
 = 
NULL
;

789 
Ω
->
maxa˘ive
 = 0;

790 } i‡(()
Ω
->
kp
.
addr
 =
sys_exô_addr
) {

791 
Ω
->
kp
.
¥e_h™dÀr
 = 
NULL
;

792 
Ω
->
maxa˘ive
 = 0;

793 } i‡(
Ω
->
maxa˘ive
 <= 0) {

795 
Ω
->
maxa˘ive
 = 
	`max
 (
COMMON_RP_NR
, 2 * 
NR_CPUS
);

797 
Ω
->
maxa˘ive
 = 
NR_CPUS
;

800 
	`INIT_HLIST_HEAD
(&
Ω
->
u£d_ö°™˚s
);

801 
	`INIT_HLIST_HEAD
(&
Ω
->
‰ì_ö°™˚s
);

802 
i
 = 0; i < 
Ω
->
maxa˘ive
; i++) {

803 
ö°
 = 
	`kmÆloc
((*ö°Ë+ 
Ω
->
d©a_size
, 
GFP_KERNEL
);

804 i‡(
ö°
 =
NULL
) {

805 
	`‰ì_Ω_ö°
(
Ω
);

806  -
ENOMEM
;

808 
	`INIT_HLIST_NODE
(&
ö°
->
uÊi°
);

809 
	`hli°_add_hód
(&
ö°
->
uÊi°
, &
Ω
->
‰ì_ö°™˚s
);

812 
	`DBPRINTF
 ("addr=%p, *addr=[%lx %lx %lx]", 
Ω
->
kp
.
addr
, () (*(rp->kp.addr)), () (*(rp->kp.addr + 1)), () (*(rp->kp.addr + 2)));

813 
Ω
->
nmis£d
 = 0;

815 i‡((
ªt
 = 
	`dbi_ªgi°î_k¥obe
(&
Ω
->
kp
)) != 0)

816 
	`‰ì_Ω_ö°
(
Ω
);

818 
	`DBPRINTF
 ("addr=%p, *addr=[%lx %lx %lx]", 
Ω
->
kp
.
addr
, () (*(rp->kp.addr)), () (*(rp->kp.addr + 1)), () (*(rp->kp.addr + 2)));

820  
ªt
;

821 
	}
}

823 
dbi_dißrm_kΩ_ö°
(
kªçrobe_ö°™˚
 *
ri
);

825 
	$dbi_uƒegi°î_kªçrobe_t›
(
kªçrobe
 *
Ω
)

827 
kªçrobe_ö°™˚
 *
ri
;

828 
	`DECLARE_NODE_PTR_FOR_HLIST
(
node
);

830 
	`dbi_uƒegi°î_k¥obe
(&
Ω
->
kp
);

832 
	`sw≠_hli°_f‹_óch_íåy
(
ri
, 
node
, &
Ω
->
u£d_ö°™˚s
, 
uÊi°
) {

833 i‡(!
	`dbi_dißrm_kΩ_ö°
(
ri
)) {

834 
	`¥ötk
("%s (%d/%d): cannot disarm krp instance (%08lx)\n",

835 
ri
->
èsk
->
comm
,Ñi->èsk->
tgid
,Ñi->èsk->
pid
,

836 ()
Ω
->
kp
.
addr
);

839 
	}
}

841 
	$dbi_uƒegi°î_kªçrobe_bŸtom
(
kªçrobe
 *
Ω
)

843 
Êags
;

844 
kªçrobe_ö°™˚
 *
ri
;

846 i‡(
	`li°_em±y
(&
Ω
->
kp
.
li°
))

847 
	`ªmove_k¥obe
(&
Ω
->
kp
);

849 
	`•ö_lock_úqßve
(&
kªçrobe_lock
, 
Êags
);

851 (
ri
 = 
	`gë_u£d_Ω_ö°
(
Ω
)Ë!
NULL
) {

852 
	`ªcy˛e_Ω_ö°
(
ri
);

854 
	`‰ì_Ω_ö°
(
Ω
);

856 
	`•ö_u∆ock_úqª°‹e
(&
kªçrobe_lock
, 
Êags
);

857 
	}
}

859 
	$dbi_uƒegi°î_kªçrobes
(
kªçrobe
 **
Ωp
, 
size_t
 
size
)

861 
size_t
 
i
;

862 
Êags
;

864 
	`•ö_lock_úqßve
(&
kªçrobe_lock
, 
Êags
);

866 
i
 = 0; i < 
size
; i++)

867 
	`dbi_uƒegi°î_kªçrobe_t›
(
Ωp
[
i
]);

869 
	`•ö_u∆ock_úqª°‹e
(&
kªçrobe_lock
, 
Êags
);

871 i‡(!
	`ö_©omic
())

872 
	`synchr⁄ize_sched
();

874 
i
 = 0; i < 
size
; i++)

875 
	`dbi_uƒegi°î_kªçrobe_bŸtom
(
Ωp
[
i
]);

876 
	}
}

878 
	$dbi_uƒegi°î_kªçrobe
(
kªçrobe
 *
Ω
)

880 
	`dbi_uƒegi°î_kªçrobes
(&
Ω
, 1);

881 
	}
}

883 
kªçrobe
 *
	$˛⁄e_kªçrobe
(
kªçrobe
 *
Ω
)

885 
k¥obe
 *
ﬁd_p
;

886 
kªçrobe
 *
˛⁄e
 = 
NULL
;

887 
ªt
;

889 
˛⁄e
 = 
	`kmÆloc
((
kªçrobe
), 
GFP_KERNEL
);

890 i‡(!
˛⁄e
) {

891 
	`DBPRINTF
 ("ÁûedÅÿÆlo¯mem‹y f‹ cl⁄ê¥obê%p!", 
Ω
->
kp
.
addr
);

892  
NULL
;

894 
	`mem˝y
(
˛⁄e
, 
Ω
, (
kªçrobe
));

895 
˛⁄e
->
kp
.
¥e_h™dÀr
 = 
¥e_h™dÀr_kªçrobe
;

896 
˛⁄e
->
kp
.
po°_h™dÀr
 = 
NULL
;

897 
˛⁄e
->
kp
.
Áu…_h™dÀr
 = 
NULL
;

898 
˛⁄e
->
kp
.
bªak_h™dÀr
 = 
NULL
;

899 
ﬁd_p
 = 
	`gë_k¥obe
(
Ω
->
kp
.
addr
);

900 i‡(
ﬁd_p
) {

901 
ªt
 = 
	`ªgi°î_aggr_k¥obe
(
ﬁd_p
, &
˛⁄e
->
kp
);

902 i‡(
ªt
) {

903 
	`k‰ì
(
˛⁄e
);

904  
NULL
;

906 
	`©omic_öc
(&
k¥obe_cou¡
);

909  
˛⁄e
;

910 
	}
}

911 
EXPORT_SYMBOL_GPL
(
˛⁄e_kªçrobe
);

913 
ölöe
 
	$rm_èsk_åampﬁöe
(
èsk_°ru˘
 *
p
, 
kªçrobe_ö°™˚
 *
ri
)

915 
	`¨ch_£t_èsk_pc
(
p
, ()
ri
->
ªt_addr
);

916 
	}
}

918 
	$dbi_dißrm_kΩ_ö°
(
kªçrobe_ö°™˚
 *
ri
)

920 *
åamp
 = (*)&
kªçrobe_åampﬁöe
;

921 *
•
 = 
ri
->sp;

922 *
found
 = 
NULL
;

923 
ªtvÆ
 = -
ENOENT
;

925 i‡(!
•
) {

926 
pc
 = 
	`¨ch_gë_èsk_pc
(
ri
->
èsk
);

928 
	`¥ötk
("---> [%d] %s (%d/%d):Öc = %08lx,Ña = %08lx,Åramp= %08lx (%08lx)\n",

929 
	`èsk_˝u
(
ri
->
èsk
),

930 
ri
->
èsk
->
comm
,Ñi->èsk->
tgid
,Ñi->èsk->
pid
,

931 
pc
, ()
ri
->
ªt_addr
,

932 ()
åamp
,

933 ()(
ri
->
Ω
 ?Ñi->Ω->
kp
.
addr
: 
NULL
));

936 i‡(
pc
 =()
åamp
) {

937 
	`rm_èsk_åampﬁöe
(
ri
->
èsk
,Ñi);

941  -
EINVAL
;

944 
•
 > 
ri
->• - 
RETPROBE_STACK_DEPTH
) {

945 i‡(*
•
 =()
åamp
) {

946 
found
 = 
•
;

949 
•
--;

952 i‡(
found
) {

953 
	`¥ötk
("---> [%d] %s (%d/%d):Åramp (%08lx) foundát %08lx (%08lx /%+d) - %p\n",

954 
	`èsk_˝u
(
ri
->
èsk
),

955 
ri
->
èsk
->
comm
,Ñi->èsk->
tgid
,Ñi->èsk->
pid
,

956 ()
åamp
,

957 ()
found
, ()
ri
->
•
,

958 
found
 - 
ri
->
•
,Ñi->
Ω
 ?Ñi->Ω->
kp
.
addr
: 
NULL
);

959 *
found
 = ()
ri
->
ªt_addr
;

960 
ªtvÆ
 = 0;

962 
	`¥ötk
("---> [%d] %s (%d/%d):Åramp (%08lx) NOT foundát sp = %08lx - %p\n",

963 
	`èsk_˝u
(
ri
->
èsk
),

964 
ri
->
èsk
->
comm
,Ñi->èsk->
tgid
,Ñi->èsk->
pid
,

965 ()
åamp
,

966 ()
ri
->
•
,Ñi->
Ω
 ?Ñi->Ω->
kp
.
addr
: 
NULL
);

969  
ªtvÆ
;

970 
	}
}

972 
	$öô_moduÀ_dïs
()

974 
ªt
;

976 
sched_addr
 = 
	`sw≠_ksyms
("__switch_to");

977 
exô_addr
 = 
	`sw≠_ksyms
("do_exit");

978 
sys_exô_group_addr
 = 
	`sw≠_ksyms
("sys_exit_group");

979 
do_group_exô_addr
 = 
	`sw≠_ksyms
("do_group_exit");

980 
sys_exô_addr
 = 
	`sw≠_ksyms
("sys_exit");

982 i‡(
sched_addr
 == 0 ||

983 
exô_addr
 == 0 ||

984 
sys_exô_group_addr
 == 0 ||

985 
do_group_exô_addr
 == 0 ||

986 
sys_exô_addr
 == 0) {

987  -
ESRCH
;

990 
ªt
 = 
	`öô_moduÀ_dïídícõs
();

991 i‡(
ªt
) {

992  
ªt
;

995  
	`¨ch_öô_moduÀ_dïs
();

996 
	}
}

998 
__öô
 
	$öô_k¥obes
()

1000 
i
, 
îr
 = 0;

1002 
moduÀ_Æloc
 = (*)
	`sw≠_ksyms
("module_alloc");

1003 i‡(!
moduÀ_Æloc
) {

1004 
	`¥ötk
("module_alloc isÇot found! Oops.\n");

1007 
moduÀ_‰ì
 = (*)
	`sw≠_ksyms
("module_free");

1008 i‡(!
moduÀ_Æloc
) {

1009 
	`¥ötk
("module_free isÇot found! Oops.\n");

1013 
	`öô_sm
();

1017 
i
 = 0; i < 
KPROBE_TABLE_SIZE
; ++i) {

1018 
	`INIT_HLIST_HEAD
(&
k¥obe_èbÀ
[
i
]);

1019 
	`INIT_HLIST_HEAD
(&
kªçrobe_ö°_èbÀ
[
i
]);

1021 
	`©omic_£t
(&
k¥obe_cou¡
, 0);

1023 
îr
 = 
	`öô_moduÀ_dïs
();

1024 i‡(
îr
) {

1025  
îr
;

1028 
îr
 = 
	`¨ch_öô_k¥obes
();

1030 
	`DBPRINTF
 ("öô_k¥obes:árch_öô_k¥obe†- %d", 
îr
);

1032  
îr
;

1033 
	}
}

1035 
__exô
 
	$exô_k¥obes
()

1037 
	`¨ch_exô_k¥obes
();

1038 
	`exô_sm
();

1039 
	}
}

1041 
moduÀ_öô
(
öô_k¥obes
);

1042 
moduÀ_exô
(
exô_k¥obes
);

1044 
EXPORT_SYMBOL_GPL
(
dbi_ªgi°î_k¥obe
);

1045 
EXPORT_SYMBOL_GPL
(
dbi_uƒegi°î_k¥obe
);

1046 
EXPORT_SYMBOL_GPL
(
dbi_ªgi°î_j¥obe
);

1047 
EXPORT_SYMBOL_GPL
(
dbi_uƒegi°î_j¥obe
);

1048 
EXPORT_SYMBOL_GPL
(
dbi_j¥obe_ªtu∫
);

1049 
EXPORT_SYMBOL_GPL
(
dbi_ªgi°î_kªçrobe
);

1050 
EXPORT_SYMBOL_GPL
(
dbi_uƒegi°î_kªçrobes
);

1051 
EXPORT_SYMBOL_GPL
(
dbi_uƒegi°î_kªçrobe
);

1053 
MODULE_LICENSE
("Dual BSD/GPL");

	@kprobe/dbi_kprobes.h

1 #i‚de‡
_DBI_KPROBES_H


2 
	#_DBI_KPROBES_H


	)

53 
	~<löux/vîsi⁄.h
>

54 
	~<löux/nŸifõr.h
>

55 
	~<löux/≥r˝u.h
>

56 
	~<löux/•ölock.h
>

57 
	~<löux/rcupd©e.h
>

58 
	~<löux/sched.h
>

59 
	~<löux/∑gem≠.h
>

61 
	~<k¥obe/¨ch/asm/dbi_k¥obes.h
>

64 #ifde‡
CONFIG_ARM


66 
	#ªgs_ªtu∫_vÆue
(
ªgs
Ë(‘egs)->
ARM_r0
)

	)

72 
	#KPROBE_HIT_ACTIVE
 0x00000001

	)

73 
	#KPROBE_HIT_SS
 0x00000002

	)

74 
	#KPROBE_REENTER
 0x00000004

	)

75 
	#KPROBE_HIT_SSDONE
 0x00000008

	)

77 
	#HIWORD
(
x
Ë(((xË& 0xFFFF0000Ë>> 16)

	)

78 
	#LOWORD
(
x
Ë((xË& 0x0000FFFF)

	)

80 
	#INVALID_VALUE
 0xFFFFFFFF

	)

81 
	#INVALID_POINTER
 (*)
INVALID_VALUE


	)

83 
	#JPROBE_ENTRY
(
≥¡ry
Ë(
k¥obe_›code_t
 *)
	)
pentry

85 
	#RETPROBE_STACK_DEPTH
 64

	)

87 
	gk¥obe
;

88 
	g±_ªgs
;

89 
	gkªçrobe
;

90 
	gkªçrobe_ö°™˚
;

91 (*
	tk¥obe_¥e_h™dÀr_t
Ë(
	tk¥obe
 *, 
	t±_ªgs
 *);

92 (*
	tk¥obe_bªak_h™dÀr_t
Ë(
	tk¥obe
 *, 
	t±_ªgs
 *);

93 (*
	tk¥obe_po°_h™dÀr_t
Ë(
	tk¥obe
 *, 
	t±_ªgs
 *, 
	tÊags
);

94 (*
	tk¥obe_Áu…_h™dÀr_t
Ë(
	tk¥obe
 *, 
	t±_ªgs
 *, 
	tå≠ƒ
);

95 (*
	tkªçrobe_h™dÀr_t
Ë(
	tkªçrobe_ö°™˚
 *, 
	t±_ªgs
 *);

97 
	sk¥obe


99 
hli°_node
 
hli°
;

101 
hli°_node
 
is_hli°
;

103 
li°_hód
 
li°
;

105 
mod_ªfcou¡ed
;

107 
nmis£d
;

109 
k¥obe_›code_t
 *
addr
;

111 *
symbﬁ_«me
;

113 
off£t
;

115 
k¥obe_¥e_h™dÀr_t
 
¥e_h™dÀr
;

117 
k¥obe_po°_h™dÀr_t
 
po°_h™dÀr
;

120 
k¥obe_Áu…_h™dÀr_t
 
Áu…_h™dÀr
;

123 
k¥obe_bªak_h™dÀr_t
 
bªak_h™dÀr
;

125 
k¥obe_›code_t
 
›code
;

127 
¨ch_•ecific_ö¢
 
aö¢
;

135 
k¥obe_›code_t
 *
ss_addr
;

137 #ifde‡
CONFIG_ARM


138 
ß„_¨m
:1;

139 
ß„_thumb
:1;

143 (*
	tk¥obe_¥e_íåy_h™dÀr_t
Ë(*
	t¥iv_¨g
, 
	t±_ªgs
 * 
	tªgs
);

155 
	sj¥obe


157 
k¥obe
 
kp
;

159 
k¥obe_›code_t
 *
íåy
;

161 
k¥obe_¥e_íåy_h™dÀr_t
 
¥e_íåy
;

162 *
¥iv_¨g
;

165 
	sj¥obe_ö°™˚


168 
hli°_node
 
uÊi°
;

169 
hli°_node
 
hli°
;

170 
j¥obe
 *
jp
;

171 
èsk_°ru˘
 *
èsk
;

188 
	skªçrobe


190 
k¥obe
 
kp
;

191 
kªçrobe_h™dÀr_t
 
h™dÀr
;

192 
kªçrobe_h™dÀr_t
 
íåy_h™dÀr
;

193 
maxa˘ive
;

194 
nmis£d
;

195 
size_t
 
d©a_size
;

196 
hli°_hód
 
‰ì_ö°™˚s
;

197 
hli°_hód
 
u£d_ö°™˚s
;

199 #ifde‡
CONFIG_ARM


201 
¨m_n‹ë
:1;

202 
thumb_n‹ë
:1;

207 
	skªçrobe_ö°™˚


210 
hli°_node
 
uÊi°
;

211 
hli°_node
 
hli°
;

212 
kªçrobe
 *
Ω
;

213 *
ªt_addr
;

214 *
•
;

215 
èsk_°ru˘
 *
èsk
;

216 
d©a
[0];

220 
	`show_ªgi°îs
 (
±_ªgs
 *
ªgs
);

221 
	`k¥obes_öc_nmis£d_cou¡
 (
k¥obe
 *
p
);

228 
	#KPROBE_HASH_BITS
 16

	)

229 
	#KPROBE_TABLE_SIZE
 (1 << 
KPROBE_HASH_BITS
)

	)

233 
k¥obe
 *
	`gë_k¥obe
(*
addr
);

234 
hli°_hód
 *
	`kªçrobe_ö°_èbÀ_hód
 (*
hash_key
);

237 
	`dbi_ªgi°î_k¥obe
 (
k¥obe
 *
p
);

238 
	`dbi_uƒegi°î_k¥obe
(
k¥obe
 *
p
);

240 
	`ªgi°î_aggr_k¥obe
 (
k¥obe
 *
ﬁd_p
, k¥obê*
p
);

242 
	`£tjmp_¥e_h™dÀr
 (
k¥obe
 *, 
±_ªgs
 *);

243 
	`l⁄gjmp_bªak_h™dÀr
 (
k¥obe
 *, 
±_ªgs
 *);

245 
	`dbi_ªgi°î_j¥obe
 (
j¥obe
 *
p
);

246 
	`dbi_uƒegi°î_j¥obe
 (
j¥obe
 *
p
);

247 
	`dbi_j¥obe_ªtu∫
 ();

248 
	`dbi_j¥obe_ªtu∫_íd
 ();

250 
kªçrobe
 * 
	`˛⁄e_kªçrobe
 (kªçrobê*
Ω
);

251 
kªçrobe_ö°™˚
 * 
	`gë_u£d_Ω_ö°
 (
kªçrobe
 *
Ω
);

254 
	`Æloc_nodes_kªçrobe
(
kªçrobe
 *
Ω
);

255 
	`dbi_ªgi°î_kªçrobe
 (
kªçrobe
 *
Ω
);

256 
	`dbi_uƒegi°î_kªçrobe
 (
kªçrobe
 *
Ω
);

257 
	`dbi_uƒegi°î_kªçrobes
(
kªçrobe
 **
Ωp
, 
size_t
 
size
);

259 
	`kªçrobe_as£π
 (
kªçrobe_ö°™˚
 *
ri
,

260 
‹ig_ªt_addªss
, 
åampﬁöe_addªss
);

263 
kªçrobe_ö°™˚
 *
	`gë_‰ì_Ω_ö°
 (
kªçrobe
 *
Ω
);

264 
kªçrobe_ö°™˚
 *
	`gë_‰ì_Ω_ö°_no_Æloc
 (
kªçrobe
 *
Ω
);

265 
	`‰ì_Ω_ö°
 (
kªçrobe
 *
Ω
);

266 
	`add_Ω_ö°
 (
kªçrobe_ö°™˚
 *
ri
);

267 
	`ªcy˛e_Ω_ö°
 (
kªçrobe_ö°™˚
 *
ri
);

268 
	`dbi_dißrm_uΩ_ö°_f‹_èsk
(
èsk_°ru˘
 *
∑ª¡
, èsk_°ru˘ *
èsk
);

270 
	`åampﬁöe_¥obe_h™dÀr
 (
k¥obe
 *
p
, 
±_ªgs
 *
ªgs
);

272 #ifde‡
KPROBES_PROFILE


273 
	`¥e_h™dÀr_kªçrobe
 (
k¥obe
 *
p
, 
±_ªgs
 *
ªgs
, 
vm_¨ó_°ru˘
 **
vma
, 
∑ge
 **∑ge, **
kaddr
);

274 
	`£t_n‹mÆized_timevÆ
 (
timevÆ
 *
tv
, 
time_t
 
£c
, 
su£c⁄ds_t
 
u£c
);

277 
	`DEFINE_PER_CPU
 (
k¥obe
 *, 
cuºít_k¥obe
);

278 
hli°_hód
 
k¥obe_èbÀ
[
KPROBE_TABLE_SIZE
];

280 
©omic_t
 
k¥obe_cou¡
;

281 
sched_addr
;

283 
k¥obe
 *
	`k¥obe_ru¬ög
 ();

284 
	`ª£t_cuºít_k¥obe
 ();

285 
k¥obe_˘lblk
 *
	`gë_k¥obe_˘lblk
 ();

287 
	`¥ï¨e_sögÀ°ï
(
k¥obe
 *
p
, 
±_ªgs
 *
ªgs
);

	@kprobe/dbi_kprobes_deps.c

27 
	~<löux/moduÀ.h
>

28 
	~<löux/sched.h
>

30 
	~<asm/pgèbÀ.h
>

32 
	~"dbi_k¥obes_dïs.h
"

33 
	~"dbi_kdebug.h
"

36 
	~<löux/¶ab.h
>

37 
	~<löux/mm.h
>

39 #i‡
LINUX_VERSION_CODE
 > 
KERNEL_VERSION
(2, 6, 29)

41 #unde‡
pgd_off£t_k


42 
	#pgd_off£t_k
(
addr
Ë
	`pgd_off£t
(
öô_èsk
.
a˘ive_mm
,áddr)

	)

45 #i‡(
LINUX_VERSION_CODE
 > 
KERNEL_VERSION
(2, 6, 38))

46 #i‚de‡
is_zîo_p‚


48 
	gsw≠_zîo_p‚
 = 0;

53 #i‡
LINUX_VERSION_CODE
 > 
KERNEL_VERSION
(2, 6, 36)

54 
ölöe
 *
	$dbi_km≠_©omic
(
∑ge
 *page)

56  
	`km≠_©omic
(
∑ge
);

57 
	}
}

58 
ölöe
 
	$dbi_kunm≠_©omic
(*
kvaddr
)

60 
	`kunm≠_©omic
(
kvaddr
);

61 
	}
}

63 
ölöe
 *
	$dbi_km≠_©omic
(
∑ge
 *page)

65  
	`km≠_©omic
(
∑ge
, 
KM_USER0
);

66 
	}
}

68 
ölöe
 
	$dbi_kunm≠_©omic
(*
kvaddr
)

70 
	`kunm≠_©omic
(
kvaddr
, 
KM_USER0
);

71 
	}
}

74 #i‡
LINUX_VERSION_CODE
 >
KERNEL_VERSION
(3, 9, 0)

75 
DECLARE_MOD_FUNC_DEP
(
do_mm≠_pgoff
, , 
fûe
 *fûe, 
addr
, 
Àn
, 
¥Ÿ
, 
Êags
, 
pgoff
, *
p›uœã
);

76 
	$DECLARE_MOD_DEP_WRAPPER
(
do_mm≠_pgoff
, , 
fûe
 *fûe, 
addr
, 
Àn
, 
¥Ÿ
, 
Êags
, 
pgoff
, *
p›uœã
)

77 
	$IMP_MOD_DEP_WRAPPER
(
do_mm≠_pgoff
, 
fûe
, 
addr
, 
Àn
, 
¥Ÿ
, 
Êags
, 
pgoff
, 
p›uœã
)

78 #ñi‡
LINUX_VERSION_CODE
 >
	`KERNEL_VERSION
(3, 4, 0)

79 
	`DECLARE_MOD_FUNC_DEP
(
do_mm≠_pgoff
, , 
fûe
 *fûe, 
addr
, 
Àn
, 
¥Ÿ
, 
Êags
, 
pgoff
);

80 
	$DECLARE_MOD_DEP_WRAPPER
(
do_mm≠_pgoff
, , 
fûe
 *fûe, 
addr
, 
Àn
, 
¥Ÿ
, 
Êags
, 
pgoff
)

81 
	$IMP_MOD_DEP_WRAPPER
(
do_mm≠_pgoff
, 
fûe
, 
addr
, 
Àn
, 
¥Ÿ
, 
Êags
, 
pgoff
)

84 #i‡
LINUX_VERSION_CODE
 >
	`KERNEL_VERSION
(3, 4, 0)

85 
	`EXPORT_SYMBOL_GPL
(
do_mm≠_pgoff
);

89 #i‚de‡
c›y_to_u£r_∑ge


90 
	`DECLARE_MOD_FUNC_DEP
(
c›y_to_u£r_∑ge
, , 
vm_¨ó_°ru˘
 *
vma
, 
∑ge
 *∑ge, 
uaddr
, *
d°
, c⁄° *
§c
, 
Àn
);

91 
	$DECLARE_MOD_DEP_WRAPPER
(
c›y_to_u£r_∑ge
, , 
vm_¨ó_°ru˘
 *
vma
, 
∑ge
 *∑ge, 
uaddr
, *
d°
, c⁄° *
§c
, 
Àn
)

92 
	$IMP_MOD_DEP_WRAPPER
(
c›y_to_u£r_∑ge
, 
vma
, 
∑ge
, 
uaddr
, 
d°
, 
§c
, 
Àn
)

96 
	`DECLARE_MOD_FUNC_DEP
(
ac˚ss_¥o˚ss_vm
, , 
èsk_°ru˘
 * 
tsk
, 
addr
, *
buf
, 
Àn
, 
wrôe
);

98 
	`DECLARE_MOD_FUNC_DEP
(
föd_exãnd_vma
, 
vm_¨ó_°ru˘
 *, 
mm_°ru˘
 * 
mm
, 
addr
);

100 #i‡
LINUX_VERSION_CODE
 <
	`KERNEL_VERSION
(2, 6, 30)

101 #i‡
LINUX_VERSION_CODE
 > 
	`KERNEL_VERSION
(2, 6, 18)

102 
	`DECLARE_MOD_FUNC_DEP
(
h™dÀ_mm_Áu…
, , 
mm_°ru˘
 *
mm
, 
vm_¨ó_°ru˘
 *
vma
, 
addªss
, 
wrôe_ac˚ss
);

105 
	`DECLARE_MOD_FUNC_DEP
(
h™dÀ_mm_Áu…
, , 
mm_°ru˘
 *
mm
, 
vm_¨ó_°ru˘
 *
vma
, 
addªss
, 
Êags
);

108 #i‡
LINUX_VERSION_CODE
 > 
	`KERNEL_VERSION
(2, 6, 38)

109 
	`DECLARE_MOD_FUNC_DEP
(
gë_g©e_vma
, 
vm_¨ó_°ru˘
 *, 
mm_°ru˘
 *
mm
);

111 
	`DECLARE_MOD_FUNC_DEP
(
gë_g©e_vma
, 
vm_¨ó_°ru˘
 *, 
èsk_°ru˘
 *
tsk
);

114 #ifde‡
CONFIG_HUGETLB_PAGE


115 
	`DECLARE_MOD_FUNC_DEP
(
fﬁlow_hugëlb_∑ge
, , 
mm_°ru˘
 *
mm
, \

116 
vm_¨ó_°ru˘
 *
vma
, 
∑ge
 **
∑ges
, \

117 
vm_¨ó_°ru˘
 **
vmas
, *
posôi⁄
, *
Àngth
, \

118 
i
, 
wrôe
);

121 #ifde‡
__HAVE_ARCH_GATE_AREA


122 #i‡
LINUX_VERSION_CODE
 > 
	`KERNEL_VERSION
(2, 6, 38)

123 
	`DECLARE_MOD_FUNC_DEP
(
ö_g©e_¨ó
, , 
mm_°ru˘
 *
mm
, 
addr
);

125 
	`DECLARE_MOD_FUNC_DEP
(
ö_g©e_¨ó
, , 
èsk_°ru˘
 *
èsk
, 
addr
);

129 #i‡
LINUX_VERSION_CODE
 > 
	`KERNEL_VERSION
(2, 6, 38)

130 
	`DECLARE_MOD_FUNC_DEP
(
ö_g©e_¨ó_no_mm
, , 
addr
);

132 
	`DECLARE_MOD_FUNC_DEP
(
ö_g©e_¨ó_no_èsk
, , 
addr
);

135 #i‡
LINUX_VERSION_CODE
 >
	`KERNEL_VERSION
(3, 9, 0)

136 
	`DECLARE_MOD_FUNC_DEP
(
fﬁlow_∑ge_mask
, \

137 
∑ge
 *, 
vm_¨ó_°ru˘
 * 
vma
, \

138 
addªss
, 
fﬁl_Êags
, \

139 *
∑ge_mask
);

140 
	`DECLARE_MOD_DEP_WRAPPER
(
fﬁlow_∑ge_mask
, 
∑ge
 *, \

141 
vm_¨ó_°ru˘
 * 
vma
, \

142 
addªss
, \

143 
fﬁl_Êags
, \

144 *
∑ge_mask
)

145 
	$IMP_MOD_DEP_WRAPPER
 (
fﬁlow_∑ge_mask
, 
vma
, 
addªss
, 
fﬁl_Êags
, 
∑ge_mask
)

147 
	`DECLARE_MOD_FUNC_DEP
(
fﬁlow_∑ge
, \

148 
∑ge
 *, 
vm_¨ó_°ru˘
 * 
vma
, \

149 
addªss
, 
fﬁl_Êags
);

150 
	`DECLARE_MOD_DEP_WRAPPER
(
fﬁlow_∑ge
, 
∑ge
 *, \

151 
vm_¨ó_°ru˘
 * 
vma
, \

152 
addªss
, \

153 
fﬁl_Êags
)

154 
	$IMP_MOD_DEP_WRAPPER
 (
fﬁlow_∑ge
, 
vma
, 
addªss
, 
fﬁl_Êags
)

157 
	`DECLARE_MOD_FUNC_DEP
(
__Êush_™⁄_∑ge
, \

158 , 
vm_¨ó_°ru˘
 *
vma
, 
∑ge
 *page, \

159 
vmaddr
);

160 
	`DECLARE_MOD_FUNC_DEP
(
vm_n‹mÆ_∑ge
, \

161 
∑ge
 *, 
vm_¨ó_°ru˘
 *
vma
, \

162 
addr
, 
±e_t
 
±e
);

163 
	`DECLARE_MOD_FUNC_DEP
(
Êush_±ø˚_ac˚ss
, \

164 , 
vm_¨ó_°ru˘
 *
vma
, 
∑ge
 *page, \

165 
uaddr
, *
kaddr
, 
Àn
, 
wrôe
);

168 #i‡(
LINUX_VERSION_CODE
 !
	`KERNEL_VERSION
(2, 6, 16))

169 
	`DECLARE_MOD_FUNC_DEP
(
put_èsk_°ru˘
, \

170 , 
èsk_°ru˘
 *
tsk
);

172 
	`DECLARE_MOD_FUNC_DEP
(
put_èsk_°ru˘
, \

173 , 
rcu_hód
 * 
rhp
);

176 
	$DECLARE_MOD_DEP_WRAPPER
(
ac˚ss_¥o˚ss_vm
, , 
èsk_°ru˘
 *
tsk
, 
addr
, *
buf
, 
Àn
, 
wrôe
)

177 
	$IMP_MOD_DEP_WRAPPER
 (
ac˚ss_¥o˚ss_vm
, 
tsk
, 
addr
, 
buf
, 
Àn
, 
wrôe
)

179 
	$DECLARE_MOD_DEP_WRAPPER
 (
föd_exãnd_vma
, 
vm_¨ó_°ru˘
 *, 
mm_°ru˘
 * 
mm
, 
addr
)

180 
	$IMP_MOD_DEP_WRAPPER
 (
föd_exãnd_vma
, 
mm
, 
addr
)

182 #i‡
LINUX_VERSION_CODE
 <
	`KERNEL_VERSION
(2, 6, 30)

183 #i‡
LINUX_VERSION_CODE
 > 
	`KERNEL_VERSION
(2, 6, 18)

184 
	`DECLARE_MOD_DEP_WRAPPER
 (
h™dÀ_mm_Áu…
, \

185 , 
mm_°ru˘
 *
mm
, 
vm_¨ó_°ru˘
 *
vma
, 
addªss
, 
wrôe_ac˚ss
)

186 
	$IMP_MOD_DEP_WRAPPER
 (
h™dÀ_mm_Áu…
, 
mm
, 
vma
, 
addªss
, 
wrôe_ac˚ss
)

189 
	`DECLARE_MOD_DEP_WRAPPER
 (
h™dÀ_mm_Áu…
, \

190 , 
mm_°ru˘
 *
mm
, 
vm_¨ó_°ru˘
 *
vma
, 
addªss
, 
Êags
)

191 
	$IMP_MOD_DEP_WRAPPER
 (
h™dÀ_mm_Áu…
, 
mm
, 
vma
, 
addªss
, 
Êags
)

194 #i‡
LINUX_VERSION_CODE
 > 
	`KERNEL_VERSION
(2, 6, 38)

195 
	`DECLARE_MOD_DEP_WRAPPER
 (
gë_g©e_vma
, \

196 
vm_¨ó_°ru˘
 *, 
mm_°ru˘
 *
mm
)

197 
	$IMP_MOD_DEP_WRAPPER
 (
gë_g©e_vma
, 
mm
)

199 
	`DECLARE_MOD_DEP_WRAPPER
 (
gë_g©e_vma
, \

200 
vm_¨ó_°ru˘
 *, 
èsk_°ru˘
 *
tsk
)

201 
	$IMP_MOD_DEP_WRAPPER
 (
gë_g©e_vma
, 
tsk
)

204 #ifde‡
CONFIG_HUGETLB_PAGE


205 
	$DECLARE_MOD_DEP_WRAPPER
 (
fﬁlow_hugëlb_∑ge
, , 
mm_°ru˘
 *
mm
, 
vm_¨ó_°ru˘
 *
vma
, 
∑ge
 **
∑ges
, vm_¨ó_°ru˘ **
vmas
, *
posôi⁄
, *
Àngth
, 
i
, 
wrôe
)

206 
	$IMP_MOD_DEP_WRAPPER
 (
fﬁlow_hugëlb_∑ge
, 
mm
, 
vma
, 
∑ges
, 
vmas
, 
posôi⁄
, 
Àngth
, 
i
, 
wrôe
)

209 
ölöe
 
	$dbi_ö_g©e_¨ó
(
èsk_°ru˘
 *
èsk
, 
addr
)

211 #ifde‡
__HAVE_ARCH_GATE_AREA


212 #i‡
LINUX_VERSION_CODE
 > 
	`KERNEL_VERSION
(2, 6, 38)

213 
mm_°ru˘
 *
mm
 = 
èsk
->mm;

214 
	`IMP_MOD_DEP_WRAPPER
 (
ö_g©e_¨ó
, 
mm
, 
addr
)

216 
	`IMP_MOD_DEP_WRAPPER
 (
ö_g©e_¨ó
, 
èsk
, 
addr
)

219  
	`ö_g©e_¨ó
(
èsk
, 
addr
);

221 
	}
}

224 #i‡
LINUX_VERSION_CODE
 > 
KERNEL_VERSION
(2, 6, 38)

225 
	$DECLARE_MOD_DEP_WRAPPER
(
ö_g©e_¨ó_no_mm
, , 
addr
)

226 
	$IMP_MOD_DEP_WRAPPER
(
ö_g©e_¨ó_no_mm
, 
addr
)

228 
	$DECLARE_MOD_DEP_WRAPPER
(
ö_g©e_¨ó_no_èsk
, , 
addr
)

229 
	$IMP_MOD_DEP_WRAPPER
(
ö_g©e_¨ó_no_èsk
, 
addr
)

232 
ölöe
 
	$dbi_ö_g©e_¨ó_no_xxx
(
addr
)

234 #i‡
LINUX_VERSION_CODE
 > 
	`KERNEL_VERSION
(2, 6, 38)

235  
	`ö_g©e_¨ó_no_mm
(
addr
);

237  
	`ö_g©e_¨ó_no_èsk
(
addr
);

239 
	}
}

241 
DECLARE_MOD_DEP_WRAPPER
 (
__Êush_™⁄_∑ge
, \

242 , 
vm_¨ó_°ru˘
 *
vma
, \

243 
∑ge
 *∑ge, 
vmaddr
)

244 
	$IMP_MOD_DEP_WRAPPER
 (
__Êush_™⁄_∑ge
, 
vma
, 
∑ge
, 
vmaddr
)

246 
	`DECLARE_MOD_DEP_WRAPPER
(
vm_n‹mÆ_∑ge
, \

247 
∑ge
 *, 
vm_¨ó_°ru˘
 *
vma
, \

248 
addr
, 
±e_t
 
±e
)

249 
	$IMP_MOD_DEP_WRAPPER
 (
vm_n‹mÆ_∑ge
, 
vma
, 
addr
, 
±e
)

251 
	`DECLARE_MOD_DEP_WRAPPER
(
Êush_±ø˚_ac˚ss
, \

252 , 
vm_¨ó_°ru˘
 *
vma
, 
∑ge
 *page, \

253 
uaddr
, *
kaddr
, 
Àn
, 
wrôe
)

254 
	$IMP_MOD_DEP_WRAPPER
(
Êush_±ø˚_ac˚ss
, 
vma
, 
∑ge
, 
uaddr
, 
kaddr
, 
Àn
, 
wrôe
)

258 
	$öô_moduÀ_dïídícõs
()

261 #i‡
LINUX_VERSION_CODE
 > 
	`KERNEL_VERSION
(2, 6, 18)

262 
	`INIT_MOD_DEP_VAR
(
h™dÀ_mm_Áu…
, handle_mm_fault);

265 #i‚de‡
c›y_to_u£r_∑ge


266 
	`INIT_MOD_DEP_VAR
(
c›y_to_u£r_∑ge
, copy_to_user_page);

269 
	`INIT_MOD_DEP_VAR
(
föd_exãnd_vma
, find_extend_vma);

270 
	`INIT_MOD_DEP_VAR
(
gë_g©e_vma
, get_gate_vma);

271 
	`INIT_MOD_DEP_VAR
(
Êush_±ø˚_ac˚ss
, flush_ptrace_access);

273 #ifde‡
CONFIG_HUGETLB_PAGE


274 
	`INIT_MOD_DEP_VAR
(
fﬁlow_hugëlb_∑ge
, follow_hugetlb_page);

277 #ifdef 
__HAVE_ARCH_GATE_AREA


278 
	`INIT_MOD_DEP_VAR
(
ö_g©e_¨ó
, in_gate_area);

281 #i‡
LINUX_VERSION_CODE
 >
	`KERNEL_VERSION
(3, 9, 0)

282 
	`INIT_MOD_DEP_VAR
(
fﬁlow_∑ge_mask
, follow_page_mask);

284 
	`INIT_MOD_DEP_VAR
(
fﬁlow_∑ge
, follow_page);

287 #i‡
LINUX_VERSION_CODE
 > 
	`KERNEL_VERSION
(2, 6, 38)

289 #i‚de‡
is_zîo_p‚


290 
sw≠_zîo_p‚
 = 
	`∑ge_to_p‚
(
	`ZERO_PAGE
(0));

293 
	`INIT_MOD_DEP_VAR
(
ö_g©e_¨ó_no_mm
, in_gate_area_no_mm);

295 
	`INIT_MOD_DEP_VAR
(
ö_g©e_¨ó_no_èsk
, in_gate_area_no_task);

298 
	`INIT_MOD_DEP_VAR
(
__Êush_™⁄_∑ge
, __flush_anon_page);

299 
	`INIT_MOD_DEP_VAR
(
vm_n‹mÆ_∑ge
, vm_normal_page);

300 
	`INIT_MOD_DEP_VAR
(
ac˚ss_¥o˚ss_vm
,áccess_process_vm);

302 #i‡(
LINUX_VERSION_CODE
 !
	`KERNEL_VERSION
(2, 6, 16))

303 #i‡(
LINUX_VERSION_CODE
 < 
	`KERNEL_VERSION
(2, 6, 11))

304 
	`INIT_MOD_DEP_VAR
(
put_èsk_°ru˘
,Öut_task_struct);

306 
	`INIT_MOD_DEP_VAR
(
put_èsk_°ru˘
, 
__put_èsk_°ru˘
);

309 
	`INIT_MOD_DEP_VAR
(
put_èsk_°ru˘
, 
__put_èsk_°ru˘_cb
);

311 #i‡
LINUX_VERSION_CODE
 >
	`KERNEL_VERSION
(3, 4, 0)

312 
	`INIT_MOD_DEP_VAR
(
do_mm≠_pgoff
, do_mmap_pgoff);

316 
	}
}

318 #i‡
LINUX_VERSION_CODE
 <
KERNEL_VERSION
(2, 6, 38)

319 
	#GUP_FLAGS_WRITE
 0x1

	)

320 
	#GUP_FLAGS_FORCE
 0x2

	)

321 
	#GUP_FLAGS_IGNORE_VMA_PERMISSIONS
 0x4

	)

322 
	#GUP_FLAGS_IGNORE_SIGKILL
 0x8

	)

325 #i‡
LINUX_VERSION_CODE
 > 
KERNEL_VERSION
(2,6,18)

326 
ölöe
 
	$u£_zîo_∑ge
(
vm_¨ó_°ru˘
 *
vma
)

335 i‡(
vma
->
vm_Êags
 & (
VM_LOCKED
 | 
VM_SHARED
))

340  !
vma
->
vm_›s
 || !vma->vm_›s->
Áu…
;

341 
	}
}

343 #i‡
LINUX_VERSION_CODE
 > 
KERNEL_VERSION
(2, 6, 38)

345 #i‡
LINUX_VERSION_CODE
 >
KERNEL_VERSION
(3, 8, 0)

347 #ifde‡
__HAVE_COLOR_ZERO_PAGE


349 
ölöe
 
	$sw≠_is_zîo_p‚
(
p‚
)

351 
off£t_‰om_zîo_p‚
 = 
p‚
 - 
sw≠_zîo_p‚
;

352  
off£t_‰om_zîo_p‚
 <(
zîo_∑ge_mask
 >> 
PAGE_SHIFT
);

353 
	}
}

357 
ölöe
 
	$sw≠_is_zîo_p‚
(
p‚
)

359  
p‚
 =
sw≠_zîo_p‚
;

360 
	}
}

365 
ölöe
 
	$sw≠_is_zîo_p‚
(
p‚
)

367 #i‚de‡
is_zîo_p‚


368  
p‚
 =
sw≠_zîo_p‚
;

370  
	`is_zîo_p‚
(
p‚
);

372 
	}
}

376 
ölöe
 
	$°ack_gu¨d_∑ge
(
vm_¨ó_°ru˘
 *
vma
, 
addr
)

378  
	`°ack_gu¨d_∑ge_°¨t
(
vma
, 
addr
) ||

379 
	`°ack_gu¨d_∑ge_íd
(
vma
, 
addr
+
PAGE_SIZE
);

380 
	}
}

382 #i‡
LINUX_VERSION_CODE
 >
KERNEL_VERSION
(3, 9, 0)

384 
ölöe
 
∑ge
 *
	$fﬁlow_∑ge_u¥obe
(
vm_¨ó_°ru˘
 *
vma
,

385 
addªss
, 
fﬁl_Êags
)

387 
unu£d_∑ge_mask
;

388  
	`fﬁlow_∑ge_mask
(
vma
, 
addªss
, 
fﬁl_Êags
, &
unu£d_∑ge_mask
);

389 
	}
}

391 
	$__gë_u£r_∑ges_u¥obe
(
èsk_°ru˘
 *
tsk
, 
mm_°ru˘
 *
mm
,

392 
°¨t
, 
ƒ_∑ges
,

393 
gup_Êags
, 
∑ge
 **
∑ges
,

394 
vm_¨ó_°ru˘
 **
vmas
, *
n⁄blockög
)

396 
i
;

397 
vm_Êags
;

398 
∑ge_mask
;

400 i‡(!
ƒ_∑ges
)

403 
	`VM_BUG_ON
(!!
∑ges
 !!!(
gup_Êags
 & 
FOLL_GET
));

409 
vm_Êags
 = (
gup_Êags
 & 
FOLL_WRITE
) ?

410 (
VM_WRITE
 | 
VM_MAYWRITE
Ë: (
VM_READ
 | 
VM_MAYREAD
);

411 
vm_Êags
 &(
gup_Êags
 & 
FOLL_FORCE
) ?

412 (
VM_MAYREAD
 | 
VM_MAYWRITE
Ë: (
VM_READ
 | 
VM_WRITE
);

423 i‡(!(
gup_Êags
 & 
FOLL_FORCE
))

424 
gup_Êags
 |
FOLL_NUMA
;

426 
i
 = 0;

429 
vm_¨ó_°ru˘
 *
vma
;

431 
vma
 = 
	`föd_exãnd_vma
(
mm
, 
°¨t
);

432 i‡(!
vma
 && 
	`dbi_ö_g©e_¨ó
(
tsk
, 
°¨t
)) {

433 
pg
 = 
°¨t
 & 
PAGE_MASK
;

434 
pgd_t
 *
pgd
;

435 
pud_t
 *
pud
;

436 
pmd_t
 *
pmd
;

437 
±e_t
 *
±e
;

440 i‡(
gup_Êags
 & 
FOLL_WRITE
)

441  
i
 ? : -
EFAULT
;

442 i‡(
pg
 > 
TASK_SIZE
)

443 
pgd
 = 
	`pgd_off£t_k
(
pg
);

445 
pgd
 = 
	`pgd_off£t_g©e
(
mm
, 
pg
);

446 
	`BUG_ON
(
	`pgd_n⁄e
(*
pgd
));

447 
pud
 = 
	`pud_off£t
(
pgd
, 
pg
);

448 
	`BUG_ON
(
	`pud_n⁄e
(*
pud
));

449 
pmd
 = 
	`pmd_off£t
(
pud
, 
pg
);

450 i‡(
	`pmd_n⁄e
(*
pmd
))

451  
i
 ? : -
EFAULT
;

452 
	`VM_BUG_ON
(
	`pmd_å™s_huge
(*
pmd
));

453 
±e
 = 
	`±e_off£t_m≠
(
pmd
, 
pg
);

454 i‡(
	`±e_n⁄e
(*
±e
)) {

455 
	`±e_unm≠
(
±e
);

456  
i
 ? : -
EFAULT
;

458 
vma
 = 
	`gë_g©e_vma
(
mm
);

459 i‡(
∑ges
) {

460 
∑ge
 *page;

462 
∑ge
 = 
	`vm_n‹mÆ_∑ge
(
vma
, 
°¨t
, *
±e
);

463 i‡(!
∑ge
) {

464 i‡(!(
gup_Êags
 & 
FOLL_DUMP
) &&

465 
	`sw≠_is_zîo_p‚
(
	`±e_p‚
(*
±e
)))

466 
∑ge
 = 
	`±e_∑ge
(*
±e
);

468 
	`±e_unm≠
(
±e
);

469  
i
 ? : -
EFAULT
;

472 
∑ges
[
i
] = 
∑ge
;

473 
	`gë_∑ge
(
∑ge
);

475 
	`±e_unm≠
(
±e
);

476 
∑ge_mask
 = 0;

477 
√xt_∑ge
;

480 i‡(!
vma
 ||

481 (
vma
->
vm_Êags
 & (
VM_IO
 | 
VM_PFNMAP
)) ||

482 !(
vm_Êags
 & 
vma
->vm_flags))

483  
i
 ? : -
EFAULT
;

485 i‡(
	`is_vm_hugëlb_∑ge
(
vma
)) {

486 
i
 = 
	`fﬁlow_hugëlb_∑ge
(
mm
, 
vma
, 
∑ges
, 
vmas
,

487 &
°¨t
, &
ƒ_∑ges
, 
i
, 
gup_Êags
);

492 
∑ge
 *page;

493 
fﬁl_Êags
 = 
gup_Êags
;

494 
∑ge_ö¸em
;

500 i‡(
	`u∆ikñy
(
	`Áèl_sig«l_≥ndög
(
cuºít
)))

501  
i
 ? i : -
ERESTARTSYS
;

504 !(
∑ge
 = 
	`fﬁlow_∑ge_mask
(
vma
, 
°¨t
,

505 
fﬁl_Êags
, &
∑ge_mask
))) {

506 
ªt
;

507 
Áu…_Êags
 = 0;

510 i‡(
fﬁl_Êags
 & 
FOLL_MLOCK
) {

511 i‡(
	`°ack_gu¨d_∑ge
(
vma
, 
°¨t
))

512 
√xt_∑ge
;

514 i‡(
fﬁl_Êags
 & 
FOLL_WRITE
)

515 
Áu…_Êags
 |
FAULT_FLAG_WRITE
;

516 i‡(
n⁄blockög
)

517 
Áu…_Êags
 |
FAULT_FLAG_ALLOW_RETRY
;

518 i‡(
fﬁl_Êags
 & 
FOLL_NOWAIT
)

519 
Áu…_Êags
 |(
FAULT_FLAG_ALLOW_RETRY
 | 
FAULT_FLAG_RETRY_NOWAIT
);

521 
ªt
 = 
	`h™dÀ_mm_Áu…
(
mm
, 
vma
, 
°¨t
,

522 
Áu…_Êags
);

524 i‡(
ªt
 & 
VM_FAULT_ERROR
) {

525 i‡(
ªt
 & 
VM_FAULT_OOM
)

526  
i
 ? i : -
ENOMEM
;

527 i‡(
ªt
 & (
VM_FAULT_HWPOISON
 |

528 
VM_FAULT_HWPOISON_LARGE
)) {

529 i‡(
i
)

530  
i
;

531 i‡(
gup_Êags
 & 
FOLL_HWPOISON
)

532  -
EHWPOISON
;

534  -
EFAULT
;

536 i‡(
ªt
 & 
VM_FAULT_SIGBUS
)

537  
i
 ? i : -
EFAULT
;

538 
	`BUG
();

541 i‡(
tsk
) {

542 i‡(
ªt
 & 
VM_FAULT_MAJOR
)

543 
tsk
->
maj_Êt
++;

545 
tsk
->
mö_Êt
++;

548 i‡(
ªt
 & 
VM_FAULT_RETRY
) {

549 i‡(
n⁄blockög
)

550 *
n⁄blockög
 = 0;

551  
i
;

566 i‡((
ªt
 & 
VM_FAULT_WRITE
) &&

567 !(
vma
->
vm_Êags
 & 
VM_WRITE
))

568 
fﬁl_Êags
 &~
FOLL_WRITE
;

572 i‡(
	`IS_ERR
(
∑ge
))

573  
i
 ? i : 
	`PTR_ERR
(
∑ge
);

574 i‡(
∑ges
) {

575 
∑ges
[
i
] = 
∑ge
;

577 
	`Êush_™⁄_∑ge
(
vma
, 
∑ge
, 
°¨t
);

578 
	`Êush_dˇche_∑ge
(
∑ge
);

579 
∑ge_mask
 = 0;

581 
√xt_∑ge
:

582 i‡(
vmas
) {

583 
vmas
[
i
] = 
vma
;

584 
∑ge_mask
 = 0;

586 
∑ge_ö¸em
 = 1 + (~(
°¨t
 >> 
PAGE_SHIFT
Ë& 
∑ge_mask
);

587 i‡(
∑ge_ö¸em
 > 
ƒ_∑ges
)

588 
∑ge_ö¸em
 = 
ƒ_∑ges
;

589 
i
 +
∑ge_ö¸em
;

590 
°¨t
 +
∑ge_ö¸em
 * 
PAGE_SIZE
;

591 
ƒ_∑ges
 -
∑ge_ö¸em
;

592 } 
ƒ_∑ges
 && 
°¨t
 < 
vma
->
vm_íd
);

593 } 
ƒ_∑ges
);

594  
i
;

595 
	}
}

599 
	$__gë_u£r_∑ges_u¥obe
(
èsk_°ru˘
 *
tsk
, 
mm_°ru˘
 *
mm
,

600 
°¨t
, 
ƒ_∑ges
, 
gup_Êags
,

601 
∑ge
 **
∑ges
, 
vm_¨ó_°ru˘
 **
vmas
,

602 *
n⁄blockög
)

604 
i
;

605 
vm_Êags
;

607 i‡(
ƒ_∑ges
 <= 0) {

611 
	`VM_BUG_ON
(!!
∑ges
 !!!(
gup_Êags
 & 
FOLL_GET
));

617 
vm_Êags
 = (
gup_Êags
 & 
FOLL_WRITE
) ?

618 (
VM_WRITE
 | 
VM_MAYWRITE
Ë: (
VM_READ
 | 
VM_MAYREAD
);

619 
vm_Êags
 &(
gup_Êags
 & 
FOLL_FORCE
) ?

620 (
VM_MAYREAD
 | 
VM_MAYWRITE
Ë: (
VM_READ
 | 
VM_WRITE
);

621 
i
 = 0;

624 
vm_¨ó_°ru˘
 *
vma
;

626 
vma
 = 
	`föd_exãnd_vma
(
mm
, 
°¨t
);

627 i‡(!
vma
 && 
	`dbi_ö_g©e_¨ó_no_xxx
(
°¨t
)) {

628 
pg
 = 
°¨t
 & 
PAGE_MASK
;

629 
pgd_t
 *
pgd
;

630 
pud_t
 *
pud
;

631 
pmd_t
 *
pmd
;

632 
±e_t
 *
±e
;

635 i‡(
gup_Êags
 & 
FOLL_WRITE
) {

636  
i
 ? : -
EFAULT
;

638 i‡(
pg
 > 
TASK_SIZE
)

639 
pgd
 = 
	`pgd_off£t_k
(
pg
);

641 
pgd
 = 
	`pgd_off£t_g©e
(
mm
, 
pg
);

642 
	`BUG_ON
(
	`pgd_n⁄e
(*
pgd
));

643 
pud
 = 
	`pud_off£t
(
pgd
, 
pg
);

644 
	`BUG_ON
(
	`pud_n⁄e
(*
pud
));

645 
pmd
 = 
	`pmd_off£t
(
pud
, 
pg
);

646 i‡(
	`pmd_n⁄e
(*
pmd
)) {

647  
i
 ? : -
EFAULT
;

649 
	`VM_BUG_ON
(
	`pmd_å™s_huge
(*
pmd
));

650 
±e
 = 
	`±e_off£t_m≠
(
pmd
, 
pg
);

651 i‡(
	`±e_n⁄e
(*
±e
)) {

652 
	`±e_unm≠
(
±e
);

653  
i
 ? : -
EFAULT
;

655 
vma
 = 
	`gë_g©e_vma
(
mm
);

656 i‡(
∑ges
) {

657 
∑ge
 *page;

659 
∑ge
 = 
	`vm_n‹mÆ_∑ge
(
vma
, 
°¨t
, *
±e
);

660 i‡(!
∑ge
) {

661 i‡(!(
gup_Êags
 & 
FOLL_DUMP
) &&

662 
	`sw≠_is_zîo_p‚
(
	`±e_p‚
(*
±e
)))

663 
∑ge
 = 
	`±e_∑ge
(*
±e
);

665 
	`±e_unm≠
(
±e
);

666  
i
 ? : -
EFAULT
;

669 
∑ges
[
i
] = 
∑ge
;

670 
	`gë_∑ge
(
∑ge
);

672 
	`±e_unm≠
(
±e
);

673 
√xt_∑ge
;

676 i‡(!
vma
 ||

677 (
vma
->
vm_Êags
 & (
VM_IO
 | 
VM_PFNMAP
)) ||

678 !(
vm_Êags
 & 
vma
->vm_flags)) {

679  
i
 ? : -
EFAULT
;

682 i‡(
	`is_vm_hugëlb_∑ge
(
vma
)) {

683 
i
 = 
	`fﬁlow_hugëlb_∑ge
(
mm
, 
vma
, 
∑ges
, 
vmas
,

684 &
°¨t
, &
ƒ_∑ges
, 
i
, 
gup_Êags
);

689 
∑ge
 *page;

690 
fﬁl_Êags
 = 
gup_Êags
;

696 i‡(
	`u∆ikñy
(
	`Áèl_sig«l_≥ndög
(
cuºít
))) {

697  
i
 ? i : -
ERESTARTSYS
;

701 !(
∑ge
 = 
	`fﬁlow_∑ge
(
vma
, 
°¨t
, 
fﬁl_Êags
))) {

702 
ªt
;

703 
Áu…_Êags
 = 0;

706 i‡(
fﬁl_Êags
 & 
FOLL_MLOCK
) {

707 i‡(
	`°ack_gu¨d_∑ge
(
vma
, 
°¨t
))

708 
√xt_∑ge
;

710 i‡(
fﬁl_Êags
 & 
FOLL_WRITE
)

711 
Áu…_Êags
 |
FAULT_FLAG_WRITE
;

712 i‡(
n⁄blockög
)

713 
Áu…_Êags
 |
FAULT_FLAG_ALLOW_RETRY
;

714 i‡(
fﬁl_Êags
 & 
FOLL_NOWAIT
)

715 
Áu…_Êags
 |(
FAULT_FLAG_ALLOW_RETRY
 | 
FAULT_FLAG_RETRY_NOWAIT
);

717 
ªt
 = 
	`h™dÀ_mm_Áu…
(
mm
, 
vma
, 
°¨t
,

718 
Áu…_Êags
);

720 i‡(
ªt
 & 
VM_FAULT_ERROR
) {

721 i‡(
ªt
 & 
VM_FAULT_OOM
) {

722  
i
 ? i : -
ENOMEM
;

724 i‡(
ªt
 & (
VM_FAULT_HWPOISON
 |

725 
VM_FAULT_HWPOISON_LARGE
)) {

726 i‡(
i
) {

727  
i
;

729 i‡(
gup_Êags
 & 
FOLL_HWPOISON
) {

730  -
EHWPOISON
;

733  -
EFAULT
;

736 i‡(
ªt
 & 
VM_FAULT_SIGBUS
) {

737  
i
 ? i : -
EFAULT
;

739 
	`BUG
();

742 i‡(
tsk
) {

743 i‡(
ªt
 & 
VM_FAULT_MAJOR
)

744 
tsk
->
maj_Êt
++;

746 
tsk
->
mö_Êt
++;

749 i‡(
ªt
 & 
VM_FAULT_RETRY
) {

750 i‡(
n⁄blockög
)

751 *
n⁄blockög
 = 0;

752  
i
;

767 i‡((
ªt
 & 
VM_FAULT_WRITE
) &&

768 !(
vma
->
vm_Êags
 & 
VM_WRITE
))

769 
fﬁl_Êags
 &~
FOLL_WRITE
;

773 i‡(
	`IS_ERR
(
∑ge
)) {

774  
i
 ? i : 
	`PTR_ERR
(
∑ge
);

776 i‡(
∑ges
) {

777 
∑ges
[
i
] = 
∑ge
;

779 
	`Êush_™⁄_∑ge
(
vma
, 
∑ge
, 
°¨t
);

780 
	`Êush_dˇche_∑ge
(
∑ge
);

782 
√xt_∑ge
:

783 i‡(
vmas
)

784 
vmas
[
i
] = 
vma
;

785 
i
++;

786 
°¨t
 +
PAGE_SIZE
;

787 
ƒ_∑ges
--;

788 } 
ƒ_∑ges
 && 
°¨t
 < 
vma
->
vm_íd
);

789 } 
ƒ_∑ges
);

791  
i
;

792 
	}
}

798 
	$__gë_u£r_∑ges_u¥obe
(
èsk_°ru˘
 *
tsk
, 
mm_°ru˘
 *
mm
,

799 
°¨t
, 
Àn
, 
Êags
,

800 
∑ge
 **
∑ges
, 
vm_¨ó_°ru˘
 **
vmas
)

802 
i
;

803 
vm_Êags
 = 0;

804 
wrôe
 = !!(
Êags
 & 
GUP_FLAGS_WRITE
);

805 
f‹˚
 = !!(
Êags
 & 
GUP_FLAGS_FORCE
);

806 
ign‹e
 = !!(
Êags
 & 
GUP_FLAGS_IGNORE_VMA_PERMISSIONS
);

808 i‡(
Àn
 <= 0)

814 
vm_Êags
 = 
wrôe
 ? (
VM_WRITE
 | 
VM_MAYWRITE
Ë: (
VM_READ
 | 
VM_MAYREAD
);

815 
vm_Êags
 &
f‹˚
 ? (
VM_MAYREAD
 | 
VM_MAYWRITE
Ë: (
VM_READ
 | 
VM_WRITE
);

816 
i
 = 0;

819 
vm_¨ó_°ru˘
 *
vma
;

820 
fﬁl_Êags
;

822 
vma
 = 
	`föd_vma
(
mm
, 
°¨t
);

823 i‡(!
vma
 && 
	`dbi_ö_g©e_¨ó
(
tsk
, 
°¨t
)) {

824 
pg
 = 
°¨t
 & 
PAGE_MASK
;

825 
vm_¨ó_°ru˘
 *
g©e_vma
 = 
	`gë_g©e_vma
(
tsk
);

826 
pgd_t
 *
pgd
;

827 
pud_t
 *
pud
;

828 
pmd_t
 *
pmd
;

829 
±e_t
 *
±e
;

832 i‡(!
ign‹e
 && 
wrôe
)

833  
i
 ? : -
EFAULT
;

834 i‡(
pg
 > 
TASK_SIZE
)

835 
pgd
 = 
	`pgd_off£t_k
(
pg
);

837 
pgd
 = 
	`pgd_off£t_g©e
(
mm
, 
pg
);

838 
	`BUG_ON
(
	`pgd_n⁄e
(*
pgd
));

839 
pud
 = 
	`pud_off£t
(
pgd
, 
pg
);

840 
	`BUG_ON
(
	`pud_n⁄e
(*
pud
));

841 
pmd
 = 
	`pmd_off£t
(
pud
, 
pg
);

842 i‡(
	`pmd_n⁄e
(*
pmd
))

843  
i
 ? : -
EFAULT
;

844 
±e
 = 
	`±e_off£t_m≠
(
pmd
, 
pg
);

845 i‡(
	`±e_n⁄e
(*
±e
)) {

846 
	`±e_unm≠
(
±e
);

847  
i
 ? : -
EFAULT
;

849 i‡(
∑ges
) {

850 
∑ge
 *∑gê
	`vm_n‹mÆ_∑ge
(
g©e_vma
, 
°¨t
, *
±e
);

851 
∑ges
[
i
] = 
∑ge
;

852 i‡(
∑ge
)

853 
	`gë_∑ge
(
∑ge
);

855 
	`±e_unm≠
(
±e
);

856 i‡(
vmas
)

857 
vmas
[
i
] = 
g©e_vma
;

858 
i
++;

859 
°¨t
 +
PAGE_SIZE
;

860 
Àn
--;

864 i‡(!
vma
 ||

865 (
vma
->
vm_Êags
 & (
VM_IO
 | 
VM_PFNMAP
)) ||

866 (!
ign‹e
 && !(
vm_Êags
 & 
vma
->vm_flags)))

867  
i
 ? : -
EFAULT
;

869 i‡(
	`is_vm_hugëlb_∑ge
(
vma
)) {

870 #i‡ 
LINUX_VERSION_CODE
 <
	`KERNEL_VERSION
(2,6,18)

871 
i
 = 
	`fﬁlow_hugëlb_∑ge
(
mm
, 
vma
, 
∑ges
, 
vmas
,

872 &
°¨t
, &
Àn
, 
i
);

874 
i
 = 
	`fﬁlow_hugëlb_∑ge
(
mm
, 
vma
, 
∑ges
, 
vmas
,

875 &
°¨t
, &
Àn
, 
i
, 
wrôe
);

880 
fﬁl_Êags
 = 
FOLL_TOUCH
;

881 i‡(
∑ges
)

882 
fﬁl_Êags
 |
FOLL_GET
;

884 #i‡
LINUX_VERSION_CODE
 > 
	`KERNEL_VERSION
(2,6,18)

885 #i‡
LINUX_VERSION_CODE
 <
	`KERNEL_VERSION
(2,6,30)

886 i‡(!
wrôe
 && 
	`u£_zîo_∑ge
(
vma
))

887 
fﬁl_Êags
 |
FOLL_ANON
;

892 
∑ge
 *page;

894 i‡(
wrôe
)

895 
fﬁl_Êags
 |
FOLL_WRITE
;

900 
	`DBPRINTF
 ("∑ge†%∞vm®%p\n", 
∑ges
, 
vma
);

901 !(
∑ge
 = 
	`fﬁlow_∑ge
(
vma
, 
°¨t
, 
fﬁl_Êags
))) {

902 
ªt
;

903 
ªt
 = 
	`h™dÀ_mm_Áu…
(
mm
, 
vma
, 
°¨t
,

904 
fﬁl_Êags
 & 
FOLL_WRITE
);

906 #i‡ 
LINUX_VERSION_CODE
 <
	`KERNEL_VERSION
(2,6,18)

907 i‡(
ªt
 & 
VM_FAULT_WRITE
)

908 
fﬁl_Êags
 &~
FOLL_WRITE
;

910 
ªt
 & ~
VM_FAULT_WRITE
) {

911 
VM_FAULT_MINOR
:

912 
tsk
->
mö_Êt
++;

914 
VM_FAULT_MAJOR
:

915 
tsk
->
maj_Êt
++;

917 
VM_FAULT_SIGBUS
:

918  
i
 ? i : -
EFAULT
;

919 
VM_FAULT_OOM
:

920  
i
 ? i : -
ENOMEM
;

922 
	`BUG
();

926 i‡(
ªt
 & 
VM_FAULT_ERROR
) {

927 i‡(
ªt
 & 
VM_FAULT_OOM
)

928  
i
 ? i : -
ENOMEM
;

929 i‡(
ªt
 & 
VM_FAULT_SIGBUS
)

930  
i
 ? i : -
EFAULT
;

931 
	`BUG
();

933 i‡(
ªt
 & 
VM_FAULT_MAJOR
)

934 
tsk
->
maj_Êt
++;

936 
tsk
->
mö_Êt
++;

950 i‡((
ªt
 & 
VM_FAULT_WRITE
) &&

951 !(
vma
->
vm_Êags
 & 
VM_WRITE
))

952 
fﬁl_Êags
 &~
FOLL_WRITE
;

959 i‡(
	`IS_ERR
(
∑ge
))

960  
i
 ? i : 
	`PTR_ERR
(
∑ge
);

961 i‡(
∑ges
) {

962 
∑ges
[
i
] = 
∑ge
;

964 #i‡ 
LINUX_VERSION_CODE
 <
	`KERNEL_VERSION
(2,6,18)

965 
	`Êush_™⁄_∑ge
(
∑ge
, 
°¨t
);

967 
	`Êush_™⁄_∑ge
(
vma
, 
∑ge
, 
°¨t
);

969 
	`Êush_dˇche_∑ge
(
∑ge
);

971 i‡(
vmas
)

972 
vmas
[
i
] = 
vma
;

973 
i
++;

974 
°¨t
 +
PAGE_SIZE
;

975 
Àn
--;

976 } 
Àn
 && 
°¨t
 < 
vma
->
vm_íd
);

977 } 
Àn
);

978  
i
;

979 
	}
}

983 
	$gë_u£r_∑ges_u¥obe
(
èsk_°ru˘
 *
tsk
, 
mm_°ru˘
 *
mm
,

984 
°¨t
, 
Àn
, 
wrôe
, 
f‹˚
,

985 
∑ge
 **
∑ges
, 
vm_¨ó_°ru˘
 **
vmas
)

987 #i‡
LINUX_VERSION_CODE
 >
	`KERNEL_VERSION
(2, 6, 29)

988 #i‡
LINUX_VERSION_CODE
 > 
	`KERNEL_VERSION
(2, 6, 38)

989 
Êags
 = 
FOLL_TOUCH
;

991 i‡(
∑ges
)

992 
Êags
 |
FOLL_GET
;

993 i‡(
wrôe
)

994 
Êags
 |
FOLL_WRITE
;

995 i‡(
f‹˚
)

996 
Êags
 |
FOLL_FORCE
;

998 
Êags
 = 0;

1000 i‡(
wrôe
)

1001 
Êags
 |
GUP_FLAGS_WRITE
;

1002 i‡(
f‹˚
)

1003 
Êags
 |
GUP_FLAGS_FORCE
;

1006  
	`__gë_u£r_∑ges_u¥obe
(
tsk
, 
mm
,

1007 
°¨t
, 
Àn
, 
Êags
,

1008 #i‡
LINUX_VERSION_CODE
 > 
	`KERNEL_VERSION
(2, 6, 38)

1009 
∑ges
, 
vmas
, 
NULL
);

1011 
∑ges
, 
vmas
);

1014  
	`gë_u£r_∑ges
(
tsk
, 
mm
, 
°¨t
, 
Àn
, 
wrôe
, 
f‹˚
, 
∑ges
, 
vmas
);

1016 
	}
}

1018 
	#ACCESS_PROCESS_OPTIMIZATION
 0

	)

1020 #i‡
ACCESS_PROCESS_OPTIMIZATION


1022 
	#GET_STEP_X
(
LEN
, 
STEP
Ë(((LENË>(STEP)Ë? (STEPË: (LENË% (STEP))

	)

1023 
	#GET_STEP_4
(
LEN
Ë
	`GET_STEP_X
((LEN), 4)

	)

1025 
	$ªad_d©a_cuºít
(
addr
, *
buf
, 
Àn
)

1027 
°ï
;

1028 
pos
 = 0;

1030 
°ï
 = 
	`GET_STEP_4
(
Àn
);Üen;Üen -= step) {

1031 
	`GET_STEP_4
(
Àn
)) {

1033 
	`gë_u£r
(*(
u8
 *)(
buf
 + 
pos
), (*)(
addr
 +Öos));

1034 
°ï
 = 1;

1039 
	`gë_u£r
(*(
u16
 *)(
buf
 + 
pos
), (*)(
addr
 +Öos));

1040 
°ï
 = 2;

1044 
	`gë_u£r
(*(
u32
 *)(
buf
 + 
pos
), (*)(
addr
 +Öos));

1045 
°ï
 = 4;

1049 
pos
 +
°ï
;

1051 
	}
}

1054 
	$wrôe_d©a_cuºít
(
addr
, *
buf
, 
Àn
)

1056 
°ï
;

1057 
pos
 = 0;

1059 
°ï
 = 
	`GET_STEP_4
(
Àn
);Üen;Üen -= step) {

1060 
	`GET_STEP_4
(
Àn
)) {

1062 
	`put_u£r
(*(
u8
 *)(
buf
 + 
pos
), (*)(
addr
 +Öos));

1063 
°ï
 = 1;

1068 
	`put_u£r
(*(
u16
 *)(
buf
 + 
pos
), (*)(
addr
 +Öos));

1069 
°ï
 = 2;

1073 
	`put_u£r
(*(
u32
 *)(
buf
 + 
pos
), (*)(
addr
 +Öos));

1074 
°ï
 = 4;

1078 
pos
 +
°ï
;

1080 
	}
}

1083 
	$ac˚ss_¥o˚ss_vm_©omic
(
èsk_°ru˘
 *
tsk
, 
addr
, *
buf
, 
Àn
, 
wrôe
)

1085 
mm_°ru˘
 *
mm
;

1086 
vm_¨ó_°ru˘
 *
vma
;

1087 *
ﬁd_buf
 = 
buf
;

1089 i‡(
Àn
 <= 0) {

1093 #i‡
ACCESS_PROCESS_OPTIMIZATION


1094 i‡(
wrôe
 =0 && 
tsk
 =
cuºít
) {

1095 
	`ªad_d©a_cuºít
(
addr
, 
buf
, 
Àn
);

1096  
Àn
;

1100 
mm
 = 
tsk
->mm;

1101 i‡(!
mm
)

1105 
Àn
) {

1106 
byãs
, 
ªt
, 
off£t
;

1107 *
maddr
;

1108 
∑ge
 *∑gê
NULL
;

1110 
ªt
 = 
	`gë_u£r_∑ges_u¥obe
(
tsk
, 
mm
, 
addr
, 1,

1111 
wrôe
, 1, &
∑ge
, &
vma
);

1113 i‡(
ªt
 <= 0) {

1118 #ifde‡
CONFIG_HAVE_IOREMAP_PROT


1119 
vma
 = 
	`föd_vma
(
mm
, 
addr
);

1120 i‡(!
vma
)

1122 i‡(
vma
->
vm_›s
 && vma->vm_›s->
ac˚ss
)

1123 
ªt
 = 
vma
->
vm_›s
->
	`ac˚ss
(vma, 
addr
, 
buf
,

1124 
Àn
, 
wrôe
);

1125 i‡(
ªt
 <= 0)

1128 
byãs
 = 
ªt
;

1130 
byãs
 = 
Àn
;

1131 
off£t
 = 
addr
 & (
PAGE_SIZE
-1);

1132 i‡(
byãs
 > 
PAGE_SIZE
-
off£t
)

1133 
byãs
 = 
PAGE_SIZE
-
off£t
;

1135 
maddr
 = 
	`dbi_km≠_©omic
(
∑ge
);

1137 i‡(
wrôe
) {

1138 
	`c›y_to_u£r_∑ge
(
vma
, 
∑ge
, 
addr
,

1139 
maddr
 + 
off£t
, 
buf
, 
byãs
);

1140 
	`£t_∑ge_dúty_lock
(
∑ge
);

1142 
	`c›y_‰om_u£r_∑ge
(
vma
, 
∑ge
, 
addr
,

1143 
buf
, 
maddr
 + 
off£t
, 
byãs
);

1146 
	`dbi_kunm≠_©omic
(
maddr
);

1147 
	`∑ge_ˇche_ªÀa£
(
∑ge
);

1149 
Àn
 -
byãs
;

1150 
buf
 +
byãs
;

1151 
addr
 +
byãs
;

1154  
buf
 - 
ﬁd_buf
;

1155 
	}
}

1157 
	$∑ge_¥e£¡
 (
mm_°ru˘
 *
mm
, 
addªss
)

1159 
pgd_t
 *
pgd
;

1160 
pud_t
 *
pud
;

1161 
pmd_t
 *
pmd
;

1162 
±e_t
 *
±ï
, 
±e
;

1163 
p‚
;

1165 
pgd
 = 
	`pgd_off£t
(
mm
, 
addªss
);

1166 i‡(
	`pgd_n⁄e
(*
pgd
Ë|| 
	`u∆ikñy
(
	`pgd_bad
(*pgd)))

1167 
out
;

1169 
pud
 = 
	`pud_off£t
(
pgd
, 
addªss
);

1170 i‡(
	`pud_n⁄e
(*
pud
Ë|| 
	`u∆ikñy
(
	`pud_bad
(*pud)))

1171 
out
;

1173 
pmd
 = 
	`pmd_off£t
(
pud
, 
addªss
);

1174 i‡(
	`pmd_n⁄e
(*
pmd
Ë|| 
	`u∆ikñy
(
	`pmd_bad
(*pmd)))

1175 
out
;

1177 
±ï
 = 
	`±e_off£t_m≠
(
pmd
, 
addªss
);

1178 i‡(!
±ï
)

1179 
out
;

1181 
±e
 = *
±ï
;

1182 
	`±e_unm≠
(
±ï
);

1183 i‡(
	`±e_¥e£¡
(
±e
)) {

1184 
p‚
 = 
	`±e_p‚
(
±e
);

1185 i‡(
	`p‚_vÆid
(
p‚
)) {

1190 
out
:

1192 
	}
}

1195 
EXPORT_SYMBOL_GPL
 (
∑ge_¥e£¡
);

1196 
EXPORT_SYMBOL_GPL
 (
ac˚ss_¥o˚ss_vm_©omic
);

	@kprobe/dbi_kprobes_deps.h

1 #i‚de‡
_DBI_KPROBES_DEPS_H


2 
	#_DBI_KPROBES_DEPS_H


	)

30 
	~<löux/vîsi⁄.h
>

31 
	~<löux/hugëlb.h
>

32 
	~<löux/mempﬁicy.h
>

33 
	~<löux/highmem.h
>

34 
	~<löux/∑gem≠.h
>

35 
	~<ksyms/ksyms.h
>

37 #i‡
LINUX_VERSION_CODE
 >
KERNEL_VERSION
(3, 9, 0)

38 
	#DECLARE_NODE_PTR_FOR_HLIST
(
v¨_«me
)

	)

39 
	#sw≠_hli°_f‹_óch_íåy_rcu
(
ços
, 
pos
, 
hód
, 
membî
Ë
	`hli°_f‹_óch_íåy_rcu
—pos, hód, membî)

	)

40 
	#sw≠_hli°_f‹_óch_íåy_ß„
(
ços
, 
pos
, 
n
, 
hód
, 
membî
Ë
	`hli°_f‹_óch_íåy_ß„
—pos,Ç, hód, membî)

	)

41 
	#sw≠_hli°_f‹_óch_íåy
(
ços
, 
pos
, 
hód
, 
membî
Ë
	`hli°_f‹_óch_íåy
—pos, hód, membî)

	)

43 
	#DECLARE_NODE_PTR_FOR_HLIST
(
v¨_«me
Ë
hli°_node
 *
	)
var_name

44 
	#sw≠_hli°_f‹_óch_íåy_rcu
(
ços
, 
pos
, 
hód
, 
membî
Ë
	`hli°_f‹_óch_íåy_rcu
—pos,Öos, hód, membî)

	)

45 
	#sw≠_hli°_f‹_óch_íåy_ß„
(
ços
, 
pos
, 
n
, 
hód
, 
membî
Ë
	`hli°_f‹_óch_íåy_ß„
—pos,Öos,Ç, hód, membî)

	)

46 
	#sw≠_hli°_f‹_óch_íåy
(
ços
, 
pos
, 
hód
, 
membî
Ë
	`hli°_f‹_óch_íåy
—pos,Öos, hód, membî)

	)

49 #i‡(
LINUX_VERSION_CODE
 < 
KERNEL_VERSION
(2, 6, 12))

50 
	#synchr⁄ize_sched
 
synchr⁄ize_kî√l


	)

55 
	#DECLARE_MOD_FUNC_DEP
(
«me
, 
ªt
, ...Ë
	`ªt
(*
__ªf_
##«me)(
__VA_ARGS__
)

	)

56 
	#DECLARE_MOD_CB_DEP
(
«me
, 
ªt
, ...Ë
	`ªt
(*«me)(
__VA_ARGS__
)

	)

61 
	#DECLARE_MOD_DEP_WRAPPER
(
«me
, 
ªt
, ...Ëªà
	`«me
(
__VA_ARGS__
)

	)

62 
	#IMP_MOD_DEP_WRAPPER
(
«me
, ...) \

64  
__ªf_
##
	`«me
(
__VA_ARGS__
); \

65 }

	)

70 
	#INIT_MOD_DEP_VAR
(
dï
, 
«me
) \

72 
__ªf_
##
dï
 = (*Ë
	`sw≠_ksyms
 (#name); \

73 i‡(!
__ªf_
##
dï
) \

75 
	`DBPRINTF
 (#name " isÇot found! Oops. Where is it?"); \

76  -
ESRCH
; \

78 }

	)

80 
	#INIT_MOD_DEP_CB
(
dï
, 
«me
) \

82 
dï
 = (*Ë
	`sw≠_ksyms
 (#name); \

83 i‡(!
dï
) \

85 
	`DBPRINTF
 (#name " isÇot found! Oops. Where is it?"); \

86  -
ESRCH
; \

88 }

	)

91 
öô_moduÀ_dïídícõs
();

93 
ac˚ss_¥o˚ss_vm_©omic
(
èsk_°ru˘
 *
tsk
, 
addr
, *
buf
, 
Àn
, 
wrôe
);

95 
	#ªad_¥oc_vm_©omic
(
tsk
, 
addr
, 
buf
, 
Àn
Ë
	`ac˚ss_¥o˚ss_vm_©omic
 (tsk,áddr, buf,Üí, 0)

	)

96 
	#wrôe_¥oc_vm_©omic
(
tsk
, 
addr
, 
buf
, 
Àn
Ë
	`ac˚ss_¥o˚ss_vm_©omic
 (tsk,áddr, buf,Üí, 1)

	)

97 
∑ge_¥e£¡
 (
mm_°ru˘
 *
mm
, 
addr
);

99 
DECLARE_MOD_DEP_WRAPPER
 (
__Êush_™⁄_∑ge
, \

100 , 
vm_¨ó_°ru˘
 *
vma
, \

101 
∑ge
 *∑ge, 
vmaddr
);

103 
DECLARE_MOD_DEP_WRAPPER
(
Êush_±ø˚_ac˚ss
, \

104 , 
vm_¨ó_°ru˘
 *
vma
, 
∑ge
 *page, \

105 
uaddr
, *
kaddr
, 
Àn
, 
wrôe
);

	@kprobe/swap_kprobe.mod.c

1 
	~<löux/moduÀ.h
>

2 
	~<löux/vîmagic.h
>

3 
	~<löux/compûî.h
>

5 
MODULE_INFO
(
vîmagic
, 
VERMAGIC_STRING
);

7 
moduÀ
 
__this_moduÀ


8 
__©åibuã__
((
£˘i⁄
(".gnu.linkonce.this_module"))) = {

9 .
«me
 = 
KBUILD_MODNAME
,

10 .
	göô
 = 
öô_moduÀ
,

11 #ifde‡
CONFIG_MODULE_UNLOAD


12 .
	gexô
 = 
˛ónup_moduÀ
,

14 .
	g¨ch
 = 
MODULE_ARCH_INIT
,

17 c⁄° 
	g__moduÀ_dïíds
[]

18 
__u£d


19 
__©åibuã__
((
£˘i⁄
(".modinfo"))) =

23 
MODULE_INFO
(
§cvîsi⁄
, "54DE5A69C15A5C2A32B593B");

	@ks_features/features_data.c

26 
	~"sysˇŒ_li°.h
"

27 
	~<löux/muãx.h
>

29 
	s„©uª
 {

30 
size_t
 
	m˙t
;

31 
sysˇŒ_id
 *
	m„©uª_li°
;

32 
	msub_ty≥
;

34 
	míabÀ
:1;

37 
	#X
(
«me
, 
¨gs
Ë
id_
##
	)
name

38 
	esysˇŒ_id
 {

39 
	mSYSCALL_LIST


41 #unde‡
X


43 
sysˇŒ_id
 
	gid_n⁄e
[] = {};

45 
sysˇŒ_id
 
	gid_fûe
[] = {

46 
id_sys_ac˘
,

47 
id_sys_mou¡
,

48 
id_sys_umou¡
,

49 
id_sys_åunˇã
,

53 
id_sys_°©fs
,

54 
id_sys_°©fs64
,

58 
id_sys_°©64
,

59 
id_sys_f°©64
,

60 
id_sys_l°©64
,

61 
id_sys_åunˇã64
,

62 
id_sys_·runˇã64
,

63 
id_sys_£tx©å
,

64 
id_sys_gëx©å
,

65 
id_sys_li°x©å
,

66 
id_sys_ªmovex©å
,

67 
id_sys_chroŸ
,

68 
id_sys_mknod
,

69 
id_sys_lök
,

70 
id_sys_symlök
,

71 
id_sys_u∆ök
,

72 
id_sys_ª«me
,

73 
id_sys_chmod
,

74 
id_sys_ªadlök
,

75 
id_sys_¸ót
,

76 
id_sys_›í
,

77 
id_sys_ac˚ss
,

78 
id_sys_chown
,

79 
id_sys_chown16
,

80 
id_sys_utime
,

81 
id_sys_utimes
,

82 
id_sys_¥ód64
,

83 
id_sys_pwrôe64
,

84 
id_sys_¥ódv
,

85 
id_sys_pwrôev
,

86 
id_sys_gëcwd
,

87 
id_sys_mkdú
,

88 
id_sys_chdú
,

89 
id_sys_rmdú
,

90 
id_sys_sw≠⁄
,

91 
id_sys_sw≠off
,

92 
id_sys_u£lib
,

93 
id_sys_mknod©
,

94 
id_sys_mkdú©
,

95 
id_sys_u∆ök©
,

96 
id_sys_symlök©
,

97 
id_sys_lök©
,

98 
id_sys_ª«mót
,

99 
id_sys_futimeßt
,

100 
id_sys_Ác˚sßt
,

101 
id_sys_fchmod©
,

102 
id_sys_fchow«t
,

103 
id_sys_›í©
,

107 
id_sys_ªadlök©
,

108 
id_sys_utimíßt
,

109 
id_sys_ÁnŸify_m¨k
,

110 
id_sys_execve
,

111 
id_sys_«me_to_h™dÀ_©
,

112 
id_sys_›í_by_h™dÀ_©


115 
sysˇŒ_id
 
	gid_ùc
[] = {

116 
id_sys_msggë
,

117 
id_sys_msg¢d
,

118 
id_sys_msgrcv
,

119 
id_sys_msg˘l
,

120 
id_sys_£mgë
,

121 
id_sys_£m›
,

122 
id_sys_£m˘l
,

123 
id_sys_£mtimed›
,

124 
id_sys_shm©
,

125 
id_sys_shmgë
,

126 
id_sys_shmdt
,

127 
id_sys_shm˘l
,

128 
id_sys_ùc


131 
sysˇŒ_id
 
	gid_√t
[] = {

132 
id_sys_shutdown
,

133 
id_sys_£ndfûe
,

134 
id_sys_£ndfûe64
,

135 
id_sys_£tsock›t
,

136 
id_sys_gësock›t
,

137 
id_sys_böd
,

138 
id_sys_c⁄√˘
,

139 
id_sys_ac˚±
,

140 
id_sys_ac˚±4
,

141 
id_sys_gësock«me
,

142 
id_sys_gë≥î«me
,

143 
id_sys_£nd
,

144 
id_sys_£ndto
,

145 
id_sys_£ndmsg
,

146 
id_sys_£ndmmsg
,

147 
id_sys_ªcv
,

148 
id_sys_ªcv‰om
,

149 
id_sys_ªcvmsg
,

150 
id_sys_ªcvmmsg
,

151 
id_sys_sockë
,

152 
id_sys_sockë∑ú
,

153 
id_sys_sockëˇŒ
,

154 
id_sys_li°í


157 
sysˇŒ_id
 
	gid_¥o˚ss
[] = {

158 
id_sys_exô
,

159 
id_sys_exô_group
,

160 
id_sys_waô4
,

161 
id_sys_waôid
,

165 
id_sys_π_tgsigqueueöfo
,

166 
id_sys_unsh¨e
,

167 
id_sys_f‹k
,

168 
id_sys_vf‹k
,

173 
id_sys_execve


176 
sysˇŒ_id
 
	gid_sig«l
[] = {

177 
id_sys_sig≥ndög
,

178 
id_sys_sig¥ocmask
,

186 
id_sys_π_sigsu•íd
,

187 
id_sys_siga˘i⁄
,

188 
id_sys_π_siga˘i⁄
,

189 
id_sys_π_sig¥ocmask
,

190 
id_sys_π_sigtimedwaô
,

191 
id_sys_π_tgsigqueueöfo
,

192 
id_sys_kûl
,

193 
id_sys_tgkûl
,

197 
id_sys_∑u£
,

198 
id_sys_sig«lfd
,

199 
id_sys_sig«lfd4


202 
sysˇŒ_id
 
	gid_desc
[] = {

203 
id_sys_fgëx©å
,

204 
id_sys_Êi°x©å
,

205 
id_sys_‰emovex©å
,

206 
id_sys_Ádvi£64_64
,

207 
id_sys_pùe2
,

208 
id_sys_dup3
,

209 
id_sys_£ndfûe
,

210 
id_sys_£ndfûe64
,

211 
id_sys_¥ódv
,

212 
id_sys_pwrôev
,

213 
id_sys_ïﬁl_¸óã1
,

214 
id_sys_ïﬁl_˘l
,

215 
id_sys_ïﬁl_waô
,

216 
id_sys_ïﬁl_pwaô
,

217 
id_sys_öŸify_öô
,

218 
id_sys_öŸify_öô1
,

219 
id_sys_öŸify_add_w©ch
,

220 
id_sys_öŸify_rm_w©ch
,

221 
id_sys_mknod©
,

222 
id_sys_mkdú©
,

223 
id_sys_u∆ök©
,

224 
id_sys_symlök©
,

225 
id_sys_lök©
,

226 
id_sys_ª«mót
,

227 
id_sys_futimeßt
,

228 
id_sys_Ác˚sßt
,

229 
id_sys_fchmod©
,

230 
id_sys_fchow«t
,

231 
id_sys_›í©
,

235 
id_sys_ªadlök©
,

236 
id_sys_utimíßt
,

237 
id_sys_•li˚
,

238 
id_sys_vm•li˚
,

239 
id_sys_ãe
,

240 
id_sys_sig«lfd
,

241 
id_sys_sig«lfd4
,

242 
id_sys_timîfd_¸óã
,

243 
id_sys_timîfd_£âime
,

244 
id_sys_timîfd_gëtime
,

245 
id_sys_evítfd
,

246 
id_sys_evítfd2
,

247 
id_sys_ÁŒoˇã
,

248 
id_sys_p£À˘6
,

249 
id_sys_µﬁl
,

250 
id_sys_ÁnŸify_öô
,

251 
id_sys_ÁnŸify_m¨k
,

252 
id_sys_syncfs
,

253 
id_sys_mm≠_pgoff
,

254 
id_sys_ﬁd_mm≠
,

255 
id_sys_«me_to_h™dÀ_©
,

256 
id_sys_£äs


259 
	#CREATE_FEATURE
(
x
, 
subty≥
) \

261 .
˙t
 = (
x
Ë/ (
sysˇŒ_id
), \

262 .
„©uª_li°
 = 
x
, \

263 .
sub_ty≥
 = 
subty≥
, \

264 .
íabÀ
 = 0 \

265 }

	)

267 
„©uª
 
	g„©uªs
[] = {

268 
CREATE_FEATURE
(
id_n⁄e
, 
PST_NONE
),

269 
CREATE_FEATURE
(
id_fûe
, 
PST_KS_FILE
),

270 
CREATE_FEATURE
(
id_ùc
, 
PST_KS_IPC
),

271 
CREATE_FEATURE
(
id_¥o˚ss
, 
PST_KS_PROCESS
),

272 
CREATE_FEATURE
(
id_sig«l
, 
PST_KS_SIGNAL
),

273 
CREATE_FEATURE
(
id_√t
, 
PST_KS_NETWORK
),

274 
CREATE_FEATURE
(
id_desc
, 
PST_KS_DESC
)

278 
	m„©uª_˙t
 = (
„©uªs
Ë/ (
„©uª
)

281 
	$„©uª_ödex
(
„©uª
 *
f
)

283  
f
 - 
„©uªs
;

284 
	}
}

	@ks_features/ks_features.c

26 
	~<löux/moduÀ.h
>

27 
	~<löux/¶ab.h
>

29 
	~<asm/î∫o.h
>

30 
	~<ksyms/ksyms.h
>

31 
	~<k¥obe/dbi_k¥obes.h
>

32 
	~<wrôî/sw≠_wrôî_moduÀ.h
>

33 
	~"ks_„©uªs.h
"

34 
	~"sysˇŒ_li°.h
"

35 
	~"„©uªs_d©a.c
"

37 
	sks_¥obe
 {

38 
kªçrobe
 
	mΩ
;

39 
	mcou¡î
;

40 *
	m¨gs
;

41 
	msub_ty≥
;

44 
	#CREATE_RP
(
«me
) \

46 .
íåy_h™dÀr
 = 
NULL
, \

47 .
h™dÀr
 = 
NULL
 \

48 }

	)

50 
	#X
(
«me
, 
¨gs
Ë#«me

	)

51 c⁄° *c⁄° 
	gsysˇŒ_«me
[] = {

52 
SYSCALL_LIST


54 #unde‡
X


57 
	msysˇŒ_«me_˙t
 = (
sysˇŒ_«me
) / (*)

61 
	#X
(
«me
, 
¨gs__
) \

63 .
Ω
 = 
	`CREATE_RP
(
«me
), \

64 .
cou¡î
 = 0, \

65 .
¨gs
 = #args__, \

66 .
sub_ty≥
 = 
PST_NONE
 \

67 }

	)

69 
ks_¥obe
 
	gk•
[] = {

70 
SYSCALL_LIST


72 #unde‡
X


74 c⁄° *
	$gë_sys_«me
(
size_t
 
id
)

76  
sysˇŒ_«me
[
id
];

77 
	}
}

79 
	$gë_cou¡î
(
size_t
 
id
)

81  
k•
[
id
].
cou¡î
;

82 
	}
}

84 
	$öc_cou¡î
(
size_t
 
id
)

86 ++
k•
[
id
].
cou¡î
;

87 
	}
}

89 
	$dec_cou¡î
(
size_t
 
id
)

91 --
k•
[
id
].
cou¡î
;

92 
	}
}

95 
	$íåy_h™dÀr
(
kªçrobe_ö°™˚
 *
ri
, 
±_ªgs
 *
ªgs
)

97 
kªçrobe
 *
Ω
 = 
ri
->rp;

99 i‡(
Ω
) {

100 
ks_¥obe
 *
k•
 = 
	`c⁄èöî_of
(
Ω
, ks_probe,Ñp);

101 c⁄° *
fmt
 = 
k•
->
¨gs
;

102 
addr
 = ()
k•
->
Ω
.
kp
.addr;

103 
sub_ty≥
 = 
k•
->sub_type;

105 
	`íåy_evít
(
fmt
, 
addr
, 
ªgs
, 
PT_KS
, 
sub_ty≥
);

109 
	}
}

111 
	$ªt_h™dÀr
(
kªçrobe_ö°™˚
 *
ri
, 
±_ªgs
 *
ªgs
)

113 
kªçrobe
 *
Ω
 = 
ri
->rp;

115 i‡(
Ω
) {

116 
func_addr
 = ()
Ω
->
kp
.
addr
;

117 
ªt_addr
 = ()
ri
->ret_addr;

119 
	`exô_evít
('x', 
ªgs
, 
func_addr
, 
ªt_addr
);

123 
	}
}

130 
	$swôch_íåy_h™dÀr
(
kªçrobe_ö°™˚
 *
ri
, 
±_ªgs
 *
ªgs
)

132 
	`swôch_íåy
(
ªgs
);

135 
	}
}

137 
	$swôch_ªt_h™dÀr
(
kªçrobe_ö°™˚
 *
ri
, 
±_ªgs
 *
ªgs
)

139 
	`swôch_exô
(
ªgs
);

142 
	}
}

144 
kªçrobe
 
	gswôch_Ω
 = {

145 .
íåy_h™dÀr
 = 
swôch_íåy_h™dÀr
,

146 .
	gh™dÀr
 = 
swôch_ªt_h™dÀr


149 
DEFINE_MUTEX
(
muãx_sc_íabÀ
);

150 
	gsc_íabÀ
 = 0;

152 
	$öô_swôch_c⁄ãxt
()

154 
addr
;

156 
addr
 = 
	`sw≠_ksyms
("__switch_to");

157 i‡(
addr
 == 0) {

158 
	`¥ötk
("ERROR:Çot found '__switch_to'\n");

159  -
EINVAL
;

162 
swôch_Ω
.
kp
.
addr
 = (
k¥obe_›code_t
 *)addr;

165 
	}
}

167 
	$exô_swôch_c⁄ãxt
()

169 i‡(
sc_íabÀ
)

170 
	`dbi_uƒegi°î_kªçrobe
(&
swôch_Ω
);

171 
	}
}

173 
	$ªgi°î_swôch_c⁄ãxt
()

175 
ªt
 = -
EINVAL
;

177 
	`muãx_lock
(&
muãx_sc_íabÀ
);

178 i‡(
sc_íabÀ
) {

179 
	`¥ötk
("switch contextÖrofiling isálreadyÑun!\n");

180 
u∆ock
;

183 
ªt
 = 
	`dbi_ªgi°î_kªçrobe
(&
swôch_Ω
);

184 i‡(
ªt
 == 0)

185 
sc_íabÀ
 = 1;

187 
u∆ock
:

188 
	`muãx_u∆ock
(&
muãx_sc_íabÀ
);

190  
ªt
;

191 
	}
}

193 
	$uƒegi°î_swôch_c⁄ãxt
()

195 
ªt
 = 0;

197 
	`muãx_lock
(&
muãx_sc_íabÀ
);

198 i‡(
sc_íabÀ
 == 0) {

199 
	`¥ötk
("switch contextÖrofiling isÇotÑunning!\n");

200 
ªt
 = -
EINVAL
;

201 
u∆ock
;

204 
	`dbi_uƒegi°î_kªçrobe
(&
swôch_Ω
);

206 
sc_íabÀ
 = 0;

207 
u∆ock
:

208 
	`muãx_u∆ock
(&
muãx_sc_íabÀ
);

210  
ªt
;

211 
	}
}

218 
	$ªgi°î_sysˇŒ
(
size_t
 
id
)

220 
ªt
;

221 
	`¥ötk
("ªgi°î_sysˇŒ: %s\n", 
	`gë_sys_«me
(
id
));

223 i‡(
k•
[
id
].
Ω
.
kp
.
addr
 =
NULL
)

226 
k•
[
id
].
Ω
.
íåy_h™dÀr
 =Éntry_handler;

227 
k•
[
id
].
Ω
.
h™dÀr
 = 
ªt_h™dÀr
;

229 
ªt
 = 
	`dbi_ªgi°î_kªçrobe
(&
k•
[
id
].
Ω
);

231  
ªt
;

232 
	}
}

235 
	$uƒegi°î_sysˇŒ
(
size_t
 
id
)

237 
	`¥ötk
("uƒegi°î_sysˇŒ: %s\n", 
	`gë_sys_«me
(
id
));

239 i‡(
k•
[
id
].
Ω
.
kp
.
addr
 =
NULL
)

242 
	`dbi_uƒegi°î_kªçrobe
(&
k•
[
id
].
Ω
);

245 
	}
}

247 
	$uƒegi°î_mu…ùÀ_sysˇŒs
(
size_t
 *
id_p
, size_à
˙t
)

249 
kªçrobe
 **
Ωp
;

250 c⁄° 
size_t
 
íd
 = ((size_t) 0) - 1;

251 
size_t
 
i
 = 0, 
id
;

252 
ªt
 = 0;

254 i‡(
˙t
 == 1)

255  
	`uƒegi°î_sysˇŒ
(
id_p
[0]);

257 --
˙t
;

259 
Ωp
 = 
	`kmÆloc
(
GFP_KERNEL
, (&(((
ks_¥obe
 *Ë0)->
Ω
)Ë* 
˙t
);

260 i‡(
Ωp
 =
NULL
) {

261 ; 
˙t
 !
íd
; --cnt) {

262 
ªt
 = 
	`uƒegi°î_sysˇŒ
(
id_p
[
˙t
]);

263 i‡(
ªt
)

264  
ªt
;

266  
ªt
;

269 ; 
˙t
 !
íd
; --cnt) {

270 
id
 = 
id_p
[
˙t
];

271 i‡(
k•
[
id
].
Ω
.
kp
.
addr
 !
NULL
) {

272 
Ωp
[
i
] = &
k•
[
id
].
Ω
;

273 ++
i
;

277 
	`dbi_uƒegi°î_kªçrobes
(
Ωp
, 
i
);

278 
	`k‰ì
(
Ωp
);

281 
	}
}

283 
	$£t_p°
(
„©uª
 *
f
, 
size_t
 
id
)

285 
k•
[
id
].
sub_ty≥
 |
f
->sub_type;

286 
	}
}

288 
	$un£t_p°
(
„©uª
 *
f
, 
size_t
 
id
)

290 
k•
[
id
].
sub_ty≥
 &!
f
->sub_type;

291 
	}
}

293 
	$do_unö°Æl_„©uªs
(
„©uª
 *
f
, 
size_t
 
i
)

295 
ªt
;

296 
size_t
 *
id_p
;

297 
size_t
 
id
;

298 
size_t
 
˙t
 = 0;

299 c⁄° 
size_t
 
íd
 = ((size_t) 0) - 1;

301 
id_p
 = 
	`kmÆloc
(
GFP_KERNEL
, (
id
Ë* (
i
 + 1));

304 ; 
i
 !
íd
; --i) {

305 
id
 = 
f
->
„©uª_li°
[
i
];

307 i‡(
	`gë_cou¡î
(
id
) == 0) {

308 
	`¥ötk
("syscall %sÇot installed\n",

309 
	`gë_sys_«me
(
id
));

310 
	`k‰ì
(
id_p
);

311 
	`BUG
();

314 
	`dec_cou¡î
(
id
);

316 i‡(
	`gë_cou¡î
(
id
) == 0) {

317 i‡(
id_p
 !
NULL
) {

318 
id_p
[
˙t
] = 
id
;

319 ++
˙t
;

321 
ªt
 = 
	`uƒegi°î_sysˇŒ
(
id
);

322 i‡(
ªt
)

323 
	`¥ötk
("syscall %s uninstallÉrror,Ñet=%d\n",

324 
	`gë_sys_«me
(
id
), 
ªt
);

328 
	`un£t_p°
(
f
, 
id
);

331 i‡(
id_p
 !
NULL
) {

332 
	`uƒegi°î_mu…ùÀ_sysˇŒs
(
id_p
, 
˙t
);

333 
	`k‰ì
(
id_p
);

335 
	}
}

337 
	$do_ö°Æl_„©uªs
(
„©uª
 *
f
)

339 
ªt
;

340 
size_t
 
i
, 
id
;

342 
i
 = 0; i < 
f
->
˙t
; ++i) {

343 
id
 = 
f
->
„©uª_li°
[
i
];

344 
	`£t_p°
(
f
, 
id
);

346 i‡(
	`gë_cou¡î
(
id
) == 0) {

347 
ªt
 = 
	`ªgi°î_sysˇŒ
(
id
);

348 i‡(
ªt
) {

349 
	`¥ötk
("syscall %s installÉrror,Ñet=%d\n",

350 
	`gë_sys_«me
(
id
), 
ªt
);

352 
	`do_unö°Æl_„©uªs
(
f
, --
i
);

353  
ªt
;

357 
	`öc_cou¡î
(
id
);

361 
	}
}

363 
DEFINE_MUTEX
(
muãx_„©uªs
);

365 
	$ö°Æl_„©uªs
(
„©uª
 *
f
)

367 
ªt
 = 0;

369 
	`muãx_lock
(&
muãx_„©uªs
);

370 i‡(
f
->
íabÀ
) {

371 
	`¥ötk
("energyÖrofiling isálreadyÑun!\n");

372 
ªt
 = -
EINVAL
;

373 
u∆ock
;

376 
ªt
 = 
	`do_ö°Æl_„©uªs
(
f
);

378 
f
->
íabÀ
 = 1;

379 
u∆ock
:

380 
	`muãx_u∆ock
(&
muãx_„©uªs
);

381  
ªt
;

382 
	}
}

384 
	$unö°Æl_„©uªs
(
„©uª
 *
f
)

386 
ªt
 = 0;

388 
	`muãx_lock
(&
muãx_„©uªs
);

389 i‡(
f
->
íabÀ
 == 0) {

390 
	`¥ötk
("„©uª[%d] i†nŸÑu¬ög!\n", 
	`„©uª_ödex
(
f
));

391 
ªt
 = -
EINVAL
;

392 
u∆ock
;

394 
	`do_unö°Æl_„©uªs
(
f
, f->
˙t
 - 1);

395 
f
->
íabÀ
 = 0;

396 
u∆ock
:

397 
	`muãx_u∆ock
(&
muãx_„©uªs
);

399  
ªt
;

400 
	}
}

402 
„©uª
 *
	$gë_„©uª
(
„©uª_id
 
id
)

404 i‡(
id
 < 0 || id >()
„©uª_˙t
)

405  
NULL
;

407  &
„©uªs
[
id
];

408 
	}
}

410 
	$£t_„©uª
(
„©uª_id
 
id
)

412 
„©uª
 *
f
;

414 i‡(
id
 =
FID_SWITCH
) {

415  
	`ªgi°î_swôch_c⁄ãxt
();

418 
f
 = 
	`gë_„©uª
(
id
);

419 i‡(
f
 =
NULL
)

420  -
EINVAL
;

422  
	`ö°Æl_„©uªs
(
f
);

423 
	}
}

424 
EXPORT_SYMBOL_GPL
(
£t_„©uª
);

426 
	$un£t_„©uª
(
„©uª_id
 
id
)

428 
„©uª
 *
f
;

430 i‡(
id
 =
FID_SWITCH
) {

431  
	`uƒegi°î_swôch_c⁄ãxt
();

434 
f
 = 
	`gë_„©uª
(
id
);

435 i‡(
f
 =
NULL
)

436  -
EINVAL
;

438  
	`unö°Æl_„©uªs
(
f
);

439 
	}
}

440 
EXPORT_SYMBOL_GPL
(
un£t_„©uª
);

442 
	$öô_sysˇŒ_„©uªs
()

444 
size_t
 
i
;

445 
addr
, 
ni_sysˇŒ
;

446 c⁄° *
«me
;

448 
ni_sysˇŒ
 = 
	`sw≠_ksyms
("sys_ni_syscall");

450 
i
 = 0; i < 
sysˇŒ_«me_˙t
; ++i) {

451 
«me
 = 
	`gë_sys_«me
(
i
);

452 
addr
 = 
	`sw≠_ksyms
(
«me
);

453 i‡(
addr
 == 0) {

454 
	`¥ötk
("%s(ËnŸ found\n", 
«me
);

455  -
EFAULT
;

458 i‡(
ni_sysˇŒ
 =
addr
) {

459 
	`¥ötk
("INFO: %†i†nŸ in°Æl\n", 
«me
);

460 
addr
 = 0;

463 
k•
[
i
].
Ω
.
kp
.
addr
 = (
k¥obe_›code_t
 *)addr;

467 
	}
}

469 
	$unöô_sysˇŒ_„©uªs
()

471 
size_t
 
id
;

473 
id
 = 0; id < 
sysˇŒ_«me_˙t
; ++id) {

474 i‡(
	`gë_cou¡î
(
id
) > 0)

475 
	`uƒegi°î_sysˇŒ
(
id
);

477 
	}
}

479 
__öô
 
	$öô_ks_„©uª
()

481 
ªt
;

483 
ªt
 = 
	`öô_swôch_c⁄ãxt
();

484 i‡(
ªt
)

485  
ªt
;

487 
ªt
 = 
	`öô_sysˇŒ_„©uªs
();

488 i‡(
ªt
)

489 
	`exô_swôch_c⁄ãxt
();

491  
ªt
;

492 
	}
}

494 
__exô
 
	$exô_ks_„©uª
()

496 
	`unöô_sysˇŒ_„©uªs
();

497 
	`exô_swôch_c⁄ãxt
();

498 
	}
}

500 
moduÀ_öô
(
öô_ks_„©uª
);

501 
moduÀ_exô
(
exô_ks_„©uª
);

503 
MODULE_LICENSE
("GPL");

506 
	$¥öt_„©uª
(
„©uª
 *
f
)

508 
size_t
 
i
;

510 
i
 = 0; i < 
f
->
˙t
; ++i) {

511 
	`¥ötk
(" fótuª[%3u]: %s\n", 
i
, 
	`gë_sys_«me
(
f
->
„©uª_li°
[i]));

513 
	}
}

515 
	$¥öt_„©uªs
()

517 
i
;

519 
	`¥ötk
("print_features:\n");

520 
i
 = 0; i < 
„©uª_˙t
; ++i) {

521 
	`¥ötk
("„©uª: %d\n", 
i
);

522 
	`¥öt_„©uª
(&
„©uªs
[
i
]);

524 
	}
}

526 
	$¥öt_Æl_sysˇŒ
()

528 
i
;

530 
	`¥ötk
("SYSCALL:\n");

531 
i
 = 0; i < 
sysˇŒ_«me_˙t
; ++i) {

532 
	`¥ötk
(" [%2d] %s\n", 
	`gë_cou¡î
(
i
), 
	`gë_sys_«me
(i));

534 
	}
}

	@ks_features/ks_features.h

26 #i‚de‡
_KS_FEATURES_H


27 
	#_KS_FEATURES_H


	)

29 
	e„©uª_id
 {

30 
	mFID_FILE
 = 1,

31 
	mFID_IPC
 = 2,

32 
	mFID_PROCESS
 = 3,

33 
	mFID_SIGNAL
 = 4,

34 
	mFID_NET
 = 5,

35 
	mFID_DESC
 = 6,

36 
	mFID_SWITCH
 = 7

39 
£t_„©uª
(
„©uª_id
 
id
);

40 
un£t_„©uª
(
„©uª_id
 
id
);

43 
¥öt_„©uªs
();

44 
¥öt_Æl_sysˇŒ
();

	@ks_features/swap_ks_features.mod.c

1 
	~<löux/moduÀ.h
>

2 
	~<löux/vîmagic.h
>

3 
	~<löux/compûî.h
>

5 
MODULE_INFO
(
vîmagic
, 
VERMAGIC_STRING
);

7 
moduÀ
 
__this_moduÀ


8 
__©åibuã__
((
£˘i⁄
(".gnu.linkonce.this_module"))) = {

9 .
«me
 = 
KBUILD_MODNAME
,

10 .
	göô
 = 
öô_moduÀ
,

11 #ifde‡
CONFIG_MODULE_UNLOAD


12 .
	gexô
 = 
˛ónup_moduÀ
,

14 .
	g¨ch
 = 
MODULE_ARCH_INIT
,

17 c⁄° 
	g__moduÀ_dïíds
[]

18 
__u£d


19 
__©åibuã__
((
£˘i⁄
(".modinfo"))) =

23 
MODULE_INFO
(
§cvîsi⁄
, "DCE354D2EB68A88F4B98712");

	@ks_features/syscall_list.h

26 #i‚de‡
_SYSCALL_LIST_H


27 
	#_SYSCALL_LIST_H


	)

29 
	#SYSCALL_LIST
 \

30 
	`X
(
sys_ac˚±4
, 
dpdd
), \

31 
	`X
(
sys_ac˚±
, 
dpd
), \

32 
	`X
(
sys_ac˚ss
, 
sd
), \

33 
	`X
(
sys_ac˘
, 
s
), \

34 
	`X
(
sys_böd
, 
dpd
), \

35 
	`X
(
sys_chdú
, 
s
), \

36 
	`X
(
sys_chmod
, 
sd
), \

37 
	`X
(
sys_chown16
, 
sdd
), \

38 
	`X
(
sys_chown
, 
sdd
), \

39 
	`X
(
sys_chroŸ
, 
s
), \

40 
	`X
(
sys_˛⁄e
, 
ddddd
), \

41 
	`X
(
sys_c⁄√˘
, 
dpd
), \

42 
	`X
(
sys_¸ót
, 
sd
), \

43 
	`X
(
sys_dup3
, 
ddd
), \

44 
	`X
(
sys_ïﬁl_¸óã1
, 
d
), \

45 
	`X
(
sys_ïﬁl_˘l
, 
dddp
), \

46 
	`X
(
sys_ïﬁl_pwaô
, 
dpddpx
), \

47 
	`X
(
sys_ïﬁl_waô
, 
dpdd
), \

48 
	`X
(
sys_evítfd2
, 
dd
), \

49 
	`X
(
sys_evítfd
, 
d
), \

50 
	`X
(
sys_execve
, 
•p
), \

51 
	`X
(
sys_exô
, 
d
), \

52 
	`X
(
sys_exô_group
, 
d
), \

53 
	`X
(
sys_Ác˚sßt
, 
dsd
), \

54 
	`X
(
sys_Ádvi£64_64
, 
dxxd
), \

55 
	`X
(
sys_ÁŒoˇã
, 
ddxx
), \

56 
	`X
(
sys_ÁnŸify_öô
, 
dd
), \

57 
	`X
(
sys_ÁnŸify_m¨k
, 
ddxds
), \

58 
	`X
(
sys_fchmod©
, 
dsd
), \

59 
	`X
(
sys_fchow«t
, 
dsddd
), \

60 
	`X
(
sys_fgëx©å
, 
d•x
), \

61 
	`X
(
sys_Êi°x©å
, 
dpx
), \

62 
	`X
(
sys_f‹k
, ), \

63 
	`X
(
sys_‰emovex©å
, 
ds
), \

64 
	`X
(
sys_f°©64
, 
xp
), \

65 
	`X
(
sys_·runˇã64
, 
dx
), \

66 
	`X
(
sys_futimeßt
, 
d•
), \

67 
	`X
(
sys_gëcwd
, 
px
), \

68 
	`X
(
sys_gë≥î«me
, 
dpd
), \

69 
	`X
(
sys_gësock«me
, 
dpd
), \

70 
	`X
(
sys_gësock›t
, 
dddpd
), \

71 
	`X
(
sys_gëx©å
, 
s•x
), \

72 
	`X
(
sys_öŸify_add_w©ch
, 
dsd
), \

73 
	`X
(
sys_öŸify_öô
, ), \

74 
	`X
(
sys_öŸify_öô1
, 
d
), \

75 
	`X
(
sys_öŸify_rm_w©ch
, 
dd
), \

76 
	`X
(
sys_ùc
, 
ddxxpx
), \

77 
	`X
(
sys_kûl
, 
dd
), \

78 
	`X
(
sys_lök©
, 
dsdsd
), \

79 
	`X
(
sys_lök
, 
ss
), \

80 
	`X
(
sys_li°í
, 
dd
), \

81 
	`X
(
sys_li°x©å
, 
•x
), \

82 
	`X
(
sys_l°©64
, 
•
), \

84 
	`X
(
sys_mkdú©
, 
dsd
), \

85 
	`X
(
sys_mkdú
, 
sd
), \

86 
	`X
(
sys_mknod©
, 
dsdd
), \

87 
	`X
(
sys_mknod
, 
sdd
), \

88 
	`X
(
sys_mm≠_pgoff
, 
xxxxxx
), \

89 
	`X
(
sys_mou¡
, 
µpxp
), \

90 
	`X
(
sys_msg˘l
, 
ddp
), \

91 
	`X
(
sys_msggë
, 
dd
), \

92 
	`X
(
sys_msgrcv
, 
dpxxd
), \

93 
	`X
(
sys_msg¢d
, 
dpxd
), \

94 
	`X
(
sys_«me_to_h™dÀ_©
, 
d•dd
), \

96 
	`X
(
sys_ﬁd_mm≠
, 
p
), \

97 
	`X
(
sys_›í©
, 
dsdd
), \

98 
	`X
(
sys_›í_by_h™dÀ_©
, 
dpd
), \

99 
	`X
(
sys_›í
, 
sdd
), \

100 
	`X
(
sys_∑u£
, ), \

101 
	`X
(
sys_pùe2
, 
dd
), \

102 
	`X
(
sys_µﬁl
, 
pdµ
), \

103 
	`X
(
sys_¥ód64
, 
dpxx
), \

104 
	`X
(
sys_¥ódv
, 
xpxxx
), \

105 
	`X
(
sys_p£À˘6
, 
dxxxµ
), \

106 
	`X
(
sys_pwrôe64
, 
dsxx
), \

107 
	`X
(
sys_pwrôev
, 
xpxxx
), \

108 
	`X
(
sys_ªadlök©
, 
d•d
), \

109 
	`X
(
sys_ªadlök
, 
•d
), \

110 
	`X
(
sys_ªcv
, 
dpxd
), \

111 
	`X
(
sys_ªcv‰om
, 
dpxdpd
), \

112 
	`X
(
sys_ªcvmmsg
, 
dpddp
), \

113 
	`X
(
sys_ªcvmsg
, 
dpd
), \

114 
	`X
(
sys_ªmovex©å
, 
ss
), \

115 
	`X
(
sys_ª«mót
, 
dsds
), \

116 
	`X
(
sys_ª«me
, 
ss
), \

117 
	`X
(
sys_rmdú
, 
s
), \

118 
	`X
(
sys_π_siga˘i⁄
, 
dµ
), \

119 
	`X
(
sys_π_sig¥ocmask
, 
dµx
), \

120 
	`X
(
sys_π_sigsu•íd
, 
px
), \

121 
	`X
(
sys_π_sigtimedwaô
, 
µpx
), \

122 
	`X
(
sys_π_tgsigqueueöfo
, 
dddp
), \

123 
	`X
(
sys_£m˘l
, 
dddx
), \

124 
	`X
(
sys_£mgë
, 
ddd
), \

125 
	`X
(
sys_£m›
, 
dpd
), \

126 
	`X
(
sys_£mtimed›
, 
dpdp
), \

127 
	`X
(
sys_£nd
, 
dpxd
), \

128 
	`X
(
sys_£ndfûe64
, 
ddlxx
), \

129 
	`X
(
sys_£ndfûe
, 
ddxx
), \

130 
	`X
(
sys_£ndmmsg
, 
dpdd
), \

131 
	`X
(
sys_£ndmsg
, 
dpd
), \

132 
	`X
(
sys_£ndto
, 
dpxdpd
), \

133 
	`X
(
sys_£äs
, 
dd
), \

134 
	`X
(
sys_£tsock›t
, 
dddpd
), \

135 
	`X
(
sys_£tx©å
, 
s•xd
), \

136 
	`X
(
sys_shm©
, 
dpd
), \

137 
	`X
(
sys_shm˘l
, 
ddp
), \

138 
	`X
(
sys_shmdt
, 
p
), \

139 
	`X
(
sys_shmgë
, 
dxd
), \

140 
	`X
(
sys_shutdown
, 
dd
), \

141 
	`X
(
sys_siga˘i⁄
, 
dµ
), \

144 
	`X
(
sys_sig«lfd4
, 
dpxd
), \

145 
	`X
(
sys_sig«lfd
, 
dpx
), \

146 
	`X
(
sys_sig≥ndög
, 
p
), \

147 
	`X
(
sys_sig¥ocmask
, 
dµ
), \

150 
	`X
(
sys_sockëˇŒ
, 
dx
), \

151 
	`X
(
sys_sockë
, 
ddd
), \

152 
	`X
(
sys_sockë∑ú
, 
dddd
), \

153 
	`X
(
sys_•li˚
, 
dxdxxd
), \

154 
	`X
(
sys_°©64
, 
•
), \

155 
	`X
(
sys_°©fs64
, 
sxp
), \

156 
	`X
(
sys_°©fs
, 
•
), \

158 
	`X
(
sys_sw≠off
, 
s
), \

159 
	`X
(
sys_sw≠⁄
, 
sd
), \

160 
	`X
(
sys_symlök©
, 
sds
), \

161 
	`X
(
sys_symlök
, 
ss
), \

162 
	`X
(
sys_syncfs
, 
d
), \

163 
	`X
(
sys_ãe
, 
ddxd
), \

164 
	`X
(
sys_tgkûl
, 
ddd
), \

165 
	`X
(
sys_timîfd_¸óã
, 
dd
), \

166 
	`X
(
sys_timîfd_gëtime
, 
dp
), \

167 
	`X
(
sys_timîfd_£âime
, 
ddµ
), \

168 
	`X
(
sys_åunˇã64
, 
sx
), \

169 
	`X
(
sys_åunˇã
, 
sx
), \

170 
	`X
(
sys_umou¡
, 
pd
), \

171 
	`X
(
sys_u∆ök©
, 
dsd
), \

172 
	`X
(
sys_u∆ök
, 
s
), \

173 
	`X
(
sys_unsh¨e
, 
x
), \

174 
	`X
(
sys_u£lib
, 
s
), \

175 
	`X
(
sys_utimíßt
, 
d•d
), \

176 
	`X
(
sys_utime
, 
µ
), \

177 
	`X
(
sys_utimes
, 
µ
), \

178 
	`X
(
sys_vf‹k
, ), \

179 
	`X
(
sys_vm•li˚
, 
dpxd
), \

180 
	`X
(
sys_waô4
, 
dddp
), \

181 
	`X
(
sys_waôid
, 
ddpdp
)

	)

	@ks_manager/ks_manager.c

25 
	~<löux/moduÀ.h
>

26 
	~<löux/¶ab.h
>

27 
	~<k¥obe/dbi_k¥obes.h
>

28 
	~<k¥obe/dbi_k¥obes_dïs.h
>

29 
	~"ks_m™agî.h
"

31 
	s¥obe
 {

32 
hli°_node
 
	mhli°
;

33 
kîn_¥obe
 
	mp
;

36 
HLIST_HEAD
(
li°_¥obes
);

38 
¥obe
 *
	$¸óã_¥obe
(
addr
, *
¥e_h™dÀr
,

39 *
jp_h™dÀr
, *
Ω_h™dÀr
)

41 
¥obe
 *
p
 = 
	`kzÆloc
((*p), 
GFP_KERNEL
);

43 
p
->p.
jp
.
kp
.
addr
 =Ö->p.
Ω
.kp.addr = (*)addr;

44 
p
->p.
jp
.
¥e_íåy
 = 
¥e_h™dÀr
;

45 
p
->p.
jp
.
íåy
 = 
jp_h™dÀr
;

46 
p
->p.
Ω
.
h™dÀr
 = 
Ω_h™dÀr
;

47 
	`INIT_HLIST_NODE
(&
p
->
hli°
);

49  
p
;

50 
	}
}

52 
	$‰ì_¥obe
(
¥obe
 *
p
)

54 
	`k‰ì
(
p
);

55 
	}
}

57 
	$add_¥obe_to_li°
(
¥obe
 *
p
)

59 
	`hli°_add_hód
(&
p
->
hli°
, &
li°_¥obes
);

60 
	}
}

62 
	$ªmove_¥obe_to_li°
(
¥obe
 *
p
)

64 
	`hli°_dñ
(&
p
->
hli°
);

65 
	}
}

67 
¥obe
 *
	$föd_¥obe
(
addr
)

69 
¥obe
 *
p
;

70 
	`DECLARE_NODE_PTR_FOR_HLIST
(
node
);

73 
	`sw≠_hli°_f‹_óch_íåy
(
p
, 
node
, &
li°_¥obes
, 
hli°
)

74 i‡(()
p
->p.
jp
.
kp
.
addr
 ==áddr)

75  
p
;

77  
NULL
;

78 
	}
}

80 
	$ksm_ªgi°î_¥obe
(
addr
, *
¥e_h™dÀr
,

81 *
jp_h™dÀr
, *
Ω_h™dÀr
)

83 
ªt
;

84 
¥obe
 *
p
;

86 
p
 = 
	`¸óã_¥obe
(
addr
, 
¥e_h™dÀr
, 
jp_h™dÀr
, 
Ω_h™dÀr
);

87 i‡(!
p
)

88  -
ENOMEM
;

90 
ªt
 = 
	`dbi_ªgi°î_j¥obe
(&
p
->p.
jp
);

91 i‡(
ªt
)

92 
‰ì
;

94 
ªt
 = 
	`dbi_ªgi°î_kªçrobe
(&
p
->p.
Ω
);

95 i‡(
ªt
)

96 
uƒegi°î_j¥obe
;

98 
	`add_¥obe_to_li°
(
p
);

101 
uƒegi°î_j¥obe
:

102 
	`dbi_uƒegi°î_j¥obe
(&
p
->p.
jp
);

103 
‰ì
:

104 
	`‰ì_¥obe
(
p
);

105  
ªt
;

106 
	}
}

107 
EXPORT_SYMBOL_GPL
(
ksm_ªgi°î_¥obe
);

109 
	$do_ksm_uƒegi°î_¥obe
(
¥obe
 *
p
)

111 
	`ªmove_¥obe_to_li°
(
p
);

112 
	`dbi_uƒegi°î_kªçrobe
(&
p
->p.
Ω
);

113 
	`dbi_uƒegi°î_j¥obe
(&
p
->p.
jp
);

114 
	`‰ì_¥obe
(
p
);

115 
	}
}

117 
	$ksm_uƒegi°î_¥obe
(
addr
)

119 
¥obe
 *
p
;

121 
p
 = 
	`föd_¥obe
(
addr
);

122 i‡(
p
 =
NULL
)

123  -
EINVAL
;

125 
	`do_ksm_uƒegi°î_¥obe
(
p
);

128 
	}
}

129 
EXPORT_SYMBOL_GPL
(
ksm_uƒegi°î_¥obe
);

131 
	$ksm_uƒegi°î_¥obe_Æl
()

133 
¥obe
 *
p
;

134 
hli°_node
 *
n
;

135 
	`DECLARE_NODE_PTR_FOR_HLIST
(
node
);

137 
	`sw≠_hli°_f‹_óch_íåy_ß„
(
p
, 
node
, 
n
, &
li°_¥obes
, 
hli°
) {

138 
	`do_ksm_uƒegi°î_¥obe
(
p
);

142 
	}
}

143 
EXPORT_SYMBOL_GPL
(
ksm_uƒegi°î_¥obe_Æl
);

145 
__öô
 
	$öô_ks_m™agî
()

148 
	}
}

150 
__exô
 
	$exô_ks_m™agî
()

152 
	`ksm_uƒegi°î_¥obe_Æl
();

153 
	}
}

155 
moduÀ_öô
(
öô_ks_m™agî
);

156 
moduÀ_exô
(
exô_ks_m™agî
);

158 
MODULE_LICENSE
 ("GPL");

	@ks_manager/ks_manager.h

1 #i‚de‡
_KS_MANAGER_H


2 
	#_KS_MANAGER_H


	)

28 
	~<k¥obe/dbi_k¥obes.h
>

30 
	skîn_¥obe
 {

31 
j¥obe
 
	mjp
;

32 
kªçrobe
 
	mΩ
;

35 
ksm_ªgi°î_¥obe
(
addr
, *
¥e_h™dÀr
,

36 *
jp_h™dÀr
, *
Ω_h™dÀr
);

37 
ksm_uƒegi°î_¥obe
(
addr
);

39 
ksm_uƒegi°î_¥obe_Æl
();

	@ks_manager/swap_ks_manager.mod.c

1 
	~<löux/moduÀ.h
>

2 
	~<löux/vîmagic.h
>

3 
	~<löux/compûî.h
>

5 
MODULE_INFO
(
vîmagic
, 
VERMAGIC_STRING
);

7 
moduÀ
 
__this_moduÀ


8 
__©åibuã__
((
£˘i⁄
(".gnu.linkonce.this_module"))) = {

9 .
«me
 = 
KBUILD_MODNAME
,

10 .
	göô
 = 
öô_moduÀ
,

11 #ifde‡
CONFIG_MODULE_UNLOAD


12 .
	gexô
 = 
˛ónup_moduÀ
,

14 .
	g¨ch
 = 
MODULE_ARCH_INIT
,

17 c⁄° 
	g__moduÀ_dïíds
[]

18 
__u£d


19 
__©åibuã__
((
£˘i⁄
(".modinfo"))) =

23 
MODULE_INFO
(
§cvîsi⁄
, "229A42BCB0C8C8BA9072596");

	@ksyms/ksyms.c

26 
	~"ksyms.h
"

27 
	~"ksyms_öô.h
"

28 
	~<löux/kÆlsyms.h
>

29 
	~<löux/moduÀ.h
>

30 
	~<löux/≥r˝u.h
>

32 
	ssymbﬁ_d©a
 {

33 c⁄° *
	m«me
;

34 
size_t
 
	mÀn
;

35 
	maddr
;

38 
	$symbﬁ_cb
(*
d©a
, c⁄° *
sym
, 
moduÀ
 *
mod
,

39 
addr
)

41 
symbﬁ_d©a
 *
sym_d©a_p
 = (symbﬁ_d©®*)
d©a
;

45 i‡(
	`°∫cmp
(
sym_d©a_p
->
«me
, 
sym
, sym_d©a_p->
Àn
) == 0) {

46 
sym_d©a_p
->
addr
 =áddr;

52 
	}
}

54 
	$sw≠_ksyms_sub°r
(c⁄° *
«me
)

56 
symbﬁ_d©a
 
sym_d©a
 = {

57 .
«me
 =Çame,

58 .
Àn
 = 
	`°æí
(
«me
),

59 .
addr
 = 0

61 
	`kÆlsyms_⁄_óch_symbﬁ
(
symbﬁ_cb
, (*)&
sym_d©a
);

63  
sym_d©a
.
addr
;

64 
	}
}

65 
EXPORT_SYMBOL_GPL
(
sw≠_ksyms_sub°r
);

	@ksyms/ksyms.h

1 #i‚de‡
__KSYMS_H__


2 
	#__KSYMS_H__


	)

28 
	~<löux/vîsi⁄.h
>

29 #i‡
LINUX_VERSION_CODE
 < 
KERNEL_VERSION
(2, 6, 33)

30 
	~<löux/autoc⁄f.h
>

32 
	~<gíî©ed/autoc⁄f.h
>

35 
	~<löux/kÆlsyms.h
>

37 #ifde‡
CONFIG_KALLSYMS


39 
ölöe
 
	$sw≠_gë_ksyms
()

42 
	}
}

44 
ölöe
 
	$sw≠_put_ksyms
()

46 
	}
}

48 
ölöe
 
	$sw≠_ksyms
(c⁄° *
«me
)

50  
	`kÆlsyms_lookup_«me
(
«me
);

51 
	}
}

55 
sw≠_gë_ksyms
();

56 
sw≠_put_ksyms
();

57 
sw≠_ksyms
(c⁄° *
«me
);

61 
sw≠_ksyms_sub°r
(c⁄° *
«me
);

	@ksyms/ksyms_init.h

25 #i‚de‡
__KSYMS_INIT_H__


26 
	#__KSYMS_INIT_H__


	)

28 #ifde‡
CONFIG_KALLSYMS


30 
ölöe
 
	$ksyms_öô
()

33 
	}
}

35 
ölöe
 
	$ksyms_exô
()

37 
	}
}

41 
ksyms_öô
();

42 
ksyms_exô
();

	@ksyms/ksyms_module.c

25 
	~"ksyms_öô.h
"

27 
	~<löux/moduÀ.h
>

29 
__öô
 
	$sw≠_ksyms_öô
()

31 
ªt
 = 
	`ksyms_öô
();

33 
	`¥ötk
("SWAP_KSYMS: Module initialized\n");

35  
ªt
;

36 
	}
}

38 
__exô
 
	$sw≠_ksyms_exô
()

40 
	`ksyms_exô
();

42 
	`¥ötk
("SWAP_KSYMS: Module uninitialized\n");

43 
	}
}

45 
moduÀ_öô
(
sw≠_ksyms_öô
);

46 
moduÀ_exô
(
sw≠_ksyms_exô
);

48 
MODULE_LICENSE
("GPL");

49 
MODULE_DESCRIPTION
("SWAP ksyms module");

50 
MODULE_AUTHOR
("Vyacheslav Cherkashin <v.cherkashin@samaung.com>");

	@ksyms/no_ksyms.c

25 
	~"ksyms.h
"

26 
	~"ksyms_öô.h
"

27 
	~<löux/ty≥s.h
>

28 
	~<löux/vmÆloc.h
>

29 
	~<löux/£m≠h‹e.h
>

30 
	~<löux/fs.h
>

31 
	~<löux/¶ab.h
>

32 
	~<asm/f˙é.h
>

35 
	#KSYMS_ERR
(
f‹m©
, 
¨gs
...) \

37 *
f
 = 
__FILE__
; \

38 *
n
 = 
	`°ºchr
(
f
, '/'); \

39 
	`¥ötk
("%s:%u \'%s\' ERROR: " 
f‹m©
 "\n" , (
n
Ë?Ç+1 : 
f
, 
__LINE__
, 
__FUNCTION__
, ##
¨gs
); \

40 } 0)

	)

43 
	ssys_m≠_ôem
 {

44 
li°_hód
 
	mli°
;

46 
	maddr
;

47 *
	m«me
;

50 * 
	gsm_∑th
 = 
NULL
;

51 
moduÀ_∑øm
(
sm_∑th
, 
ch¨p
, 0);

53 
LIST_HEAD
(
smi_li°
);

54 
fûe
 *
	gfûe
 = 
NULL
;

56 
	g˙t_öô_sm
 = 0;

57 
DEFINE_SEMAPHORE
(
˙t_öô_sm_lock
);

59 
	$fûe_›í
()

61 
fûe
 *
f
 = 
	`fûp_›í
(
sm_∑th
, 
O_RDONLY
, 0);

63 i‡(
	`IS_ERR
(
f
)) {

64 
	`KSYMS_ERR
("ˇ¬Ÿ o≥¿fûê\'%s\'", 
sm_∑th
);

65  
	`PTR_ERR
(
f
);

68 
fûe
 = 
f
;

71 
	}
}

73 
	$fûe_˛o£
()

75 i‡(
fûe
) {

76 
ªt
 = 
	`fûp_˛o£
(
fûe
, 
NULL
);

77 
fûe
 = 
NULL
;

79 i‡(
ªt
) {

80 
	`KSYMS_ERR
("whûê˛osög fûê\'%s\'Éº=%d", 
sm_∑th
, 
ªt
);

83 
	}
}

85 
	$fûe_check
()

87 
ªt
 = 
	`fûe_›í
();

88 i‡(
ªt
 == 0) {

89 
	`fûe_˛o£
();

92  
ªt
;

93 
	}
}

95 
	$fûe_size
(
fûe
 *file)

97 
k°©
 
°
;

98 i‡(
	`vfs_gë©å
(
fûe
->
f_∑th
.
m¡
, fûe->f_∑th.
díåy
, &
°
)) {

102 i‡(!
	`S_ISREG
(
°
.
mode
)) {

106 i‡(
°
.
size
 != ()st.size) {

110  
°
.
size
;

111 
	}
}

113 
sys_m≠_ôem
 *
	$¸óã_smi
(
addr
, c⁄° *
«me
)

115 
sys_m≠_ôem
 *
smi
 = 
	`kmÆloc
((*smi), 
GFP_KERNEL
);

117 i‡(
smi
 =
NULL
) {

118 
	`KSYMS_ERR
("notÉnough memory");

119  
NULL
;

122 
smi
->
«me
 = 
	`kmÆloc
(
	`°æí
“ameË+ 1, 
GFP_KERNEL
);

123 i‡(
smi
->
«me
 =
NULL
) {

124 
	`k‰ì
(
smi
);

125 
	`KSYMS_ERR
("notÉnough memory");

126  
NULL
;

129 
	`INIT_LIST_HEAD
(&
smi
->
li°
);

130 
smi
->
addr
 =áddr;

131 
	`°r˝y
(
smi
->
«me
,Çame);

133  
smi
;

134 
	}
}

136 
	$‰ì_smi
(
sys_m≠_ôem
 *
smi
)

138 
	`k‰ì
(
smi
->
«me
);

139 
	`k‰ì
(
smi
);

140 
	}
}

142 
	$add_smi
(
sys_m≠_ôem
 *
smi
)

144 
	`li°_add_èû
(&
smi
->
li°
, &
smi_li°
);

145 
	}
}

147 
	$is_ídlöe
(
c
)

149  
c
 == '\n' || c == '\r' || c == '\0';

150 
	}
}

152 
	$is_symbﬁ_©å
(
c
)

154  
c
 == 't' || c == 'T';

155 
	}
}

157 
sys_m≠_ôem
 *
	$gë_sys_m≠_ôem
(*
begö
, *
íd
)

159 
sys_m≠_ôem
 *
smi
 = 
NULL
;

160 
n
, 
Àn
 = 
íd
 - 
begö
;

161 
addr
;

162 
©å
, 
«me
[128], *
löe
;

164 
löe
 = 
	`kmÆloc
(
Àn
 + 1, 
GFP_KERNEL
);

165 
	`mem˝y
(
löe
, 
begö
, 
Àn
);

166 
löe
[
Àn
] = '\0';

168 
n
 = 
	`ssˇnf
(
löe
, "%lx %¯%127s", &
addr
, &
©å
, 
«me
);

169 
«me
[127] = '\0';

171 i‡(
n
 != 3) {

172 
	`KSYMS_ERR
("∑rsögÜöe: \"%s\"", 
löe
);

173 
©å
 = '\0';

176 
	`k‰ì
(
löe
);

178 i‡(
	`is_symbﬁ_©å
(
©å
)) {

179 
smi
 = 
	`¸óã_smi
(
addr
, 
«me
);

182  
smi
;

183 
	}
}

186 
	$∑rsög
(*
buf
, 
size
)

188 
sys_m≠_ôem
 *
smi
;

189 *
°¨t
, *
íd
, *
c
;

191 
°¨t
 = 
buf
;

192 
íd
 = 
buf
 + 
size
;

194 
c
 = 
°¨t
; c < 
íd
; ++c) {

195 i‡(
	`is_ídlöe
(*
c
)) {

196 
smi
 = 
	`gë_sys_m≠_ôem
(
°¨t
, 
c
);

197 i‡(
smi
) {

198 
	`add_smi
(
smi
);

201 
°¨t
 = 
c
; c < 
íd
; ++c) {

202 i‡(!
	`is_ídlöe
(*
c
)) {

203 
°¨t
 = 
c
;

209 
	}
}

211 
	$¸óã_sys_m≠
()

213 *
d©a
;

214 
size
;

215 
ªt
 = 
	`fûe_›í
();

217 i‡(
ªt
) {

218  
ªt
;

221 
size
 = 
	`fûe_size
(
fûe
);

222 i‡(
size
 < 0) {

223 
	`KSYMS_ERR
("cannot get file size");

224 
ªt
 = 
size
;

225 
˛o£
;

228 
d©a
 = 
	`vmÆloc
(
size
);

229 i‡(
d©a
 =
NULL
) {

230 
	`KSYMS_ERR
("notÉnough memory");

231 
ªt
 = -1;

232 
˛o£
;

235 i‡(
	`kî√l_ªad
(
fûe
, 0, 
d©a
, 
size
) != size) {

236 
	`KSYMS_ERR
("ªadög fûê%s", 
sm_∑th
);

237 
ªt
 = -1;

238 
‰ì
;

241 
	`∑rsög
(
d©a
, 
size
);

243 
‰ì
:

244 
	`v‰ì
(
d©a
);

246 
˛o£
:

247 
	`fûe_˛o£
();

250 
	}
}

252 
	$‰ì_sys_m≠
()

254 
sys_m≠_ôem
 *
smi
, *
n
;

255 
	`li°_f‹_óch_íåy_ß„
(
smi
, 
n
, &
smi_li°
, 
li°
) {

256 
	`li°_dñ
(&
smi
->
li°
);

257 
	`‰ì_smi
(
smi
);

259 
	}
}

261 
	$sw≠_gë_ksyms
()

263 
ªt
 = 0;

265 
	`down
(&
˙t_öô_sm_lock
);

266 i‡(
˙t_öô_sm
 == 0) {

267 
ªt
 = 
	`¸óã_sys_m≠
();

270 ++
˙t_öô_sm
;

271 
	`up
(&
˙t_öô_sm_lock
);

273  
ªt
;

274 
	}
}

275 
EXPORT_SYMBOL_GPL
(
sw≠_gë_ksyms
);

277 
	$sw≠_put_ksyms
()

279 
	`down
(&
˙t_öô_sm_lock
);

280 --
˙t_öô_sm
;

281 i‡(
˙t_öô_sm
 == 0) {

282 
	`‰ì_sys_m≠
();

285 i‡(
˙t_öô_sm
 < 0) {

286 
	`KSYMS_ERR
("˙t_öô_sm=%d", 
˙t_öô_sm
);

287 
˙t_öô_sm
 = 0;

290 
	`up
(&
˙t_öô_sm_lock
);

291 
	}
}

292 
EXPORT_SYMBOL_GPL
(
sw≠_put_ksyms
);

294 
	$sw≠_ksyms
(c⁄° *
«me
)

296 
sys_m≠_ôem
 *
smi
;

298 
	`li°_f‹_óch_íåy
(
smi
, &
smi_li°
, 
li°
) {

299 i‡(
	`°rcmp
(
«me
, 
smi
->name) == 0) {

300  
smi
->
addr
;

305 
	}
}

306 
EXPORT_SYMBOL_GPL
(
sw≠_ksyms
);

308 
	$sw≠_ksyms_sub°r
(c⁄° *
«me
)

310 
sys_m≠_ôem
 *
smi
;

311 
size_t
 
Àn
 = 
	`°æí
(
«me
);

313 
	`li°_f‹_óch_íåy
(
smi
, &
smi_li°
, 
li°
) {

314 i‡(
	`°∫cmp
(
«me
, 
smi
->«me, 
Àn
) == 0)

315  
smi
->
addr
;

319 
	}
}

320 
EXPORT_SYMBOL_GPL
(
sw≠_ksyms_sub°r
);

322 
	$ksyms_öô
()

324 
ªt
 = 0;

326 i‡(
sm_∑th
 =
NULL
) {

327 
	`KSYMS_ERR
("sm_path=NULL");

328  -
EINVAL
;

331 
ªt
 = 
	`fûe_check
();

332 i‡(
ªt
) {

333  -
EINVAL
;

337 
	`sw≠_gë_ksyms
();

340 
	}
}

342 
	$ksyms_exô
()

344 
	`down
(&
˙t_öô_sm_lock
);

346 i‡(
˙t_öô_sm
 > 0) {

347 
	`‰ì_sys_m≠
();

350 
	`up
(&
˙t_öô_sm_lock
);

351 
	}
}

	@parser/features.c

26 
	~<löux/ty≥s.h
>

27 
	~<löux/moduÀ.h
>

28 
	~<ks_„©uªs/ks_„©uªs.h
>

29 
	~<us_m™agî/us_m™agî.h
>

30 
	~"∑r£r_defs.h
"

31 
	~"„©uªs.h
"

32 
	~"msg_∑r£r.h
"

34 
	~<ßm∂î/sw≠_ßm∂î_moduÀ.h
>

35 
	~<íîgy/íîgy.h
>

37 
	e„©uªs_li°
 {

38 
	msysˇŒ_fûe
 = (1 << 10),

39 
	msysˇŒ_ùc
 = (1 << 11),

40 
	msysˇŒ_¥o˚ss
 = (1 << 12),

41 
	msysˇŒ_sig«l
 = (1 << 13),

42 
	msysˇŒ_√tw‹k
 = (1 << 14),

43 
	msysˇŒ_desc
 = (1 << 15),

44 
	mc⁄ãxt_swôch
 = (1 << 16),

45 
	mfunc_ßm∂ög
 = (1 << 19)

48 
	$£t_us_ö°
(
c⁄f_d©a
 *
c⁄f
)

50 
	`£t_quõt
(
QT_OFF
);

53 
	}
}

55 
	$un£t_us_ö°
()

57 
	`£t_quõt
(
QT_ON
);

60 
	}
}

62 
	$£t_sysˇŒ_fûe
(
c⁄f_d©a
 *
c⁄f
)

64 
ªt
;

66 
ªt
 = 
	`£t_„©uª
(
FID_FILE
);

68  
ªt
;

69 
	}
}

71 
	$un£t_sysˇŒ_fûe
()

73 
ªt
;

75 
ªt
 = 
	`un£t_„©uª
(
FID_FILE
);

77  
ªt
;

78 
	}
}

80 
	$£t_sysˇŒ_ùc
(
c⁄f_d©a
 *
c⁄f
)

82 
ªt
;

84 
ªt
 = 
	`£t_„©uª
(
FID_IPC
);

86  
ªt
;

87 
	}
}

89 
	$un£t_sysˇŒ_ùc
()

91 
ªt
;

93 
ªt
 = 
	`un£t_„©uª
(
FID_IPC
);

95  
ªt
;

96 
	}
}

98 
	$£t_sysˇŒ_¥o˚ss
(
c⁄f_d©a
 *
c⁄f
)

100 
ªt
;

102 
ªt
 = 
	`£t_„©uª
(
FID_PROCESS
);

104  
ªt
;

105 
	}
}

107 
	$un£t_sysˇŒ_¥o˚ss
()

109 
ªt
;

111 
ªt
 = 
	`un£t_„©uª
(
FID_PROCESS
);

113  
ªt
;

114 
	}
}

116 
	$£t_sysˇŒ_sig«l
(
c⁄f_d©a
 *
c⁄f
)

118 
ªt
;

120 
ªt
 = 
	`£t_„©uª
(
FID_SIGNAL
);

122  
ªt
;

123 
	}
}

125 
	$un£t_sysˇŒ_sig«l
()

127 
ªt
;

129 
ªt
 = 
	`un£t_„©uª
(
FID_SIGNAL
);

131  
ªt
;

132 
	}
}

134 
	$£t_sysˇŒ_√tw‹k
(
c⁄f_d©a
 *
c⁄f
)

136 
ªt
;

138 
ªt
 = 
	`£t_„©uª
(
FID_NET
);

140  
ªt
;

141 
	}
}

143 
	$un£t_sysˇŒ_√tw‹k
()

145 
ªt
;

147 
ªt
 = 
	`un£t_„©uª
(
FID_NET
);

149  
ªt
;

150 
	}
}

152 
	$£t_sysˇŒ_desc
(
c⁄f_d©a
 *
c⁄f
)

154 
ªt
;

156 
ªt
 = 
	`£t_„©uª
(
FID_DESC
);

158  
ªt
;

159 
	}
}

161 
	$un£t_sysˇŒ_desc
()

163 
ªt
;

165 
ªt
 = 
	`un£t_„©uª
(
FID_DESC
);

167  
ªt
;

168 
	}
}

170 
	$£t_c⁄ãxt_swôch
(
c⁄f_d©a
 *
c⁄f
)

172 
ªt
;

174 
ªt
 = 
	`£t_„©uª
(
FID_SWITCH
);

176  
ªt
;

177 
	}
}

179 
	$un£t_c⁄ãxt_swôch
()

181 
ªt
;

183 
ªt
 = 
	`un£t_„©uª
(
FID_SWITCH
);

185  
ªt
;

186 
	}
}

188 
	$£t_func_ßm∂ög
(
c⁄f_d©a
 *
c⁄f
)

190 
ªt
;

192 
ªt
 = 
	`sw≠_ßm∂î_°¨t
(
c⁄f
->
d©a_msg_≥riod
);

194  
ªt
;

195 
	}
}

197 
	$un£t_func_ßm∂ög
()

199 
ªt
;

201 
ªt
 = 
	`sw≠_ßm∂î_°›
();

203  
ªt
;

204 
	}
}

206 
	$£t_func_íîgy
(
c⁄f_d©a
 *
c⁄f
)

208  
	`£t_íîgy
();

209 
	}
}

211 
	$un£t_func_íîgy
()

213  
	`un£t_íîgy
();

214 
	}
}

216 
	s„©uª_ôem
 {

217 *
	m«me
;

218 (*
	m£t
)(
c⁄f_d©a
 *
	mc⁄f
);

219 (*
	mun£t
)();

222 
„©uª_ôem
 
	g„©uª_us_ö°
 = {

223 .
«me
 = "user space instrumentation",

224 .
	g£t
 = 
£t_us_ö°
,

225 .
	gun£t
 = 
un£t_us_ö°


228 
„©uª_ôem
 
	g„©uª_sysˇŒ_fûe
 = {

229 .
«me
 = "file operation syscalls",

230 .
	g£t
 = 
£t_sysˇŒ_fûe
,

231 .
	gun£t
 = 
un£t_sysˇŒ_fûe


234 
„©uª_ôem
 
	g„©uª_sysˇŒ_ùc
 = {

235 .
«me
 = "IPC syscall",

236 .
	g£t
 = 
£t_sysˇŒ_ùc
,

237 .
	gun£t
 = 
un£t_sysˇŒ_ùc


240 
„©uª_ôem
 
	g„©uª_sysˇŒ_¥o˚ss
 = {

241 .
«me
 = "process syscalls",

242 .
	g£t
 = 
£t_sysˇŒ_¥o˚ss
,

243 .
	gun£t
 = 
un£t_sysˇŒ_¥o˚ss


246 
„©uª_ôem
 
	g„©uª_sysˇŒ_sig«l
 = {

247 .
«me
 = "signal syscalls",

248 .
	g£t
 = 
£t_sysˇŒ_sig«l
,

249 .
	gun£t
 = 
un£t_sysˇŒ_sig«l


252 
„©uª_ôem
 
	g„©uª_sysˇŒ_√tw‹k
 = {

253 .
«me
 = "network syscalls",

254 .
	g£t
 = 
£t_sysˇŒ_√tw‹k
,

255 .
	gun£t
 = 
un£t_sysˇŒ_√tw‹k


258 
„©uª_ôem
 
	g„©uª_sysˇŒ_desc
 = {

259 .
«me
 = "descriptor syscalls",

260 .
	g£t
 = 
£t_sysˇŒ_desc
,

261 .
	gun£t
 = 
un£t_sysˇŒ_desc


264 
„©uª_ôem
 
	g„©uª_c⁄ãxt_swôch
 = {

265 .
«me
 = "context switch",

266 .
	g£t
 = 
£t_c⁄ãxt_swôch
,

267 .
	gun£t
 = 
un£t_c⁄ãxt_swôch


270 
„©uª_ôem
 
	g„©uª_func_ßm∂ög
 = {

271 .
«me
 = "function sampling",

272 .
	g£t
 = 
£t_func_ßm∂ög
,

273 .
	gun£t
 = 
un£t_func_ßm∂ög


276 
„©uª_ôem
 
	g„©uª_func_íîgy
 = {

277 .
«me
 = "energy",

278 .
	g£t
 = 
£t_func_íîgy
,

279 .
	gun£t
 = 
un£t_func_íîgy


282 
„©uª_ôem
 *
	g„©uª_li°
[] = {

283  
NULL
,

284  
NULL
,

285  &
„©uª_us_ö°
,

286  
NULL
,

287  
NULL
,

288  
NULL
,

289  
NULL
,

290  
NULL
,

291  
NULL
,

292  
NULL
,

293  &
„©uª_sysˇŒ_fûe
,

294  &
„©uª_sysˇŒ_ùc
,

295  &
„©uª_sysˇŒ_¥o˚ss
,

296  &
„©uª_sysˇŒ_sig«l
,

297  &
„©uª_sysˇŒ_√tw‹k
,

298  &
„©uª_sysˇŒ_desc
,

299  &
„©uª_c⁄ãxt_swôch
,

300  
NULL
,

301  
NULL
,

302  &
„©uª_func_ßm∂ög
,

303  
NULL
,

304  
NULL
,

305  
NULL
,

306  
NULL
,

307  
NULL
,

308  
NULL
,

309  &
„©uª_func_íîgy


313 
	mSIZE_FEATURE_LIST
 = (
„©uª_li°
Ë/ (
„©uª_ôem
 *),

316 
u64
 
	g„©uª_ö°
 = 0;

317 
u64
 
	g„©uª_mask
 = 0;

319 
	$öô_„©uªs
()

321 
i
;

322 
i
 = 0; i < 
SIZE_FEATURE_LIST
; ++i) {

323 
	`¥ötk
("### f inô_„©uª_mask[%2d]=%p\n", 
i
, 
„©uª_li°
[i]);

324 i‡(
„©uª_li°
[
i
] !
NULL
) {

325 
„©uª_mask
 |((
u64
)1Ë<< 
i
;

326 
	`¥ötk
("### fÇame=%s\n", 
„©uª_li°
[
i
]->
«me
);

331 
	}
}

333 
	$unöô_„©uªs
()

335 
	}
}

337 
	$do_£t_„©uªs
(
c⁄f_d©a
 *
c⁄f
)

339 
i
, 
ªt
;

340 
u64
 
„©uª_XOR
;

341 
u64
 
„©uªs
, 
„©uªs_backup
;

344 
„©uªs_backup
 = 
„©uªs
 = 
c⁄f
->
u£_„©uªs0
;

346 
„©uªs
 &
„©uª_mask
;

347 
„©uª_XOR
 = 
„©uªs
 ^ 
„©uª_ö°
;

349 
i
 = 0; 
„©uª_XOR
 && i < 
SIZE_FEATURE_LIST
; ++i) {

350 i‡((
„©uª_XOR
 & 1Ë&& 
„©uª_li°
[
i
] !
NULL
) {

351 
u64
 
f_mask
;

352 i‡(
„©uªs
 & 1)

353 
ªt
 = 
„©uª_li°
[
i
]->
	`£t
(
c⁄f
);

355 
ªt
 = 
„©uª_li°
[
i
]->
	`un£t
();

357 i‡(
ªt
) {

358 *
func
 = 
„©uªs
 & 1 ? "set" : "unset";

359 
	`¥öt_îr
("%s '%s'Ñet=%d\n",

360 
func
, 
„©uª_li°
[
i
]->
«me
, 
ªt
);

362  
ªt
;

364 
f_mask
 = ~(1 << 
i
);

365 
„©uª_ö°
 = („©uª_ö° & 
f_mask
) |

366 (
„©uªs_backup
 & ~
f_mask
);

369 
„©uªs
 >>= 1;

370 
„©uª_XOR
 >>= 1;

374 
	}
}

376 
DEFINE_MUTEX
(
muãx_„©uªs
);

378 
	$£t_„©uªs
(
c⁄f_d©a
 *
c⁄f
)

380 
ªt
;

382 
	`muãx_lock
(&
muãx_„©uªs
);

383 
ªt
 = 
	`do_£t_„©uªs
(
c⁄f
);

384 
	`muãx_u∆ock
(&
muãx_„©uªs
);

386  
ªt
;

387 
	}
}

	@parser/features.h

26 #i‚de‡
_FEATURES_H


27 
	#_FEATURES_H


	)

29 
	gc⁄f_d©a
;

31 
öô_„©uªs
();

32 
unöô_„©uªs
();

34 
£t_„©uªs
(
c⁄f_d©a
 *
c⁄f
);

	@parser/msg_buf.c

26 
	~<löux/¶ab.h
>

27 
	~<löux/vmÆloc.h
>

28 
	~"msg_buf.h
"

29 
	~"∑r£r_defs.h
"

31 
	$öô_mb
(
msg_buf
 *
mb
, 
size_t
 
size
)

33 i‡(
size
) {

34 
mb
->
begö
 = 
	`vmÆloc
(
size
);

35 i‡(
mb
->
begö
 =
NULL
) {

36 
	`¥ötk
("Cannotálloc memory!\n");

37  -
ENOMEM
;

40 
mb
->
±r
 = mb->
begö
;

41 
mb
->
íd
 = mb->
begö
 + 
size
;

43 
mb
->
begö
 = mb->
íd
 = mb->
±r
 = 
NULL
;

46 
	}
}

48 
	$unöô_mb
(
msg_buf
 *
mb
)

50 
	`v‰ì
(
mb
->
begö
);

51 
	}
}

53 
	$cmp_mb
(
msg_buf
 *
mb
, 
size_t
 
size
)

55 *
tmp
;

57 
tmp
 = 
mb
->
±r
 + 
size
;

58 i‡(
mb
->
íd
 > 
tmp
)

60 i‡(
mb
->
íd
 < 
tmp
)

64 
	}
}

66 
size_t
 
	$ªmaöed_mb
(
msg_buf
 *
mb
)

68  
mb
->
íd
 - mb->
±r
;

69 
	}
}

71 
	$is_íd_mb
(
msg_buf
 *
mb
)

73  
mb
->
±r
 =mb->
íd
;

74 
	}
}

76 
	$gë_u8
(
msg_buf
 *
mb
, 
u8
 *
vÆ
)

78 i‡(
	`cmp_mb
(
mb
, (*
vÆ
)) < 0)

79  -
EINVAL
;

81 *
vÆ
 = *((
u8
 *)
mb
->
±r
);

82 
mb
->
±r
 +(*
vÆ
);

84 
	`¥öt_∑r£_debug
("u8 ->%d;%08X\n", *
vÆ
, *val);

87 
	}
}

89 
	$gë_u32
(
msg_buf
 *
mb
, 
u32
 *
vÆ
)

91 i‡(
	`cmp_mb
(
mb
, (*
vÆ
)) < 0)

92  -
EINVAL
;

94 *
vÆ
 = *((
u32
 *)
mb
->
±r
);

95 
mb
->
±r
 +(*
vÆ
);

97 
	`¥öt_∑r£_debug
("u32->%d;%08X\n", *
vÆ
, *val);

100 
	}
}

102 
	$gë_u64
(
msg_buf
 *
mb
, 
u64
 *
vÆ
)

104 i‡(
	`cmp_mb
(
mb
, (*
vÆ
)) < 0)

105  -
EINVAL
;

107 *
vÆ
 = *((
u64
 *)
mb
->
±r
);

108 
mb
->
±r
 +(*
vÆ
);

109 
	`¥öt_∑r£_debug
("u64->%Œu; 0x%016ŒX\n", *
vÆ
, *val);

112 
	}
}

114 
	$gë_°rög
(
msg_buf
 *
mb
, **
°r
)

116 
size_t
 
Àn
, 
Àn_max
;

117 íum { 
mö_Àn_°r
 = 1 };

119 i‡(
	`cmp_mb
(
mb
, 
mö_Àn_°r
) < 0)

120  -
EINVAL
;

122 
Àn_max
 = 
	`ªmaöed_mb
(
mb
) - 1;

123 
Àn
 = 
	`°∫Àn
(
mb
->
±r
, 
Àn_max
);

125 *
°r
 = 
	`kmÆloc
(
Àn
 + 1, 
GFP_KERNEL
);

126 i‡(*
°r
 =
NULL
)

127  -
ENOMEM
;

129 
	`mem˝y
(*
°r
, 
mb
->
±r
, 
Àn
);

130 (*
°r
)[
Àn
] = '\0';

132 
mb
->
±r
 +
Àn
 + 1;

134 
	`¥öt_∑r£_debug
("°r->'%s'\n", *
°r
);

136 
	}
}

138 
	$put_°rög
(*
°r
)

140 
	`k‰ì
(
°r
);

141 
	}
}

	@parser/msg_buf.h

26 #i‚de‡
_MSG_BUF_H


27 
	#_MSG_BUF_H


	)

29 
	~<löux/ty≥s.h
>

31 
	smsg_buf
 {

32 *
	mbegö
;

33 *
	míd
;

34 *
	m±r
;

37 
öô_mb
(
msg_buf
 *
mb
, 
size_t
 
size
);

38 
unöô_mb
(
msg_buf
 *
mb
);

40 
cmp_mb
(
msg_buf
 *
mb
, 
size_t
 
size
);

41 
size_t
 
ªmaöed_mb
(
msg_buf
 *
mb
);

42 
is_íd_mb
(
msg_buf
 *
mb
);

44 
gë_u8
(
msg_buf
 *
mb
, 
u8
 *
vÆ
);

45 
gë_u32
(
msg_buf
 *
mb
, 
u32
 *
vÆ
);

46 
gë_u64
(
msg_buf
 *
mb
, 
u64
 *
vÆ
);

48 
gë_°rög
(
msg_buf
 *
mb
, **
°r
);

49 
put_°rög
(*
°r
);

	@parser/msg_cmd.c

26 
	~<löux/î∫o.h
>

27 
	~<wrôî/sw≠_wrôî_moduÀ.h
>

28 
	~"msg_∑r£r.h
"

29 
	~"msg_buf.h
"

30 
	~"„©uªs.h
"

31 
	~"∑r£r_defs.h
"

32 
	~"us_ö°.h
"

33 
	~<us_m™agî/us_m™agî.h
>

35 
	$£t_c⁄fig
(
c⁄f_d©a
 *
c⁄f
)

37 
ªt
;

39 
ªt
 = 
	`£t_„©uªs
(
c⁄f
);

41  
ªt
;

42 
	}
}

44 
	$msg_kìp_Æive
(
msg_buf
 *
mb
)

46 i‡(!
	`is_íd_mb
(
mb
)) {

47 
	`¥öt_îr
("tÿl⁄g mesßge,Ñemaöed=%u", 
	`ªmaöed_mb
(
mb
));

48  -
EINVAL
;

52 
	}
}

54 
	$msg_°¨t
(
msg_buf
 *
mb
)

56 
ªt
 = 0;

57 
us_ö°_d©a
 *
us_ö°
;

58 
c⁄f_d©a
 
c⁄f
;

60 
	`ª£t_£q_num
();

61 
	`ª£t_disˇrded
();

63 
us_ö°
 = 
	`¸óã_us_ö°_d©a
(
mb
);

64 i‡(
us_ö°
 =
NULL
) {

65  -
EINVAL
;

68 i‡(!
	`is_íd_mb
(
mb
)) {

69 
	`¥öt_îr
("tÿl⁄g mesßge,Ñemaöed=%u", 
	`ªmaöed_mb
(
mb
));

70 
ªt
 = -
EINVAL
;

71 
‰ì_us_ö°
;

74 
ªt
 = 
	`mod_us_ö°
(
us_ö°
, 
MT_ADD
);

75 i‡(
ªt
) {

76 
	`¥ötk
("C™nŸ mod u†ö°,Ñë = %d\n", 
ªt
);

77 
ªt
 = -
EINVAL
;

78 
‰ì_us_ö°
;

81 
ªt
 = 
	`usm_°¨t
();

82 i‡(
ªt
)

83 
‰ì_us_ö°
;

85 
	`ª°‹e_c⁄fig
(&
c⁄f
);

86 
	`£t_c⁄fig
(&
c⁄f
);

88 
‰ì_us_ö°
:

89 
	`de°roy_us_ö°_d©a
(
us_ö°
);

91  
ªt
;

92 
	}
}

94 
	$msg_°›
(
msg_buf
 *
mb
)

96 
ªt
 = 0;

97 
c⁄f_d©a
 
c⁄f
;

98 
disˇrded
;

100 i‡(!
	`is_íd_mb
(
mb
)) {

101 
	`¥öt_îr
("tÿl⁄g mesßge,Ñemaöed=%u", 
	`ªmaöed_mb
(
mb
));

102  -
EINVAL
;

105 
ªt
 = 
	`usm_°›
();

106 i‡(
ªt
)

107  
ªt
;

109 
c⁄f
.
u£_„©uªs0
 = 0;

110 
c⁄f
.
u£_„©uªs1
 = 0;

111 
ªt
 = 
	`£t_c⁄fig
(&
c⁄f
);

112 i‡(
ªt
)

113 
	`¥ötk
("C™nŸ së c⁄fig,Ñë = %d\n", 
ªt
);

115 
disˇrded
 = 
	`gë_disˇrded_cou¡
();

116 
	`¥ötk
("disˇrded mesßges: %d\n", 
disˇrded
);

117 
	`ª£t_disˇrded
();

119  
ªt
;

120 
	}
}

122 
	$msg_c⁄fig
(
msg_buf
 *
mb
)

124 
ªt
 = 0;

125 
c⁄f_d©a
 *
c⁄f
;

126 
°©us_ty≥
 
°
;

128 
c⁄f
 = 
	`¸óã_c⁄f_d©a
(
mb
);

129 i‡(
c⁄f
 =
NULL
)

130  -
EINVAL
;

132 i‡(!
	`is_íd_mb
(
mb
)) {

133 
	`¥öt_îr
("tÿl⁄g mesßge,Ñemaöed=%u", 
	`ªmaöed_mb
(
mb
));

134 
ªt
 = -
EINVAL
;

135 
‰ì_c⁄f_d©a
;

138 
°
 = 
	`usm_gë_°©us
();

139 i‡(
°
 =
ST_ON
)

140 
	`£t_c⁄fig
(
c⁄f
);

142 
	`ßve_c⁄fig
(
c⁄f
);

143 
	`usm_put_°©us
(
°
);

145 
‰ì_c⁄f_d©a
:

146 
	`de°roy_c⁄f_d©a
(
c⁄f
);

148  
ªt
;

149 
	}
}

151 
	$msg_sw≠_ö°_add
(
msg_buf
 *
mb
)

153 
ªt
 = 0;

154 
us_ö°_d©a
 *
us_ö°
;

156 
us_ö°
 = 
	`¸óã_us_ö°_d©a
(
mb
);

157 i‡(
us_ö°
 =
NULL
) {

158  -
EINVAL
;

161 i‡(!
	`is_íd_mb
(
mb
)) {

162 
	`¥öt_îr
("tÿl⁄g mesßge,Ñemaöed=%u", 
	`ªmaöed_mb
(
mb
));

163 
ªt
 = -
EINVAL
;

164 
‰ì_us_ö°
;

167 
ªt
 = 
	`mod_us_ö°
(
us_ö°
, 
MT_ADD
);

169 
‰ì_us_ö°
:

170 
	`de°roy_us_ö°_d©a
(
us_ö°
);

172  
ªt
;

173 
	}
}

175 
	$msg_sw≠_ö°_ªmove
(
msg_buf
 *
mb
)

177 
ªt
 = 0;

178 
us_ö°_d©a
 *
us_ö°
;

180 
us_ö°
 = 
	`¸óã_us_ö°_d©a
(
mb
);

181 i‡(
us_ö°
 =
NULL
) {

182  -
EINVAL
;

185 i‡(!
	`is_íd_mb
(
mb
)) {

186 
	`¥öt_îr
("tÿl⁄g mesßge,Ñemaöed=%u", 
	`ªmaöed_mb
(
mb
));

187 
ªt
 = -
EINVAL
;

188 
‰ì_us_ö°
;

191 
ªt
 = 
	`mod_us_ö°
(
us_ö°
, 
MT_DEL
);

193 
‰ì_us_ö°
:

194 
	`de°roy_us_ö°_d©a
(
us_ö°
);

196  
ªt
;

197 
	}
}

199 
	$öô_cmd
()

201 
ªt
;

203 
ªt
 = 
	`öô_„©uªs
();

205  
ªt
;

206 
	}
}

208 
	$unöô_cmd
()

210 
	`unöô_„©uªs
();

211 
	}
}

	@parser/msg_cmd.h

25 #i‚de‡
_MSG_CMD_H


26 
	#_MSG_CMD_H


	)

28 
	gmsg_buf
;

30 
öô_cmd
();

31 
unöô_cmd
();

33 
msg_kìp_Æive
(
msg_buf
 *
mb
);

34 
msg_°¨t
(
msg_buf
 *
mb
);

35 
msg_°›
(
msg_buf
 *
mb
);

36 
msg_c⁄fig
(
msg_buf
 *
mb
);

37 
msg_sw≠_ö°_add
(
msg_buf
 *
mb
);

38 
msg_sw≠_ö°_ªmove
(
msg_buf
 *
mb
);

	@parser/msg_parser.c

26 
	~<löux/¶ab.h
>

27 
	~"msg_∑r£r.h
"

28 
	~"msg_buf.h
"

29 
	~"∑r£r_defs.h
"

32 
	$°r_to_u32
(c⁄° * 
°r
, 
u32
 *
vÆ
)

34 
u32
 
ªsu…
;

35 if(!
°r
 || !*str)

36  -
EINVAL
;

38 
ªsu…
 = 0 ; *
°r
; ++str) {

39 i‡(*
°r
 < '0' || *str> '9')

40  -
EINVAL
;

42 
ªsu…
 =Ñesu… * 10 + (*
°r
 - '0');

45 *
vÆ
 = 
ªsu…
;

48 
	}
}

58 
≠p_öfo_d©a
 *
	$¸óã_≠p_öfo
(
msg_buf
 *
mb
)

60 
ªt
;

61 
≠p_öfo_d©a
 *
ai
;

62 
u32
 
≠p_ty≥
;

63 *
è_id
, *
exec_∑th
;

65 
	`¥öt_∑r£_debug
("app_info:\n");

67 
	`¥öt_∑r£_debug
("type:");

68 
ªt
 = 
	`gë_u32
(
mb
, &
≠p_ty≥
);

69 i‡(
ªt
) {

70 
	`¥öt_îr
("failedÅoÑeadÅargetápplicationÅype\n");

71  
NULL
;

74 
	`¥öt_∑r£_debug
("id:");

75 
ªt
 = 
	`gë_°rög
(
mb
, &
è_id
);

76 i‡(
ªt
) {

77 
	`¥öt_îr
("failedÅoÑeadÅargetápplication ID\n");

78  
NULL
;

81 
	`¥öt_∑r£_debug
("execÖath:");

82 
ªt
 = 
	`gë_°rög
(
mb
, &
exec_∑th
);

83 i‡(
ªt
) {

84 
	`¥öt_îr
("failedÅoÑeadÉxecutableÖath\n");

85 
‰ì_è_id
;

88 
ai
 = 
	`kmÆloc
((*ai), 
GFP_KERNEL
);

89 i‡(
ai
 =
NULL
) {

90 
	`¥öt_îr
("out of memory\n");

91 
‰ì_exec_∑th
;

94 
≠p_ty≥
) {

95 
AT_TIZEN_NATIVE_APP
:

96 
AT_TIZEN_WEB_APP
:

97 
AT_COMMON_EXEC
:

98 
ai
->
tgid
 = 0;

100 
AT_PID
: {

101 
u32
 
tgid
 = 0;

103 i‡(*
è_id
 != '\0') {

104 
ªt
 = 
	`°r_to_u32
(
è_id
, &
tgid
);

105 i‡(
ªt
) {

106 
	`¥öt_îr
("converting stringÅo PID, "

107 "°r='%s'\n", 
è_id
);

108 
‰ì_ai
;

112 
ai
->
tgid
 =Ågid;

116 
	`¥öt_îr
("wr⁄gáµliˇti⁄Åy≥(%u)\n", 
≠p_ty≥
);

117 
ªt
 = -
EINVAL
;

118 
‰ì_ai
;

121 
ai
->
≠p_ty≥
 = (
APP_TYPE
)app_type;

122 
ai
->
exec_∑th
 =Éxec_path;

124 
	`put_°rög
(
è_id
);

126  
ai
;

128 
‰ì_ai
:

129 
	`k‰ì
(
ai
);

131 
‰ì_exec_∑th
:

132 
	`put_°rög
(
exec_∑th
);

134 
‰ì_è_id
:

135 
	`put_°rög
(
è_id
);

137  
NULL
;

138 
	}
}

140 
	$de°roy_≠p_öfo
(
≠p_öfo_d©a
 *
ai
)

142 
	`put_°rög
(
ai
->
exec_∑th
);

143 
	`k‰ì
(
ai
);

144 
	}
}

154 
c⁄f_d©a
 *
	$¸óã_c⁄f_d©a
(
msg_buf
 *
mb
)

156 
c⁄f_d©a
 *
c⁄f
;

157 
u64
 
u£_„©uªs0
, 
u£_„©uªs1
;

158 
u32
 
°p
, 
dmp
;

160 
	`¥öt_∑r£_debug
("conf_data:\n");

162 
	`¥öt_∑r£_debug
("features:");

163 i‡(
	`gë_u64
(
mb
, &
u£_„©uªs0
)) {

164 
	`¥öt_îr
("failedÅoÑead use_features\n");

165  
NULL
;

168 i‡(
	`gë_u64
(
mb
, &
u£_„©uªs1
)) {

169 
	`¥öt_îr
("failedÅoÑead use_features\n");

170  
NULL
;

173 
	`¥öt_∑r£_debug
("sysÅraceÖeriod:");

174 i‡(
	`gë_u32
(
mb
, &
°p
)) {

175 
	`¥öt_îr
("failedÅoÑead sysÅraceÖeriod\n");

176  
NULL
;

179 
	`¥öt_∑r£_debug
("data msgÖeriod:");

180 i‡(
	`gë_u32
(
mb
, &
dmp
)) {

181 
	`¥öt_îr
("failedÅoÑead data messageÖeriod\n");

182  
NULL
;

185 
c⁄f
 = 
	`kmÆloc
((*c⁄f), 
GFP_KERNEL
);

186 i‡(
c⁄f
 =
NULL
) {

187 
	`¥öt_îr
("out of memory\n");

188  
NULL
;

191 
c⁄f
->
u£_„©uªs0
 = use_features0;

192 
c⁄f
->
u£_„©uªs1
 = use_features1;

193 
c⁄f
->
sys_åa˚_≥riod
 = 
°p
;

194 
c⁄f
->
d©a_msg_≥riod
 = 
dmp
;

196  
c⁄f
;

197 
	}
}

199 
	$de°roy_c⁄f_d©a
(
c⁄f_d©a
 *
c⁄f
)

201 
	`k‰ì
(
c⁄f
);

202 
	}
}

204 
c⁄f_d©a
 
	gc⁄fig
;

205 
	$ßve_c⁄fig
(c⁄° 
c⁄f_d©a
 *
c⁄f
)

207 
	`mem˝y
(&
c⁄fig
, 
c⁄f
, (config));

208 
	}
}

210 
	$ª°‹e_c⁄fig
(
c⁄f_d©a
 *
c⁄f
)

212 
	`mem˝y
(
c⁄f
, &
c⁄fig
, (*conf));

213 
	}
}

221 
func_ö°_d©a
 *
	$¸óã_func_ö°_d©a
(
msg_buf
 *
mb
)

223 
func_ö°_d©a
 *
fi
;

224 
u64
 
addr
;

225 *
¨gs
;

226 
ªt_ty≥
;

228 
	`¥öt_∑r£_debug
("funcáddr:");

229 i‡(
	`gë_u64
(
mb
, &
addr
)) {

230 
	`¥öt_îr
("failedÅoÑead data functionáddress\n");

231  
NULL
;

234 
	`¥öt_∑r£_debug
("functárgs:");

235 i‡(
	`gë_°rög
(
mb
, &
¨gs
)) {

236 
	`¥öt_îr
("failedÅoÑead data functionárguments\n");

237  
NULL
;

240 
	`¥öt_∑r£_debug
("functÑetÅype:");

241 i‡(
	`gë_u8
(
mb
, (
u8
 *)&
ªt_ty≥
)) {

242 
	`¥öt_îr
("failedÅoÑead data functionárguments\n");

243 
‰ì_¨gs
;

246 
fi
 = 
	`kmÆloc
((*fi), 
GFP_KERNEL
);

247 i‡(
fi
 =
NULL
) {

248 
	`¥öt_îr
("out of memory\n");

249 
‰ì_¨gs
;

252 
fi
->
addr
 =áddr;

253 
fi
->
¨gs
 =árgs;

254 
fi
->
ªt_ty≥
 =Ñet_type;

256  
fi
;

258 
‰ì_¨gs
:

259 
	`put_°rög
(
¨gs
);

260  
NULL
;

261 
	}
}

263 
	$de°roy_func_ö°_d©a
(
func_ö°_d©a
 *
fi
)

265 
	`put_°rög
(
fi
->
¨gs
);

266 
	`k‰ì
(
fi
);

267 
	}
}

277 
lib_ö°_d©a
 *
	$¸óã_lib_ö°_d©a
(
msg_buf
 *
mb
)

279 
lib_ö°_d©a
 *
li
;

280 
func_ö°_d©a
 *
fi
;

281 *
∑th
;

282 
u32
 
˙t
, 
j
, 
i
 = 0;

284 
	`¥öt_∑r£_debug
("binÖath:");

285 i‡(
	`gë_°rög
(
mb
, &
∑th
)) {

286 
	`¥öt_îr
("failedÅoÑeadÖath of binary\n");

287  
NULL
;

290 
	`¥öt_∑r£_debug
("func count:");

291 i‡(
	`gë_u32
(
mb
, &
˙t
)) {

292 
	`¥öt_îr
("failedÅoÑead count of functions\n");

293 
‰ì_∑th
;

296 i‡(
	`ªmaöed_mb
(
mb
Ë/ 
MIN_SIZE_FUNC_INST
 < 
˙t
) {

297 
	`¥öt_îr
("tÿm©ch cou¡ o‡fun˘i⁄s(%u)\n", 
˙t
);

298 
‰ì_∑th
;

301 
li
 = 
	`kmÆloc
((*li), 
GFP_KERNEL
);

302 i‡(
li
 =
NULL
)

303 i‡(
li
 =
NULL
) {

304 
	`¥öt_îr
("out of memory\n");

305 
‰ì_∑th
;

308 
li
->
func
 = 
	`kmÆloc
((
func_ö°_d©a
 *Ë* 
˙t
, 
GFP_KERNEL
);

309 i‡(
li
->
func
 =
NULL
)

310 i‡(
li
->
func
 =
NULL
) {

311 
	`¥öt_îr
("out of memory\n");

312 
‰ì_li
;

315 
i
 = 0; i < 
˙t
; ++i) {

316 
	`¥öt_∑r£_debug
("fun¯#%d:\n", 
i
 + 1);

317 
fi
 = 
	`¸óã_func_ö°_d©a
(
mb
);

318 i‡(
fi
 =
NULL
)

319 
‰ì_func
;

321 
li
->
func
[
i
] = 
fi
;

324 
li
->
∑th
 =Öath;

325 
li
->
˙t_func
 = 
˙t
;

327  
li
;

329 
‰ì_func
:

330 
j
 = 0; j < 
i
; ++j)

331 
	`de°roy_func_ö°_d©a
(
li
->
func
[
j
]);

332 
	`k‰ì
(
li
->
func
);

334 
‰ì_li
:

335 
	`k‰ì
(
li
);

337 
‰ì_∑th
:

338 
	`put_°rög
(
∑th
);

340  
NULL
;

341 
	}
}

343 
	$de°roy_lib_ö°_d©a
(
lib_ö°_d©a
 *
li
)

345 
i
;

347 
	`put_°rög
(
li
->
∑th
);

349 
i
 = 0; i < 
li
->
˙t_func
; ++i)

350 
	`de°roy_func_ö°_d©a
(
li
->
func
[
i
]);

352 
	`k‰ì
(
li
->
func
);

353 
	`k‰ì
(
li
);

354 
	}
}

364 
≠p_ö°_d©a
 *
	$¸óã_≠p_ö°_d©a
(
msg_buf
 *
mb
)

366 
≠p_ö°_d©a
 *
≠p_ö°
;

367 
≠p_öfo_d©a
 *
≠p_öfo
;

368 
func_ö°_d©a
 *
func
;

369 
lib_ö°_d©a
 *
lib
;

370 
u32
 
˙t_func
, 
i_func
 = 0, 
˙t_lib
, 
i_lib
 = 0, 
i
;

372 
≠p_öfo
 = 
	`¸óã_≠p_öfo
(
mb
);

373 i‡(
≠p_öfo
 =
NULL
)

374  
NULL
;

376 
	`¥öt_∑r£_debug
("func count:");

377 i‡(
	`gë_u32
(
mb
, &
˙t_func
)) {

378 
	`¥öt_îr
("failedÅoÑead count of functions\n");

379 
‰ì_≠p_öfo
;

382 i‡(
	`ªmaöed_mb
(
mb
Ë/ 
MIN_SIZE_FUNC_INST
 < 
˙t_func
) {

383 
	`¥öt_îr
("tÿm©ch cou¡ o‡fun˘i⁄s(%u)\n", 
˙t_func
);

384 
‰ì_≠p_öfo
;

387 
≠p_ö°
 = 
	`kmÆloc
((*≠p_ö°), 
GFP_KERNEL
);

388 i‡(
≠p_ö°
 =
NULL
) {

389 
	`¥öt_îr
("out of memory\n");

390 
‰ì_≠p_öfo
;

393 
≠p_ö°
->
func
 = 
	`kmÆloc
((
func_ö°_d©a
 *Ë* 
˙t_func
,

394 
GFP_KERNEL
);

395 i‡(
≠p_ö°
->
func
 =
NULL
) {

396 
	`¥öt_îr
("out of memory\n");

397 
‰ì_≠p_ö°
;

400 
i_func
 = 0; i_fun¯< 
˙t_func
; ++i_func) {

401 
	`¥öt_∑r£_debug
("fun¯#%d:\n", 
i_func
 + 1);

402 
func
 = 
	`¸óã_func_ö°_d©a
(
mb
);

403 i‡(
func
 =
NULL
)

404 
‰ì_func
;

406 
≠p_ö°
->
func
[
i_func
] = func;

409 
	`¥öt_∑r£_debug
("lib count:");

410 i‡(
	`gë_u32
(
mb
, &
˙t_lib
)) {

411 
	`¥öt_îr
("failedÅoÑead count ofÜibraries\n");

412 
‰ì_func
;

415 i‡(
	`ªmaöed_mb
(
mb
Ë/ 
MIN_SIZE_LIB_INST
 < 
˙t_lib
) {

416 
	`¥öt_îr
("tÿm©ch cou¡ o‡libørõs(%u)\n", 
˙t_lib
);

417 
‰ì_func
;

420 
≠p_ö°
->
lib
 = 
	`kmÆloc
((
lib_ö°_d©a
 *Ë* 
˙t_lib
,

421 
GFP_KERNEL
);

422 i‡(
≠p_ö°
->
lib
 =
NULL
) {

423 
	`¥öt_îr
("out of memory\n");

424 
‰ì_func
;

427 
i_lib
 = 0; i_lib < 
˙t_lib
; ++i_lib) {

428 
	`¥öt_∑r£_debug
("lib #%d:\n", 
i_lib
 + 1);

429 
lib
 = 
	`¸óã_lib_ö°_d©a
(
mb
);

430 i‡(
lib
 =
NULL
)

431 
‰ì_lib
;

433 
≠p_ö°
->
lib
[
i_lib
] =Üib;

436 
≠p_ö°
->
≠p_öfo
 =ápp_info;

437 
≠p_ö°
->
˙t_func
 = cnt_func;

438 
≠p_ö°
->
˙t_lib
 = cnt_lib;

440  
≠p_ö°
;

442 
‰ì_lib
:

443 
i
 = 0; i < 
i_lib
; ++i)

444 
	`de°roy_lib_ö°_d©a
(
≠p_ö°
->
lib
[
i
]);

445 
	`k‰ì
(
≠p_ö°
->
lib
);

447 
‰ì_func
:

448 
i
 = 0; i < 
i_func
; ++i)

449 
	`de°roy_func_ö°_d©a
(
≠p_ö°
->
func
[
i
]);

450 
	`k‰ì
(
≠p_ö°
->
func
);

452 
‰ì_≠p_ö°
:

453 
	`k‰ì
(
≠p_ö°
);

455 
‰ì_≠p_öfo
:

456 
	`de°roy_≠p_öfo
(
≠p_öfo
);

458  
NULL
;

459 
	}
}

461 
	$de°roy_≠p_ö°_d©a
(
≠p_ö°_d©a
 *
ai
)

463 
i
;

465 
i
 = 0; i < 
ai
->
˙t_lib
; ++i)

466 
	`de°roy_lib_ö°_d©a
(
ai
->
lib
[
i
]);

467 
	`k‰ì
(
ai
->
lib
);

469 
i
 = 0; i < 
ai
->
˙t_func
; ++i)

470 
	`de°roy_func_ö°_d©a
(
ai
->
func
[
i
]);

471 
	`k‰ì
(
ai
->
func
);

473 
	`de°roy_≠p_öfo
(
ai
->
≠p_öfo
);

474 
	`k‰ì
(
ai
);

475 
	}
}

485 
us_ö°_d©a
 *
	$¸óã_us_ö°_d©a
(
msg_buf
 *
mb
)

487 
us_ö°_d©a
 *
ui
;

488 
≠p_ö°_d©a
 *
ai
;

489 
u32
 
˙t
, 
j
, 
i
 = 0;

491 
	`¥öt_∑r£_debug
("us_inst_data:\n");

493 
	`¥öt_∑r£_debug
("app count:");

494 i‡(
	`gë_u32
(
mb
, &
˙t
)) {

495 
	`¥öt_îr
("failedÅoÑead count ofápplications\n");

496  
NULL
;

499 i‡(
	`ªmaöed_mb
(
mb
Ë/ 
MIN_SIZE_APP_INST
 < 
˙t
) {

500 
	`¥öt_îr
("tÿm©ch cou¡ o‡≠∂iˇti⁄s(%u)\n", 
˙t
);

501  
NULL
;

504 
ui
 = 
	`kmÆloc
((
us_ö°_d©a
), 
GFP_KERNEL
);

505 i‡(
ui
 =
NULL
) {

506 
	`¥öt_îr
("out of memory\n");

507  
NULL
;

510 
ui
->
≠p_ö°
 = 
	`kmÆloc
((
≠p_ö°_d©a
 *Ë* 
˙t
,

511 
GFP_KERNEL
);

512 i‡(
ui
->
≠p_ö°
 =
NULL
) {

513 
	`¥öt_îr
("out of memory\n");

514 
‰ì_ui
;

517 
i
 = 0; i < 
˙t
; ++i) {

518 
	`¥öt_∑r£_debug
("≠∞#%d:\n",
i
+1);

519 
ai
 = 
	`¸óã_≠p_ö°_d©a
(
mb
);

520 i‡(
ai
 =
NULL
)

521 
‰ì_≠p_ö°
;

523 
ui
->
≠p_ö°
[
i
] = 
ai
;

526 
ui
->
˙t
 = cnt;

528  
ui
;

530 
‰ì_≠p_ö°
:

531 
j
 = 0; j < 
i
; ++j)

532 
	`de°roy_≠p_ö°_d©a
(
ui
->
≠p_ö°
[
j
]);

533 
	`k‰ì
(
ui
->
≠p_ö°
);

535 
‰ì_ui
:

536 
	`k‰ì
(
ui
);

538  
NULL
;

539 
	}
}

541 
	$de°roy_us_ö°_d©a
(
us_ö°_d©a
 *
ui
)

543 
i
;

545 
i
 = 0; i < 
ui
->
˙t
; ++i)

546 
	`de°roy_≠p_ö°_d©a
(
ui
->
≠p_ö°
[
i
]);

548 
	`k‰ì
(
ui
->
≠p_ö°
);

549 
	`k‰ì
(
ui
);

550 
	}
}

	@parser/msg_parser.h

26 #i‚de‡
_MSG_PARSER_H


27 
	#_MSG_PARSER_H


	)

29 
	~<löux/ty≥s.h
>

31 
	gmsg_buf
;

33 
	eAPP_TYPE
 {

34 
	mAT_TIZEN_NATIVE_APP
 = 0x01,

35 
	mAT_PID
 = 0x02,

36 
	mAT_COMMON_EXEC
 = 0x03,

37 
	mAT_TIZEN_WEB_APP
 = 0x04

41 
	mSIZE_APP_TYPE
 = 4

45 
	s≠p_öfo_d©a
 {

46 
APP_TYPE
 
	m≠p_ty≥
;

47 
pid_t
 
	mtgid
;

48 *
	mexec_∑th
;

52 
	sc⁄f_d©a
 {

53 
u64
 
	mu£_„©uªs0
;

54 
u64
 
	mu£_„©uªs1
;

55 
u32
 
	msys_åa˚_≥riod
;

56 
u32
 
	md©a_msg_≥riod
;

60 
	sfunc_ö°_d©a
 {

61 
u64
 
	maddr
;

62 *
	m¨gs
;

63 
	mªt_ty≥
;

67 
	slib_ö°_d©a
 {

68 *
	m∑th
;

69 
u32
 
	m˙t_func
;

70 
func_ö°_d©a
 **
	mfunc
;

74 
	s≠p_ö°_d©a
 {

75 
≠p_öfo_d©a
 *
	m≠p_öfo
;

76 
u32
 
	m˙t_func
;

77 
func_ö°_d©a
 **
	mfunc
;

78 
u32
 
	m˙t_lib
;

79 
lib_ö°_d©a
 **
	mlib
;

83 
	sus_ö°_d©a
 {

84 
u32
 
	m˙t
;

85 
≠p_ö°_d©a
 **
	m≠p_ö°
;

89 
≠p_öfo_d©a
 *
¸óã_≠p_öfo
(
msg_buf
 *
mb
);

90 
de°roy_≠p_öfo
(
≠p_öfo_d©a
 *
≠p_öfo
);

92 
c⁄f_d©a
 *
¸óã_c⁄f_d©a
(
msg_buf
 *
mb
);

93 
de°roy_c⁄f_d©a
(
c⁄f_d©a
 *
c⁄f
);

95 
ßve_c⁄fig
(c⁄° 
c⁄f_d©a
 *
c⁄f
);

96 
ª°‹e_c⁄fig
(
c⁄f_d©a
 *
c⁄f
);

98 
func_ö°_d©a
 *
¸óã_func_ö°_d©a
(
msg_buf
 *
mb
);

99 
de°roy_func_ö°_d©a
(
func_ö°_d©a
 *
func_ö°
);

101 
lib_ö°_d©a
 *
¸óã_lib_ö°_d©a
(
msg_buf
 *
mb
);

102 
de°roy_lib_ö°_d©a
(
lib_ö°_d©a
 *
lib_ö°
);

104 
≠p_ö°_d©a
 *
¸óã_≠p_ö°_d©a
(
msg_buf
 *
mb
);

105 
de°roy_≠p_ö°_d©a
(
≠p_ö°_d©a
 *
≠p_ö°
);

107 
us_ö°_d©a
 *
¸óã_us_ö°_d©a
(
msg_buf
 *
mb
);

108 
de°roy_us_ö°_d©a
(
us_ö°_d©a
 *
us_ö°
);

112 
func_ö°_d©a
 
make_func_ö°_d©a
();

113 
lib_ö°_d©a
 
make_lib_ö°_d©a
();

114 
≠p_ö°_d©a
 
make_≠p_ö°_d©a
();

115 
us_ö°_d©a
 
make_us_ö°_d©a
();

118 
	mMIN_SIZE_STRING
 = 1,

119 
	mMIN_SIZE_FUNC_INST
 = (
make_func_ö°_d©a
().
addr
) +

120 
MIN_SIZE_STRING
,

121 
	mMIN_SIZE_LIB_INST
 = 
MIN_SIZE_STRING
 +

122 (
make_lib_ö°_d©a
().
˙t_func
),

123 
	mMIN_SIZE_APP_INFO
 = 
SIZE_APP_TYPE
 + 
MIN_SIZE_STRING
 + MIN_SIZE_STRING,

124 
	mMIN_SIZE_APP_INST
 = 
MIN_SIZE_APP_INFO
 +

125 (
make_≠p_ö°_d©a
().
˙t_func
) +

126 (
make_≠p_ö°_d©a
().
˙t_lib
),

127 
	mMIN_SIZE_US_INST
 = (
make_us_ö°_d©a
().
˙t
)

	@parser/parser_defs.h

27 #i‚de‡
__SWAP_DRIVER_DEVICE_DEFS_H__


28 
	#__SWAP_DRIVER_DEVICE_DEFS_H__


	)

30 
	~<löux/kî√l.h
>

34 
	#¥öt_debug
(
msg
, 
¨gs
...) \

35 
	`¥ötk
(
KERN_DEBUG
 "SWAP_PARSER DEBUG : " 
msg
, ##
¨gs
)

	)

36 
	#¥öt_msg
(
msg
, 
¨gs
...) \

37 
	`¥ötk
(
KERN_INFO
 "SWAP_PARSER : " 
msg
, ##
¨gs
)

	)

38 
	#¥öt_w¨n
(
msg
, 
¨gs
...) \

39 
	`¥ötk
(
KERN_WARNING
 "SWAP_PARSER WARNING : " 
msg
, ##
¨gs
)

	)

40 
	#¥öt_îr
(
msg
, 
¨gs
...) \

41 
	`¥ötk
(
KERN_ERR
 "SWAP_PARSER ERROR : " 
msg
, ##
¨gs
)

	)

42 
	#¥öt_¸ô
(
msg
, 
¨gs
...) \

43 
	`¥ötk
(
KERN_CRIT
 "SWAP_PARSER CRITICAL : " 
msg
, ##
¨gs
)

	)

46 #ifde‡
PARSE_DEBUG


47 
	#¥öt_∑r£_debug
(
msg
, 
¨gs
...) \

48 
	`¥ötk
(
KERN_DEBUG
 "SWAP_PARSER DEBUG : " 
msg
, ##
¨gs
)

	)

50 
	#¥öt_∑r£_debug
(
msg
, 
¨gs
...) \

51 dÿ{} 0)

	)

	@parser/swap_message_parser.mod.c

1 
	~<löux/moduÀ.h
>

2 
	~<löux/vîmagic.h
>

3 
	~<löux/compûî.h
>

5 
MODULE_INFO
(
vîmagic
, 
VERMAGIC_STRING
);

7 
moduÀ
 
__this_moduÀ


8 
__©åibuã__
((
£˘i⁄
(".gnu.linkonce.this_module"))) = {

9 .
«me
 = 
KBUILD_MODNAME
,

10 .
	göô
 = 
öô_moduÀ
,

11 #ifde‡
CONFIG_MODULE_UNLOAD


12 .
	gexô
 = 
˛ónup_moduÀ
,

14 .
	g¨ch
 = 
MODULE_ARCH_INIT
,

17 c⁄° 
	g__moduÀ_dïíds
[]

18 
__u£d


19 
__©åibuã__
((
£˘i⁄
(".modinfo"))) =

23 
MODULE_INFO
(
§cvîsi⁄
, "11D694AB459E6C9BDFDC823");

	@parser/swap_msg_parser.c

26 
	~<löux/moduÀ.h
>

27 
	~<löux/vmÆloc.h
>

28 
	~<asm/uac˚ss.h
>

30 
	~"∑r£r_defs.h
"

31 
	~"msg_buf.h
"

32 
	~"msg_cmd.h
"

34 
	~<drivî/drivî_to_msg.h
>

35 
	~<drivî/sw≠_io˘l.h
>

37 
	eMSG_ID
 {

38 
	mMSG_KEEP_ALIVE
 = 0x0001,

39 
	mMSG_START
 = 0x0002,

40 
	mMSG_STOP
 = 0x0003,

41 
	mMSG_CONFIG
 = 0x0004,

42 
	mMSG_SWAP_INST_ADD
 = 0x0008,

43 
	mMSG_SWAP_INST_REMOVE
 = 0x0009

46 
	sbasic_msg_fmt
 {

47 
u32
 
	mmsg_id
;

48 
u32
 
	mÀn
;

49 } 
__©åibuã__
((
∑cked
));

51 
	$msg_h™dÀr
(
__u£r
 *
msg
)

53 
ªt
;

54 
u32
 
size
;

55 
MSG_ID
 
msg_id
;

56 
msg_buf
 
mb
;

57 
__u£r
 *
∑ylﬂd
;

58 
basic_msg_fmt
 
bmf
;

59 íum { 
size_max
 = 128 * 1024 * 1024 };

61 
ªt
 = 
	`c›y_‰om_u£r
(&
bmf
, (*)
msg
, (bmf));

62 i‡(
ªt
)

63  
ªt
;

65 
size
 = 
bmf
.
Àn
;

66 i‡(
size
 >
size_max
) {

67 
	`¥ötk
("%s:Åoÿœrgêmesßge, size=%u\n", 
__func__
, 
size
);

68  -
ENOMEM
;

71 
ªt
 = 
	`öô_mb
(&
mb
, 
size
);

72 i‡(
ªt
)

73  
ªt
;

75 
∑ylﬂd
 = 
msg
 + (
bmf
);

76 i‡(
size
) {

77 
ªt
 = 
	`c›y_‰om_u£r
(
mb
.
begö
, (*)
∑ylﬂd
, 
size
);

78 i‡(
ªt
)

79 
unöô
;

82 
msg_id
 = 
bmf
.msg_id;

83 
msg_id
) {

84 
MSG_KEEP_ALIVE
:

85 
	`¥öt_∑r£_debug
("MSG_KEEP_ALIVE. size=%d\n", 
size
);

86 
ªt
 = 
	`msg_kìp_Æive
(&
mb
);

88 
MSG_START
:

89 
	`¥öt_∑r£_debug
("MSG_START. size=%d\n", 
size
);

90 
ªt
 = 
	`msg_°¨t
(&
mb
);

92 
MSG_STOP
:

93 
	`¥öt_∑r£_debug
("MSG_STOP. size=%d\n", 
size
);

94 
ªt
 = 
	`msg_°›
(&
mb
);

96 
MSG_CONFIG
:

97 
	`¥öt_∑r£_debug
("MSG_CONFIG. size=%d\n", 
size
);

98 
ªt
 = 
	`msg_c⁄fig
(&
mb
);

100 
MSG_SWAP_INST_ADD
:

101 
	`¥öt_∑r£_debug
("MSG_SWAP_INST_ADD. size=%d\n", 
size
);

102 
ªt
 = 
	`msg_sw≠_ö°_add
(&
mb
);

104 
MSG_SWAP_INST_REMOVE
:

105 
	`¥öt_∑r£_debug
("MSG_SWAP_INST_REMOVE. size=%d\n", 
size
);

106 
ªt
 = 
	`msg_sw≠_ö°_ªmove
(&
mb
);

109 
	`¥öt_îr
("öc‹ª˘ mesßgêID [%u]. size=%d\n", 
msg_id
, 
size
);

110 
ªt
 = -
EINVAL
;

114 
unöô
:

115 
	`unöô_mb
(&
mb
);

116  
ªt
;

117 
	}
}

119 
	$ªgi°î_msg_h™dÀr
()

121 
	`£t_msg_h™dÀr
(
msg_h™dÀr
);

122 
	}
}

124 
	$uƒegi°î_msg_h™dÀr
()

126 
	`£t_msg_h™dÀr
(
NULL
);

127 
	}
}

129 
__öô
 
	$sw≠_∑r£r_öô
()

131 
ªt
;

132 
	`ªgi°î_msg_h™dÀr
();

134 
ªt
 = 
	`öô_cmd
();

136  
ªt
;

137 
	}
}

139 
__exô
 
	$sw≠_∑r£r_exô
()

141 
	`unöô_cmd
();

142 
	`uƒegi°î_msg_h™dÀr
();

143 
	}
}

145 
moduÀ_öô
(
sw≠_∑r£r_öô
);

146 
moduÀ_exô
(
sw≠_∑r£r_exô
);

148 
MODULE_LICENSE
("GPL");

	@parser/us_inst.c

26 
	~<löux/moduÀ.h
>

27 
	~<löux/vîsi⁄.h
>

28 
	~<löux/î∫o.h
>

29 
	~<löux/«mei.h
>

30 
	~<us_m™agî/pf/pf_group.h
>

31 
	~"msg_∑r£r.h
"

32 
	~"us_ö°.h
"

35 
díåy
 *
	$díåy_by_∑th
(c⁄° *
∑th
)

37 
díåy
 *dentry;

38 #i‡
LINUX_VERSION_CODE
 > 
	`KERNEL_VERSION
(2, 6, 38)

39 
∑th
 
°_∑th
;

40 i‡(
	`kîn_∑th
(
∑th
, 
LOOKUP_FOLLOW
, &
°_∑th
) != 0) {

42 
«meid©a
 
nd
;

43 i‡(
	`∑th_lookup
(
∑th
, 
LOOKUP_FOLLOW
, &
nd
) != 0) {

45 
	`¥ötk
("ÁûedÅÿlooku∞díåy f‹Ö©h %s!\n", 
∑th
);

46  
NULL
;

49 #i‡
LINUX_VERSION_CODE
 < 
	`KERNEL_VERSION
(2, 6, 25)

50 
díåy
 = 
nd
.dentry;

51 
	`∑th_ªÀa£
(&
nd
);

52 #ñi‡
LINUX_VERSION_CODE
 <
	`KERNEL_VERSION
(2, 6, 38)

53 
díåy
 = 
nd
.
∑th
.dentry;

54 
	`∑th_put
(&
nd
.
∑th
);

56 
díåy
 = 
°_∑th
.dentry;

57 
	`∑th_put
(&
°_∑th
);

59  
díåy
;

60 
	}
}

63 
	$mod_func_ö°
(
func_ö°_d©a
 *
func
, 
pf_group
 *
pfg
,

64 
díåy
 *díåy, 
MOD_TYPE
 
mt
)

66 
ªt
;

68 
mt
) {

69 
MT_ADD
:

70 
ªt
 = 
	`pf_ªgi°î_¥obe
(
pfg
, 
díåy
, 
func
->
addr
, func->
¨gs
,

71 
func
->
ªt_ty≥
);

73 
MT_DEL
:

74 
ªt
 = 
	`pf_uƒegi°î_¥obe
(
pfg
, 
díåy
, 
func
->
addr
);

77 
	`¥ötk
("ERROR: mod_ty≥=0x%x\n", 
mt
);

78 
ªt
 = -
EINVAL
;

81  
ªt
;

82 
	}
}

84 
	$mod_lib_ö°
(
lib_ö°_d©a
 *
lib
, 
pf_group
 *
pfg
,

85 
MOD_TYPE
 
mt
)

87 
ªt
 = 0, 
i
;

88 
díåy
 *dentry;

90 
díåy
 = 
	`díåy_by_∑th
(
lib
->
∑th
);

91 i‡(
díåy
 =
NULL
) {

92 
	`¥ötk
("C™nŸ gë díåy byÖ©h %s\n", 
lib
->
∑th
);

93  -
EINVAL
;

96 
i
 = 0; i < 
lib
->
˙t_func
; ++i) {

97 
ªt
 = 
	`mod_func_ö°
(
lib
->
func
[
i
], 
pfg
, 
díåy
, 
mt
);

98 i‡(
ªt
) {

99 
	`¥ötk
("C™nŸ mod fun¯ö°,Ñë = %d\n", 
ªt
);

100  
ªt
;

104  
ªt
;

105 
	}
}

107 
	$gë_pfg_by_≠p_öfo
(
≠p_öfo_d©a
 *
≠p_öfo
, 
pf_group
 **
pfg
)

109 
díåy
 *dentry;

111 
díåy
 = 
	`díåy_by_∑th
(
≠p_öfo
->
exec_∑th
);

112 i‡(
díåy
 =
NULL
)

113  -
EINVAL
;

115 
≠p_öfo
->
≠p_ty≥
) {

116 
AT_PID
:

117 i‡(
≠p_öfo
->
tgid
 == 0) {

118 i‡(
≠p_öfo
->
exec_∑th
[0] == '\0')

119 *
pfg
 = 
	`gë_pf_group_dumb
(
díåy
);

121 
pf_díåy
;

123 *
pfg
 = 
	`gë_pf_group_by_tgid
(
≠p_öfo
->
tgid
, 
díåy
);

125 
AT_TIZEN_NATIVE_APP
:

126 
AT_TIZEN_WEB_APP
:

127 
AT_COMMON_EXEC
:

128 
pf_díåy
:

129 *
pfg
 = 
	`gë_pf_group_by_díåy
(
díåy
, dentry);

132 
	`¥ötk
("ERROR:áµ_ty≥=0x%x\n", 
≠p_öfo
->
≠p_ty≥
);

133  -
EINVAL
;

137 
	}
}

139 
	$mod_us_≠p_ö°
(
≠p_ö°_d©a
 *
≠p_ö°
, 
MOD_TYPE
 
mt
)

141 
ªt
, 
i
;

142 
pf_group
 *
pfg
;

143 
díåy
 *dentry;

145 
ªt
 = 
	`gë_pfg_by_≠p_öfo
(
≠p_ö°
->
≠p_öfo
, &
pfg
);

146 i‡(
ªt
) {

147 
	`¥ötk
("C™nŸ gëÖfg byáµ info,Ñë = %d\n", 
ªt
);

148  
ªt
;

151 
i
 = 0; i < 
≠p_ö°
->
˙t_func
; ++i) {

153 
díåy
 = 
	`díåy_by_∑th
(
≠p_ö°
->
≠p_öfo
->
exec_∑th
);

154 i‡(
díåy
 =
NULL
) {

155 
	`¥ötk
("Cannot find dentry byÖath %s\n",

156 
≠p_ö°
->
≠p_öfo
->
exec_∑th
);

157  -
EINVAL
;

160 
ªt
 = 
	`mod_func_ö°
(
≠p_ö°
->
func
[
i
], 
pfg
, 
díåy
, 
mt
);

161 i‡(
ªt
) {

162 
	`¥ötk
("C™nŸ mod fun¯ö°,Ñë = %d\n", 
ªt
);

163  
ªt
;

167 
i
 = 0; i < 
≠p_ö°
->
˙t_lib
; ++i) {

168 
ªt
 = 
	`mod_lib_ö°
(
≠p_ö°
->
lib
[
i
], 
pfg
, 
mt
);

169 i‡(
ªt
) {

170 
	`¥ötk
("C™nŸ modÜib in°,Ñë = %d\n", 
ªt
);

171  
ªt
;

176 
	}
}

178 
	$mod_us_ö°
(
us_ö°_d©a
 *
us_ö°
, 
MOD_TYPE
 
mt
)

180 
u32
 
i
;

181 
ªt
;

183 
i
 = 0; i < 
us_ö°
->
˙t
; ++i) {

184 
ªt
 = 
	`mod_us_≠p_ö°
(
us_ö°
->
≠p_ö°
[
i
], 
mt
);

185 i‡(
ªt
) {

186 
	`¥ötk
("C™nŸ mod u†≠∞ö°,Ñë = %d\n", 
ªt
);

187  
ªt
;

192 
	}
}

	@parser/us_inst.h

26 #i‚de‡
_US_INST_H


27 
	#_US_INST_H


	)

29 
	eMOD_TYPE
 {

30 
	mMT_ADD
,

31 
	mMT_DEL


34 
	gus_ö°_d©a
;

36 
mod_us_ö°
(
us_ö°_d©a
 *
us_ö°
, 
MOD_TYPE
 
mt
);

	@sampler/kernel_operations.h

26 #i‚de‡
__KERNEL_OPERATIONS_H__


27 
	#__KERNEL_OPERATIONS_H__


	)

29 
	~<löux/kî√l.h
>

31 
	#¥öt_debug
(
msg
, 
¨gs
...) \

32 
	`¥ötk
(
KERN_DEBUG
 "SWAP_SAMPLER DEBUG : " 
msg
, ##
¨gs
)

	)

33 
	#¥öt_msg
(
msg
, 
¨gs
...) \

34 
	`¥ötk
(
KERN_INFO
 "SWAP_SAMPLER : " 
msg
, ##
¨gs
)

	)

35 
	#¥öt_w¨n
(
msg
, 
¨gs
...) \

36 
	`¥ötk
(
KERN_WARNING
 "SWAP_SAMPLER WARNING : " 
msg
, ##
¨gs
)

	)

37 
	#¥öt_îr
(
msg
, 
¨gs
...) \

38 
	`¥ötk
(
KERN_ERR
 "SWAP_SAMPLER ERROR : " 
msg
, ##
¨gs
)

	)

39 
	#¥öt_¸ô
(
msg
, 
¨gs
...) \

40 
	`¥ötk
(
KERN_CRIT
 "SWAP_SAMPLER CRITICAL : " 
msg
, ##
¨gs
)

	)

	@sampler/sampler_hrtimer.c

27 
	~<löux/ty≥s.h
>

28 
	~"ßm∂î_timîs.h
"

31 
u64
 
	gßm∂î_timî_qu™tum
 = 0;

32 
DEFINE_PER_CPU
(
hπimî
, 
dbi_hπimî
);

33 
	gdbi_hπimî_ru¬ög
;

35 
ª°¨t_ªt
 
	$ßm∂î_timîs_ª°¨t
(
sw≠_timî
 *
timî
)

37 
ª°¨t_ªt
 
ªt
;

39 
	`hπimî_f‹w¨d_now
(
timî
, 
	`ns_to_ktime
(
ßm∂î_timî_qu™tum
));

40 
ªt
 = 
HRTIMER_RESTART
;

42  
ªt
;

43 
	}
}

46 
	$ßm∂î_timîs_£t_run
()

48 
dbi_hπimî_ru¬ög
 = 1;

49 
	}
}

52 
	$ßm∂î_timîs_£t_°›
()

54 
dbi_hπimî_ru¬ög
 = 0;

55 
	}
}

58 
	$ßm∂î_timîs_°¨t
(*
ª°¨t_func
)

60 
hπimî
 *hπimî = &
	`__gë_˝u_v¨
(
dbi_hπimî
);

62 i‡(!
dbi_hπimî_ru¬ög
)

65 
	`hπimî_öô
(
hπimî
, 
CLOCK_MONOTONIC
, 
HRTIMER_MODE_REL
);

66 
hπimî
->
fun˘i⁄
 = 
ª°¨t_func
;

67 
	`hπimî_°¨t
(
hπimî
, 
	`ns_to_ktime
(
ßm∂î_timî_qu™tum
),

68 
HRTIMER_MODE_REL_PINNED
);

69 
	}
}

72 
	$ßm∂î_timîs_°›
(
˝u
)

74 
hπimî
 *hπimî = &
	`≥r_˝u
(
dbi_hπimî
, 
˝u
);

76 i‡(!
dbi_hπimî_ru¬ög
)

79 
	`hπimî_ˇn˚l
(
hπimî
);

80 
	}
}

83 
	$ßm∂î_timîs_£t_qu™tum
(
timî_qu™tum
)

85 
ßm∂î_timî_qu™tum
 = 
timî_qu™tum
 * 1000 * 1000;

86 
	}
}

	@sampler/sampler_timer.c

27 
	~"ßm∂î_timîs.h
"

31 
	gßm∂î_timî_qu™tum
 = 0;

32 
DEFINE_PER_CPU
(
timî_li°
, 
dbi_timî
);

33 
	gdbi_timî_ru¬ög
;

36 
ª°¨t_ªt
 
	$ßm∂î_timîs_ª°¨t
(
sw≠_timî
 *
timî
)

38 
ª°¨t_ªt
 
ªt
;

40 
	`mod_timî_pö√d
((
timî_li°
 *)
timî
,

41 
jiffõs
 + 
ßm∂î_timî_qu™tum
);

42 
ªt
 = 0;

44  
ªt
;

45 
	}
}

48 
	$ßm∂î_timîs_£t_run
()

50 
dbi_timî_ru¬ög
 = 1;

51 
	}
}

54 
	$ßm∂î_timîs_£t_°›
()

56 
dbi_timî_ru¬ög
 = 0;

57 
	}
}

60 
	$ßm∂î_timîs_°¨t
(*
ª°¨t_func
)

62 
timî_li°
 *
timî
 = &
	`__gë_˝u_v¨
(
dbi_timî
);

64 i‡(!
dbi_timî_ru¬ög
)

67 
	`öô_timî
(
timî
);

68 
timî
->
d©a
 = ()timer;

69 
timî
->
fun˘i⁄
 = 
ª°¨t_func
;

71 
	`mod_timî_pö√d
(
timî
, 
jiffõs
 + 
ßm∂î_timî_qu™tum
);

72 
	}
}

75 
	$ßm∂î_timîs_°›
(
˝u
)

77 
timî_li°
 *
timî
 = &
	`≥r_˝u
(
dbi_timî
, 
˝u
);

79 i‡(!
dbi_timî_ru¬ög
)

81 
	`dñ_timî_sync
(
timî
);

82 
	}
}

85 
	$ßm∂î_timîs_£t_qu™tum
(
timî_qu™tum
)

87 
ßm∂î_timî_qu™tum
 = 
timî_qu™tum
;

88 
	}
}

	@sampler/sampler_timers.h

27 #i‚de‡
__SAMPLER_TIMERS_H__


28 
	#__SAMPLER_TIMERS_H__


	)

33 #i‡
deföed
(
CONFIG_HIGH_RES_TIMERS
)

35 
	~<löux/hπimî.h
>

39 
	~<löux/timî.h
>

45 #i‡
deföed
(
CONFIG_HIGH_RES_TIMERS
)

47 
hπimî
 
	tsw≠_timî
;

48 
hπimî_ª°¨t
 
	tª°¨t_ªt
;

52 
timî_li°
 
	tsw≠_timî
;

53 
	tª°¨t_ªt
;

60 
ª°¨t_ªt
 
ßm∂î_timîs_ª°¨t
(
sw≠_timî
 *
timî
);

61 
ßm∂î_timîs_°›
(
˝u
);

62 
ßm∂î_timîs_°¨t
(*
unu£d
);

63 
ßm∂î_timîs_£t_qu™tum
(
timî_qu™tum
);

64 
ßm∂î_timîs_£t_run
();

65 
ßm∂î_timîs_£t_°›
();

	@sampler/swap_sampler.mod.c

1 
	~<löux/moduÀ.h
>

2 
	~<löux/vîmagic.h
>

3 
	~<löux/compûî.h
>

5 
MODULE_INFO
(
vîmagic
, 
VERMAGIC_STRING
);

7 
moduÀ
 
__this_moduÀ


8 
__©åibuã__
((
£˘i⁄
(".gnu.linkonce.this_module"))) = {

9 .
«me
 = 
KBUILD_MODNAME
,

10 .
	göô
 = 
öô_moduÀ
,

11 #ifde‡
CONFIG_MODULE_UNLOAD


12 .
	gexô
 = 
˛ónup_moduÀ
,

14 .
	g¨ch
 = 
MODULE_ARCH_INIT
,

17 c⁄° 
	g__moduÀ_dïíds
[]

18 
__u£d


19 
__©åibuã__
((
£˘i⁄
(".modinfo"))) =

23 
MODULE_INFO
(
§cvîsi⁄
, "1D5BCA2923A500536FEAF4E");

	@sampler/swap_sampler_errors.h

27 
	e_sw≠_ßm∂î_îr‹s
 {

28 
	mE_SS_SUCCESS
 = 0,

29 
	mE_SS_WRONG_QUANTUM
 = 1

	@sampler/swap_sampler_module.c

26 
	~<asm/±ø˚.h
>

27 
	~<löux/jiffõs.h
>

28 
	~<löux/sched.h
>

29 
	~<löux/nŸifõr.h
>

30 
	~<löux/˝u.h
>

31 
	~<löux/moduÀ.h
>

33 
	~<wrôî/sw≠_wrôî_moduÀ.h
>

35 
	~"sw≠_ßm∂î_moduÀ.h
"

36 
	~"sw≠_ßm∂î_îr‹s.h
"

37 
	~"kî√l_›î©i⁄s.h
"

38 
	~"ßm∂î_timîs.h
"

41 
BLOCKING_NOTIFIER_HEAD
(
sw≠_ßm∂î_nŸifõr_li°
);

43 
ª°¨t_ªt
 
	$dbi_timî_ª°¨t
(
sw≠_timî
 *
timî
)

45 i‡(
cuºít
)

46 
	`ßm∂e_msg
(
	`èsk_±_ªgs
(
cuºít
));

48  
	`ßm∂î_timîs_ª°¨t
(
timî
);

49 
	}
}

51 
	$dbi_timî_°¨t
()

53 
	`gë_⁄löe_˝us
();

54 
	`ßm∂î_timîs_£t_run
();

56 
	`⁄_óch_˝u
(
ßm∂î_timîs_°¨t
, 
dbi_timî_ª°¨t
, 1);

57 
	`put_⁄löe_˝us
();

59  
E_SS_SUCCESS
;

60 
	}
}

62 
	$dbi_timî_°›
()

64 
˝u
;

66 
	`gë_⁄löe_˝us
();

68 
	`f‹_óch_⁄löe_˝u
(
˝u
)

69 
	`ßm∂î_timîs_°›
(
˝u
);

70 
	`ßm∂î_timîs_£t_°›
();

71 
	`put_⁄löe_˝us
();

72 
	}
}

74 
__˝uöô
 
	$dbi_˝u_nŸify
(
nŸifõr_block
 *
£lf
,

75 
a˘i⁄
, *
h˝u
)

77 
˝u
 = (Ë
h˝u
;

79 
a˘i⁄
) {

80 
CPU_ONLINE
:

81 
CPU_ONLINE_FROZEN
:

82 
	`smp_ˇŒ_fun˘i⁄_sögÀ
(
˝u
, 
ßm∂î_timîs_°¨t
,

83 
dbi_timî_ª°¨t
, 1);

85 
CPU_DEAD
:

86 
CPU_DEAD_FROZEN
:

87 
	`ßm∂î_timîs_°›
(
˝u
);

91  
NOTIFY_OK
;

92 
	}
}

94 
nŸifõr_block
 
__ªfd©a
 
	gdbi_˝u_nŸifõr
 = {

95 .
nŸifõr_ˇŒ
 = 
dbi_˝u_nŸify
,

98 
	$do_sw≠_ßm∂î_°¨t
(
timî_qu™tum
)

100 i‡(
timî_qu™tum
 <= 0)

101  -
EINVAL
;

103 
	`ßm∂î_timîs_£t_qu™tum
(
timî_qu™tum
);

104 
	`dbi_timî_°¨t
();

107 
	}
}

109 
	$do_sw≠_ßm∂î_°›
()

111 
	`dbi_timî_°›
();

112 
	}
}

114 
DEFINE_MUTEX
(
muãx_run
);

115 
	gßm∂î_run
 = 0;

117 
	$sw≠_ßm∂î_°¨t
(
timî_qu™tum
)

119 
ªt
 = -
EINVAL
;

121 
	`muãx_lock
(&
muãx_run
);

122 i‡(
ßm∂î_run
) {

123 
	`¥ötk
("samplerÖrofiling isálreadyÑun!\n");

124 
u∆ock
;

127 
ªt
 = 
	`do_sw≠_ßm∂î_°¨t
(
timî_qu™tum
);

128 i‡(
ªt
 == 0)

129 
ßm∂î_run
 = 1;

131 
u∆ock
:

132 
	`muãx_u∆ock
(&
muãx_run
);

134  
ªt
;

135 
	}
}

136 
EXPORT_SYMBOL_GPL
(
sw≠_ßm∂î_°¨t
);

138 
	$sw≠_ßm∂î_°›
()

140 
ªt
 = 0;

142 
	`muãx_lock
(&
muãx_run
);

143 i‡(
ßm∂î_run
 == 0) {

144 
	`¥ötk
("energyÖrofiling isÇotÑunning!\n");

145 
ªt
 = -
EINVAL
;

146 
u∆ock
;

149 
	`do_sw≠_ßm∂î_°›
();

151 
ßm∂î_run
 = 0;

152 
u∆ock
:

153 
	`muãx_u∆ock
(&
muãx_run
);

155  
ªt
;

156 
	}
}

157 
EXPORT_SYMBOL_GPL
(
sw≠_ßm∂î_°›
);

159 
__öô
 
	$ßm∂î_öô
()

161 
ªtvÆ
;

163 
ªtvÆ
 = 
	`ªgi°î_hŸ˝u_nŸifõr
(&
dbi_˝u_nŸifõr
);

164 i‡(
ªtvÆ
) {

165 
	`¥öt_îr
("Error ofÑegister_hotcpu_notifier()\n");

166  
ªtvÆ
;

169 
	`¥öt_msg
("Sample ininitialization success\n");

171  
E_SS_SUCCESS
;

172 
	}
}

174 
__exô
 
	$ßm∂î_exô
()

176 i‡(
ßm∂î_run
)

177 
	`do_sw≠_ßm∂î_°›
();

179 
	`uƒegi°î_hŸ˝u_nŸifõr
(&
dbi_˝u_nŸifõr
);

181 
	`¥öt_msg
("Sampler uninitialized\n");

182 
	}
}

184 
moduÀ_öô
(
ßm∂î_öô
);

185 
moduÀ_exô
(
ßm∂î_exô
);

187 
MODULE_LICENSE
("GPL");

188 
MODULE_DESCRIPTION
("SWAP sampling module");

189 
MODULE_AUTHOR
("Andreev S.V., Aksenov A.S.");

	@sampler/swap_sampler_module.h

29 #i‚de‡
__SWAP_SAMPLER_MODULE_H__


30 
	#__SWAP_SAMPLER_MODULE_H__


	)

33 
sw≠_ßm∂î_°¨t
(
timî_qu™tum
);

36 
sw≠_ßm∂î_°›
();

	@uprobe/arch/asm-arm/swap_uprobes.c

27 
	~<k¥obe/dbi_k¥obes.h
>

28 
	~<k¥obe/¨ch/asm/dbi_k¥obes.h
>

29 
	~<k¥obe/¨ch/asm/åampﬁöe_¨m.h
>

30 
	~<asm/å≠s.h
>

31 
	~<u¥obe/sw≠_u¥obes.h
>

32 
	~<u¥obe/¨ch/asm/sw≠_u¥obes.h
>

33 
	~<k¥obe/dbi_ö¢_¶Ÿs.h
>

34 
	~<k¥obe/dbi_k¥obes_dïs.h
>

35 
	~"åampﬁöe_thumb.h
"

38 
	~<k¥obe/dbi_kdebug.h
>

41 
	#Êush_ö¢s
(
addr
, 
size
) \

42 
	`Êush_iˇche_ønge
(()(
addr
), \

43 ()(
addr
Ë+ (
size
))

	)

45 
ölöe
 
	$bønch_t16_de°
(
k¥obe_›code_t
 
ö¢
, 
ö¢_addr
)

47 
off£t
 = 
ö¢
 & 0x3ff;

48 
off£t
 -
ö¢
 & 0x400;

49  (
ö¢_addr
 + 4 + 
off£t
 * 2);

50 
	}
}

52 
ölöe
 
	$bønch_c⁄d_t16_de°
(
k¥obe_›code_t
 
ö¢
, 
ö¢_addr
)

54 
off£t
 = 
ö¢
 & 0x7f;

55 
off£t
 -
ö¢
 & 0x80;

56  (
ö¢_addr
 + 4 + 
off£t
 * 2);

57 
	}
}

59 
ölöe
 
	$bønch_t32_de°
(
k¥obe_›code_t
 
ö¢
, 
ö¢_addr
)

61 
poff
 = 
ö¢
 & 0x3ff;

62 
off£t
 = (
ö¢
 & 0x07fe0000) >> 17;

64 
poff
 -(
ö¢
 & 0x400);

66 i‡(
ö¢
 & (1 << 12))

67  ((
ö¢_addr
 + 4 + (
poff
 << 12Ë+ 
off£t
 * 4));

69  ((
ö¢_addr
 + 4 + (
poff
 << 12Ë+ 
off£t
 * 4) & ~3);

70 
	}
}

72 
ölöe
 
	$cbz_t16_de°
(
k¥obe_›code_t
 
ö¢
, 
ö¢_addr
)

74 
i
 = (
ö¢
 & 0x200) >> 3;

75 
off£t
 = (
ö¢
 & 0xf8) >> 2;

76  
ö¢_addr
 + 4 + 
i
 + 
off£t
;

77 
	}
}

80 
	$is_thumb2
(
k¥obe_›code_t
 
ö¢
)

82  ((
ö¢
 & 0xf800) == 0xe800 ||

83 (
ö¢
 & 0xf800) == 0xf000 ||

84 (
ö¢
 & 0xf800) == 0xf800);

85 
	}
}

87 
	$¨ch_c›y_åampﬁöe_¨m_u¥obe
(
u¥obe
 *
up
)

89 
ªt
;

90 
k¥obe
 *
p
 = 
	`up2kp
(
up
);

91 
ö¢
 = 
p
->
›code
;

92 
vaddr
 = ()
p
->
addr
;

93 *
åamp
 = 
up
->
©ømp
.
åamp_¨m
;

95 
ªt
 = 
	`¨ch_make_åampﬁöe_¨m
(
vaddr
, 
ö¢
, 
åamp
);

96 
p
->
ß„_¨m
 = !!
ªt
;

98  
ªt
;

99 
	}
}

101 
	$¨ch_check_ö¢_thumb
(
ö¢
)

103 
ªt
 = 0;

106 i‡(
	`THUMB_INSN_MATCH
(
UNDEF
, 
ö¢
) ||

107 
	`THUMB_INSN_MATCH
(
SWI
, 
ö¢
) ||

108 
	`THUMB_INSN_MATCH
(
BREAK
, 
ö¢
) ||

109 
	`THUMB2_INSN_MATCH
(
B1
, 
ö¢
) ||

110 
	`THUMB2_INSN_MATCH
(
B2
, 
ö¢
) ||

111 
	`THUMB2_INSN_MATCH
(
BXJ
, 
ö¢
) ||

112 (
	`THUMB2_INSN_MATCH
(
ADR
, 
ö¢
Ë&& 
	`THUMB2_INSN_REG_RD
(insn) == 15) ||

113 (
	`THUMB2_INSN_MATCH
(
LDRW
, 
ö¢
Ë&& 
	`THUMB2_INSN_REG_RT
(insn) == 15) ||

114 (
	`THUMB2_INSN_MATCH
(
LDRW1
, 
ö¢
Ë&& 
	`THUMB2_INSN_REG_RT
(insn) == 15) ||

115 (
	`THUMB2_INSN_MATCH
(
LDRHW
, 
ö¢
Ë&& 
	`THUMB2_INSN_REG_RT
(insn) == 15) ||

116 (
	`THUMB2_INSN_MATCH
(
LDRHW1
, 
ö¢
Ë&& 
	`THUMB2_INSN_REG_RT
(insn) == 15) ||

117 (
	`THUMB2_INSN_MATCH
(
LDRWL
, 
ö¢
Ë&& 
	`THUMB2_INSN_REG_RT
(insn) == 15) ||

118 
	`THUMB2_INSN_MATCH
(
LDMIA
, 
ö¢
) ||

119 
	`THUMB2_INSN_MATCH
(
LDMDB
, 
ö¢
) ||

120 (
	`THUMB2_INSN_MATCH
(
DP
, 
ö¢
Ë&& 
	`THUMB2_INSN_REG_RD
(insn) == 15) ||

121 (
	`THUMB2_INSN_MATCH
(
RSBW
, 
ö¢
Ë&& 
	`THUMB2_INSN_REG_RD
(insn) == 15) ||

122 (
	`THUMB2_INSN_MATCH
(
RORW
, 
ö¢
Ë&& 
	`THUMB2_INSN_REG_RD
(insn) == 15) ||

123 (
	`THUMB2_INSN_MATCH
(
ROR
, 
ö¢
Ë&& 
	`THUMB2_INSN_REG_RD
(insn) == 15) ||

124 (
	`THUMB2_INSN_MATCH
(
LSLW1
, 
ö¢
Ë&& 
	`THUMB2_INSN_REG_RD
(insn) == 15) ||

125 (
	`THUMB2_INSN_MATCH
(
LSLW2
, 
ö¢
Ë&& 
	`THUMB2_INSN_REG_RD
(insn) == 15) ||

126 (
	`THUMB2_INSN_MATCH
(
LSRW1
, 
ö¢
Ë&& 
	`THUMB2_INSN_REG_RD
(insn) == 15) ||

127 (
	`THUMB2_INSN_MATCH
(
LSRW2
, 
ö¢
Ë&& 
	`THUMB2_INSN_REG_RD
(insn) == 15) ||

129 (
	`THUMB2_INSN_MATCH
(
STRW1
, 
ö¢
Ë&& 
	`THUMB2_INSN_REG_RN
(insn) == 15) ||

130 (
	`THUMB2_INSN_MATCH
(
STRBW1
, 
ö¢
Ë&& 
	`THUMB2_INSN_REG_RN
(insn) == 15) ||

131 (
	`THUMB2_INSN_MATCH
(
STRHW1
, 
ö¢
Ë&& 
	`THUMB2_INSN_REG_RN
(insn) == 15) ||

132 (
	`THUMB2_INSN_MATCH
(
STRW
, 
ö¢
Ë&& 
	`THUMB2_INSN_REG_RN
(insn) == 15) ||

133 (
	`THUMB2_INSN_MATCH
(
STRHW
, 
ö¢
Ë&& 
	`THUMB2_INSN_REG_RN
(insn) == 15) ||

134 (
	`THUMB2_INSN_MATCH
(
LDRW
, 
ö¢
Ë&& 
	`THUMB2_INSN_REG_RN
(insn) == 15) ||

135 (
	`THUMB2_INSN_MATCH
(
LDRBW
, 
ö¢
Ë&& 
	`THUMB2_INSN_REG_RN
(insn) == 15) ||

136 (
	`THUMB2_INSN_MATCH
(
LDRHW
, 
ö¢
Ë&& 
	`THUMB2_INSN_REG_RN
(insn) == 15) ||

138 (
	`THUMB2_INSN_MATCH
(
LDRD
, 
ö¢
Ë|| THUMB2_INSN_MATCH(
LDRD1
, in¢Ë|| THUMB2_INSN_MATCH(
STRD
, insn))) {

139 
	`¥ötk
("Bad in¢árch_check_ö¢_thumb: %lx\n", 
ö¢
);

140 
ªt
 = -
EFAULT
;

143  
ªt
;

144 
	}
}

146 
	$¥ï_pc_dï_ö¢_execbuf_thumb
(
k¥obe_›code_t
 * 
ö¢s
, k¥obe_›code_à
ö¢
, 
uªgs
)

148 
mªg
 = 0;

149 
ªg
 = 0;

151 i‡(
	`THUMB_INSN_MATCH
(
APC
, 
ö¢
Ë|| THUMB_INSN_MATCH(
LRO3
, insn)) {

152 
ªg
 = ((
ö¢
 & 0xffffË& 
uªgs
) >> 8;

154 i‡(
	`THUMB_INSN_MATCH
(
MOV3
, 
ö¢
)) {

155 i‡(((((Ë
ö¢
) & 0xff) >> 3) == 15) {

156 
ªg
 = (
ö¢
 & 0xffffË& 
uªgs
;

161 i‡(
	`THUMB2_INSN_MATCH
(
ADR
, 
ö¢
)) {

162 
ªg
 = ((
ö¢
 >> 16Ë& 
uªgs
) >> 8;

163 i‡(
ªg
 == 15) {

167 i‡(
	`THUMB2_INSN_MATCH
(
LDRW
, 
ö¢
Ë|| THUMB2_INSN_MATCH(
LDRW1
, insn) ||

168 
	`THUMB2_INSN_MATCH
(
LDRHW
, 
ö¢
Ë|| THUMB2_INSN_MATCH(
LDRHW1
, insn) ||

169 
	`THUMB2_INSN_MATCH
(
LDRWL
, 
ö¢
)) {

170 
ªg
 = ((
ö¢
 >> 16Ë& 
uªgs
) >> 12;

171 i‡(
ªg
 == 15) {

176 i‡(
	`THUMB2_INSN_MATCH
(
LDRBW
, 
ö¢
Ë|| THUMB2_INSN_MATCH(
LDRBW1
, insn) ||

177 
	`THUMB2_INSN_MATCH
(
LDREX
, 
ö¢
)) {

178 
ªg
 = ((
ö¢
 >> 16Ë& 
uªgs
) >> 12;

180 i‡(
	`THUMB2_INSN_MATCH
(
DP
, 
ö¢
)) {

181 
ªg
 = ((
ö¢
 >> 16Ë& 
uªgs
) >> 12;

182 i‡(
ªg
 == 15) {

186 i‡(
	`THUMB2_INSN_MATCH
(
RSBW
, 
ö¢
)) {

187 
ªg
 = ((
ö¢
 >> 12Ë& 
uªgs
) >> 8;

188 i‡(
ªg
 == 15){

192 i‡(
	`THUMB2_INSN_MATCH
(
RORW
, 
ö¢
)) {

193 
ªg
 = ((
ö¢
 >> 12Ë& 
uªgs
) >> 8;

194 i‡(
ªg
 == 15) {

198 i‡(
	`THUMB2_INSN_MATCH
(
ROR
, 
ö¢
Ë|| THUMB2_INSN_MATCH(
LSLW1
, insn) ||

199 
	`THUMB2_INSN_MATCH
(
LSLW2
, 
ö¢
Ë|| THUMB2_INSN_MATCH(
LSRW1
, insn) ||

200 
	`THUMB2_INSN_MATCH
(
LSRW2
, 
ö¢
)) {

201 
ªg
 = ((
ö¢
 >> 12Ë& 
uªgs
) >> 8;

202 i‡(
ªg
 == 15) {

206 i‡(
	`THUMB2_INSN_MATCH
(
TEQ1
, 
ö¢
Ë|| THUMB2_INSN_MATCH(
TST1
, insn)) {

207 
ªg
 = 15;

209 i‡(
	`THUMB2_INSN_MATCH
(
TEQ2
, 
ö¢
Ë|| THUMB2_INSN_MATCH(
TST2
, insn)) {

210 
ªg
 = 
	`THUMB2_INSN_REG_RM
(
ö¢
);

223 i‡((
	`THUMB2_INSN_MATCH
(
STRW
, 
ö¢
Ë|| THUMB2_INSN_MATCH(
STRBW
, insn) ||

224 
	`THUMB2_INSN_MATCH
(
STRD
, 
ö¢
Ë|| THUMB2_INSN_MATCH(
STRHT
, insn) ||

225 
	`THUMB2_INSN_MATCH
(
STRT
, 
ö¢
Ë|| THUMB2_INSN_MATCH(
STRHW1
, insn) ||

226 
	`THUMB2_INSN_MATCH
(
STRHW
, 
ö¢
)Ë&& 
	`THUMB2_INSN_REG_RT
(insn) == 15) {

227 
ªg
 = 
	`THUMB2_INSN_REG_RT
(
ö¢
);

230 i‡(
ªg
 == 6 ||Ñeg == 7) {

231 *((*)
ö¢s
 + 0Ë(*((*)ö¢†+ 0Ë& 0x00ffË| ((1 << 
mªg
) | (1 << (mreg + 1)));

232 *((*)
ö¢s
 + 1Ë(*((*)ö¢†+ 1Ë& 0xf8ffË| (
mªg
 << 8);

233 *((*)
ö¢s
 + 2Ë(*((*)ö¢†+ 2Ë& 0xfff8Ë| (
mªg
 + 1);

234 *((*)
ö¢s
 + 3Ë(*((*)ö¢†+ 3Ë& 0xffc7Ë| (
mªg
 << 3);

235 *((*)
ö¢s
 + 7Ë(*((*)ö¢†+ 7Ë& 0xf8ffË| (
mªg
 << 8);

236 *((*)
ö¢s
 + 8Ë(*((*)ö¢†+ 8Ë& 0xffc7Ë| (
mªg
 << 3);

237 *((*)
ö¢s
 + 9Ë(*((*)ö¢†+ 9Ë& 0xffc7Ë| ((
mªg
 + 1) << 3);

238 *((*)
ö¢s
 + 10Ë(*((*)ö¢†+ 10Ë& 0x00ffË| (–1 << 
mªg
) | (1 << (mreg + 1)));

241 i‡(
	`THUMB_INSN_MATCH
(
APC
, 
ö¢
)) {

243 *((*)
ö¢s
 + 4Ë((
ö¢
 & 0xffff) | 0x800);

245 i‡(
	`THUMB_INSN_MATCH
(
LRO3
, 
ö¢
)) {

247 *((*)
ö¢s
 + 4Ë((
ö¢
 & 0xffff) + 0x5000);

249 i‡(
	`THUMB_INSN_MATCH
(
MOV3
, 
ö¢
)) {

251 *((*)
ö¢s
 + 4Ë((
ö¢
 & 0xffff) ^ 0x10);

253 i‡(
	`THUMB2_INSN_MATCH
(
ADR
, 
ö¢
)) {

255 
ö¢s
[2] = (
ö¢
 & 0xfffffff0) | 0x0d;

257 i‡(
	`THUMB2_INSN_MATCH
(
LDRW
, 
ö¢
Ë|| THUMB2_INSN_MATCH(
LDRBW
, insn) ||

258 
	`THUMB2_INSN_MATCH
(
LDRHW
, 
ö¢
)) {

263 
ö¢s
[2] = (
ö¢
 & 0xf0fffff0) | 0x0c00000d;

265 i‡(
	`THUMB2_INSN_MATCH
(
LDRW1
, 
ö¢
Ë|| THUMB2_INSN_MATCH(
LDRBW1
, insn) ||

266 
	`THUMB2_INSN_MATCH
(
LDRHW1
, 
ö¢
Ë|| THUMB2_INSN_MATCH(
LDRD
, insn) ||

267 
	`THUMB2_INSN_MATCH
(
LDRD1
, 
ö¢
Ë|| THUMB2_INSN_MATCH(
LDREX
, insn)) {

269 
ö¢s
[2] = (
ö¢
 & 0xfffffff0) | 0xd;

271 i‡(
	`THUMB2_INSN_MATCH
(
MUL
, 
ö¢
)) {

272 
ö¢s
[2] = (
ö¢
 & 0xfff0ffff) | 0x000d0000;

274 i‡(
	`THUMB2_INSN_MATCH
(
DP
, 
ö¢
)) {

275 i‡(
	`THUMB2_INSN_REG_RM
(
ö¢
) == 15) {

276 
ö¢s
[2] = (
ö¢
 & 0xfff0ffff) | 0x000d0000;

277 } i‡(
	`THUMB2_INSN_REG_RN
(
ö¢
) == 15) {

278 
ö¢s
[2] = (
ö¢
 & 0xfffffff0) | 0xd;

281 i‡(
	`THUMB2_INSN_MATCH
(
LDRWL
, 
ö¢
)) {

283 
ö¢s
[2] = (
ö¢
 & 0xfffffff0) | 0xd;

285 i‡(
	`THUMB2_INSN_MATCH
(
RSBW
, 
ö¢
)) {

286 
ö¢s
[2] = (
ö¢
 & 0xfffffff0) | 0xd;

288 i‡(
	`THUMB2_INSN_MATCH
(
RORW
, 
ö¢
Ë|| THUMB2_INSN_MATCH(
LSLW1
, in¢Ë|| THUMB2_INSN_MATCH(
LSRW1
, insn)) {

289 i‡((
	`THUMB2_INSN_REG_RM
(
ö¢
Ë=15Ë&& (
	`THUMB2_INSN_REG_RN
(insn) == 15)) {

290 
ö¢s
[2] = (
ö¢
 & 0xfffdfffd);

291 } i‡(
	`THUMB2_INSN_REG_RM
(
ö¢
) == 15) {

292 
ö¢s
[2] = (
ö¢
 & 0xfff0ffff) | 0xd0000;

293 } i‡(
	`THUMB2_INSN_REG_RN
(
ö¢
) == 15) {

294 
ö¢s
[2] = (
ö¢
 & 0xfffffff0) | 0xd;

297 i‡(
	`THUMB2_INSN_MATCH
(
ROR
, 
ö¢
Ë|| THUMB2_INSN_MATCH(
LSLW2
, in¢Ë|| THUMB2_INSN_MATCH(
LSRW2
, insn)) {

298 
ö¢s
[2] = (
ö¢
 & 0xfff0ffff) | 0xd0000;

312 i‡(
	`THUMB2_INSN_MATCH
(
STRW
, 
ö¢
Ë|| THUMB2_INSN_MATCH(
STRBW
, insn)) {

313 
ö¢s
[2] = (
ö¢
 & 0xfff0ffff) | 0x000d0000;

315 i‡(
	`THUMB2_INSN_MATCH
(
STRD
, 
ö¢
Ë|| THUMB2_INSN_MATCH(
STRHT
, insn) ||

316 
	`THUMB2_INSN_MATCH
(
STRT
, 
ö¢
Ë|| THUMB2_INSN_MATCH(
STRHW1
, insn)) {

317 i‡(
	`THUMB2_INSN_REG_RN
(
ö¢
) == 15) {

318 
ö¢s
[2] = (
ö¢
 & 0xfffffff0) | 0xd;

320 
ö¢s
[2] = 
ö¢
;

323 i‡(
	`THUMB2_INSN_MATCH
(
STRHW
, 
ö¢
Ë&& (
	`THUMB2_INSN_REG_RN
(insn) == 15)) {

324 i‡(
	`THUMB2_INSN_REG_RN
(
ö¢
) == 15) {

325 
ö¢s
[2] = (
ö¢
 & 0xf0fffff0) | 0x0c00000d;

327 
ö¢s
[2] = 
ö¢
;

334 i‡((
ªg
 =15Ë&& (
	`THUMB2_INSN_MATCH
(
STRW
, 
ö¢
) ||

335 
	`THUMB2_INSN_MATCH
(
STRBW
, 
ö¢
) ||

336 
	`THUMB2_INSN_MATCH
(
STRD
, 
ö¢
) ||

337 
	`THUMB2_INSN_MATCH
(
STRHT
, 
ö¢
) ||

338 
	`THUMB2_INSN_MATCH
(
STRT
, 
ö¢
) ||

339 
	`THUMB2_INSN_MATCH
(
STRHW1
, 
ö¢
) ||

340 
	`THUMB2_INSN_MATCH
(
STRHW
, 
ö¢
) )) {

341 
ö¢s
[2] = (insns[2] & 0x0fffffff) | 0xd0000000;

344 i‡(
	`THUMB2_INSN_MATCH
(
TEQ1
, 
ö¢
Ë|| THUMB2_INSN_MATCH(
TST1
, insn)) {

345 
ö¢s
[2] = (
ö¢
 & 0xfffffff0) | 0xd;

347 i‡(
	`THUMB2_INSN_MATCH
(
TEQ2
, 
ö¢
Ë|| THUMB2_INSN_MATCH(
TST2
, insn)) {

348 i‡((
	`THUMB2_INSN_REG_RN
(
ö¢
Ë=15Ë&& (
	`THUMB2_INSN_REG_RM
(insn) == 15)) {

349 
ö¢s
[2] = (
ö¢
 & 0xfffdfffd);

350 } i‡(
	`THUMB2_INSN_REG_RM
(
ö¢
) == 15) {

351 
ö¢s
[2] = (
ö¢
 & 0xfff0ffff) | 0xd0000;

352 } i‡(
	`THUMB2_INSN_REG_RN
(
ö¢
) == 15) {

353 
ö¢s
[2] = (
ö¢
 & 0xfffffff0) | 0xd;

359 
	}
}

361 
	$¨ch_c›y_åampﬁöe_thumb_u¥obe
(
u¥obe
 *
up
)

363 
uªgs
, 
pc_dï
;

364 
k¥obe
 *
p
 = 
	`up2kp
(
up
);

365 
addr
;

366 
vaddr
 = ()
p
->
addr
;

367 
ö¢
 = 
p
->
›code
;

368 *
åamp
 = 
up
->
©ømp
.
åamp_thumb
;

369 íum { 
åamp_Àn
 = (
up
->
©ømp
.
åamp_thumb
) };

371 
p
->
ß„_thumb
 = 1;

372 i‡(
vaddr
 & 0x01) {

373 
	`¥ötk
("Eº‹ i¿%†© %d:áâem±Åÿªgi°î k¥obê©á¿u«lig√dáddªss\n", 
__FILE__
, 
__LINE__
);

374  -
EINVAL
;

377 i‡(!
	`¨ch_check_ö¢_thumb
(
ö¢
)) {

378 
p
->
ß„_thumb
 = 0;

381 
uªgs
 = 0;

382 
pc_dï
 = 0;

384 i‡(
	`THUMB_INSN_MATCH
(
APC
, 
ö¢
Ë|| THUMB_INSN_MATCH(
LRO3
, insn)) {

385 
uªgs
 = 0x0700;

386 
pc_dï
 = 1;

387 } i‡(
	`THUMB_INSN_MATCH
(
MOV3
, 
ö¢
) && ((((()insn) & 0xff) >> 3) == 15)) {

389 
uªgs
 = 0x07;

390 
pc_dï
 = 1;

391 } 
	`THUMB2_INSN_MATCH
(
ADR
, 
ö¢
) {

392 
uªgs
 = 0x0f00;

393 
pc_dï
 = 1;

394 } i‡(((
	`THUMB2_INSN_MATCH
(
LDRW
, 
ö¢
Ë|| THUMB2_INSN_MATCH(
LDRW1
, insn) ||

395 
	`THUMB2_INSN_MATCH
(
LDRBW
, 
ö¢
Ë|| THUMB2_INSN_MATCH(
LDRBW1
, insn) ||

396 
	`THUMB2_INSN_MATCH
(
LDRHW
, 
ö¢
Ë|| THUMB2_INSN_MATCH(
LDRHW1
, insn) ||

397 
	`THUMB2_INSN_MATCH
(
LDRWL
, 
ö¢
)Ë&& 
	`THUMB2_INSN_REG_RN
(insn) == 15) ||

398 
	`THUMB2_INSN_MATCH
(
LDREX
, 
ö¢
) ||

399 ((
	`THUMB2_INSN_MATCH
(
STRW
, 
ö¢
Ë|| THUMB2_INSN_MATCH(
STRBW
, insn) ||

400 
	`THUMB2_INSN_MATCH
(
STRHW
, 
ö¢
Ë|| THUMB2_INSN_MATCH(
STRHW1
, insn)) &&

401 (
	`THUMB2_INSN_REG_RN
(
ö¢
Ë=15 || 
	`THUMB2_INSN_REG_RT
(insn) == 15)) ||

402 ((
	`THUMB2_INSN_MATCH
(
STRT
, 
ö¢
Ë|| THUMB2_INSN_MATCH(
STRHT
, insn)) &&

403 (
	`THUMB2_INSN_REG_RN
(
ö¢
Ë=15 || 
	`THUMB2_INSN_REG_RT
(insn) == 15))) {

404 
uªgs
 = 0xf000;

405 
pc_dï
 = 1;

406 } i‡((
	`THUMB2_INSN_MATCH
(
LDRD
, 
ö¢
Ë|| THUMB2_INSN_MATCH(
LDRD1
, in¢)Ë&& (
	`THUMB2_INSN_REG_RN
(insn) == 15)) {

407 
uªgs
 = 0xff00;

408 
pc_dï
 = 1;

409 } i‡(
	`THUMB2_INSN_MATCH
(
MUL
, 
ö¢
Ë&& 
	`THUMB2_INSN_REG_RM
(insn) == 15) {

410 
uªgs
 = 0xf;

411 
pc_dï
 = 1;

412 } i‡(
	`THUMB2_INSN_MATCH
(
DP
, 
ö¢
Ë&& (
	`THUMB2_INSN_REG_RN
(ö¢Ë=15 || 
	`THUMB2_INSN_REG_RM
(insn) == 15)) {

413 
uªgs
 = 0xf000;

414 
pc_dï
 = 1;

415 } i‡(
	`THUMB2_INSN_MATCH
(
STRD
, 
ö¢
Ë&& ((
	`THUMB2_INSN_REG_RN
(ö¢Ë=15Ë|| (
	`THUMB2_INSN_REG_RT
(ö¢Ë=15Ë|| 
	`THUMB2_INSN_REG_RT2
(insn) == 15)) {

416 
uªgs
 = 0xff00;

417 
pc_dï
 = 1;

418 } i‡(
	`THUMB2_INSN_MATCH
(
RSBW
, 
ö¢
Ë&& 
	`THUMB2_INSN_REG_RN
(insn) == 15) {

419 
uªgs
 = 0x0f00;

420 
pc_dï
 = 1;

421 } i‡(
	`THUMB2_INSN_MATCH
 (
RORW
, 
ö¢
Ë&& (
	`THUMB2_INSN_REG_RN
(ö¢Ë=15 || 
	`THUMB2_INSN_REG_RM
(insn) == 15)) {

422 
uªgs
 = 0x0f00;

423 
pc_dï
 = 1;

424 } i‡((
	`THUMB2_INSN_MATCH
(
ROR
, 
ö¢
Ë|| THUMB2_INSN_MATCH(
LSLW2
, in¢Ë|| THUMB2_INSN_MATCH(
LSRW2
, in¢)Ë&& 
	`THUMB2_INSN_REG_RM
(insn) == 15) {

425 
uªgs
 = 0x0f00;

426 
pc_dï
 = 1;

427 } i‡((
	`THUMB2_INSN_MATCH
(
LSLW1
, 
ö¢
Ë|| THUMB2_INSN_MATCH(
LSRW1
, in¢)Ë&& (
	`THUMB2_INSN_REG_RN
(ö¢Ë=15 || 
	`THUMB2_INSN_REG_RM
(insn) == 15)) {

428 
uªgs
 = 0x0f00;

429 
pc_dï
 = 1;

430 } i‡((
	`THUMB2_INSN_MATCH
(
TEQ1
, 
ö¢
Ë|| THUMB2_INSN_MATCH(
TST1
, in¢)Ë&& 
	`THUMB2_INSN_REG_RN
(insn) == 15) {

431 
uªgs
 = 0xf0000;

432 
pc_dï
 = 1;

433 } i‡((
	`THUMB2_INSN_MATCH
(
TEQ2
, 
ö¢
Ë|| THUMB2_INSN_MATCH(
TST2
, insn)) &&

434 (
	`THUMB2_INSN_REG_RN
(
ö¢
Ë=15 || 
	`THUMB2_INSN_REG_RM
(insn) == 15)) {

435 
uªgs
 = 0xf0000;

436 
pc_dï
 = 1;

439 i‡(
	`u∆ikñy
(
uªgs
 && 
pc_dï
)) {

440 
	`mem˝y
(
åamp
, 
pc_dï_ö¢_execbuf_thumb
, 
åamp_Àn
);

441 i‡(
	`¥ï_pc_dï_ö¢_execbuf_thumb
(
åamp
, 
ö¢
, 
uªgs
) != 0) {

442 
	`¥ötk
("Error in %sát %d: failedÅoÖrepareÉxec buffer for insn %lx!",

443 
__FILE__
, 
__LINE__
, 
ö¢
);

444 
p
->
ß„_thumb
 = 1;

447 
addr
 = 
vaddr
 + 4;

448 *((*)
åamp
 + 13) = 0xdeff;

449 *((*)
åamp
 + 14Ë
addr
 & 0x0000ffff;

450 *((*)
åamp
 + 15Ë
addr
 >> 16;

451 i‡(!
	`is_thumb2
(
ö¢
)) {

452 
addr
 = 
vaddr
 + 2;

453 *((*)
åamp
 + 16Ë(
addr
 & 0x0000ffff) | 0x1;

454 *((*)
åamp
 + 17Ë
addr
 >> 16;

456 
addr
 = 
vaddr
 + 4;

457 *((*)
åamp
 + 16Ë(
addr
 & 0x0000ffff) | 0x1;

458 *((*)
åamp
 + 17Ë
addr
 >> 16;

461 
	`mem˝y
(
åamp
, 
gí_ö¢_execbuf_thumb
, 
åamp_Àn
);

462 *((*)
åamp
 + 13) = 0xdeff;

463 i‡(!
	`is_thumb2
(
ö¢
)) {

464 
addr
 = 
vaddr
 + 2;

465 *((*)
åamp
 + 2Ë
ö¢
;

466 *((*)
åamp
 + 16Ë(
addr
 & 0x0000ffff) | 0x1;

467 *((*)
åamp
 + 17Ë
addr
 >> 16;

469 
addr
 = 
vaddr
 + 4;

470 
åamp
[1] = 
ö¢
;

471 *((*)
åamp
 + 16Ë(
addr
 & 0x0000ffff) | 0x1;

472 *((*)
åamp
 + 17Ë
addr
 >> 16;

476 i‡(
	`THUMB_INSN_MATCH
(
B2
, 
ö¢
)) {

477 
	`mem˝y
(
åamp
, 
b_off_ö¢_execbuf_thumb
, 
åamp_Àn
);

478 *((*)
åamp
 + 13) = 0xdeff;

479 
addr
 = 
	`bønch_t16_de°
(
ö¢
, 
vaddr
);

480 *((*)
åamp
 + 14Ë(
addr
 & 0x0000ffff) | 0x1;

481 *((*)
åamp
 + 15Ë
addr
 >> 16;

482 *((*)
åamp
 + 16) = 0;

483 *((*)
åamp
 + 17) = 0;

485 } i‡(
	`THUMB_INSN_MATCH
(
B1
, 
ö¢
)) {

486 
	`mem˝y
(
åamp
, 
b_c⁄d_ö¢_execbuf_thumb
, 
åamp_Àn
);

487 *((*)
åamp
 + 13) = 0xdeff;

488 *((*)
åamp
 + 0Ë|(
ö¢
 & 0xf00);

489 
addr
 = 
	`bønch_c⁄d_t16_de°
(
ö¢
, 
vaddr
);

490 *((*)
åamp
 + 14Ë(
addr
 & 0x0000ffff) | 0x1;

491 *((*)
åamp
 + 15Ë
addr
 >> 16;

492 
addr
 = 
vaddr
 + 2;

493 *((*)
åamp
 + 16Ë(
addr
 & 0x0000ffff) | 0x1;

494 *((*)
åamp
 + 17Ë
addr
 >> 16;

496 } i‡(
	`THUMB_INSN_MATCH
(
BLX2
, 
ö¢
) ||

497 
	`THUMB_INSN_MATCH
(
BX
, 
ö¢
)) {

498 
	`mem˝y
(
åamp
, 
b_r_ö¢_execbuf_thumb
, 
åamp_Àn
);

499 *((*)
åamp
 + 13) = 0xdeff;

500 *((*)
åamp
 + 4Ë
ö¢
;

501 
addr
 = 
vaddr
 + 2;

502 *((*)
åamp
 + 16Ë(
addr
 & 0x0000ffff) | 0x1;

503 *((*)
åamp
 + 17Ë
addr
 >> 16;

505 } i‡(
	`THUMB2_INSN_MATCH
(
BLX1
, 
ö¢
) ||

506 
	`THUMB2_INSN_MATCH
(
BL
, 
ö¢
)) {

507 
	`mem˝y
(
åamp
, 
blx_off_ö¢_execbuf_thumb
, 
åamp_Àn
);

508 *((*)
åamp
 + 13) = 0xdeff;

509 
addr
 = 
	`bønch_t32_de°
(
ö¢
, 
vaddr
);

510 *((*)
åamp
 + 14Ë(
addr
 & 0x0000ffff);

511 *((*)
åamp
 + 15Ë
addr
 >> 16;

512 
addr
 = 
vaddr
 + 4;

513 *((*)
åamp
 + 16Ë(
addr
 & 0x0000ffff) | 0x1;

514 *((*)
åamp
 + 17Ë
addr
 >> 16;

516 } i‡(
	`THUMB_INSN_MATCH
(
CBZ
, 
ö¢
)) {

517 
	`mem˝y
(
åamp
, 
cbz_ö¢_execbuf_thumb
, 
åamp_Àn
);

518 *((*)
åamp
 + 13) = 0xdeff;

519 *((*)
åamp
 + 0Ë
ö¢
 & (~insn & 0xf8);

520 *((*)
åamp
 + 0) &= 0x20;

521 
addr
 = 
	`cbz_t16_de°
(
ö¢
, 
vaddr
);

522 *((*)
åamp
 + 14Ë(
addr
 & 0x0000ffff) | 0x1;

523 *((*)
åamp
 + 15Ë
addr
 >> 16;

524 
addr
 = 
vaddr
 + 2;

525 *((*)
åamp
 + 16Ë(
addr
 & 0x0000ffff) | 0x1;

526 *((*)
åamp
 + 17Ë
addr
 >> 16;

530 
	}
}

532 
	$¨ch_¥ï¨e_u¥obe
(
u¥obe
 *
up
)

534 
k¥obe
 *
p
 = 
	`up2kp
(
up
);

535 
èsk_°ru˘
 *
èsk
 = 
up
->task;

536 
vaddr
 = ()
p
->
addr
;

537 
ö¢
;

539 i‡(
vaddr
 & 0x01) {

540 
	`¥ötk
("Error in %sát %d:áttemptÅoÑegister uprobe "

541 "©á¿u«lig√dáddªss\n", 
__FILE__
, 
__LINE__
);

542  -
EINVAL
;

545 i‡(!
	`ªad_¥oc_vm_©omic
(
èsk
, 
vaddr
, &
ö¢
, (insn)))

546 
	`∑nic
("ÁûedÅÿªad mem‹y %lx!\n", 
vaddr
);

548 
p
->
›code
 = 
ö¢
;

550 
	`¨ch_c›y_åampﬁöe_¨m_u¥obe
(
up
);

551 
	`¨ch_c›y_åampﬁöe_thumb_u¥obe
(
up
);

553 i‡((
p
->
ß„_¨m
Ë&& (p->
ß„_thumb
)) {

554 
	`¥ötk
("Error in %sát %d: failed "

557 
__FILE__
, 
__LINE__
, 
èsk
->
tgid
, 
vaddr
, 
ö¢
);

559 i‡(!
	`wrôe_¥oc_vm_©omic
(
èsk
, 
vaddr
, &
ö¢
, (insn)))

560 
	`∑nic
("FaûedÅÿwrôêmem‹y %p!\n", 
p
->
addr
);

562  -
EFAULT
;

566 
	}
}

568 
	$¨ch_›code_™Æysis_uªçrobe
(
uªçrobe
 *
Ω
)

571 
Ω
->
thumb_n‹ë
 = !!(
	`THUMB2_INSN_MATCH
(
BL
,Ñp->
up
.
kp
.
›code
) ||

572 
	`THUMB2_INSN_MATCH
(
BLX1
, 
Ω
->
up
.
kp
.
›code
) ||

573 
	`THUMB_INSN_MATCH
(
BLX2
, 
Ω
->
up
.
kp
.
›code
));

575 
Ω
->
¨m_n‹ë
 = !!(
	`ARM_INSN_MATCH
(
BL
,Ñp->
up
.
kp
.
›code
) ||

576 
	`ARM_INSN_MATCH
(
BLX1
, 
Ω
->
up
.
kp
.
›code
) ||

577 
	`ARM_INSN_MATCH
(
BLX2
, 
Ω
->
up
.
kp
.
›code
));

578 
	}
}

580 
	$¨ch_¥ï¨e_uªçrobe
(
uªçrobe_ö°™˚
 *
ri
,

581 
±_ªgs
 *
ªgs
)

583 
ri
->
ªt_addr
 = (
k¥obe_›code_t
 *)
ªgs
->
ARM_Ã
;

584 
ri
->
•
 = (
k¥obe_›code_t
 *)
ªgs
->
ARM_•
;

587 
ri
->
•
 = (
k¥obe_›code_t
 *)((Ïi->• | !!
	`thumb_mode
(
ªgs
));

589 i‡(
	`thumb_mode
(
ªgs
)) {

590 
ªgs
->
ARM_Ã
 = ()(
ri
->
Ω
->
up
.
kp
.
aö¢
.
ö¢
) + 0x1b;

592 
ªgs
->
ARM_Ã
 = ()(
ri
->
Ω
->
up
.
kp
.
aö¢
.
ö¢
 + 
UPROBES_TRAMP_RET_BREAK_IDX
);

594 
	}
}

596 
	$¨ch_dißrm_uΩ_ö°
(
uªçrobe_ö°™˚
 *
ri
,

597 
èsk_°ru˘
 *
èsk
)

599 *
åamp
;

600 *
•
 = (*)(()
ri
->sp & ~1);

601 *
°ack
 = 
•
 - 
RETPROBE_STACK_DEPTH
 + 1;

602 *
found
 = 
NULL
;

603 *
buf
[
RETPROBE_STACK_DEPTH
];

604 
i
, 
ªtvÆ
;

607 i‡(()
ri
->
•
 & 1) {

608 
åamp
 = (*)

609 (()
ri
->
Ω
->
up
.
kp
.
aö¢
.
ö¢
 + 0x1b);

611 
åamp
 = (*)(
ri
->
Ω
->
up
.
kp
.
aö¢
.
ö¢
 +

612 
UPROBES_TRAMP_RET_BREAK_IDX
);

615 
ªtvÆ
 = 
	`ªad_¥oc_vm_©omic
(
èsk
, ()
°ack
,

616 
buf
, (buf));

617 i‡(
ªtvÆ
 !(
buf
)) {

618 
	`¥ötk
("---> %s (%d/%d): failedÅoÑead stack from %08lx\n",

619 
èsk
->
comm
,Åask->
tgid
,Åask->
pid
,

620 ()
°ack
);

621 
ªtvÆ
 = -
EFAULT
;

622 
out
;

626 
i
 = 
RETPROBE_STACK_DEPTH
 - 1; i >= 0; i--) {

627 i‡(
buf
[
i
] =
åamp
) {

628 
found
 = 
°ack
 + 
i
;

633 i‡(
found
) {

634 
	`¥ötk
("---> %s (%d/%d):Årampoline foundát "

636 
èsk
->
comm
,Åask->
tgid
,Åask->
pid
,

637 ()
found
, ()
•
,

638 
found
 - 
•
, 
ri
->
Ω
->
up
.
kp
.
addr
);

639 
ªtvÆ
 = 
	`wrôe_¥oc_vm_©omic
(
èsk
, ()
found
,

640 &
ri
->
ªt_addr
,

641 (
ri
->
ªt_addr
));

642 i‡(
ªtvÆ
 !(
ri
->
ªt_addr
)) {

643 
	`¥ötk
("---> %s (%d/%d): failedÅo write value "

645 
èsk
->
comm
,Åask->
tgid
,Åask->
pid
, ()
found
);

646 
ªtvÆ
 = -
EFAULT
;

648 
ªtvÆ
 = 0;

651 
±_ªgs
 *
uªgs
 = 
	`èsk_±_ªgs
(
ri
->
èsk
);

652 
ø
 = 
	`dbi_gë_ªt_addr
(
uªgs
);

653 i‡(
ø
 =()
åamp
) {

654 
	`¥ötk
("---> %s (%d/%d):Årampoline foundát "

656 
èsk
->
comm
,Åask->
tgid
,Åask->
pid
,

657 
ø
, 
ri
->
Ω
->
up
.
kp
.
addr
);

658 
	`dbi_£t_ªt_addr
(
uªgs
, ()
ri
->
ªt_addr
);

659 
ªtvÆ
 = 0;

661 
	`¥ötk
("---> %s (%d/%d):Årampoline NOT foundát "

663 
èsk
->
comm
,Åask->
tgid
,Åask->
pid
,

664 ()
•
, 
ø
, 
ri
->
Ω
->
up
.
kp
.
addr
);

665 
ªtvÆ
 = -
ENOENT
;

669 
out
:

670  
ªtvÆ
;

671 
	}
}

673 
	$£tjmp_u¥e_h™dÀr
(
k¥obe
 *
p
, 
±_ªgs
 *
ªgs
)

675 
u¥obe
 *
up
 = 
	`c⁄èöî_of
(
p
, u¥obe, 
kp
);

676 
uj¥obe
 *
jp
 = 
	`c⁄èöî_of
(
up
, ujprobe, up);

678 
k¥obe_¥e_íåy_h™dÀr_t
 
¥e_íåy
 = (k¥obe_¥e_íåy_h™dÀr_t)
jp
->pre_entry;

679 
íåy_poöt_t
 
íåy
 = (íåy_poöt_t)
jp
->entry;

681 i‡(
¥e_íåy
) {

682 
p
->
ss_addr
 = (
k¥obe_›code_t
 *)
	`¥e_íåy
(
jp
->
¥iv_¨g
, 
ªgs
);

685 i‡(
íåy
) {

686 
	`íåy
(
ªgs
->
ARM_r0
,Ñegs->
ARM_r1
,Ñegs->
ARM_r2
,

687 
ªgs
->
ARM_r3
,Ñegs->
ARM_r4
,Ñegs->
ARM_r5
);

689 
	`¨ch_uj¥obe_ªtu∫
();

693 
	}
}

695 
	$¨ch_gë_åampﬁöe_addr
(
k¥obe
 *
p
, 
±_ªgs
 *
ªgs
)

697  
	`thumb_mode
(
ªgs
) ?

698 ()(
p
->
aö¢
.
ö¢
) + 0x1b :

699 ()(
p
->
aö¢
.
ö¢
 + 
UPROBES_TRAMP_RET_BREAK_IDX
);

700 
	}
}

702 
	$¨ch_£t_‹ig_ªt_addr
(
‹ig_ªt_addr
, 
±_ªgs
 *
ªgs
)

704 
ªgs
->
ARM_Ã
 = 
‹ig_ªt_addr
;

705 
ªgs
->
ARM_pc
 = 
‹ig_ªt_addr
 & ~0x1;

707 i‡(
ªgs
->
ARM_Ã
 & 0x1)

708 
ªgs
->
ARM_˝§
 |
PSR_T_BIT
;

710 
ªgs
->
ARM_˝§
 &~
PSR_T_BIT
;

711 
	}
}

713 
	$ª°‹e_›code_f‹_thumb
(
k¥obe
 *
p
, 
±_ªgs
 *
ªgs
)

715 i‡(
	`thumb_mode
(
ªgs
Ë&& !
	`is_thumb2
(
p
->
›code
)) {

716 
u16
 
tmp
 = 
p
->
›code
 >> 16;

717 
	`wrôe_¥oc_vm_©omic
(
cuºít
,

718 ()((
u16
*)
p
->
addr
 + 1), &
tmp
, 2);

719 
	`Êush_ö¢s
(
p
->
addr
, 4);

721 
	}
}

723 
	$make_åampﬁöe
(
u¥obe
 *
up
, 
±_ªgs
 *
ªgs
)

725 *
åamp
, *
uåamp
;

726 
k¥obe
 *
p
 = 
	`up2kp
(
up
);

727 
sw
;

734 
sw
 = (!!
	`thumb_mode
(
ªgs
)) |

735 ()!
p
->
ß„_¨m
 << 1 |

736 ()!
p
->
ß„_thumb
 << 2;

738 
sw
) {

742 
åamp
 = 
up
->
©ømp
.
åamp_¨m
;

747 
	`ª°‹e_›code_f‹_thumb
(
p
, 
ªgs
);

748 
åamp
 = 
up
->
©ømp
.
åamp_thumb
;

751 
	`¥ötk
("Error in %sát %d: weáre inárm mode "

754 
__FILE__
, 
__LINE__
, 
p
->
›code
,Ö->
addr
);

756 
	`dißrm_u¥obe
(
p
, 
up
->
èsk
);

761 
uåamp
 = 
	`Æloc_ö¢_¶Ÿ
(
up
->
sm
);

763 i‡(!
	`wrôe_¥oc_vm_©omic
(
up
->
èsk
, ()
uåamp
, 
åamp
,

764 
UPROBES_TRAMP_LEN
 * (*
åamp
)))

765 
	`∑nic
("ÁûedÅÿwrôêmem‹y %p!\n", 
uåamp
);

767 
p
->
aö¢
.
ö¢
 = 
uåamp
;

770 
	}
}

772 
	$u¥obe_h™dÀr
(
±_ªgs
 *
ªgs
)

774 
k¥obe_›code_t
 *
addr
 = (k¥obe_›code_à*)(
ªgs
->
ARM_pc
);

775 
èsk_°ru˘
 *
èsk
 = 
cuºít
;

776 
pid_t
 
tgid
 = 
èsk
->tgid;

777 
k¥obe
 *
p
;

779 
p
 = 
	`gë_uk¥obe
(
addr
, 
tgid
);

780 i‡(
p
 =
NULL
) {

781 
off£t_bp
 = 
	`thumb_mode
(
ªgs
) ?

783 4 * 
UPROBES_TRAMP_RET_BREAK_IDX
;

784 *
åamp_addr
 = (*)
addr
 - 
off£t_bp
;

786 
p
 = 
	`gë_uk¥obe_by_ö¢_¶Ÿ
(
åamp_addr
, 
tgid
, 
ªgs
);

787 i‡(
p
 =
NULL
) {

788 
	`¥ötk
("no_uprobe: Not one of ours:Üet "

789 "kî√»h™dÀ ià%p\n", 
addr
);

793 
	`åampﬁöe_u¥obe_h™dÀr
(
p
, 
ªgs
);

795 i‡(
p
->
aö¢
.
ö¢
 =
NULL
) {

796 
u¥obe
 *
up
 = 
	`kp2up
(
p
);

798 i‡(
	`make_åampﬁöe
(
up
, 
ªgs
)) {

799 
	`¥ötk
("no_uprobeÜive\n");

804 
	`add_u¥obe_èbÀ
(
p
);

807 i‡(!
p
->
¥e_h™dÀr
 || !p->
	`¥e_h™dÀr
’, 
ªgs
)) {

808 
	`¥ï¨e_sögÀ°ï
(
p
, 
ªgs
);

813 
	}
}

815 
	$u¥obe_å≠_h™dÀr
(
±_ªgs
 *
ªgs
, 
ö°r
)

817 
ªt
;

818 
Êags
;

819 
	`loˇl_úq_ßve
(
Êags
);

821 
	`¥ìm±_dißbÀ
();

822 
ªt
 = 
	`u¥obe_h™dÀr
(
ªgs
);

823 
	`¥ìm±_íabÀ_no_ªsched
();

825 
	`loˇl_úq_ª°‹e
(
Êags
);

826  
ªt
;

827 
	}
}

830 
undef_hook
 
	gundef_hook_f‹_us_¨m
 = {

831 .
ö°r_mask
 = 0xffffffff,

832 .
	gö°r_vÆ
 = 
BREAKPOINT_INSTRUCTION
,

833 .
	g˝§_mask
 = 
MODE_MASK
,

834 .
	g˝§_vÆ
 = 
USR_MODE
,

835 .
	g‚
 = 
u¥obe_å≠_h™dÀr


839 
undef_hook
 
	gundef_hook_f‹_us_thumb
 = {

840 .
ö°r_mask
 = 0xffffffff,

841 .
	gö°r_vÆ
 = 
BREAKPOINT_INSTRUCTION
 & 0x0000ffff,

842 .
	g˝§_mask
 = 
MODE_MASK
,

843 .
	g˝§_vÆ
 = 
USR_MODE
,

844 .
	g‚
 = 
u¥obe_å≠_h™dÀr


847 
	$sw≠_¨ch_öô_u¥obes
()

849 
	`sw≠_ªgi°î_undef_hook
(&
undef_hook_f‹_us_¨m
);

850 
	`sw≠_ªgi°î_undef_hook
(&
undef_hook_f‹_us_thumb
);

853 
	}
}

855 
	$sw≠_¨ch_exô_u¥obes
()

857 
	`sw≠_uƒegi°î_undef_hook
(&
undef_hook_f‹_us_thumb
);

858 
	`sw≠_uƒegi°î_undef_hook
(&
undef_hook_f‹_us_¨m
);

859 
	}
}

	@uprobe/arch/asm-arm/swap_uprobes.h

28 #i‚de‡
_ARM_SWAP_UPROBES_H


29 
	#_ARM_SWAP_UPROBES_H


	)

32 
	~<k¥obe/¨ch/asm/dbi_k¥obes.h
>

35 
	gk¥obe
;

36 
	gèsk_°ru˘
;

37 
	gu¥obe
;

38 
	guªçrobe
;

39 
	guªçrobe_ö°™˚
;

42 
	s¨ch_•ecific_åamp
 {

43 
	måamp_¨m
[
UPROBES_TRAMP_LEN
];

44 
	måamp_thumb
[
UPROBES_TRAMP_LEN
];

48 
ölöe
 
u32
 
	$sw≠_gë_uΩ_Êﬂt
(
±_ªgs
 *
ªgs
)

50  
ªgs
->
ARM_r0
;

51 
	}
}

53 
ölöe
 
u64
 
	$sw≠_gë_uΩ_doubÀ
(
±_ªgs
 *
ªgs
)

56  
ªgs
->
ARM_r0
 | (
u64
Ïegs->
ARM_r1
 << 32;

57 
	}
}

59 
ölöe
 
	$¨ch_uj¥obe_ªtu∫
()

61 
	}
}

63 
¨ch_¥ï¨e_u¥obe
(
u¥obe
 *
up
);

65 
£tjmp_u¥e_h™dÀr
(
k¥obe
 *
p
, 
±_ªgs
 *
ªgs
);

66 
ölöe
 
	$l⁄gjmp_bªak_uh™dÀr
(
k¥obe
 *
p
, 
±_ªgs
 *
ªgs
)

69 
	}
}

71 
¨ch_›code_™Æysis_uªçrobe
(
uªçrobe
 *
Ω
);

72 
¨ch_¥ï¨e_uªçrobe
(
uªçrobe_ö°™˚
 *
ri
, 
±_ªgs
 *
ªgs
);

73 
¨ch_dißrm_uΩ_ö°
(
uªçrobe_ö°™˚
 *
ri
,

74 
èsk_°ru˘
 *
èsk
);

76 
¨ch_gë_åampﬁöe_addr
(
k¥obe
 *
p
, 
±_ªgs
 *
ªgs
);

77 
¨ch_£t_‹ig_ªt_addr
(
‹ig_ªt_addr
, 
±_ªgs
 *
ªgs
);

79 
ölöe
 
	$sw≠_gë_u¨g
(
±_ªgs
 *
ªgs
, 
n
)

81 
u32
 *
±r
, 
addr
 = 0;

83 
n
) {

85  
ªgs
->
ARM_r0
;

87  
ªgs
->
ARM_r1
;

89  
ªgs
->
ARM_r2
;

91  
ªgs
->
ARM_r3
;

94 
±r
 = (
u32
 *)
ªgs
->
ARM_•
 + 
n
 - 4;

95 i‡(
	`gë_u£r
(
addr
, 
±r
))

96 
	`¥ötk
("ÁûedÅÿdîe„ªn˚áÖoöãr,Öå=%p\n", 
±r
);

98  
addr
;

99 
	}
}

101 
sw≠_¨ch_öô_u¥obes
();

102 
sw≠_¨ch_exô_u¥obes
();

	@uprobe/arch/asm-arm/trampoline_thumb.h

28 #i‚de‡
__ASM_ARM_TRAMPOLINE_THUMB_H


29 
	#__ASM_ARM_TRAMPOLINE_THUMB_H


	)

31 
gí_ö¢_execbuf_thumb
();

32 
pc_dï_ö¢_execbuf_thumb
();

33 
b_r_ö¢_execbuf_thumb
();

34 
b_off_ö¢_execbuf_thumb
();

35 
blx_off_ö¢_execbuf_thumb
();

36 
b_c⁄d_ö¢_execbuf_thumb
();

37 
cbz_ö¢_execbuf_thumb
();

	@uprobe/arch/asm-x86/swap_uprobes.c

27 
	~<löux/kdebug.h
>

28 
	~<k¥obe/¨ch/asm/dbi_k¥obes.h
>

29 
	~<u¥obe/sw≠_u¥obes.h
>

30 
	~<u¥obe/¨ch/asm/sw≠_u¥obes.h
>

31 
	~<k¥obe/dbi_ö¢_¶Ÿs.h
>

33 
	su¥obe_˘lblk
 {

34 
	mÊags
;

35 
k¥obe
 *
	mp
;

38 
	$åampﬁöe_addr
(
u¥obe
 *
up
)

40  ()(
up
->
kp
.
aö¢
.
ö¢
 +

41 
UPROBES_TRAMP_RET_BREAK_IDX
);

42 
	}
}

44 
DEFINE_PER_CPU
(
u¥obe_˘lblk
, 
ucb
Ë{ 0, 
NULL
 };

46 
k¥obe
 *
	$gë_cuºít_¥obe
()

48  
	`__gë_˝u_v¨
(
ucb
).
p
;

49 
	}
}

51 
	$£t_cuºít_¥obe
(
k¥obe
 *
p
)

53 
	`__gë_˝u_v¨
(
ucb
).
p
 =Ö;

54 
	}
}

56 
	$ª£t_cuºít_¥obe
()

58 
	`£t_cuºít_¥obe
(
NULL
);

59 
	}
}

61 
	$ßve_cuºít_Êags
(
±_ªgs
 *
ªgs
)

63 
	`__gë_˝u_v¨
(
ucb
).
Êags
 = 
ªgs
->
	`EREG
(flags);

64 
	}
}

66 
	$ª°‹e_cuºít_Êags
(
±_ªgs
 *
ªgs
)

68 
ªgs
->
	`EREG
(
Êags
Ë&~
IF_MASK
;

69 
ªgs
->
	`EREG
(
Êags
Ë|
	`__gë_˝u_v¨
(
ucb
).Êag†& 
IF_MASK
;

70 
	}
}

72 
	$¨ch_¥ï¨e_u¥obe
(
u¥obe
 *
up
)

74 
ªt
 = 0;

75 
k¥obe
 *
p
 = 
	`up2kp
(
up
);

76 
èsk_°ru˘
 *
èsk
 = 
up
->task;

77 
u8
 *
åamp
 = 
up
->
©ømp
.tramp;

78 íum { 
ˇŒ_ªœtive_›code
 = 0xe8 };

80 i‡(!
	`ªad_¥oc_vm_©omic
(
èsk
, ()
p
->
addr
,

81 
åamp
, 
MAX_INSN_SIZE
))

82 
	`∑nic
("ÁûedÅÿªad mem‹y %p!\n", 
p
->
addr
);

84 i‡(
åamp
[0] =
ˇŒ_ªœtive_›code
) {

85 
	`¥ötk
("cannot installÖrobe: 1st instruction is call\n");

89 
åamp
[
UPROBES_TRAMP_RET_BREAK_IDX
] = 
BREAKPOINT_INSTRUCTION
;

92 
p
->
›code
 = 
åamp
[0];

94 
p
->
aö¢
.
boo°abÀ
 = 
	`ˇn_boo°
(
åamp
) ? 0 : -1;

96  
ªt
;

97 
	}
}

99 
	$£tjmp_u¥e_h™dÀr
(
k¥obe
 *
p
, 
±_ªgs
 *
ªgs
)

101 
u¥obe
 *
up
 = 
	`c⁄èöî_of
(
p
, u¥obe, 
kp
);

102 
uj¥obe
 *
jp
 = 
	`c⁄èöî_of
(
up
, ujprobe, up);

103 
k¥obe_¥e_íåy_h™dÀr_t
 
¥e_íåy
 = (k¥obe_¥e_íåy_h™dÀr_t)
jp
->pre_entry;

104 
íåy_poöt_t
 
íåy
 = (íåy_poöt_t)
jp
->entry;

105 
¨gs
[6];

109 #i‡
LINUX_VERSION_CODE
 >
	`KERNEL_VERSION
(2, 6, 18)

110 
	`åa˚_h¨dúqs_off
();

114 i‡(!
	`ªad_¥oc_vm_©omic
(
cuºít
, 
ªgs
->
	`EREG
(
•
Ë+ 4, 
¨gs
, (args)))

115 
	`∑nic
("ÁûedÅÿªad u£∏•a˚ fun¯¨gumít†%lx!\n", 
ªgs
->
	`EREG
(
•
) + 4);

117 i‡(
¥e_íåy
)

118 
p
->
ss_addr
 = (
k¥obe_›code_t
 *)
	`¥e_íåy
(
jp
->
¥iv_¨g
, 
ªgs
);

120 i‡(
íåy
)

121 
	`íåy
(
¨gs
[0],árgs[1],árgs[2],árgs[3],árgs[4],árgs[5]);

123 
	`¨ch_uj¥obe_ªtu∫
();

126 
	}
}

128 
	$¨ch_¥ï¨e_uªçrobe
(
uªçrobe_ö°™˚
 *
ri
, 
±_ªgs
 *
ªgs
)

131 
ø
 = 
	`åampﬁöe_addr
(&
ri
->
Ω
->
up
);

132 
ri
->
•
 = (
k¥obe_›code_t
 *)
ªgs
->sp;

134 i‡(!
	`ªad_¥oc_vm_©omic
(
cuºít
, 
ªgs
->
	`EREG
(
•
), &(
ri
->
ªt_addr
), (ri->ret_addr)))

135 
	`∑nic
("ÁûedÅÿªad u£∏•a˚ fun¯ø %lx!\n", 
ªgs
->
	`EREG
(
•
));

137 i‡(!
	`wrôe_¥oc_vm_©omic
(
cuºít
, 
ªgs
->
	`EREG
(
•
), &
ø
, (ra)))

138 
	`∑nic
("ÁûedÅÿwrôêu£∏•a˚ fun¯ø %lx!\n", 
ªgs
->
	`EREG
(
•
));

139 
	}
}

141 
	$¨ch_dißrm_uΩ_ö°
(
uªçrobe_ö°™˚
 *
ri
,

142 
èsk_°ru˘
 *
èsk
)

144 
Àn
;

145 
ªt_addr
;

146 
•
 = ()
ri
->sp;

147 
åamp_addr
 = 
	`åampﬁöe_addr
(&
ri
->
Ω
->
up
);

148 
Àn
 = 
	`ªad_¥oc_vm_©omic
(
èsk
, 
•
, &
ªt_addr
, (ret_addr));

149 i‡(
Àn
 !(
ªt_addr
)) {

150 
	`¥ötk
("---> %s (%d/%d): failedÅoÑead stack from %08lx\n",

151 
èsk
->
comm
,Åask->
tgid
,Åask->
pid
, 
•
);

152  -
EFAULT
;

155 i‡(
åamp_addr
 =
ªt_addr
) {

156 
Àn
 = 
	`wrôe_¥oc_vm_©omic
(
èsk
, 
•
, &
ri
->
ªt_addr
,

157 (
ri
->
ªt_addr
));

158 i‡(
Àn
 !(
ri
->
ªt_addr
)) {

159 
	`¥ötk
("---> %s (%d/%d): failedÅo write "

161 
èsk
->
comm
,Åask->
tgid
,Åask->
pid
, 
•
);

162  -
EFAULT
;

165 
	`¥ötk
("---> %s (%d/%d):Årampoline NOT foundát sp = %08lx\n",

166 
èsk
->
comm
,Åask->
tgid
,Åask->
pid
, 
•
);

167  -
ENOENT
;

171 
	}
}

173 
	$¨ch_gë_åampﬁöe_addr
(
k¥obe
 *
p
, 
±_ªgs
 *
ªgs
)

175  
	`åampﬁöe_addr
(
	`kp2up
(
p
));

176 
	}
}

178 
	$¨ch_£t_‹ig_ªt_addr
(
‹ig_ªt_addr
, 
±_ªgs
 *
ªgs
)

180 
ªgs
->
	`EREG
(
ù
Ë
‹ig_ªt_addr
;

181 
	}
}

183 
	$£t_u£r_jmp_›
(*
‰om
, *
to
)

185 
	s__¨ch_jmp_›


187 
›
;

188 
øddr
;

189 } 
	`__©åibuã__
 ((
∑cked
)Ë
j›
;

191 
j›
.
øddr
 = ()(
to
Ë- (()(
‰om
) + 5);

192 
j›
.
›
 = 
RELATIVEJUMP_INSTRUCTION
;

194 i‡(!
	`wrôe_¥oc_vm_©omic
(
cuºít
, ()
‰om
, &
j›
, (jop)))

195 
	`∑nic
("ÁûedÅÿwrôêjum∞›codêtÿu£∏•a˚ %p!\n", 
‰om
);

196 
	}
}

198 
	$ªsume_executi⁄
(
k¥obe
 *
p
, 
±_ªgs
 *
ªgs
, 
Êags
)

200 *
tos
, 
tos_dw‹d
 = 0;

201 
c›y_eù
 = ()
p
->
aö¢
.
ö¢
;

202 
‹ig_eù
 = ()
p
->
addr
;

203 
k¥obe_›code_t
 
ö¢s
[2];

205 
ªgs
->
	`EREG
(
Êags
Ë&~
TF_MASK
;

207 
tos
 = (*)&
tos_dw‹d
;

208 i‡(!
	`ªad_¥oc_vm_©omic
(
cuºít
, 
ªgs
->
	`EREG
(
•
), &
tos_dw‹d
, (tos_dword)))

209 
	`∑nic
("ÁûedÅÿªad dw‹d fromÅ› o‡thêu£∏•a˚ sèck %lx!\n", 
ªgs
->
	`EREG
(
•
));

211 i‡(!
	`ªad_¥oc_vm_©omic
(
cuºít
, ()
p
->
aö¢
.
ö¢
, 
ö¢s
, 2 * (
k¥obe_›code_t
)))

212 
	`∑nic
("ÁûedÅÿªad fú° 2 opcode†o‡ö°ru˘i⁄ c›y from u£∏•a˚ %p!\n", 
p
->
aö¢
.
ö¢
);

214 
ö¢s
[0]) {

216 *
tos
 &~(
TF_MASK
 | 
IF_MASK
);

217 *
tos
 |
Êags
 & (
TF_MASK
 | 
IF_MASK
);

226 
p
->
aö¢
.
boo°abÀ
 = 1;

227 
no_ch™ge
;

229 *
tos
 = 
‹ig_eù
 + (*to†- 
c›y_eù
);

232 *
tos
 = 
‹ig_eù
 + (*to†- 
c›y_eù
);

234 i‡(!
	`wrôe_¥oc_vm_©omic
(
cuºít
, 
ªgs
->
	`EREG
 (
•
), &
tos_dw‹d
, (tos_dword)))

235 
	`∑nic
("ÁûedÅÿwrôêdw‹dÅÿt› o‡thêu£∏•a˚ sèck %lx!\n", 
ªgs
->
	`EREG
 (
•
));

237 
no_ch™ge
;

239 i‡((
ö¢s
[1] & 0x30) == 0x10) {

245 *
tos
 = 
‹ig_eù
 + (*to†- 
c›y_eù
);

247 i‡(!
	`wrôe_¥oc_vm_©omic
(
cuºít
, 
ªgs
->
	`EREG
(
•
), &
tos_dw‹d
, (tos_dword)))

248 
	`∑nic
("ÁûedÅÿwrôêdw‹dÅÿt› o‡thêu£∏•a˚ sèck %lx!\n", 
ªgs
->
	`EREG
(
•
));

250 
no_ch™ge
;

251 } i‡(((
ö¢s
[1] & 0x31) == 0x20) ||

252 ((
ö¢s
[1] & 0x31) == 0x21)) {

255 
p
->
aö¢
.
boo°abÀ
 = 1;

256 
no_ch™ge
;

262 i‡(!
	`wrôe_¥oc_vm_©omic
(
cuºít
, 
ªgs
->
	`EREG
(
•
), &
tos_dw‹d
, (tos_dword)))

263 
	`∑nic
("ÁûedÅÿwrôêdw‹dÅÿt› o‡thêu£∏•a˚ sèck %lx!\n", 
ªgs
->
	`EREG
(
•
));

265 i‡(
p
->
aö¢
.
boo°abÀ
 == 0) {

266 i‡((
ªgs
->
	`EREG
(
ù
Ë> 
c›y_eù
Ë&& (ªgs->EREG(ùË- c›y_eùË+ 5 < 
MAX_INSN_SIZE
) {

271 
	`£t_u£r_jmp_›
((*Ë
ªgs
->
	`EREG
(
ù
), (*)
‹ig_eù
 + (ªgs->EREG(ùË- 
c›y_eù
));

272 
p
->
aö¢
.
boo°abÀ
 = 1;

274 
p
->
aö¢
.
boo°abÀ
 = -1;

278 
ªgs
->
	`EREG
(
ù
Ë
‹ig_eù
 + (ªgs->EREG(ùË- 
c›y_eù
);

280 
no_ch™ge
:

282 
	}
}

284 
	$make_åampﬁöe
(
u¥obe
 *
up
)

286 
k¥obe
 *
p
 = 
	`up2kp
(
up
);

287 
èsk_°ru˘
 *
èsk
 = 
up
->task;

288 *
åamp
;

290 
åamp
 = 
	`Æloc_ö¢_¶Ÿ
(
up
->
sm
);

291 i‡(
åamp
 == 0) {

292 
	`¥ötk
("trampoline out of memory\n");

293  -
ENOMEM
;

296 i‡(!
	`wrôe_¥oc_vm_©omic
(
èsk
, ()
åamp
,

297 
up
->
©ømp
.
åamp
,

298 (
up
->
©ømp
.
åamp
))) {

299 
	`‰ì_ö¢_¶Ÿ
(
up
->
sm
, 
åamp
);

300 
	`∑nic
("ÁûedÅÿwrôêmem‹y %p!\n", 
åamp
);

301  -
EINVAL
;

304 
p
->
aö¢
.
ö¢
 = 
åamp
;

307 
	}
}

309 
	$u¥obe_h™dÀr
(
±_ªgs
 *
ªgs
)

311 
k¥obe
 *
p
;

312 
k¥obe_›code_t
 *
addr
;

313 
èsk_°ru˘
 *
èsk
 = 
cuºít
;

314 
pid_t
 
tgid
 = 
èsk
->tgid;

316 
	`ßve_cuºít_Êags
(
ªgs
);

318 
addr
 = (
k¥obe_›code_t
 *)(
ªgs
->
	`EREG
(
ù
) - (kprobe_opcode_t));

319 
p
 = 
	`gë_uk¥obe
(
addr
, 
tgid
);

321 i‡(
p
 =
NULL
) {

322 *
åamp_addr
 = (*)
addr
 - 
UPROBES_TRAMP_RET_BREAK_IDX
;

324 
p
 = 
	`gë_uk¥obe_by_ö¢_¶Ÿ
(
åamp_addr
, 
tgid
, 
ªgs
);

325 i‡(
p
 =
NULL
) {

326 
	`¥ötk
("no_uprobe\n");

330 
	`åampﬁöe_u¥obe_h™dÀr
(
p
, 
ªgs
);

333 i‡(
p
->
aö¢
.
ö¢
 =
NULL
) {

334 
u¥obe
 *
up
 = 
	`kp2up
(
p
);

336 
	`make_åampﬁöe
(
up
);

339 
	`add_u¥obe_èbÀ
(
p
);

342 i‡(!
p
->
¥e_h™dÀr
 || !p->
	`¥e_h™dÀr
’, 
ªgs
)) {

343 i‡(
p
->
aö¢
.
boo°abÀ
 =1 && !p->
po°_h™dÀr
) {

344 
ªgs
->
	`EREG
(
ù
Ë()
p
->
aö¢
.
ö¢
;

348 
	`¥ï¨e_sögÀ°ï
(
p
, 
ªgs
);

352 
	`£t_cuºít_¥obe
(
p
);

355 
	}
}

357 
	$po°_u¥obe_h™dÀr
(
±_ªgs
 *
ªgs
)

359 
k¥obe
 *
p
 = 
	`gë_cuºít_¥obe
();

360 
Êags
 = 
	`__gë_˝u_v¨
(
ucb
).flags;

362 i‡(
p
 =
NULL
)

365 
	`ªsume_executi⁄
(
p
, 
ªgs
, 
Êags
);

366 
	`ª°‹e_cuºít_Êags
(
ªgs
);

368 
	`ª£t_cuºít_¥obe
();

371 
	}
}

373 
	$u¥obe_ex˚±i⁄s_nŸify
(
nŸifõr_block
 *
£lf
, 
vÆ
, *
d©a
)

375 
dõ_¨gs
 *
¨gs
 = (dõ_¨g†*)
d©a
;

376 
ªt
 = 
NOTIFY_DONE
;

378 i‡(
¨gs
->
ªgs
 =
NULL
 || !
	`u£r_mode_vm
(args->regs))

379  
ªt
;

381 
vÆ
) {

382 #ifde‡
CONFIG_KPROBES


383 
DIE_INT3
:

385 
DIE_TRAP
:

387 i‡(
	`u¥obe_h™dÀr
(
¨gs
->
ªgs
))

388 
ªt
 = 
NOTIFY_STOP
;

390 
DIE_DEBUG
:

391 i‡(
	`po°_u¥obe_h™dÀr
(
¨gs
->
ªgs
))

392 
ªt
 = 
NOTIFY_STOP
;

398  
ªt
;

399 
	}
}

401 
nŸifõr_block
 
	gu¥obe_ex˚±i⁄s_nb
 = {

402 .
nŸifõr_ˇŒ
 = 
u¥obe_ex˚±i⁄s_nŸify
,

403 .
	g¥i‹ôy
 = 
INT_MAX


406 
	$sw≠_¨ch_öô_u¥obes
()

408  
	`ªgi°î_dõ_nŸifõr
(&
u¥obe_ex˚±i⁄s_nb
);

409 
	}
}

411 
	$sw≠_¨ch_exô_u¥obes
()

413 
	`uƒegi°î_dõ_nŸifõr
(&
u¥obe_ex˚±i⁄s_nb
);

414 
	}
}

	@uprobe/arch/asm-x86/swap_uprobes.h

27 #i‚de‡
_ARM_SWAP_UPROBES_H


28 
	#_ARM_SWAP_UPROBES_H


	)

31 
	~<k¥obe/¨ch/asm/dbi_k¥obes.h
>

34 
	gu¥obe
;

35 
	guªçrobe
;

36 
	guªçrobe_ö°™˚
;

39 
	s¨ch_•ecific_åamp
 {

40 
u8
 
	måamp
[
UPROBES_TRAMP_LEN
 + 
BP_INSN_SIZE
];

44 
ölöe
 
u32
 
	$sw≠_gë_uΩ_Êﬂt
(
±_ªgs
 *
ªgs
)

46 
u32
 
°0
;

48 
asm
 vﬁ©ûê("f°ps %0" : "=m" (
°0
));

50  
°0
;

51 
	}
}

53 
ölöe
 
u64
 
	$sw≠_gë_uΩ_doubÀ
(
±_ªgs
 *
ªgs
)

55 
u64
 
°1
;

57 
asm
 vﬁ©ûê("f°∂ %0" : "=m" (
°1
));

59  
°1
;

60 
	}
}

62 
ölöe
 
	$¨ch_uj¥obe_ªtu∫
()

64 
	}
}

66 
¨ch_¥ï¨e_u¥obe
(
u¥obe
 *
up
);

67 
£tjmp_u¥e_h™dÀr
(
k¥obe
 *
p
, 
±_ªgs
 *
ªgs
);

68 
ölöe
 
	$l⁄gjmp_bªak_uh™dÀr
(
k¥obe
 *
p
, 
±_ªgs
 *
ªgs
)

71 
	}
}

73 
ölöe
 
	$¨ch_›code_™Æysis_uªçrobe
(
uªçrobe
 *
Ω
)

76 
	}
}

78 
¨ch_¥ï¨e_uªçrobe
(
uªçrobe_ö°™˚
 *
ri
, 
±_ªgs
 *
ªgs
);

79 
¨ch_dißrm_uΩ_ö°
(
uªçrobe_ö°™˚
 *
ri
,

80 
èsk_°ru˘
 *
èsk
);

81 
¨ch_gë_åampﬁöe_addr
(
k¥obe
 *
p
, 
±_ªgs
 *
ªgs
);

82 
¨ch_£t_‹ig_ªt_addr
(
‹ig_ªt_addr
, 
±_ªgs
 *
ªgs
);

84 
ölöe
 
	$sw≠_gë_u¨g
(
±_ªgs
 *
ªgs
, 
n
)

86 
u32
 *
±r
, 
addr
 = 0;

89 
±r
 = (
u32
 *)
ªgs
->
•
 + 
n
 + 1;

90 i‡(
	`gë_u£r
(
addr
, 
±r
))

91 
	`¥ötk
("ÁûedÅÿdîe„ªn˚áÖoöãr,Öå=%p\n", 
±r
);

93  
addr
;

94 
	}
}

96 
sw≠_¨ch_öô_u¥obes
();

97 
sw≠_¨ch_exô_u¥obes
();

	@uprobe/swap_uprobe.mod.c

1 
	~<löux/moduÀ.h
>

2 
	~<löux/vîmagic.h
>

3 
	~<löux/compûî.h
>

5 
MODULE_INFO
(
vîmagic
, 
VERMAGIC_STRING
);

7 
moduÀ
 
__this_moduÀ


8 
__©åibuã__
((
£˘i⁄
(".gnu.linkonce.this_module"))) = {

9 .
«me
 = 
KBUILD_MODNAME
,

10 .
	göô
 = 
öô_moduÀ
,

11 #ifde‡
CONFIG_MODULE_UNLOAD


12 .
	gexô
 = 
˛ónup_moduÀ
,

14 .
	g¨ch
 = 
MODULE_ARCH_INIT
,

17 c⁄° 
	g__moduÀ_dïíds
[]

18 
__u£d


19 
__©åibuã__
((
£˘i⁄
(".modinfo"))) =

23 
MODULE_INFO
(
§cvîsi⁄
, "BD4EA0C00F723EBCF554002");

	@uprobe/swap_uprobes.c

28 
	~"sw≠_u¥obes.h
"

29 
	~<k¥obe/dbi_kdebug.h
>

31 
	~<u¥obe/¨ch/asm/sw≠_u¥obes.h
>

33 
	~<löux/hash.h
>

34 
	~<löux/mempﬁicy.h
>

35 
	~<löux/moduÀ.h
>

36 
	~<k¥obe/dbi_ö¢_¶Ÿs.h
>

37 
	~<k¥obe/dbi_k¥obes_dïs.h
>

40 
	mUPROBE_HASH_BITS
 = 10,

41 
	mUPROBE_TABLE_SIZE
 = (1 << 
UPROBE_HASH_BITS
)

44 
hli°_hód
 
	gu¥obe_ö¢_¶Ÿ_èbÀ
[
UPROBE_TABLE_SIZE
];

45 
hli°_hód
 
	gu¥obe_èbÀ
[
UPROBE_TABLE_SIZE
];

47 
DEFINE_SPINLOCK
(
uªçrobe_lock
);

48 
hli°_hód
 
	guªçrobe_ö°_èbÀ
[
UPROBE_TABLE_SIZE
];

50 
	#DEBUG_PRINT_HASH_TABLE
 0

	)

52 #i‡
DEBUG_PRINT_HASH_TABLE


53 
	$¥öt_k¥obe_hash_èbÀ
()

55 
i
;

56 
hli°_hód
 *
hód
;

57 
k¥obe
 *
p
;

58 
	`DECLARE_NODE_PTR_FOR_HLIST
(
node
);

61 
i
 = 0; i < 
KPROBE_TABLE_SIZE
; ++i) {

62 
hód
 = &
k¥obe_èbÀ
[
i
];

63 
	`sw≠_hli°_f‹_óch_íåy_rcu
(
p
, 
node
, 
hód
, 
is_hli°_¨m
) {

64 
	`¥ötk
("####### find KÅgid=%u,áddr=%x\n",

65 
p
->
tgid
,Ö->
addr
);

68 
	}
}

70 
	$¥öt_kªçrobe_hash_èbÀ
()

72 
i
;

73 
hli°_hód
 *
hód
;

74 
k¥obe
 *
p
;

75 
	`DECLARE_NODE_PTR_FOR_HLIST
(
node
);

78 
i
 = 0; i < 
KPROBE_TABLE_SIZE
; ++i) {

79 
hód
 = &
kªçrobe_ö°_èbÀ
[
i
];

80 
	`sw≠_hli°_f‹_óch_íåy_rcu
(
p
, 
node
, 
hód
, 
is_hli°_¨m
) {

81 
	`¥ötk
("####### find KRÅgid=%u,áddr=%x\n",

82 
p
->
tgid
,Ö->
addr
);

85 
	}
}

87 
	$¥öt_u¥obe_hash_èbÀ
()

89 
i
;

90 
hli°_hód
 *
hód
;

91 
k¥obe
 *
p
;

92 
	`DECLARE_NODE_PTR_FOR_HLIST
(
node
);

95 
i
 = 0; i < 
UPROBE_TABLE_SIZE
; ++i) {

96 
hód
 = &
u¥obe_ö¢_¶Ÿ_èbÀ
[
i
];

97 
	`sw≠_hli°_f‹_óch_íåy_rcu
(
p
, 
node
, 
hód
, 
is_hli°_¨m
) {

98 
	`¥ötk
("####### find UÅgid=%u,áddr=%x\n",

99 
p
->
tgid
,Ö->
addr
);

102 
	}
}

108 
ölöe
 
	$c›y_u¥obe
(
k¥obe
 *
ﬁd_p
, k¥obê*
p
)

110 
	`mem˝y
(&
p
->
›code
, &
ﬁd_p
->›code, (
k¥obe_›code_t
));

111 
	`mem˝y
(&
p
->
aö¢
, &
ﬁd_p
->aö¢, (
¨ch_•ecific_ö¢
));

112 
p
->
ss_addr
 = 
ﬁd_p
->ss_addr;

113 #ifde‡
CONFIG_ARM


114 
p
->
ß„_¨m
 = 
ﬁd_p
->safe_arm;

115 
p
->
ß„_thumb
 = 
ﬁd_p
->safe_thumb;

117 
	}
}

123 
	$aggr_¥e_uh™dÀr
(
k¥obe
 *
p
, 
±_ªgs
 *
ªgs
)

125 
k¥obe
 *
kp
;

126 
ªt
;

128 
	`li°_f‹_óch_íåy_rcu
(
kp
, &
p
->
li°
,Üist) {

129 i‡(
kp
->
¥e_h™dÀr
) {

130 
ªt
 = 
kp
->
	`¥e_h™dÀr
(kp, 
ªgs
);

131 i‡(
ªt
) {

132  
ªt
;

138 
	}
}

140 
	$aggr_po°_uh™dÀr
(
k¥obe
 *
p
, 
±_ªgs
 *
ªgs
, 
Êags
)

142 
k¥obe
 *
kp
;

144 
	`li°_f‹_óch_íåy_rcu
(
kp
, &
p
->
li°
,Üist) {

145 i‡(
kp
->
po°_h™dÀr
) {

146 
kp
->
	`po°_h™dÀr
(kp, 
ªgs
, 
Êags
);

149 
	}
}

151 
	$aggr_Áu…_uh™dÀr
(
k¥obe
 *
p
, 
±_ªgs
 *
ªgs
, 
å≠ƒ
)

154 
	}
}

156 
	$aggr_bªak_uh™dÀr
(
k¥obe
 *
p
, 
±_ªgs
 *
ªgs
)

159 
	}
}

165 
	$add_√w_u¥obe
(
k¥obe
 *
ﬁd_p
, k¥obê*
p
)

167 i‡(
p
->
bªak_h™dÀr
) {

168 i‡(
ﬁd_p
->
bªak_h™dÀr
) {

169  -
EEXIST
;

172 
	`li°_add_èû_rcu
(&
p
->
li°
, &
ﬁd_p
->list);

173 
ﬁd_p
->
bªak_h™dÀr
 = 
aggr_bªak_uh™dÀr
;

175 
	`li°_add_rcu
 (&
p
->
li°
, &
ﬁd_p
->list);

178 i‡(
p
->
po°_h™dÀr
 && !
ﬁd_p
->post_handler) {

179 
ﬁd_p
->
po°_h™dÀr
 = 
aggr_po°_uh™dÀr
;

183 
	}
}

189 
ölöe
 
	$add_aggr_u¥obe
(
k¥obe
 *
≠
, k¥obê*
p
)

191 
	`c›y_u¥obe
(
p
, 
≠
);

193 
≠
->
addr
 = 
p
->addr;

194 
≠
->
¥e_h™dÀr
 = 
aggr_¥e_uh™dÀr
;

195 
≠
->
Áu…_h™dÀr
 = 
aggr_Áu…_uh™dÀr
;

197 i‡(
p
->
po°_h™dÀr
) {

198 
≠
->
po°_h™dÀr
 = 
aggr_po°_uh™dÀr
;

201 i‡(
p
->
bªak_h™dÀr
) {

202 
≠
->
bªak_h™dÀr
 = 
aggr_bªak_uh™dÀr
;

205 
	`INIT_LIST_HEAD
(&
≠
->
li°
);

206 
	`li°_add_rcu
(&
p
->
li°
, &
≠
->list);

208 
	`hli°_ª∂a˚_rcu
(&
p
->
hli°
, &
≠
->hlist);

209 
	}
}

215 
	$ªgi°î_aggr_u¥obe
(
k¥obe
 *
ﬁd_p
, k¥obê*
p
)

217 
ªt
 = 0;

218 
k¥obe
 *
≠
;

220 i‡(
ﬁd_p
->
¥e_h™dÀr
 =
aggr_¥e_uh™dÀr
) {

221 
	`c›y_u¥obe
(
ﬁd_p
, 
p
);

222 
ªt
 = 
	`add_√w_u¥obe
(
ﬁd_p
, 
p
);

224 
u¥obe
 *
u≠
 = 
	`kzÆloc
((*u≠), 
GFP_KERNEL
);

225 i‡(!
u≠
) {

226  -
ENOMEM
;

229 
u≠
->
èsk
 = 
	`kp2up
(
p
)->task;

230 
≠
 = 
	`up2kp
(
u≠
);

231 
	`add_aggr_u¥obe
(
≠
, 
ﬁd_p
);

232 
	`c›y_u¥obe
(
≠
, 
p
);

233 
ªt
 = 
	`add_√w_u¥obe
(
≠
, 
p
);

236  
ªt
;

237 
	}
}

239 
	$¨m_u¥obe
(
u¥obe
 *
p
)

241 
k¥obe_›code_t
 
ö¢
 = 
BREAKPOINT_INSTRUCTION
;

242 
ªt
 = 
	`wrôe_¥oc_vm_©omic
(
p
->
èsk
, (Ì->
kp
.
addr
,

243 &
ö¢
, (insn));

244 i‡(!
ªt
) {

245 
	`∑nic
("arm_uprobe: failedÅo write memory "

246 "tgid=%uáddr=%p!\n", 
p
->
èsk
->
tgid
,Ö->
kp
.
addr
);

248 
	}
}

250 
	$dißrm_u¥obe
(
k¥obe
 *
p
, 
èsk_°ru˘
 *
èsk
)

252 
ªt
 = 
	`wrôe_¥oc_vm_©omic
(
èsk
, ()
p
->
addr
,

253 &
p
->
›code
, (p->opcode));

254 i‡(!
ªt
) {

255 
	`∑nic
("disarm_uprobe: failedÅo write memory "

256 "tgid=%u,áddr=%p!\n", 
èsk
->
tgid
, 
p
->
addr
);

258 
	}
}

259 
EXPORT_SYMBOL_GPL
(
dißrm_u¥obe
);

261 
	$öô_u¥obes_ö¢_¶Ÿs
()

263 
i
;

264 
i
 = 0; i < 
UPROBE_TABLE_SIZE
; ++i) {

265 
	`INIT_HLIST_HEAD
(&
u¥obe_ö¢_¶Ÿ_èbÀ
[
i
]);

267 
	}
}

269 
	$öô_u¥obe_èbÀ
()

271 
i
;

272 
i
 = 0; i < 
UPROBE_TABLE_SIZE
; ++i) {

273 
	`INIT_HLIST_HEAD
(&
u¥obe_èbÀ
[
i
]);

275 
	}
}

277 
	$öô_uªçrobe_ö°_èbÀ
()

279 
i
;

280 
i
 = 0; i < 
UPROBE_TABLE_SIZE
; ++i) {

281 
	`INIT_HLIST_HEAD
 (&
uªçrobe_ö°_èbÀ
[
i
]);

283 
	}
}

285 
k¥obe
 *
	$gë_uk¥obe
(*
addr
, 
pid_t
 
tgid
)

287 
hli°_hód
 *
hód
;

288 
k¥obe
 *
p
;

289 
	`DECLARE_NODE_PTR_FOR_HLIST
(
node
);

291 
hód
 = &
u¥obe_èbÀ
[
	`hash_±r
(
addr
, 
UPROBE_HASH_BITS
)];

292 
	`sw≠_hli°_f‹_óch_íåy_rcu
(
p
, 
node
, 
hód
, 
hli°
) {

293 i‡(
p
->
addr
 =add∏&& 
	`kp2up
’)->
èsk
->
tgid
 ==Ågid) {

294  
p
;

298  
NULL
;

299 
	}
}

301 
	$add_u¥obe_èbÀ
(
k¥obe
 *
p
)

303 
	`INIT_HLIST_NODE
(&
p
->
is_hli°
);

304 
	`hli°_add_hód_rcu
(&
p
->
is_hli°
, &
u¥obe_ö¢_¶Ÿ_èbÀ
[
	`hash_±r
’->
aö¢
.
ö¢
, 
UPROBE_HASH_BITS
)]);

305 
	}
}

307 
k¥obe
 *
	$gë_uk¥obe_by_ö¢_¶Ÿ
(*
addr
, 
pid_t
 
tgid
, 
±_ªgs
 *
ªgs
)

309 
hli°_hód
 *
hód
;

310 
k¥obe
 *
p
;

311 
	`DECLARE_NODE_PTR_FOR_HLIST
(
node
);

314 
hód
 = &
u¥obe_ö¢_¶Ÿ_èbÀ
[
	`hash_±r
(
addr
, 
UPROBE_HASH_BITS
)];

315 
	`sw≠_hli°_f‹_óch_íåy_rcu
(
p
, 
node
, 
hód
, 
is_hli°
) {

316 i‡(
p
->
aö¢
.
ö¢
 =
addr
 && 
	`kp2up
’)->
èsk
->
tgid
 ==Ågid) {

317  
p
;

321  
NULL
;

322 
	}
}

325 
	$ªmove_u¥obe
(
u¥obe
 *
up
)

327 
k¥obe
 *
p
 = 
	`up2kp
(
up
);

329 
	`‰ì_ö¢_¶Ÿ
(
up
->
sm
, 
p
->
aö¢
.
ö¢
);

330 
	}
}

332 
hli°_hód
 *
	$uªçrobe_ö°_èbÀ_hód
(*
hash_key
)

334  &
uªçrobe_ö°_èbÀ
[
	`hash_±r
 (
hash_key
, 
UPROBE_HASH_BITS
)];

335 
	}
}

338 
	$add_uΩ_ö°
(
uªçrobe_ö°™˚
 *
ri
)

344 
	`hli°_dñ
(&
ri
->
uÊi°
);

347 
	`INIT_HLIST_NODE
(&
ri
->
hli°
);

348 
	`hli°_add_hód
(&
ri
->
hli°
, 
	`uªçrobe_ö°_èbÀ_hód
‘i->
èsk
->
mm
));

351 
	`INIT_HLIST_NODE
(&
ri
->
uÊi°
);

352 
	`hli°_add_hód
(&
ri
->
uÊi°
, &ri->
Ω
->
u£d_ö°™˚s
);

353 
	}
}

356 
	$ªcy˛e_uΩ_ö°
(
uªçrobe_ö°™˚
 *
ri
)

358 i‡(
ri
->
Ω
) {

359 
	`hli°_dñ
(&
ri
->
hli°
);

361 
	`hli°_dñ
(&
ri
->
uÊi°
);

363 
	`INIT_HLIST_NODE
(&
ri
->
uÊi°
);

364 
	`hli°_add_hód
(&
ri
->
uÊi°
, &ri->
Ω
->
‰ì_ö°™˚s
);

366 
	}
}

369 
uªçrobe_ö°™˚
 *
	$gë_u£d_uΩ_ö°
(
uªçrobe
 *
Ω
)

371 
uªçrobe_ö°™˚
 *
ri
;

372 
	`DECLARE_NODE_PTR_FOR_HLIST
(
node
);

374 
	`sw≠_hli°_f‹_óch_íåy
(
ri
, 
node
, &
Ω
->
u£d_ö°™˚s
, 
uÊi°
) {

375  
ri
;

378  
NULL
;

379 
	}
}

382 
uªçrobe_ö°™˚
 *
	$gë_‰ì_uΩ_ö°_no_Æloc
(
uªçrobe
 *
Ω
)

384 
uªçrobe_ö°™˚
 *
ri
;

385 
	`DECLARE_NODE_PTR_FOR_HLIST
(
node
);

387 
	`sw≠_hli°_f‹_óch_íåy
(
ri
, 
node
, &
Ω
->
‰ì_ö°™˚s
, 
uÊi°
) {

388  
ri
;

391  
NULL
;

392 
	}
}

395 
	$‰ì_uΩ_ö°
(
uªçrobe
 *
Ω
)

397 
uªçrobe_ö°™˚
 *
ri
;

398 (
ri
 = 
	`gë_‰ì_uΩ_ö°_no_Æloc
(
Ω
)Ë!
NULL
) {

399 
	`hli°_dñ
(&
ri
->
uÊi°
);

400 
	`k‰ì
(
ri
);

402 
	}
}

404 
	#COMMON_URP_NR
 10

	)

406 
	$Æloc_nodes_uªçrobe
(
uªçrobe
 *
Ω
)

408 
Æloc_nodes
;

409 
uªçrobe_ö°™˚
 *
ö°
;

410 
i
;

413 
Ω
->
maxa˘ive
 +
	`max
(
COMMON_URP_NR
, 2 * 
NR_CPUS
);

415 
Ω
->
maxa˝±ive
 +
NR_CPUS
;

417 
Æloc_nodes
 = 
COMMON_URP_NR
;

419 
i
 = 0; i < 
Æloc_nodes
; ++i) {

420 
ö°
 = 
	`kmÆloc
((*ö°), 
GFP_ATOMIC
);

421 i‡(
ö°
 =
NULL
) {

422 
	`‰ì_uΩ_ö°
(
Ω
);

423  -
ENOMEM
;

425 
	`INIT_HLIST_NODE
(&
ö°
->
uÊi°
);

426 
	`hli°_add_hód
(&
ö°
->
uÊi°
, &
Ω
->
‰ì_ö°™˚s
);

430 
	}
}

433 
uªçrobe_ö°™˚
 *
	$gë_‰ì_uΩ_ö°
(
uªçrobe
 *
Ω
)

435 
uªçrobe_ö°™˚
 *
ri
;

436 
	`DECLARE_NODE_PTR_FOR_HLIST
(
node
);

438 
	`sw≠_hli°_f‹_óch_íåy
(
ri
, 
node
, &
Ω
->
‰ì_ö°™˚s
, 
uÊi°
) {

439  
ri
;

442 i‡(!
	`Æloc_nodes_uªçrobe
(
Ω
)) {

443 
	`sw≠_hli°_f‹_óch_íåy
(
ri
, 
node
, &
Ω
->
‰ì_ö°™˚s
, 
uÊi°
) {

444  
ri
;

448  
NULL
;

449 
	}
}

452 
	$dbi_ªgi°î_u¥obe
(
u¥obe
 *
up
)

454 
ªt
 = 0;

455 
k¥obe
 *
p
, *
ﬁd_p
;

457 
p
 = &
up
->
kp
;

458 i‡(!
p
->
addr
) {

459  -
EINVAL
;

462 
	`DBPRINTF
("p->add∏0x%∞∞0x%p\n", 
p
->
addr
,Ö);

465 #i‡
	`deföed
(
CONFIG_ARM
)

467 i‡((Ë
p
->
addr
 & 0x01) {

468 
p
->
addr
 = (
k¥obe_›code_t
 *)(()p->addr & 0xfffffffe);

472 
p
->
aö¢
.
ö¢
 = 
NULL
;

473 
p
->
mod_ªfcou¡ed
 = 0;

474 
p
->
nmis£d
 = 0;

475 
	`INIT_LIST_HEAD
(&
p
->
li°
);

476 #ifde‡
KPROBES_PROFILE


477 
p
->
°¨t_tm
.
tv_£c
 =Ö->°¨t_tm.
tv_u£c
 = 0;

478 
p
->
hnd_tm_sum
.
tv_£c
 =Ö->hnd_tm_sum.
tv_u£c
 = 0;

479 
p
->
cou¡
 = 0;

483 
ﬁd_p
 = 
	`gë_uk¥obe
(
p
->
addr
, 
	`kp2up
’)->
èsk
->
tgid
);

484 i‡(
ﬁd_p
) {

485 #ifde‡
CONFIG_ARM


486 
p
->
ß„_¨m
 = 
ﬁd_p
->safe_arm;

487 
p
->
ß„_thumb
 = 
ﬁd_p
->safe_thumb;

489 
ªt
 = 
	`ªgi°î_aggr_u¥obe
(
ﬁd_p
, 
p
);

490 
	`DBPRINTF
("gŸÿout\n", 
ªt
);

491 
out
;

494 
ªt
 = 
	`¨ch_¥ï¨e_u¥obe
(
up
);

495 i‡(
ªt
) {

496 
	`DBPRINTF
("gŸÿout\n", 
ªt
);

497 
out
;

500 
	`DBPRINTF
 ("bef‹êouàªà0x%x\n", 
ªt
);

503 
	`INIT_HLIST_NODE
(&
p
->
hli°
);

504 
	`hli°_add_hód_rcu
(&
p
->
hli°
, &
u¥obe_èbÀ
[
	`hash_±r
’->
addr
, 
UPROBE_HASH_BITS
)]);

505 
	`¨m_u¥obe
(
up
);

507 
out
:

508 
	`DBPRINTF
("ouàªà0x%x\n", 
ªt
);

509  
ªt
;

510 
	}
}

512 
	$__dbi_uƒegi°î_u¥obe
(
u¥obe
 *
up
, 
dißrm
)

514 
k¥obe
 *
p
, *
ﬁd_p
, *
li°_p
;

515 
˛ónup_p
;

517 
p
 = &
up
->
kp
;

518 
ﬁd_p
 = 
	`gë_uk¥obe
(
p
->
addr
, 
	`kp2up
’)->
èsk
->
tgid
);

519 i‡(
	`u∆ikñy
(!
ﬁd_p
)) {

523 i‡(
p
 !
ﬁd_p
) {

524 
	`li°_f‹_óch_íåy_rcu
(
li°_p
, &
ﬁd_p
->
li°
,Üist) {

525 i‡(
li°_p
 =
p
) {

527 
vÆid_p
;

534 
vÆid_p
:

535 i‡((
ﬁd_p
 =
p
Ë|| ((ﬁd_p->
¥e_h™dÀr
 =
aggr_¥e_uh™dÀr
) &&

536 (
p
->
li°
.
√xt
 =&
ﬁd_p
->li°Ë&& (p->li°.
¥ev
 == &old_p->list))) {

538 i‡(
dißrm
)

539 
	`dißrm_u¥obe
(&
up
->
kp
, up->
èsk
);

541 
	`hli°_dñ_rcu
(&
ﬁd_p
->
hli°
);

542 
˛ónup_p
 = 1;

544 
	`li°_dñ_rcu
(&
p
->
li°
);

545 
˛ónup_p
 = 0;

548 i‡(
˛ónup_p
) {

549 i‡(
p
 !
ﬁd_p
) {

550 
	`li°_dñ_rcu
(&
p
->
li°
);

551 
	`k‰ì
(
ﬁd_p
);

554 i‡(!
	`ö_©omic
()) {

555 
	`synchr⁄ize_sched
();

558 
	`ªmove_u¥obe
(
up
);

560 i‡(
p
->
bªak_h™dÀr
) {

561 
ﬁd_p
->
bªak_h™dÀr
 = 
NULL
;

564 i‡(
p
->
po°_h™dÀr
) {

565 
	`li°_f‹_óch_íåy_rcu
 (
li°_p
, &
ﬁd_p
->
li°
,Üist) {

566 i‡(
li°_p
->
po°_h™dÀr
) {

567 
˛ónup_p
 = 2;

572 i‡(
˛ónup_p
 == 0) {

573 
ﬁd_p
->
po°_h™dÀr
 = 
NULL
;

577 
	}
}

578 
EXPORT_SYMBOL_GPL
(
__dbi_uƒegi°î_u¥obe
);

580 
	$dbi_uƒegi°î_u¥obe
(
u¥obe
 *
up
)

582 
	`__dbi_uƒegi°î_u¥obe
(
up
, 1);

583 
	}
}

585 
	$dbi_ªgi°î_uj¥obe
(
uj¥obe
 *
jp
)

587 
ªt
 = 0;

590 
jp
->
up
.
kp
.
¥e_h™dÀr
 = 
£tjmp_u¥e_h™dÀr
;

591 
jp
->
up
.
kp
.
bªak_h™dÀr
 = 
l⁄gjmp_bªak_uh™dÀr
;

593 
ªt
 = 
	`dbi_ªgi°î_u¥obe
(&
jp
->
up
);

595  
ªt
;

596 
	}
}

598 
	$__dbi_uƒegi°î_uj¥obe
(
uj¥obe
 *
jp
, 
dißrm
)

600 
	`__dbi_uƒegi°î_u¥obe
(&
jp
->
up
, 
dißrm
);

608 i‡(!(
	`hli°_unhashed
(&
jp
->
up
.
kp
.
is_hli°
))) {

609 
	`hli°_dñ_rcu
(&
jp
->
up
.
kp
.
is_hli°
);

611 
	}
}

612 
EXPORT_SYMBOL_GPL
(
__dbi_uƒegi°î_uj¥obe
);

614 
	$dbi_uƒegi°î_uj¥obe
(
uj¥obe
 *
jp
)

616 
	`__dbi_uƒegi°î_uj¥obe
(
jp
, 1);

617 
	}
}

619 
	$åampﬁöe_u¥obe_h™dÀr
(
k¥obe
 *
p
, 
±_ªgs
 *
ªgs
)

621 
uªçrobe_ö°™˚
 *
ri
 = 
NULL
;

622 
hli°_hód
 *
hód
;

623 
Êags
, 
åamp_addr
, 
‹ig_ªt_addr
 = 0;

624 
hli°_node
 *
tmp
;

625 
	`DECLARE_NODE_PTR_FOR_HLIST
(
node
);

627 
åamp_addr
 = 
	`¨ch_gë_åampﬁöe_addr
(
p
, 
ªgs
);

628 
	`•ö_lock_úqßve
(&
uªçrobe_lock
, 
Êags
);

630 
hód
 = 
	`uªçrobe_ö°_èbÀ_hód
(
cuºít
->
mm
);

645 
	`sw≠_hli°_f‹_óch_íåy_ß„
(
ri
, 
node
, 
tmp
, 
hód
, 
hli°
) {

646 i‡(
ri
->
èsk
 !
cuºít
) {

651 i‡(
ri
->
Ω
 &&Ñi->Ω->
h™dÀr
) {

652 
ri
->
Ω
->
	`h™dÀr
‘i, 
ªgs
);

655 
‹ig_ªt_addr
 = ()
ri
->
ªt_addr
;

656 
	`ªcy˛e_uΩ_ö°
(
ri
);

658 i‡(
‹ig_ªt_addr
 !
åamp_addr
) {

668 
	`•ö_u∆ock_úqª°‹e
(&
uªçrobe_lock
, 
Êags
);

669 
	`¨ch_£t_‹ig_ªt_addr
(
‹ig_ªt_addr
, 
ªgs
);

672 
	}
}

674 
	$¥e_h™dÀr_uªçrobe
(
k¥obe
 *
p
, 
±_ªgs
 *
ªgs
)

676 
u¥obe
 *
up
 = 
	`c⁄èöî_of
(
p
, u¥obe, 
kp
);

677 
uªçrobe
 *
Ω
 = 
	`c⁄èöî_of
(
up
, uretprobe, up);

678 #ifde‡
CONFIG_ARM


679 
n‹ë
 = 
	`thumb_mode
(
ªgs
Ë? 
Ω
->
thumb_n‹ë
 :Ñp->
¨m_n‹ë
;

681 
uªçrobe_ö°™˚
 *
ri
;

682 
Êags
;

684 #ifde‡
CONFIG_ARM


685 i‡(
n‹ë
)

690 
	`•ö_lock_úqßve
(&
uªçrobe_lock
, 
Êags
);

693 i‡((
ri
 = 
	`gë_‰ì_uΩ_ö°
(
Ω
)Ë!
NULL
) {

694 
ri
->
Ω
 =Ñp;

695 
ri
->
èsk
 = 
cuºít
;

697 i‡(
Ω
->
íåy_h™dÀr
)

698 
Ω
->
	`íåy_h™dÀr
(
ri
, 
ªgs
);

700 
	`¨ch_¥ï¨e_uªçrobe
(
ri
, 
ªgs
);

702 
	`add_uΩ_ö°
(
ri
);

704 ++
Ω
->
nmis£d
;

707 
	`•ö_u∆ock_úqª°‹e
(&
uªçrobe_lock
, 
Êags
);

710 
	}
}

712 
	$dbi_ªgi°î_uªçrobe
(
uªçrobe
 *
Ω
)

714 
i
, 
ªt
 = 0;

715 
uªçrobe_ö°™˚
 *
ö°
;

717 
	`DBPRINTF
 ("START\n");

719 
Ω
->
up
.
kp
.
¥e_h™dÀr
 = 
¥e_h™dÀr_uªçrobe
;

720 
Ω
->
up
.
kp
.
po°_h™dÀr
 = 
NULL
;

721 
Ω
->
up
.
kp
.
Áu…_h™dÀr
 = 
NULL
;

722 
Ω
->
up
.
kp
.
bªak_h™dÀr
 = 
NULL
;

725 i‡(
Ω
->
maxa˘ive
 <= 0) {

727 
Ω
->
maxa˘ive
 = 
	`max
(10, 2 * 
NR_CPUS
);

729 
Ω
->
maxa˘ive
 = 
NR_CPUS
;

733 
	`INIT_HLIST_HEAD
(&
Ω
->
u£d_ö°™˚s
);

734 
	`INIT_HLIST_HEAD
(&
Ω
->
‰ì_ö°™˚s
);

736 
i
 = 0; i < 
Ω
->
maxa˘ive
; i++) {

737 
ö°
 = 
	`kmÆloc
((*ö°), 
GFP_ATOMIC
);

738 i‡(
ö°
 =
NULL
) {

739 
	`‰ì_uΩ_ö°
(
Ω
);

740  -
ENOMEM
;

743 
	`INIT_HLIST_NODE
(&
ö°
->
uÊi°
);

744 
	`hli°_add_hód
(&
ö°
->
uÊi°
, &
Ω
->
‰ì_ö°™˚s
);

747 
Ω
->
nmis£d
 = 0;

750 
ªt
 = 
	`dbi_ªgi°î_u¥obe
(&
Ω
->
up
);

751 i‡(
ªt
)

752  
ªt
;

754 
	`¨ch_›code_™Æysis_uªçrobe
(
Ω
);

757 
	}
}

760 
	$dbi_dißrm_uΩ_ö°_f‹_èsk
(
èsk_°ru˘
 *
∑ª¡
, èsk_°ru˘ *
èsk
)

762 
uªçrobe_ö°™˚
 *
ri
;

763 
hli°_hód
 *
hód
 = 
	`uªçrobe_ö°_èbÀ_hód
(
∑ª¡
->
mm
);

764 
hli°_node
 *
tmp
;

765 
	`DECLARE_NODE_PTR_FOR_HLIST
(
node
);

767 
	`sw≠_hli°_f‹_óch_íåy_ß„
(
ri
, 
node
, 
tmp
, 
hód
, 
hli°
) {

768 i‡(
∑ª¡
 =
ri
->
èsk
) {

769 
	`¨ch_dißrm_uΩ_ö°
(
ri
, 
èsk
);

774 
	}
}

775 
EXPORT_SYMBOL_GPL
(
dbi_dißrm_uΩ_ö°_f‹_èsk
);

777 
	$__dbi_uƒegi°î_uªçrobe
(
uªçrobe
 *
Ω
, 
dißrm
)

779 
Êags
;

780 
uªçrobe_ö°™˚
 *
ri
;

782 
	`__dbi_uƒegi°î_u¥obe
(&
Ω
->
up
, 
dißrm
);

783 
	`•ö_lock_úqßve
 (&
uªçrobe_lock
, 
Êags
);

785 (
ri
 = 
	`gë_u£d_uΩ_ö°
(
Ω
)Ë!
NULL
) {

786 i‡(
	`¨ch_dißrm_uΩ_ö°
(
ri
,Ñi->
èsk
) != 0)

787 
	`¥ötk
("%s (%d/%d): cannot disarm urp instance (%08lx)\n",

788 
ri
->
èsk
->
comm
,Ñi->èsk->
tgid
,Ñi->èsk->
pid
,

789 ()
Ω
->
up
.
kp
.
addr
);

790 
	`ªcy˛e_uΩ_ö°
(
ri
);

793 i‡(
	`hli°_em±y
(&
Ω
->
u£d_ö°™˚s
)) {

794 
k¥obe
 *
p
 = &
Ω
->
up
.
kp
;

796 i‡(!(
	`hli°_unhashed
(&
p
->
is_hli°
))) {

797 
	`hli°_dñ_rcu
(&
p
->
is_hli°
);

801 (
ri
 = 
	`gë_u£d_uΩ_ö°
(
Ω
)Ë!
NULL
) {

802 
ri
->
Ω
 = 
NULL
;

803 
	`hli°_dñ
(&
ri
->
uÊi°
);

806 
	`•ö_u∆ock_úqª°‹e
(&
uªçrobe_lock
, 
Êags
);

807 
	`‰ì_uΩ_ö°
(
Ω
);

808 
	}
}

809 
EXPORT_SYMBOL_GPL
(
__dbi_uƒegi°î_uªçrobe
);

811 
	$dbi_uƒegi°î_uªçrobe
(
uªçrobe
 *
Ω
)

813 
	`__dbi_uƒegi°î_uªçrobe
(
Ω
, 1);

814 
	}
}

816 
	$dbi_uƒegi°î_Æl_u¥obes
(
èsk_°ru˘
 *
èsk
)

818 
hli°_hód
 *
hód
;

819 
k¥obe
 *
p
;

820 
i
;

821 
hli°_node
 *
äode
;

822 
	`DECLARE_NODE_PTR_FOR_HLIST
(
node
);

824 
i
 = 0; i < 
UPROBE_TABLE_SIZE
; ++i) {

825 
hód
 = &
u¥obe_èbÀ
[
i
];

826 
	`sw≠_hli°_f‹_óch_íåy_ß„
(
p
, 
node
, 
äode
, 
hód
, 
hli°
) {

827 i‡(
	`kp2up
(
p
)->
èsk
->
tgid
 ==Åask->tgid) {

828 
u¥obe
 *
up
 = 
	`c⁄èöî_of
(
p
, u¥obe, 
kp
);

829 
	`¥ötk
("dbi_unregister_all_uprobes: delete uprobeát %p[%lx] for %s/%d\n",

830 
p
->
addr
, (Ì->
›code
, 
èsk
->
comm
,Åask->
pid
);

831 
	`dbi_uƒegi°î_u¥obe
(
up
);

835 
	}
}

837 
	$sw≠_uj¥obe_ªtu∫
()

839 
	`¨ch_uj¥obe_ªtu∫
();

840 
	}
}

841 
EXPORT_SYMBOL_GPL
(
sw≠_uj¥obe_ªtu∫
);

843 
__öô
 
	$öô_u¥obes
()

845 
	`öô_u¥obe_èbÀ
();

846 
	`öô_u¥obes_ö¢_¶Ÿs
();

847 
	`öô_uªçrobe_ö°_èbÀ
();

849  
	`sw≠_¨ch_öô_u¥obes
();

850 
	}
}

852 
__exô
 
	$exô_u¥obes
()

854 
	`sw≠_¨ch_exô_u¥obes
();

855 
	}
}

857 
EXPORT_SYMBOL_GPL
(
dbi_ªgi°î_uj¥obe
);

858 
EXPORT_SYMBOL_GPL
(
dbi_uƒegi°î_uj¥obe
);

859 
EXPORT_SYMBOL_GPL
(
dbi_ªgi°î_uªçrobe
);

860 
EXPORT_SYMBOL_GPL
(
dbi_uƒegi°î_uªçrobe
);

861 
EXPORT_SYMBOL_GPL
(
dbi_uƒegi°î_Æl_u¥obes
);

863 
moduÀ_öô
(
öô_u¥obes
);

864 
moduÀ_exô
(
exô_u¥obes
);

866 
MODULE_LICENSE
 ("GPL");

	@uprobe/swap_uprobes.h

1 #i‚de‡
_DBI_UPROBES_H


2 
	#_DBI_UPROBES_H


	)

30 
	~<k¥obe/dbi_k¥obes.h
>

31 
	~<u¥obe/¨ch/asm/sw≠_u¥obes.h
>

34 
	su¥obe
 {

35 
k¥obe
 
	mkp
;

36 
èsk_°ru˘
 *
	mèsk
;

37 
¶Ÿ_m™agî
 *
	msm
;

38 
¨ch_•ecific_åamp
 
	m©ømp
;

41 (*
	tu¥obe_¥e_íåy_h™dÀr_t
)(*
	t¥iv_¨g
, 
	t±_ªgs
 * 
	tªgs
);

43 
	suj¥obe
 {

44 
u¥obe
 
up
;

46 *
íåy
;

48 
u¥obe_¥e_íåy_h™dÀr_t
 
¥e_íåy
;

49 *
¥iv_¨g
;

50 *
¨gs
;

53 
uªçrobe_ö°™˚
;

55 (*
	tuªçrobe_h™dÀr_t
)(
	tuªçrobe_ö°™˚
 *, 
	t±_ªgs
 *);

67 
	suªçrobe
 {

68 
u¥obe
 
up
;

69 
uªçrobe_h™dÀr_t
 
h™dÀr
;

70 
uªçrobe_h™dÀr_t
 
íåy_h™dÀr
;

71 
maxa˘ive
;

72 
nmis£d
;

73 
hli°_hód
 
‰ì_ö°™˚s
;

74 
hli°_hód
 
u£d_ö°™˚s
;

76 #ifde‡
CONFIG_ARM


78 
¨m_n‹ë
:1;

79 
thumb_n‹ë
:1;

83 
	suªçrobe_ö°™˚
 {

85 
hli°_node
 
uÊi°
;

86 
hli°_node
 
hli°
;

87 
uªçrobe
 *
Ω
;

88 
k¥obe_›code_t
 *
ªt_addr
;

89 
k¥obe_›code_t
 *
•
;

90 
èsk_°ru˘
 *
èsk
;

93 
	`dbi_ªgi°î_u¥obe
(
u¥obe
 *
p
);

94 
	`dbi_uƒegi°î_u¥obe
(
u¥obe
 *
p
);

95 
	`__dbi_uƒegi°î_u¥obe
(
u¥obe
 *
up
, 
dißrm
);

97 
	`dbi_ªgi°î_uj¥obe
(
uj¥obe
 *
jp
);

98 
	`dbi_uƒegi°î_uj¥obe
(
uj¥obe
 *
jp
);

99 
	`__dbi_uƒegi°î_uj¥obe
(
uj¥obe
 *
jp
, 
dißrm
);

101 
	`dbi_ªgi°î_uªçrobe
(
uªçrobe
 *
Ω
);

102 
	`dbi_uƒegi°î_uªçrobe
(
uªçrobe
 *
Ω
);

103 
	`__dbi_uƒegi°î_uªçrobe
(
uªçrobe
 *
Ω
, 
dißrm
);

105 
	`dbi_uƒegi°î_Æl_u¥obes
(
èsk_°ru˘
 *
èsk
);

107 
	`sw≠_uj¥obe_ªtu∫
();

108 
k¥obe
 *
	`gë_uk¥obe
(*
addr
, 
pid_t
 
tgid
);

109 
k¥obe
 *
	`gë_uk¥obe_by_ö¢_¶Ÿ
(*
addr
, 
pid_t
 
tgid
, 
±_ªgs
 *
ªgs
);

111 
ölöe
 
u¥obe
 *
	$kp2up
(
k¥obe
 *
p
)

113  
	`c⁄èöî_of
(
p
, 
u¥obe
, 
kp
);

114 
	}
}

116 
ölöe
 
k¥obe
 *
	$up2kp
(
u¥obe
 *
p
)

118  &
p
->
kp
;

119 
	}
}

121 
dißrm_u¥obe
(
k¥obe
 *
p
, 
èsk_°ru˘
 *
èsk
);

123 
åampﬁöe_u¥obe_h™dÀr
(
k¥obe
 *
p
, 
±_ªgs
 *
ªgs
);

125 
add_u¥obe_èbÀ
(
k¥obe
 *
p
);

	@us_manager/debugfs_us_manager.c

1 
	~<löux/debugfs.h
>

2 
	~<löux/moduÀ.h
>

4 
	~<drivî/sw≠_debugfs.h
>

5 
	~<us_m™agî/s•t/s•t_¥oc.h
>

7 
	~"debugfs_us_m™agî.h
"

9 
	#MAX_APPS_COUNT
 8

	)

10 
	#PID_STRING
 21

	)

18 
	sªad_buf
 {

19 *
	mbegö
;

20 *
	m±r
;

21 *
	míd
;

24 
	$⁄_óch_¥oc_ˇŒback
(
s•t_¥oc
 *
¥oc
, *
d©a
)

26 
ªad_buf
 *
rbuf
 = (ªad_bu‡*)
d©a
;

27 
pid_°r
[
PID_STRING
];

28 
Àn
;

30 
	`•rötf
(
pid_°r
, "%d", 
¥oc
->
tgid
);

32 
Àn
 = 
	`°æí
(
pid_°r
);

34 i‡(
rbuf
->
íd
 -Ñbuf->
±r
 < 
Àn
 + 2)

37 i‡(
rbuf
->
±r
 !rbuf->
begö
) {

38 *
rbuf
->
±r
 = ' ';

39 ++
rbuf
->
±r
;

42 
	`mem˝y
(
rbuf
->
±r
, 
pid_°r
, 
Àn
);

43 
rbuf
->
±r
 +
Àn
;

44 
	}
}

46 
ssize_t
 
	$ªad_èsks
(
fûe
 *fûe, 
__u£r
 *
u£r_buf
,

47 
size_t
 
cou¡
, 
loff_t
 *
µos
)

49 
buf
[
PID_STRING
 * 
MAX_APPS_COUNT
];

50 
ªad_buf
 
rbuf
 = {

51 .
begö
 = 
buf
,

52 .
±r
 = 
buf
,

53 .
íd
 = 
buf
 + (buf)

56 
	`⁄_óch_¥oc_no_lock
(
⁄_óch_¥oc_ˇŒback
, (*)&
rbuf
);

58 i‡(
rbuf
.
±r
 <Ñbuf.
íd
)

59 ++
rbuf
.
±r
;

60 *
rbuf
.
±r
 = '\n';

62  
	`sim∂e_ªad_‰om_buf„r
(
u£r_buf
, 
cou¡
, 
µos
, 
rbuf
.
begö
,

63 
rbuf
.
±r
 -Ñbuf.
begö
);

64 
	}
}

66 c⁄° 
fûe_›î©i⁄s
 
	gf›s_èsks
 = {

67 .
ow√r
 = 
THIS_MODULE
,

68 .
	gªad
 = 
ªad_èsks


76 
díåy
 *
	gus_m™agî_dú
 = 
NULL
;

78 
	$exô_debugfs_us_m™agî
()

80 i‡(
us_m™agî_dú
)

81 
	`debugfs_ªmove_ªcursive
(
us_m™agî_dú
);

83 
us_m™agî_dú
 = 
NULL
;

84 
	}
}

86 
	$öô_debugfs_us_m™agî
()

88 
díåy
 *
sw≠_dú
, *dentry;

90 
sw≠_dú
 = 
	`gë_sw≠_debugfs_dú
();

91 i‡(
sw≠_dú
 =
NULL
)

92  -
ENOENT
;

94 
us_m™agî_dú
 = 
	`debugfs_¸óã_dú
(
US_MANAGER_DFS_DIR
, 
sw≠_dú
);

95 i‡(
us_m™agî_dú
 =
NULL
)

96  -
ENOMEM
;

98 
díåy
 = 
	`debugfs_¸óã_fûe
(
US_MANAGER_TASKS
, 0600, 
us_m™agî_dú
, 
NULL
,

99 &
f›s_èsks
);

100 i‡(
díåy
 =
NULL
)

101 
Áû
;

105 
Áû
:

106 
	`exô_debugfs_us_m™agî
();

107  -
ENOMEM
;

108 
	}
}

	@us_manager/debugfs_us_manager.h

1 #i‚de‡
__DEBUGFS_US_MANAGER_H__


2 
	#__DEBUGFS_US_MANAGER_H__


	)

4 
	#US_MANAGER_DFS_DIR
 "us_m™agî"

	)

5 
	#US_MANAGER_TASKS
 "èsks"

	)

7 
öô_debugfs_us_m™agî
();

8 
exô_debugfs_us_m™agî
();

	@us_manager/helper.c

26 
	~<k¥obe/dbi_k¥obes.h
>

27 
	~<k¥obe/dbi_k¥obes_dïs.h
>

28 
	~<ksyms/ksyms.h
>

29 
	~<wrôî/kî√l_›î©i⁄s.h
>

30 
	~<wrôî/sw≠_wrôî_moduÀ.h
>

31 
	~"us_¶Ÿ_m™agî.h
"

32 
	~"s•t/s•t.h
"

33 
	~"hñ≥r.h
"

35 
	gèsk_°ru˘
;

37 
èsk_°ru˘
 *
check_èsk
(èsk_°ru˘ *
èsk
);

45 
	spf_d©a
 {

46 
	maddr
;

49 
	$íåy_h™dÀr_mf
(
kªçrobe_ö°™˚
 *
ri
, 
±_ªgs
 *
ªgs
)

51 
pf_d©a
 *
d©a
 = (pf_d©®*)
ri
->data;

53 
d©a
->
addr
 = 
	`sw≠_gë_k¨g
(
ªgs
, 2);

56 
	}
}

59 
	$ªt_h™dÀr_mf
(
kªçrobe_ö°™˚
 *
ri
, 
±_ªgs
 *
ªgs
)

61 
èsk_°ru˘
 *
èsk
 = 
cuºít
;

62 
∑ge_addr
;

64 i‡(
	`is_kthªad
(
èsk
))

68 
∑ge_addr
 = ((
pf_d©a
 *)
ri
->
d©a
)->
addr
 & 
PAGE_MASK
;

69 
	`ˇŒ_∑ge_Áu…
(
èsk
, 
∑ge_addr
);

72 
	}
}

74 
kªçrobe
 
	gmf_kªçrobe
 = {

75 .
íåy_h™dÀr
 = 
íåy_h™dÀr_mf
,

76 .
	gh™dÀr
 = 
ªt_h™dÀr_mf
,

77 .
	gd©a_size
 = (
pf_d©a
)

88 
	$ªcovî_chûd
(
èsk_°ru˘
 *
chûd_èsk
, 
s•t_¥oc
 *
¥oc
)

90 
	`s•t_¥oc_unö°Æl
(
¥oc
, 
chûd_èsk
, 
US_DISARM
);

91 
	`dbi_dißrm_uΩ_ö°_f‹_èsk
(
cuºít
, 
chûd_èsk
);

92 
	}
}

94 
	$rm_u¥obes_chûd
(
èsk_°ru˘
 *
èsk
)

96 
s•t_¥oc
 *
¥oc
 = 
	`s•t_¥oc_gë_by_èsk
(
cuºít
);

97 if(
¥oc
) {

98 
	`ªcovî_chûd
(
èsk
, 
¥oc
);

100 
	}
}

103 
	$ªt_h™dÀr_˝
(
kªçrobe_ö°™˚
 *
ri
, 
±_ªgs
 *
ªgs
)

105 
èsk_°ru˘
 *
èsk
 = (èsk_°ru˘ *)
	`ªgs_ªtu∫_vÆue
(
ªgs
);

107 if(!
èsk
 || 
	`IS_ERR
(task))

108 
out
;

110 if(
èsk
->
mm
 !
cuºít
->mm) {

111 
	`rm_u¥obes_chûd
(
èsk
);

113 
out
:

115 
	}
}

117 
kªçrobe
 
	g˝_kªçrobe
 = {

118 .
h™dÀr
 = 
ªt_h™dÀr_˝
,

130 
	$mr_¥e_h™dÀr
(
k¥obe
 *
p
, 
±_ªgs
 *
ªgs
)

132 
èsk_°ru˘
 *
èsk
 = (èsk_°ru˘ *)
	`sw≠_gë_k¨g
(
ªgs
, 0);

134 i‡(
	`is_kthªad
(
èsk
))

135 
out
;

137 i‡(
èsk
->
tgid
 !èsk->
pid
) {

138 
out
;

141 
	`ˇŒ_mm_ªÀa£
(
èsk
);

142 
out
:

144 
	}
}

146 
k¥obe
 
	gmr_k¥obe
 = {

147 .
¥e_h™dÀr
 = 
mr_¥e_h™dÀr


157 
	sunm≠_d©a
 {

158 
	m°¨t
;

159 
size_t
 
	mÀn
;

162 
	$ªmove_unm≠_¥obes
(
s•t_¥oc
 *
¥oc
, 
unm≠_d©a
 *
umd
)

164 
èsk_°ru˘
 *
èsk
 = 
¥oc
->task;

165 
°¨t
 = 
umd
->start;

166 
size_t
 
Àn
 = 
	`PAGE_ALIGN
(
umd
->len);

167 
	`LIST_HEAD
(
hód
);

169 i‡(
	`s•t_¥oc_gë_fûes_by_ªgi⁄
(
¥oc
, &
hód
, 
°¨t
, 
Àn
)) {

170 
s•t_fûe
 *
fûe
, *
n
;

171 
íd
 = 
°¨t
 + 
Àn
;

173 
	`li°_f‹_óch_íåy_ß„
(
fûe
, 
n
, &
hód
, 
li°
) {

174 i‡(
fûe
->
vm_°¨t
 >
íd
)

177 i‡(
fûe
->
vm_°¨t
 >
°¨t
) {

178 
	`s•t_fûe_unö°Æl
(
fûe
, 
èsk
, 
US_UNINSTALL
);

184 
	`s•t_¥oc_ö£π_fûes
(
¥oc
, &
hód
);

186 
	`¥oc_unm≠_msg
(
°¨t
, 
íd
);

188 
	}
}

191 
	$íåy_h™dÀr_unm≠
(
kªçrobe_ö°™˚
 *
ri
,

192 
±_ªgs
 *
ªgs
)

194 
unm≠_d©a
 *
d©a
 = (unm≠_d©®*)
ri
->data;

196 
d©a
->
°¨t
 = 
	`sw≠_gë_k¨g
(
ªgs
, 1);

197 
d©a
->
Àn
 = (
size_t
)
	`sw≠_gë_k¨g
(
ªgs
, 2);

200 
	}
}

202 
	$ªt_h™dÀr_unm≠
(
kªçrobe_ö°™˚
 *
ri
,

203 
±_ªgs
 *
ªgs
)

205 
èsk_°ru˘
 *
èsk
;

206 
s•t_¥oc
 *
¥oc
;

208 
èsk
 = 
cuºít
->
group_Àadî
;

209 i‡(
	`is_kthªad
(
èsk
) ||

210 
	`gë_ªgs_ªt_vÆ
(
ªgs
))

213 
¥oc
 = 
	`s•t_¥oc_gë_by_èsk
(
èsk
);

214 i‡(
¥oc
)

215 
	`ªmove_unm≠_¥obes
(
¥oc
, (
unm≠_d©a
 *)
ri
->
d©a
);

218 
	}
}

220 
kªçrobe
 
	gunm≠_kªçrobe
 = {

221 .
íåy_h™dÀr
 = 
íåy_h™dÀr_unm≠
,

222 .
	gh™dÀr
 = 
ªt_h™dÀr_unm≠
,

223 .
	gd©a_size
 = (
unm≠_d©a
)

233 
	$ªt_h™dÀr_mm≠
(
kªçrobe_ö°™˚
 *
ri
,

234 
±_ªgs
 *
ªgs
)

236 
s•t_¥oc
 *
¥oc
;

237 
èsk_°ru˘
 *
èsk
;

238 
°¨t_addr
;

239 
vm_¨ó_°ru˘
 *
vma
;

241 
èsk
 = 
cuºít
->
group_Àadî
;

242 i‡(
	`is_kthªad
(
èsk
))

245 
°¨t_addr
 = ()
	`gë_ªgs_ªt_vÆ
(
ªgs
);

246 i‡(
	`IS_ERR_VALUE
(
°¨t_addr
))

249 
¥oc
 = 
	`s•t_¥oc_gë_by_èsk
(
èsk
);

250 i‡(
¥oc
 =
NULL
)

253 
vma
 = 
	`föd_vma_öãr£˘i⁄
(
èsk
->
mm
, 
°¨t_addr
, start_addr + 1);

254 i‡(
vma
 && 
	`check_vma
(vma))

255 
	`pcoc_m≠_msg
(
vma
);

258 
	}
}

260 
kªçrobe
 
	gmm≠_kªçrobe
 = {

261 .
h™dÀr
 = 
ªt_h™dÀr_mm≠


266 
	$ªgi°î_hñ≥r
()

268 
ªt
 = 0;

271 
ªt
 = 
	`dbi_ªgi°î_kªçrobe
(&
unm≠_kªçrobe
);

272 i‡(
ªt
) {

273 
	`¥ötk
("dbi_ªgi°î_k¥obe(do_munm≠Ëªsu…=%d!\n", 
ªt
);

274  
ªt
;

278 
ªt
 = 
	`dbi_ªgi°î_k¥obe
(&
mr_k¥obe
);

279 i‡(
ªt
 != 0) {

280 
	`¥ötk
("dbi_ªgi°î_k¥obe(mm_ªÀa£Ëªsu…=%d!\n", 
ªt
);

281 
uƒegi°î_unm≠
;

286 
ªt
 = 
	`dbi_ªgi°î_kªçrobe
(&
˝_kªçrobe
);

287 i‡(
ªt
) {

288 
	`¥ötk
("dbi_ªgi°î_kªçrobe(c›y_¥o˚ssËªsu…=%d!\n", 
ªt
);

289 
uƒegi°î_mr
;

293 
ªt
 = 
	`dbi_ªgi°î_kªçrobe
(&
mm≠_kªçrobe
);

294 i‡(
ªt
) {

295 
	`¥ötk
("dbi_ªgi°î_kªçrobe(do_mm≠_pgoffËªsu…=%d!\n", 
ªt
);

296 
uƒegi°î_˝
;

300 
ªt
 = 
	`dbi_ªgi°î_kªçrobe
(&
mf_kªçrobe
);

301 i‡(
ªt
) {

302 
	`¥ötk
("dbi_ªgi°î_kªçrobe(do_∑ge_Áu…Ëªsu…=%d!\n", 
ªt
);

303 
uƒegi°î_mm≠
;

306  
ªt
;

309 
uƒegi°î_mm≠
:

310 
	`dbi_uƒegi°î_kªçrobe
(&
mm≠_kªçrobe
);

312 
uƒegi°î_˝
:

313 
	`dbi_uƒegi°î_kªçrobe
(&
˝_kªçrobe
);

315 
uƒegi°î_mr
:

316 
	`dbi_uƒegi°î_k¥obe
(&
mr_k¥obe
);

318 
uƒegi°î_unm≠
:

319 
	`dbi_uƒegi°î_kªçrobe
(&
unm≠_kªçrobe
);

321  
ªt
;

322 
	}
}

324 
	$uƒegi°î_hñ≥r
()

327 
	`dbi_uƒegi°î_kªçrobe
(&
mf_kªçrobe
);

330 
	`dbi_uƒegi°î_kªçrobe
(&
mm≠_kªçrobe
);

333 
	`dbi_uƒegi°î_kªçrobe
(&
˝_kªçrobe
);

336 
	`dbi_uƒegi°î_k¥obe
(&
mr_k¥obe
);

339 
	`dbi_uƒegi°î_kªçrobe
(&
unm≠_kªçrobe
);

340 
	}
}

342 
	$öô_hñ≥r
()

344 
addr
;

345 
addr
 = 
	`sw≠_ksyms
("handle_mm_fault");

346 i‡(
addr
 == 0) {

347 
	`¥ötk
("Cannot findáddress for handle_mm_fault function!\n");

348  -
EINVAL
;

350 
mf_kªçrobe
.
kp
.
addr
 = (
k¥obe_›code_t
 *)addr;

352 
addr
 = 
	`sw≠_ksyms_sub°r
("copy_process");

353 i‡(
addr
 == 0) {

354 
	`¥ötk
("Cannot findáddress for copy_process function!\n");

355  -
EINVAL
;

357 
˝_kªçrobe
.
kp
.
addr
 = (
k¥obe_›code_t
 *)addr;

359 
addr
 = 
	`sw≠_ksyms
("mm_release");

360 i‡(
addr
 == 0) {

361 
	`¥ötk
("Cannot findáddress for mm_release function!\n");

362  -
EINVAL
;

364 
mr_k¥obe
.
addr
 = (
k¥obe_›code_t
 *)addr;

366 
addr
 = 
	`sw≠_ksyms
("do_munmap");

367 i‡(
addr
 == 0) {

368 
	`¥ötk
("Cannot findáddress for do_munmap function!\n");

369  -
EINVAL
;

371 
unm≠_kªçrobe
.
kp
.
addr
 = (
k¥obe_›code_t
 *)addr;

373 
addr
 = 
	`sw≠_ksyms
("do_mmap_pgoff");

374 i‡(
addr
 == 0) {

375 
	`¥ötk
("Cannot findáddress for do_mmap_pgoff function!\n");

376  -
EINVAL
;

378 
mm≠_kªçrobe
.
kp
.
addr
 = (
k¥obe_›code_t
 *)addr;

381 
	}
}

383 
	$unöô_hñ≥r
()

385 
	}
}

	@us_manager/helper.h

25 #i‚de‡
_HELPER_H


26 
	#_HELPER_H


	)

28 
	~<löux/sched.h
>

30 
ölöe
 
	$is_kthªad
(
èsk_°ru˘
 *
èsk
)

32  !
èsk
->
mm
;

33 
	}
}

35 
öô_hñ≥r
();

36 
unöô_hñ≥r
();

38 
ªgi°î_hñ≥r
();

39 
uƒegi°î_hñ≥r
();

	@us_manager/img/img_file.c

26 
	~"img_fûe.h
"

27 
	~"img_ù.h
"

28 
	~<löux/¶ab.h
>

29 
	~<löux/dˇche.h
>

31 
img_fûe
 *
	$¸óã_img_fûe
(
díåy
 *dentry)

33 
img_fûe
 *
fûe
;

35 
fûe
 = 
	`kmÆloc
((*fûe), 
GFP_KERNEL
);

36 
fûe
->
díåy
 = dentry;

37 
	`INIT_LIST_HEAD
(&
fûe
->
ù_li°
);

38 
	`INIT_LIST_HEAD
(&
fûe
->
li°
);

40  
fûe
;

41 
	}
}

43 
	$‰ì_img_fûe
(
img_fûe
 *
fûe
)

46 
	}
}

48 
	$img_add_ù_by_li°
(
img_fûe
 *
fûe
, 
img_ù
 *
ù
)

50 
	`li°_add
(&
ù
->
li°
, &
fûe
->
ù_li°
);

51 
	}
}

53 
	$img_dñ_ù_by_li°
(
img_ù
 *
ù
)

55 
	`li°_dñ
(&
ù
->
li°
);

56 
	}
}

58 
img_ù
 *
	$föd_img_ù
(
img_fûe
 *
fûe
, 
addr
)

60 
img_ù
 *
ù
;

62 
	`li°_f‹_óch_íåy
(
ù
, &
fûe
->
ù_li°
, 
li°
) {

63 i‡(
ù
->
addr
 ==áddr)

64  
ù
;

67  
NULL
;

68 
	}
}

70 
	$img_fûe_add_ù
(
img_fûe
 *
fûe
, 
addr
,

71 c⁄° *
¨gs
, 
ªt_ty≥
)

73 
img_ù
 *
ù
;

75 
ù
 = 
	`föd_img_ù
(
fûe
, 
addr
);

76 i‡(
ù
) {

81 
ù
 = 
	`¸óã_img_ù
(
addr
, 
¨gs
, 
ªt_ty≥
);

82 
	`img_add_ù_by_li°
(
fûe
, 
ù
);

85 
	}
}

87 
	$img_fûe_dñ_ù
(
img_fûe
 *
fûe
, 
addr
)

89 
img_ù
 *
ù
;

91 
ù
 = 
	`föd_img_ù
(
fûe
, 
addr
);

92 i‡(
ù
 =
NULL
) {

93 
	`¥ötk
("W¨nög:Çÿù found i¿img,ádd∏%lx\n", 
addr
);

94  -
EINVAL
;

97 
	`img_dñ_ù_by_li°
(
ù
);

100 
	}
}

102 
	$img_fûe_em±y
(
img_fûe
 *
fûe
)

104  
	`li°_em±y
(&
fûe
->
ù_li°
);

105 
	}
}

108 
	$img_fûe_¥öt
(
img_fûe
 *
fûe
)

110 
img_ù
 *
ù
;

112 
	`¥ötk
("### d_öame=%s\n", 
fûe
->
díåy
->
d_öame
);

114 
	`li°_f‹_óch_íåy
(
ù
, &
fûe
->
ù_li°
, 
li°
) {

115 
	`img_ù_¥öt
(
ù
);

117 
	}
}

	@us_manager/img/img_file.h

26 #i‚de‡
_IMG_FILE_H


27 
	#_IMG_FILE_H


	)

29 
	~<löux/ty≥s.h
>

31 
	simg_fûe
 {

32 
li°_hód
 
	mli°
;

33 
díåy
 *
	mdíåy
;

34 
li°_hód
 
	mù_li°
;

37 
img_fûe
 *
¸óã_img_fûe
(
díåy
 *dentry);

38 
‰ì_img_fûe
(
img_fûe
 *
ù
);

40 
img_fûe_add_ù
(
img_fûe
 *
fûe
, 
addr
,

41 c⁄° *
¨gs
, 
ªt_ty≥
);

42 
img_fûe_dñ_ù
(
img_fûe
 *
fûe
, 
addr
);

44 
img_fûe_em±y
(
img_fûe
 *
fûe
);

47 
img_fûe_¥öt
(
img_fûe
 *
fûe
);

	@us_manager/img/img_ip.c

26 
	~"img_ù.h
"

27 
	~<löux/¶ab.h
>

29 
img_ù
 *
	$¸óã_img_ù
(
addr
, c⁄° *
¨gs
,

30 
ªt_ty≥
)

32 
img_ù
 *
ù
;

33 
size_t
 
Àn
;

35 
ù
 = 
	`kmÆloc
((*ù), 
GFP_KERNEL
);

36 
	`INIT_LIST_HEAD
(&
ù
->
li°
);

37 
ù
->
addr
 =áddr;

40 
Àn
 = 
	`°æí
(
¨gs
) + 1;

41 
ù
->
¨gs
 = 
	`kmÆloc
(
Àn
, 
GFP_KERNEL
);

42 
	`mem˝y
(
ù
->
¨gs
,árgs, 
Àn
);

44 
ù
->
ªt_ty≥
 =Ñet_type;

46  
ù
;

47 
	}
}

49 
	$‰ì_img_ù
(
img_ù
 *
ù
)

51 
	`k‰ì
(
ù
->
¨gs
);

52 
	`k‰ì
(
ù
);

53 
	}
}

56 
	$img_ù_¥öt
(
img_ù
 *
ù
)

58 
	`¥ötk
("###áddr=8%lx,árgs=%s\n", 
ù
->
addr
, ip->
¨gs
);

59 
	}
}

	@us_manager/img/img_ip.h

26 #i‚de‡
_IMG_IP_H


27 
	#_IMG_IP_H


	)

29 
	~<löux/ty≥s.h
>

31 
	simg_ù
 {

32 
li°_hód
 
	mli°
;

33 
	maddr
;

34 *
	m¨gs
;

35 
	mªt_ty≥
;

38 
img_ù
 *
¸óã_img_ù
(
addr
, c⁄° *
¨gs
,

39 
ªt_ty≥
);

40 
‰ì_img_ù
(
img_ù
 *
ù
);

43 
img_ù_¥öt
(
img_ù
 *
ù
);

	@us_manager/img/img_proc.c

26 
	~"img_¥oc.h
"

27 
	~"img_fûe.h
"

28 
	~<löux/¶ab.h
>

30 
img_¥oc
 *
	$¸óã_img_¥oc
()

32 
img_¥oc
 *
¥oc
;

34 
¥oc
 = 
	`kmÆloc
((*¥oc), 
GFP_KERNEL
);

35 
	`INIT_LIST_HEAD
(&
¥oc
->
fûe_li°
);

37  
¥oc
;

38 
	}
}

40 
	$‰ì_img_¥oc
(
img_¥oc
 *
ù
)

43 
	}
}

45 
	$img_add_fûe_by_li°
(
img_¥oc
 *
¥oc
, 
img_fûe
 *
fûe
)

47 
	`li°_add
(&
fûe
->
li°
, &
¥oc
->
fûe_li°
);

48 
	}
}

50 
	$img_dñ_fûe_by_li°
(
img_fûe
 *
fûe
)

52 
	`li°_dñ
(&
fûe
->
li°
);

53 
	}
}

55 
img_fûe
 *
	$föd_img_fûe
(
img_¥oc
 *
¥oc
, 
díåy
 *dentry)

57 
img_fûe
 *
fûe
;

59 
	`li°_f‹_óch_íåy
(
fûe
, &
¥oc
->
fûe_li°
, 
li°
) {

60 i‡(
fûe
->
díåy
 == dentry)

61  
fûe
;

64  
NULL
;

65 
	}
}

67 
	$img_¥oc_add_ù
(
img_¥oc
 *
¥oc
, 
díåy
 *dentry,

68 
addr
, c⁄° *
¨gs
, 
ªt_ty≥
)

70 
ªt
;

71 
img_fûe
 *
fûe
;

73 
fûe
 = 
	`föd_img_fûe
(
¥oc
, 
díåy
);

74 i‡(
fûe
)

75  
	`img_fûe_add_ù
(
fûe
, 
addr
, 
¨gs
, 
ªt_ty≥
);

77 
fûe
 = 
	`¸óã_img_fûe
(
díåy
);

79 
ªt
 = 
	`img_fûe_add_ù
(
fûe
, 
addr
, 
¨gs
, 
ªt_ty≥
);

80 i‡(
ªt
) {

81 
	`¥ötk
("Cannotádd ipÅo img file\n");

82 
	`‰ì_img_fûe
(
fûe
);

85 
	`img_add_fûe_by_li°
(
¥oc
, 
fûe
);

87  
ªt
;

88 
	}
}

90 
	$img_¥oc_dñ_ù
(
img_¥oc
 *
¥oc
, 
díåy
 *díåy, 
addr
)

92 
ªt
;

93 
img_fûe
 *
fûe
;

95 
fûe
 = 
	`föd_img_fûe
(
¥oc
, 
díåy
);

96 i‡(
fûe
 =
NULL
)

97  -
EINVAL
;

99 
ªt
 = 
	`img_fûe_dñ_ù
(
fûe
, 
addr
);

100 i‡(
ªt
 =0 && 
	`img_fûe_em±y
(
fûe
)) {

101 
	`img_dñ_fûe_by_li°
(
fûe
);

102 
	`‰ì_img_fûe
(
fûe
);

105  
ªt
;

106 
	}
}

109 
	$img_¥oc_¥öt
(
img_¥oc
 *
¥oc
)

111 
img_fûe
 *
fûe
;

113 
	`¥ötk
("### img_proc_print:\n");

114 
	`li°_f‹_óch_íåy
(
fûe
, &
¥oc
->
fûe_li°
, 
li°
) {

115 
	`img_fûe_¥öt
(
fûe
);

117 
	}
}

	@us_manager/img/img_proc.h

26 #i‚de‡
_IMG_PROC_H


27 
	#_IMG_PROC_H


	)

29 
	~<löux/ty≥s.h
>

31 
	gdíåy
;

33 
	simg_¥oc
 {

34 
li°_hód
 
	mfûe_li°
;

37 
img_¥oc
 *
¸óã_img_¥oc
();

38 
‰ì_img_¥oc
(
img_¥oc
 *
¥oc
);

40 
img_¥oc_add_ù
(
img_¥oc
 *
¥oc
, 
díåy
 *dentry,

41 
addr
, c⁄° *
¨gs
, 
ªt_ty≥
);

42 
img_¥oc_dñ_ù
(
img_¥oc
 *
¥oc
, 
díåy
 *díåy, 
addr
);

45 
img_¥oc_¥öt
(
img_¥oc
 *
¥oc
);

	@us_manager/pf/pf_group.c

26 
	~<löux/moduÀ.h
>

27 
	~<löux/¶ab.h
>

28 
	~<löux/li°.h
>

29 
	~"¥oc_fûãrs.h
"

30 
	~<us_m™agî/img/img_¥oc.h
>

31 
	~<us_m™agî/img/img_fûe.h
>

32 
	~<us_m™agî/img/img_ù.h
>

33 
	~<us_m™agî/s•t/s•t_¥oc.h
>

34 
	~<us_m™agî/hñ≥r.h
>

35 
	~<wrôî/sw≠_wrôî_moduÀ.h
>

37 
	spf_group
 {

38 
li°_hód
 
	mli°
;

39 
img_¥oc
 *
	mi_¥oc
;

40 
¥oc_fûãr
 *
	mfûãr
;

43 
li°_hód
 
	m¥oc_li°
;

46 
	s∂_°ru˘
 {

47 
li°_hód
 
	mli°
;

48 
s•t_¥oc
 *
	m¥oc
;

51 
LIST_HEAD
(
pfg_li°
);

54 
∂_°ru˘
 *
	$¸óã_∂_°ru˘
(
s•t_¥oc
 *
¥oc
)

56 
∂_°ru˘
 *
∂s
 = 
	`kmÆloc
((*∂s), 
GFP_KERNEL
);

58 
	`INIT_LIST_HEAD
(&
∂s
->
li°
);

59 
∂s
->
¥oc
 =Öroc;

61  
∂s
;

62 
	}
}

64 
	$‰ì_∂_°ru˘
(
∂_°ru˘
 *
∂s
)

66 
	`k‰ì
(
∂s
);

67 
	}
}

69 
	$add_∂_°ru˘
(
pf_group
 *
pfg
, 
∂_°ru˘
 *
∂s
)

71 
	`li°_add
(&
∂s
->
li°
, &
pfg
->
¥oc_li°
);

72 
	}
}

74 
	$dñ_∂_°ru˘
(
∂_°ru˘
 *
∂s
)

76 
	`li°_dñ
(&
∂s
->
li°
);

77 
	}
}

79 
	$c›y_¥oc_f‹m_img_to_s•t
(
img_¥oc
 *
i_¥oc
, 
s•t_¥oc
 *
¥oc
)

81 
s•t_fûe
 *
fûe
;

82 
img_fûe
 *
i_fûe
;

83 
img_ù
 *
i_ù
;

85 
	`li°_f‹_óch_íåy
(
i_fûe
, &
i_¥oc
->
fûe_li°
, 
li°
) {

86 
fûe
 = 
	`s•t_¥oc_föd_fûe_‹_√w
(
¥oc
, 
i_fûe
->
díåy
);

88 
	`li°_f‹_óch_íåy
(
i_ù
, &
i_fûe
->
ù_li°
, 
li°
)

89 
	`s•t_fûe_add_ù
(
fûe
, 
i_ù
->
addr
, i_ù->
¨gs
,

90 
i_ù
->
ªt_ty≥
);

92 
	}
}

94 
∂_°ru˘
 *
	$föd_∂_°ru˘
(
pf_group
 *
pfg
,

95 
èsk_°ru˘
 *
èsk
)

97 
∂_°ru˘
 *
∂s
;

99 
	`li°_f‹_óch_íåy
(
∂s
, &
pfg
->
¥oc_li°
, 
li°
) {

100 i‡(
∂s
->
¥oc
->
tgid
 =
èsk
->tgid)

101  
∂s
;

104  
NULL
;

105 
	}
}

107 
s•t_¥oc
 *
	$gë_¥oc_by_pfg
(
pf_group
 *
pfg
,

108 
èsk_°ru˘
 *
èsk
)

110 
∂_°ru˘
 *
∂s
;

112 
∂s
 = 
	`föd_∂_°ru˘
(
pfg
, 
èsk
);

113 i‡(
∂s
)

114  
∂s
->
¥oc
;

116  
NULL
;

117 
	}
}

119 
s•t_¥oc
 *
	$√w_¥oc_by_pfg
(
pf_group
 *
pfg
,

120 
èsk_°ru˘
 *
èsk
)

122 
∂_°ru˘
 *
∂s
;

123 
s•t_¥oc
 *
¥oc
;

125 
¥oc
 = 
	`s•t_¥oc_gë_by_èsk_‹_√w
(
èsk
, 
pfg
->
fûãr
->
¥iv
);

126 
	`c›y_¥oc_f‹m_img_to_s•t
(
pfg
->
i_¥oc
, 
¥oc
);

128 
∂s
 = 
	`¸óã_∂_°ru˘
(
¥oc
);

129 
	`add_∂_°ru˘
(
pfg
, 
∂s
);

131  
¥oc
;

132 
	}
}

135 
pf_group
 *
	$¸óã_pfg
(
¥oc_fûãr
 *
fûãr
)

137 
pf_group
 *
pfg
 = 
	`kmÆloc
((*pfg), 
GFP_KERNEL
);

139 
	`INIT_LIST_HEAD
(&
pfg
->
li°
);

140 
pfg
->
fûãr
 = filter;

141 
pfg
->
i_¥oc
 = 
	`¸óã_img_¥oc
();

142 
	`INIT_LIST_HEAD
(&
pfg
->
¥oc_li°
);

144  
pfg
;

145 
	}
}

147 
	$‰ì_pfg
(
pf_group
 *
pfg
)

150 
	`k‰ì
(
pfg
);

151 
	}
}

153 
	$add_pfg_by_li°
(
pf_group
 *
pfg
)

155 
	`li°_add
(&
pfg
->
li°
, &
pfg_li°
);

156 
	}
}

158 
	$dñ_pfg_by_li°
(
pf_group
 *
pfg
)

160 
	`li°_dñ
(&
pfg
->
li°
);

161 
	}
}

163 
pf_group
 *
	$gë_pf_group_by_díåy
(
díåy
 *díåy, *
¥iv
)

165 
pf_group
 *
pfg
;

166 
¥oc_fûãr
 *
fûãr
;

168 
	`li°_f‹_óch_íåy
(
pfg
, &
pfg_li°
, 
li°
) {

169 i‡(
	`check_pf_by_díåy
(
pfg
->
fûãr
, 
díåy
))

170  
pfg
;

173 
fûãr
 = 
	`¸óã_pf_by_díåy
(
díåy
, 
¥iv
);

174 
pfg
 = 
	`¸óã_pfg
(
fûãr
);

176 
	`add_pfg_by_li°
(
pfg
);

178  
pfg
;

179 
	}
}

180 
EXPORT_SYMBOL_GPL
(
gë_pf_group_by_díåy
);

182 
pf_group
 *
	$gë_pf_group_by_tgid
(
pid_t
 
tgid
, *
¥iv
)

184 
pf_group
 *
pfg
;

185 
¥oc_fûãr
 *
fûãr
;

187 
	`li°_f‹_óch_íåy
(
pfg
, &
pfg_li°
, 
li°
) {

188 i‡(
	`check_pf_by_tgid
(
pfg
->
fûãr
, 
tgid
))

189  
pfg
;

192 
fûãr
 = 
	`¸óã_pf_by_tgid
(
tgid
, 
¥iv
);

193 
pfg
 = 
	`¸óã_pfg
(
fûãr
);

195 
	`add_pfg_by_li°
(
pfg
);

197  
pfg
;

198 
	}
}

199 
EXPORT_SYMBOL_GPL
(
gë_pf_group_by_tgid
);

201 
pf_group
 *
	$gë_pf_group_dumb
(*
¥iv
)

203 
pf_group
 *
pfg
;

204 
¥oc_fûãr
 *
fûãr
;

206 
	`li°_f‹_óch_íåy
(
pfg
, &
pfg_li°
, 
li°
) {

207 i‡(
	`check_pf_dumb
(
pfg
->
fûãr
))

208  
pfg
;

211 
fûãr
 = 
	`¸óã_pf_dumb
(
pfg
->filter);

212 
pfg
 = 
	`¸óã_pfg
(
fûãr
);

214 
	`add_pfg_by_li°
(
pfg
);

216  
pfg
;

217 
	}
}

218 
EXPORT_SYMBOL_GPL
(
gë_pf_group_dumb
);

220 
	$put_pf_group
(
pf_group
 *
pfg
)

223 
	}
}

225 
	$pf_ªgi°î_¥obe
(
pf_group
 *
pfg
, 
díåy
 *dentry,

226 
off£t
, c⁄° *
¨gs
, 
ªt_ty≥
)

228  
	`img_¥oc_add_ù
(
pfg
->
i_¥oc
, 
díåy
, 
off£t
, 
¨gs
, 
ªt_ty≥
);

229 
	}
}

230 
EXPORT_SYMBOL_GPL
(
pf_ªgi°î_¥obe
);

232 
	$pf_uƒegi°î_¥obe
(
pf_group
 *
pfg
, 
díåy
 *dentry,

233 
off£t
)

235  
	`img_¥oc_dñ_ù
(
pfg
->
i_¥oc
, 
díåy
, 
off£t
);

236 
	}
}

237 
EXPORT_SYMBOL_GPL
(
pf_uƒegi°î_¥obe
);

239 
	$ˇŒ_∑ge_Áu…
(
èsk_°ru˘
 *
èsk
, 
∑ge_addr
)

241 
pf_group
 *
pfg
, *
pfg_fú°
 = 
NULL
;

242 
s•t_¥oc
 *
¥oc
 = 
NULL
;

244 
	`li°_f‹_óch_íåy
(
pfg
, &
pfg_li°
, 
li°
) {

245 i‡(
	`check_èsk_f
(
pfg
->
fûãr
, 
èsk
Ë=
NULL
)

248 
¥oc
 = 
	`gë_¥oc_by_pfg
(
pfg
, 
èsk
);

249 i‡(
¥oc
 =
NULL
 && 
èsk
->
tgid
 =èsk->
pid
) {

250 
¥oc
 = 
	`√w_¥oc_by_pfg
(
pfg
, 
èsk
);

251 
pfg_fú°
 = 
pfg
;

255 i‡(
¥oc
) {

256 i‡(
pfg_fú°
) {

257 
díåy
 *dentry;

259 
díåy
 = 
	`gë_díåy_by_pf
(
pfg_fú°
->
fûãr
);

260 i‡(
díåy
 =
NULL
) {

261 
díåy
 = 
èsk
->
mm
->
exe_fûe
 ?

262 
èsk
->
mm
->
exe_fûe
->
f_díåy
 :

263 
NULL
;

266 
	`¥oc_öfo_msg
(
èsk
, 
díåy
);

267 
	`s•t_¥oc_ö°Æl
(
¥oc
);

269 
	`s•t_¥oc_ö°Æl_∑ge
(
¥oc
, 
∑ge_addr
);

272 
	}
}

274 
	$unö°Æl_¥oc
(
s•t_¥oc
 *
¥oc
)

276 
èsk_°ru˘
 *
èsk
 = 
¥oc
->task;

277 
pf_group
 *
pfg
;

278 
∂_°ru˘
 *
∂s
;

279 
i
;

281 
	`li°_f‹_óch_íåy
(
pfg
, &
pfg_li°
, 
li°
) {

282 
∂s
 = 
	`föd_∂_°ru˘
(
pfg
, 
èsk
);

283 i‡(
∂s
) {

284 
	`dñ_∂_°ru˘
(
∂s
);

285 
	`‰ì_∂_°ru˘
(
∂s
);

289 
	`èsk_lock
(
èsk
);

290 
i
 = 0; 
èsk
->
mm
 =
NULL
; ++i) {

291 
	`èsk_u∆ock
(
èsk
);

292 i‡(
i
 >= 10)

293 
	`BUG
();

295 
	`scheduÀ
();

296 
	`èsk_lock
(
èsk
);

299 
	`s•t_¥oc_unö°Æl
(
¥oc
, 
èsk
, 
US_UNREGS_PROBE
);

300 
	`èsk_u∆ock
(
èsk
);

302 
	`s•t_¥oc_‰ì
(
¥oc
);

303 
	}
}

305 
	$ˇŒ_mm_ªÀa£
(
èsk_°ru˘
 *
èsk
)

307 
s•t_¥oc
 *
¥oc
;

309 
¥oc
 = 
	`s•t_¥oc_gë_by_èsk
(
èsk
);

310 i‡(
¥oc
)

312 
	`unö°Æl_¥oc
(
¥oc
);

313 
	}
}

315 
	$unö°Æl_∑ge
(
addr
)

318 
	}
}

320 
	$ö°Æl_Æl
()

322 
èsk_°ru˘
 *
èsk
;

323 
tmp_o›s_ö_¥ogªss
;

325 
tmp_o›s_ö_¥ogªss
 = 
o›s_ö_¥ogªss
;

326 
o›s_ö_¥ogªss
 = 1;

327 
	`rcu_ªad_lock
();

328 
	`f‹_óch_¥o˚ss
(
èsk
) {

329 i‡(
èsk
->
tgid
 !èsk->
pid
)

332 i‡(
	`is_kthªad
(
èsk
))

335 
	`ˇŒ_∑ge_Áu…
(
èsk
, 0xba00baab);

337 
	`rcu_ªad_u∆ock
();

338 
o›s_ö_¥ogªss
 = 
tmp_o›s_ö_¥ogªss
;

339 
	}
}

341 
	$˛ón_pfg
()

343 
pf_group
 *
pfg
, *
n
;

345 
	`li°_f‹_óch_íåy_ß„
(
pfg
, 
n
, &
pfg_li°
, 
li°
) {

346 
	`dñ_pfg_by_li°
(
pfg
);

347 
	`‰ì_pfg
(
pfg
);

349 
	}
}

351 
	$⁄_óch_unö°Æl_¥oc
(
s•t_¥oc
 *
¥oc
, *
d©a
)

353 
	`unö°Æl_¥oc
(
¥oc
);

354 
	}
}

356 
	$unö°Æl_Æl
()

358 
	`waô_¥oc_lock
();

359 
	`⁄_óch_¥oc_no_lock
(
⁄_óch_unö°Æl_¥oc
, 
NULL
);

360 
	`˛ón_pfg
();

361 
	}
}

364 
	$pfg_¥öt
(
pf_group
 *
pfg
)

366 
	`img_¥oc_¥öt
(
pfg
->
i_¥oc
);

367 
	}
}

368 
EXPORT_SYMBOL_GPL
(
pfg_¥öt
);

	@us_manager/pf/pf_group.h

26 #i‚de‡
_PF_GROUP_H


27 
	#_PF_GROUP_H


	)

29 
	~<löux/ty≥s.h
>

31 
	gdíåy
;

32 
	gpf_group
;

33 
	gs•t_¥oc
;

35 
pf_group
 *
gë_pf_group_by_díåy
(
díåy
 *díåy, *
¥iv
);

36 
pf_group
 *
gë_pf_group_by_tgid
(
pid_t
 
tgid
, *
¥iv
);

37 
pf_group
 *
gë_pf_group_dumb
(*
¥iv
);

38 
put_pf_group
(
pf_group
 *
pfg
);

40 
pf_ªgi°î_¥obe
(
pf_group
 *
pfg
, 
díåy
 *dentry,

41 
off£t
, c⁄° *
¨gs
, 
ªt_ty≥
);

42 
pf_uƒegi°î_¥obe
(
pf_group
 *
pfg
, 
díåy
 *dentry,

43 
off£t
);

45 
ö°Æl_Æl
();

46 
unö°Æl_Æl
();

48 
ˇŒ_∑ge_Áu…
(
èsk_°ru˘
 *
èsk
, 
∑ge_addr
);

49 
ˇŒ_mm_ªÀa£
(
èsk_°ru˘
 *
èsk
);

50 
unö°Æl_¥oc
(
s•t_¥oc
 *
¥oc
);

52 
unö°Æl_∑ge
(
addr
);

55 
pfg_¥öt
(
pf_group
 *
pfg
);

	@us_manager/pf/proc_filters.c

26 
	~<löux/¶ab.h
>

27 
	~<löux/sched.h
>

28 
	~<löux/mm_ty≥s.h
>

29 
	~<löux/fs.h
>

30 
	~"¥oc_fûãrs.h
"

31 
	~<us_m™agî/s•t/s•t.h
>

33 
	$check_díåy
(
èsk_°ru˘
 *
èsk
, 
díåy
 *dentry)

35 
vm_¨ó_°ru˘
 *
vma
;

36 
mm_°ru˘
 *
mm
 = 
èsk
->mm;

38 i‡(
mm
 =
NULL
) {

42 
vma
 = 
mm
->
mm≠
; vma; vm®vma->
vm_√xt
) {

43 i‡(
	`check_vma
(
vma
Ë&& vma->
vm_fûe
->
f_díåy
 =
díåy
) {

49 
	}
}

51 
èsk_°ru˘
 *
	$ˇŒ_by_díåy
(
¥oc_fûãr
 *
£lf
,

52 
èsk_°ru˘
 *
èsk
)

54 
díåy
 *díåy = (díåy *)
£lf
->
d©a
;

56 i‡(!
díåy
 || 
	`check_díåy
(
èsk
, dentry))

57  
èsk
;

59  
NULL
;

60 
	}
}

62 
èsk_°ru˘
 *
	$ˇŒ_by_tgid
(
¥oc_fûãr
 *
£lf
,

63 
èsk_°ru˘
 *
èsk
)

65 
pid_t
 
tgid
 = (pid_t)
£lf
->
d©a
;

67 i‡(
èsk
->
tgid
 ==Ågid)

68  
èsk
;

70  
NULL
;

71 
	}
}

74 
èsk_°ru˘
 *
	$ˇŒ_dumb
(
¥oc_fûãr
 *
£lf
,

75 
èsk_°ru˘
 *
èsk
)

77  
èsk
;

78 
	}
}

80 
¥oc_fûãr
 *
	$¸óã_pf
()

82 
¥oc_fûãr
 *
pf
 = 
	`kmÆloc
((*pf), 
GFP_KERNEL
);

84  
pf
;

85 
	}
}

87 
¥oc_fûãr
 *
	$¸óã_pf_by_díåy
(
díåy
 *díåy, *
¥iv
)

89 
¥oc_fûãr
 *
pf
 = 
	`¸óã_pf
();

91 
pf
->
ˇŒ
 = &
ˇŒ_by_díåy
;

92 
pf
->
d©a
 = (*)
díåy
;

93 
pf
->
¥iv
 =Öriv;

95  
pf
;

96 
	}
}

97 
¥oc_fûãr
 *
	$¸óã_pf_by_tgid
(
pid_t
 
tgid
, *
¥iv
)

99 
¥oc_fûãr
 *
pf
 = 
	`¸óã_pf
();

101 
pf
->
ˇŒ
 = &
ˇŒ_by_tgid
;

102 
pf
->
d©a
 = (*)
tgid
;

103 
pf
->
¥iv
 =Öriv;

105  
pf
;

106 
	}
}

108 
¥oc_fûãr
 *
	$¸óã_pf_dumb
(*
¥iv
)

110 
¥oc_fûãr
 *
pf
 = 
	`¸óã_pf
();

112 
pf
->
ˇŒ
 = &
ˇŒ_dumb
;

113 
pf
->
d©a
 = 
NULL
;

114 
pf
->
¥iv
 =Öriv;

116  
pf
;

117 
	}
}

119 
	$‰ì_pf
(
¥oc_fûãr
 *
pf
)

121 
	`k‰ì
(
pf
);

122 
	}
}

124 
	$check_pf_by_díåy
(
¥oc_fûãr
 *
fûãr
, 
díåy
 *dentry)

126  
fûãr
->
d©a
 =(*)
díåy
 &&

127 
fûãr
->
ˇŒ
 =&
ˇŒ_by_díåy
;

128 
	}
}

130 
	$check_pf_by_tgid
(
¥oc_fûãr
 *
fûãr
, 
pid_t
 
tgid
)

132  
fûãr
->
d©a
 =(*)
tgid
 && fûãr->
ˇŒ
 =&
ˇŒ_by_tgid
;

133 
	}
}

135 
	$check_pf_dumb
(
¥oc_fûãr
 *
fûãr
)

137  
fûãr
->
ˇŒ
 =&
ˇŒ_dumb
;

138 
	}
}

140 
díåy
 *
	$gë_díåy_by_pf
(
¥oc_fûãr
 *
fûãr
)

142 i‡(
fûãr
->
ˇŒ
 =&
ˇŒ_by_díåy
)

143  (
díåy
 *)
fûãr
->
d©a
;

145  
NULL
;

146 
	}
}

	@us_manager/pf/proc_filters.h

26 #i‚de‡
_PROC_FILTERS_H


27 
	#_PROC_FILTERS_H


	)

29 
	~<löux/ty≥s.h
>

31 
	gdíåy
;

32 
	gèsk_°ru˘
;

34 
	s¥oc_fûãr
 {

35 
	mèsk_°ru˘
 *(*
	mˇŒ
)(
¥oc_fûãr
 *
	m£lf
,

36 
èsk_°ru˘
 *
	mèsk
);

37 *
	md©a
;

38 *
	m¥iv
;

41 
	#check_èsk_f
(
fûãr
, 
èsk
Ëfûãr->
	`ˇŒ
(fûãr,Åask)

	)

43 
¥oc_fûãr
 *
¸óã_pf_by_díåy
(
díåy
 *díåy, *
¥iv
);

44 
¥oc_fûãr
 *
¸óã_pf_by_tgid
(
pid_t
 
tgid
, *
¥iv
);

45 
¥oc_fûãr
 *
¸óã_pf_dumb
(*
¥iv
);

46 
‰ì_pf
(
¥oc_fûãr
 *
pf
);

48 
check_pf_by_díåy
(
¥oc_fûãr
 *
fûãr
, 
díåy
 *dentry);

49 
check_pf_by_tgid
(
¥oc_fûãr
 *
fûãr
, 
pid_t
 
tgid
);

50 
check_pf_dumb
(
¥oc_fûãr
 *
fûãr
);

51 
díåy
 *
gë_díåy_by_pf
(
¥oc_fûãr
 *
fûãr
);

	@us_manager/sspt/ip.c

25 
	~<löux/¶ab.h
>

26 
	~"ù.h
"

27 
	~"s•t_∑ge.h
"

28 
	~"s•t_fûe.h
"

29 
	~<wrôî/sw≠_wrôî_moduÀ.h
>

30 
	~<us_m™agî/us_m™agî.h
>

33 
	$íåy_h™dÀr
(
uªçrobe_ö°™˚
 *
ri
, 
±_ªgs
 *
ªgs
)

35 
uªçrobe
 *
Ω
 = 
ri
->rp;

37 i‡(
Ω
 && 
	`gë_quõt
(Ë=
QT_OFF
) {

38 
us_ù
 *
ù
 = 
	`c⁄èöî_of
(
Ω
, us_ù, 
ªçrobe
);

39 c⁄° *
fmt
 = 
ù
->
¨gs
;

40 
addr
 = ()
ù
->
‹ig_addr
;

42 
	`íåy_evít
(
fmt
, 
addr
, 
ªgs
, 
PT_US
, 
PST_NONE
);

46 
	}
}

48 
	$ªt_h™dÀr
(
uªçrobe_ö°™˚
 *
ri
, 
±_ªgs
 *
ªgs
)

50 
uªçrobe
 *
Ω
 = 
ri
->rp;

52 i‡(
Ω
 && 
	`gë_quõt
(Ë=
QT_OFF
) {

53 
us_ù
 *
ù
 = 
	`c⁄èöî_of
(
Ω
, us_ù, 
ªçrobe
);

54 
addr
 = ()
ù
->
‹ig_addr
;

55 
ªt_addr
 = ()
ri
->ret_addr;

57 
	`exô_evít
(
ù
->
ªt_ty≥
, 
ªgs
, 
addr
, 
ªt_addr
);

61 
	}
}

63 
us_ù
 *
	$¸óã_ù
(
off£t
, c⁄° *
¨gs
, 
ªt_ty≥
)

65 
size_t
 
Àn
 = 
	`°æí
(
¨gs
) + 1;

66 
us_ù
 *
ù
 = 
	`kmÆloc
((*ùË+ 
Àn
, 
GFP_ATOMIC
);

68 i‡(
ù
 !
NULL
) {

69 
	`mem£t
(
ù
, 0, (*ip));

71 
	`INIT_LIST_HEAD
(&
ù
->
li°
);

72 
ù
->
off£t
 = offset;

73 
ù
->
¨gs
 = (*)ip + (*ip);

74 
ù
->
ªt_ty≥
 =Ñet_type;

77 
	`mem˝y
(
ù
->
¨gs
,árgs, 
Àn
);

80 
ù
->
ªçrobe
.
h™dÀr
 = 
ªt_h™dÀr
;

81 
ù
->
ªçrobe
.
íåy_h™dÀr
 =Éntry_handler;

83 
	`¥ötk
("Cannot kmalloc in create_ip function!\n");

86  
ù
;

87 
	}
}

89 
	$‰ì_ù
(
us_ù
 *
ù
)

91 
	`k‰ì
(
ù
);

92 
	}
}

	@us_manager/sspt/ip.h

1 #i‚de‡
__IP__


2 
	#__IP__


	)

28 
	~<löux/li°.h
>

29 
	~<u¥obe/sw≠_u¥obes.h
>

31 
	gs•t_∑ge
;

33 
	sus_ù
 {

34 
li°_hód
 
	mli°
;

35 
s•t_∑ge
 *
	m∑ge
;

37 
uªçrobe
 
	mªçrobe
;

38 *
	m¨gs
;

39 
	mªt_ty≥
;

40 
	m‹ig_addr
;

42 
	moff£t
;

46 
us_ù
 *
¸óã_ù
(
off£t
, c⁄° *
¨gs
, 
ªt_ty≥
);

47 
‰ì_ù
(
us_ù
 *
ù
);

	@us_manager/sspt/sspt.h

1 #i‚de‡
__SSPT__


2 
	#__SSPT__


	)

28 
	~"ù.h
"

29 
	~"s•t_∑ge.h
"

30 
	~"s•t_fûe.h
"

31 
	~"s•t_¥oc.h
"

32 
	~"s•t_debug.h
"

33 
	~<u¥obe/sw≠_u¥obes.h
>

36 
	~<us_m™agî/us_m™agî.h
>

37 
	~<us_m™agî/pf/pf_group.h
>

40 
ölöe
 
	$check_vma
(
vm_¨ó_°ru˘
 *
vma
)

42  
vma
->
vm_fûe
 &&

43 !(
vma
->
vm_pgoff
 != 0 ||

44 !(
vma
->
vm_Êags
 & 
VM_EXEC
) ||

45 !(
vma
->
vm_Êags
 & (
VM_READ
 | 
VM_MAYREAD
)));

46 
	}
}

48 
ölöe
 
	$s•t_ªgi°î_u•robe
(
us_ù
 *
ù
)

50 
ªt
;

53 
ù
->
ªçrobe
.
up
.
èsk
 = ip->
∑ge
->
fûe
->
¥oc
->task;

54 
ù
->
ªçrobe
.
up
.
sm
 = ip->
∑ge
->
fûe
->
¥oc
->sm;

56 
ªt
 = 
	`dbi_ªgi°î_uªçrobe
(&
ù
->
ªçrobe
);

57 i‡(
ªt
) {

58 
s•t_fûe
 *
fûe
 = 
ù
->
∑ge
->file;

59 *
«me
 = 
fûe
->
díåy
->
d_öame
;

60 
addr
 = ()
ù
->
ªçrobe
.
up
.
kp
.addr;

61 
off£t
 = 
addr
 - 
fûe
->
vm_°¨t
;

63 
	`¥ötk
("dbi_register_uretprobe() failure %d (%s:%lx|%lx)\n",

64 
ªt
, 
«me
, 
off£t
, ()
ù
->
ªçrobe
.
up
.
kp
.
›code
);

67  
ªt
;

68 
	}
}

70 
ölöe
 
	$do_uƒegi°î_u•robe
(
us_ù
 *
ù
, 
dißrm
)

72 
	`__dbi_uƒegi°î_uªçrobe
(&
ù
->
ªçrobe
, 
dißrm
);

75 
	}
}

77 
ölöe
 
	$s•t_uƒegi°î_u•robe
(
èsk_°ru˘
 *
èsk
, 
us_ù
 *
ù
, 
US_FLAGS
 
Êag
)

79 
îr
 = 0;

81 
Êag
) {

82 
US_UNREGS_PROBE
:

83 
îr
 = 
	`do_uƒegi°î_u•robe
(
ù
, 1);

85 
US_DISARM
:

86 
	`dißrm_u¥obe
(&
ù
->
ªçrobe
.
up
.
kp
, 
èsk
);

88 
US_UNINSTALL
:

89 
îr
 = 
	`do_uƒegi°î_u•robe
(
ù
, 0);

92 
	`∑nic
("öc‹ª˘ vÆuêÊag=%d", 
Êag
);

95  
îr
;

96 
	}
}

	@us_manager/sspt/sspt_debug.h

1 #i‚de‡
__SSPT_DEBUG__


2 
	#__SSPT_DEBUG__


	)

28 
	~<k¥obe/dbi_k¥obes_dïs.h
>

30 
ölöe
 
	$¥öt_j¥obe
(
j¥obe
 *
jp
)

32 
	`¥ötk
("### JP:Éntry=%lx,Öre_entry=%lx\n",

33 ()
jp
->
íåy
, ()jp->
¥e_íåy
);

34 
	}
}

36 
ölöe
 
	$¥öt_ªçrobe
(
uªçrobe
 *
Ω
)

38 
	`¥ötk
("### RP: handler=%lx\n",

39 ()
Ω
->
h™dÀr
);

40 
	}
}

42 
ölöe
 
	$¥öt_ù
(
us_ù
 *
ù
, 
i
)

44 
	`¥ötk
("###áddr[%2d]=%lx, R_addr=%lx\n",

45 
i
, ()
ù
->
off£t
,

46 ()
ù
->
ªçrobe
.
up
.
kp
.
addr
);

47 
	`¥öt_ªçrobe
(&
ù
->
ªçrobe
);

48 
	}
}

50 
ölöe
 
	$¥öt_∑ge_¥obes
(c⁄° 
s•t_∑ge
 *
∑ge
)

52 
i
 = 0;

53 
us_ù
 *
ù
;

55 
	`¥ötk
("### off£t=%lx\n", 
∑ge
->
off£t
);

56 
	`¥ötk
("###Ço install:\n");

57 
	`li°_f‹_óch_íåy
(
ù
, &
∑ge
->
ù_li°_no_ö°
, 
li°
) {

58 
	`¥öt_ù
(
ù
, 
i
);

59 ++
i
;

62 
	`¥ötk
("### install:\n");

63 
	`li°_f‹_óch_íåy
(
ù
, &
∑ge
->
ù_li°_ö°
, 
li°
) {

64 
	`¥öt_ù
(
ù
, 
i
);

65 ++
i
;

67 
	}
}

69 
ölöe
 
	$¥öt_fûe_¥obes
(c⁄° 
s•t_fûe
 *
fûe
)

71 
i
;

72 
èbÀ_size
;

73 
s•t_∑ge
 *
∑ge
 = 
NULL
;

74 
hli°_hód
 *
hód
 = 
NULL
;

75 *
NA
 = "N/A";

76 *
«me
;

77 
	`DECLARE_NODE_PTR_FOR_HLIST
(
node
);

79 i‡(
fûe
 =
NULL
) {

80 
	`¥ötk
("### file_p == NULL\n");

84 
èbÀ_size
 = (1 << 
fûe
->
∑ge_¥obes_hash_bôs
);

85 
«me
 = (
fûe
->
díåy
Ë? fûe->díåy->
d_öame
 : 
NA
;

87 
	`¥ötk
("###Örint_file_probes:Öath=%s, d_iname=%s,Åable_size=%lu, vm_start=%lx\n",

88 
fûe
->
díåy
->
d_öame
, 
«me
, 
èbÀ_size
, fûe->
vm_°¨t
);

90 
i
 = 0; i < 
èbÀ_size
; ++i) {

91 
hód
 = &
fûe
->
∑ge_¥obes_èbÀ
[
i
];

92 
	`sw≠_hli°_f‹_óch_íåy_rcu
(
∑ge
, 
node
, 
hód
, 
hli°
) {

93 
	`¥öt_∑ge_¥obes
(
∑ge
);

96 
	}
}

98 
ölöe
 
	$¥öt_¥oc_¥obes
(c⁄° 
s•t_¥oc
 *
¥oc
)

100 
s•t_fûe
 *
fûe
;

102 
	`¥ötk
("###Örint_proc_probes\n");

103 
	`li°_f‹_óch_íåy
(
fûe
, &
¥oc
->
fûe_li°
, 
li°
) {

104 
	`¥öt_fûe_¥obes
(
fûe
);

106 
	`¥ötk
("###Örint_proc_probes\n");

107 
	}
}

	@us_manager/sspt/sspt_feature.c

25 
	~"s•t_„©uª.h
"

26 
	~"s•t_¥oc.h
"

27 
	~<löux/moduÀ.h
>

28 
	~<löux/¶ab.h
>

29 
	~<löux/li°.h
>

30 
	~<löux/•ölock.h
>

33 
	ss•t_„©uª
 {

34 
li°_hód
 
	m„©uª_li°
;

37 
	ss•t_„©uª_img
 {

38 
li°_hód
 
	mli°
;

40 *(*
	mÆloc
)();

41 (*
	m‰ì
)(*
	md©a
);

44 
	ss•t_„©uª_d©a
 {

45 
li°_hód
 
	mli°
;

47 
s•t_„©uª_img
 *
	mimg
;

48 *
	md©a
;

51 
DEFINE_SPINLOCK
(
„©uª_img_lock
);

52 
LIST_HEAD
(
„©uª_img_li°
);

54 
s•t_„©uª_d©a
 *
	$¸óã_„©uª_d©a
(
s•t_„©uª_img
 *
img
)

56 
s•t_„©uª_d©a
 *
fd
;

58 
fd
 = 
	`kmÆloc
((*fd), 
GFP_ATOMIC
);

59 i‡(
fd
) {

60 
	`INIT_LIST_HEAD
(&
fd
->
li°
);

61 
fd
->
img
 = img;

62 
fd
->
d©a
 = 
img
->
	`Æloc
();

65  
fd
;

66 
	}
}

68 
	$de°roy_„©uª_d©a
(
s•t_„©uª_d©a
 *
fd
)

70 
fd
->
img
->
	`‰ì
(fd->
d©a
);

71 
	`k‰ì
(
fd
);

72 
	}
}

74 
s•t_„©uª
 *
	$s•t_¸óã_„©uª
()

76 
s•t_„©uª
 *
f
;

78 
f
 = 
	`kmÆloc
((*f), 
GFP_ATOMIC
);

79 i‡(
f
) {

80 
s•t_„©uª_d©a
 *
fd
;

81 
s•t_„©uª_img
 *
fi
;

82 
Êags
;

84 
	`INIT_LIST_HEAD
(&
f
->
„©uª_li°
);

86 
	`•ö_lock_úqßve
(&
„©uª_img_lock
, 
Êags
);

87 
	`li°_f‹_óch_íåy
(
fi
, &
„©uª_img_li°
, 
li°
) {

88 
fd
 = 
	`¸óã_„©uª_d©a
(
fi
);

91 
	`li°_add
(&
fd
->
li°
, &
f
->
„©uª_li°
);

93 
	`•ö_u∆ock_úqª°‹e
(&
„©uª_img_lock
, 
Êags
);

96  
f
;

97 
	}
}

99 
	$s•t_de°roy_„©uª
(
s•t_„©uª
 *
f
)

101 
s•t_„©uª_d©a
 *
fd
, *
n
;

103 
	`li°_f‹_óch_íåy_ß„
(
fd
, 
n
, &
f
->
„©uª_li°
, 
li°
) {

105 
	`li°_dñ
(&
fd
->
li°
);

106 
	`de°roy_„©uª_d©a
(
fd
);

109 
	`k‰ì
(
f
);

110 
	}
}

112 
	$add_„©uª_img_to_li°
(
s•t_„©uª_img
 *
fi
)

114 
Êags
;

116 
	`•ö_lock_úqßve
(&
„©uª_img_lock
, 
Êags
);

117 
	`li°_add
(&
fi
->
li°
, &
„©uª_img_li°
);

118 
	`•ö_u∆ock_úqª°‹e
(&
„©uª_img_lock
, 
Êags
);

119 
	}
}

121 
	$dñ_„©uª_img_‰om_li°
(
s•t_„©uª_img
 *
fi
)

123 
Êags
;

125 
	`•ö_lock_úqßve
(&
„©uª_img_lock
, 
Êags
);

126 
	`li°_dñ
(&
fi
->
li°
);

127 
	`•ö_u∆ock_úqª°‹e
(&
„©uª_img_lock
, 
Êags
);

128 
	}
}

130 
s•t_„©uª_img
 *
¸óã_„©uª_img
(*(*
Æloc
)(),

131 (*
‰ì
)(*
d©a
))

133 
s•t_„©uª_img
 *
fi
;

135 
fi
 = 
	`kmÆloc
((*fi), 
GFP_ATOMIC
);

136 if(
fi
) {

137 
	`INIT_LIST_HEAD
(&
fi
->
li°
);

138 
fi
->
Æloc
 =álloc;

139 
fi
->
‰ì
 = free;

141 
	`add_„©uª_img_to_li°
(
fi
);

144  
fi
;

145 
	}
}

147 
	$de°roy_„©uª_img
(
s•t_„©uª_img
 *
fi
)

149 
	`dñ_„©uª_img_‰om_li°
(
fi
);

151 
	`k‰ì
(
fi
);

152 
	}
}

154 
	$dñ_„©uª_by_img
(
s•t_„©uª
 *
f
,

155 
s•t_„©uª_img
 *
img
)

157 
s•t_„©uª_d©a
 *
fd
;

159 
	`li°_f‹_óch_íåy
(
fd
, &
f
->
„©uª_li°
, 
li°
) {

160 i‡(
img
 =
fd
->img) {

162 
	`li°_dñ
(&
fd
->
li°
);

163 
	`de°roy_„©uª_d©a
(
fd
);

167 
	}
}

169 
	$dñ_„©uª_‰om_¥oc
(
s•t_¥oc
 *
¥oc
, *
d©a
)

171 
	`dñ_„©uª_by_img
(
¥oc
->
„©uª
, (
s•t_„©uª_img
 *)
d©a
);

172 
	}
}

174 *
	$s•t_gë_„©uª_d©a
(
s•t_„©uª
 *
f
, 
s•t_„©uª_id_t
 
id
)

176 
s•t_„©uª_img
 *
img
 = (s•t_„©uª_img *)
id
;

177 
s•t_„©uª_d©a
 *
fd
;

179 
	`li°_f‹_óch_íåy
(
fd
, &
f
->
„©uª_li°
, 
li°
) {

180 i‡(
img
 =
fd
->img)

181  
fd
->
d©a
;

184  
NULL
;

185 
	}
}

186 
EXPORT_SYMBOL_GPL
(
s•t_gë_„©uª_d©a
);

188 
s•t_„©uª_id_t
 
s•t_ªgi°î_„©uª
(*(*
Æloc
)(), (*
‰ì
)(*
d©a
))

190 
s•t_„©uª_img
 *
fi
;

192 
fi
 = 
	`¸óã_„©uª_img
(
Æloc
, 
‰ì
);

196  (
s•t_„©uª_id_t
)
fi
;

197 
	}
}

198 
EXPORT_SYMBOL_GPL
(
s•t_ªgi°î_„©uª
);

200 
	$s•t_uƒegi°î_„©uª
(
s•t_„©uª_id_t
 
id
)

202 
s•t_„©uª_img
 *
fi
 = (s•t_„©uª_img *)
id
;

204 
	`⁄_óch_¥oc
(
dñ_„©uª_‰om_¥oc
, (*)
fi
);

205 
	`de°roy_„©uª_img
(
fi
);

206 
	}
}

207 
EXPORT_SYMBOL_GPL
(
s•t_uƒegi°î_„©uª
);

	@us_manager/sspt/sspt_feature.h

1 #i‚de‡
_SSPT_FEATUER_H


2 
	#_SSPT_FEATUER_H


	)

28 
	gs•t_„©uª
;

30 * 
	ts•t_„©uª_id_t
;

31 
	#SSPT_FEATURE_ID_BAD
 
NULL


	)

33 
s•t_„©uª
 *
s•t_¸óã_„©uª
();

34 
s•t_de°roy_„©uª
(
s•t_„©uª
 *
f
);

36 *
s•t_gë_„©uª_d©a
(
s•t_„©uª
 *
f
, 
s•t_„©uª_id_t
 
id
);

37 
s•t_„©uª_id_t
 
s•t_ªgi°î_„©uª
(*(*
Æloc
)(),

38 (*
‰ì
)(*
d©a
));

39 
	`s•t_uƒegi°î_„©uª
(
s•t_„©uª_id_t
 
id
);

	@us_manager/sspt/sspt_file.c

25 
	~"s•t.h
"

26 
	~"s•t_fûe.h
"

27 
	~"s•t_∑ge.h
"

28 
	~"s•t_¥oc.h
"

29 
	~<löux/¶ab.h
>

30 
	~<löux/li°.h
>

31 
	~<löux/hash.h
>

32 
	~<löux/sched.h
>

33 
	~<k¥obe/dbi_k¥obes_dïs.h
>

35 
	$ˇlcuœti⁄_hash_bôs
(
˙t
)

37 
bôs
;

38 
bôs
 = 1; 
˙t
 >>= 1; ++bits);

40  
bôs
;

41 
	}
}

43 
s•t_fûe
 *
	$s•t_fûe_¸óã
(
díåy
 *díåy, 
∑ge_˙t
)

45 
s•t_fûe
 *
obj
 = 
	`kmÆloc
((*obj), 
GFP_ATOMIC
);

47 i‡(
obj
) {

48 
i
, 
èbÀ_size
;

49 
	`INIT_LIST_HEAD
(&
obj
->
li°
);

50 
obj
->
¥oc
 = 
NULL
;

51 
obj
->
díåy
 = dentry;

52 
obj
->
lﬂded
 = 0;

53 
obj
->
vm_°¨t
 = 0;

54 
obj
->
vm_íd
 = 0;

56 
obj
->
∑ge_¥obes_hash_bôs
 = 
	`ˇlcuœti⁄_hash_bôs
(
∑ge_˙t
);

57 
èbÀ_size
 = (1 << 
obj
->
∑ge_¥obes_hash_bôs
);

59 
obj
->
∑ge_¥obes_èbÀ
 = 
	`kmÆloc
((*obj->∑ge_¥obes_èbÀ)*
èbÀ_size
, 
GFP_ATOMIC
);

61 
i
 = 0; i < 
èbÀ_size
; ++i) {

62 
	`INIT_HLIST_HEAD
(&
obj
->
∑ge_¥obes_èbÀ
[
i
]);

66  
obj
;

67 
	}
}

69 
	$s•t_fûe_‰ì
(
s•t_fûe
 *
fûe
)

71 
hli°_hód
 *
hód
;

72 
s•t_∑ge
 *
∑ge
;

73 
i
, 
èbÀ_size
 = (1 << 
fûe
->
∑ge_¥obes_hash_bôs
);

74 
hli°_node
 *
n
;

75 
	`DECLARE_NODE_PTR_FOR_HLIST
(
p
);

77 
i
 = 0; i < 
èbÀ_size
; ++i) {

78 
hód
 = &
fûe
->
∑ge_¥obes_èbÀ
[
i
];

79 
	`sw≠_hli°_f‹_óch_íåy_ß„
(
∑ge
, 
p
, 
n
, 
hód
, 
hli°
) {

80 
	`hli°_dñ
(&
∑ge
->
hli°
);

81 
	`s•t_∑ge_‰ì
(
∑ge
);

85 
	`k‰ì
(
fûe
->
∑ge_¥obes_èbÀ
);

86 
	`k‰ì
(
fûe
);

87 
	}
}

89 
	$s•t_add_∑ge
(
s•t_fûe
 *
fûe
, 
s•t_∑ge
 *
∑ge
)

91 
∑ge
->
fûe
 = file;

92 
	`hli°_add_hód
(&
∑ge
->
hli°
, &
fûe
->
∑ge_¥obes_èbÀ
[
	`hash_±r
((*Ìage->
off£t
,

93 
fûe
->
∑ge_¥obes_hash_bôs
)]);

94 
	}
}

96 
s•t_∑ge
 *
	$s•t_föd_∑ge
(
s•t_fûe
 *
fûe
, 
off£t
)

98 
hli°_hód
 *
hód
;

99 
s•t_∑ge
 *
∑ge
;

100 
	`DECLARE_NODE_PTR_FOR_HLIST
(
node
);

102 
hód
 = &
fûe
->
∑ge_¥obes_èbÀ
[
	`hash_±r
((*)
off£t
, fûe->
∑ge_¥obes_hash_bôs
)];

103 
	`sw≠_hli°_f‹_óch_íåy
(
∑ge
, 
node
, 
hód
, 
hli°
) {

104 i‡(
∑ge
->
off£t
 == offset) {

105  
∑ge
;

109  
NULL
;

110 
	}
}

112 
s•t_∑ge
 *
	$s•t_föd_∑ge_‹_√w
(
s•t_fûe
 *
fûe
, 
off£t
)

114 
s•t_∑ge
 *
∑ge
 = 
	`s•t_föd_∑ge
(
fûe
, 
off£t
);

116 i‡(
∑ge
 =
NULL
) {

117 
∑ge
 = 
	`s•t_∑ge_¸óã
(
off£t
);

118 
	`s•t_add_∑ge
(
fûe
, 
∑ge
);

121  
∑ge
;

122 
	}
}

124 
s•t_∑ge
 *
	$s•t_föd_∑ge_m≠≥d
(
s•t_fûe
 *
fûe
, 
∑ge
)

126 
off£t
;

128 i‡(
fûe
->
vm_°¨t
 > 
∑ge
 || fûe->
vm_íd
 <Öage) {

130 
	`¥ötk
("ERROR: file_p[vm_start..vm_end] <>Öage: file_p[vm_start=%lx, vm_end=%lx, d_iname=%s]Öage=%lx\n",

131 
fûe
->
vm_°¨t
, fûe->
vm_íd
, fûe->
díåy
->
d_öame
, 
∑ge
);

132  
NULL
;

135 
off£t
 = 
∑ge
 - 
fûe
->
vm_°¨t
;

137  
	`s•t_föd_∑ge
(
fûe
, 
off£t
);

138 
	}
}

140 
	$s•t_fûe_add_ù
(
s•t_fûe
 *
fûe
, 
off£t
,

141 c⁄° *
¨gs
, 
ªt_ty≥
)

143 
s•t_∑ge
 *
∑ge
 = 
	`s•t_föd_∑ge_‹_√w
(
fûe
, 
off£t
 & 
PAGE_MASK
);

146 
us_ù
 *
ù
 = 
	`¸óã_ù
(
off£t
, 
¨gs
, 
ªt_ty≥
);

148 
	`s•t_add_ù
(
∑ge
, 
ù
);

149 
	}
}

151 
s•t_∑ge
 *
	$s•t_gë_∑ge
(
s•t_fûe
 *
fûe
, 
off£t_addr
)

153 
off£t
 = 
off£t_addr
 & 
PAGE_MASK
;

154 
s•t_∑ge
 *
∑ge
 = 
	`s•t_föd_∑ge_‹_√w
(
fûe
, 
off£t
);

156 
	`•ö_lock
(&
∑ge
->
lock
);

158  
∑ge
;

159 
	}
}

161 
	$s•t_put_∑ge
(
s•t_∑ge
 *
∑ge
)

163 
	`•ö_u∆ock
(&
∑ge
->
lock
);

164 
	}
}

166 
	$s•t_fûe_check_ö°Æl_∑ges
(
s•t_fûe
 *
fûe
)

168 
i
, 
èbÀ_size
;

169 
s•t_∑ge
 *
∑ge
;

170 
hli°_hód
 *
hód
;

171 
hli°_node
 *
tmp
;

172 
	`DECLARE_NODE_PTR_FOR_HLIST
(
node
);

174 
èbÀ_size
 = (1 << 
fûe
->
∑ge_¥obes_hash_bôs
);

175 
i
 = 0; i < 
èbÀ_size
; ++i) {

176 
hód
 = &
fûe
->
∑ge_¥obes_èbÀ
[
i
];

177 
	`sw≠_hli°_f‹_óch_íåy_ß„
(
∑ge
, 
node
, 
tmp
, 
hód
, 
hli°
) {

178 i‡(
	`s•t_∑ge_is_ö°ÆÀd
(
∑ge
)) {

185 
	}
}

187 
	$s•t_fûe_ö°Æl
(
s•t_fûe
 *
fûe
)

189 
s•t_∑ge
 *
∑ge
 = 
NULL
;

190 
hli°_hód
 *
hód
 = 
NULL
;

191 
i
, 
èbÀ_size
 = (1 << 
fûe
->
∑ge_¥obes_hash_bôs
);

192 
∑ge_addr
;

193 
mm_°ru˘
 *
mm
;

194 
	`DECLARE_NODE_PTR_FOR_HLIST
(
node
);

196 
i
 = 0; i < 
èbÀ_size
; ++i) {

197 
hód
 = &
fûe
->
∑ge_¥obes_èbÀ
[
i
];

198 
	`sw≠_hli°_f‹_óch_íåy_rcu
(
∑ge
, 
node
, 
hód
, 
hli°
) {

199 
∑ge_addr
 = 
fûe
->
vm_°¨t
 + 
∑ge
->
off£t
;

200 i‡(
∑ge_addr
 < 
fûe
->
vm_°¨t
 ||

201 
∑ge_addr
 >
fûe
->
vm_íd
)

204 
mm
 = 
∑ge
->
fûe
->
¥oc
->
èsk
->mm;

205 i‡(
	`∑ge_¥e£¡
(
mm
, 
∑ge_addr
))

206 
	`s•t_ªgi°î_∑ge
(
∑ge
, 
fûe
);

209 
	}
}

211 
	$s•t_fûe_unö°Æl
(
s•t_fûe
 *
fûe
, 
èsk_°ru˘
 *
èsk
, 
US_FLAGS
 
Êag
)

213 
i
, 
îr
 = 0;

214 
èbÀ_size
 = (1 << 
fûe
->
∑ge_¥obes_hash_bôs
);

215 
s•t_∑ge
 *
∑ge
;

216 
hli°_hód
 *
hód
;

217 
hli°_node
 *
tmp
;

218 
	`DECLARE_NODE_PTR_FOR_HLIST
(
node
);

220 
i
 = 0; i < 
èbÀ_size
; ++i) {

221 
hód
 = &
fûe
->
∑ge_¥obes_èbÀ
[
i
];

222 
	`sw≠_hli°_f‹_óch_íåy_ß„
 (
∑ge
, 
node
, 
tmp
, 
hód
, 
hli°
) {

223 
îr
 = 
	`s•t_uƒegi°î_∑ge
(
∑ge
, 
Êag
, 
èsk
);

224 i‡(
îr
 != 0) {

225 
	`¥ötk
("ERROR s•t_fûe_unö°Æl:Éº=%d\n", 
îr
);

226  
îr
;

231 i‡(
Êag
 !
US_DISARM
) {

232 
fûe
->
lﬂded
 = 0;

235  
îr
;

236 
	}
}

238 
	$s•t_fûe_£t_m≠pög
(
s•t_fûe
 *
fûe
, 
vm_¨ó_°ru˘
 *
vma
)

240 
fûe
->
vm_°¨t
 = 
vma
->vm_start;

241 
fûe
->
vm_íd
 = 
vma
->vm_end;

246 
	}
}

	@us_manager/sspt/sspt_file.h

1 #i‚de‡
__SSPT_FILE__


2 
	#__SSPT_FILE__


	)

28 
	~"ù.h
"

29 
	~<löux/ty≥s.h
>

31 
	gUS_FLAGS
;

32 
	gvm_¨ó_°ru˘
;

34 
	ss•t_fûe
 {

35 
li°_hód
 
	mli°
;

36 
s•t_¥oc
 *
	m¥oc
;

37 
díåy
 *
	mdíåy
;

38 
	mlﬂded
;

39 
	mvm_°¨t
;

40 
	mvm_íd
;

42 
	m∑ge_¥obes_hash_bôs
;

43 
hli°_hód
 *
	m∑ge_¥obes_èbÀ
;

47 
s•t_fûe
 *
s•t_fûe_¸óã
(
díåy
 *díåy, 
∑ge_˙t
);

48 
s•t_fûe_‰ì
(
s•t_fûe
 *
fûe
);

50 
s•t_∑ge
 *
s•t_föd_∑ge_m≠≥d
(
s•t_fûe
 *
fûe
,

51 
∑ge
);

52 
s•t_fûe_add_ù
(
s•t_fûe
 *
fûe
, 
off£t
,

53 c⁄° *
¨gs
, 
ªt_ty≥
);

55 
s•t_∑ge
 *
s•t_gë_∑ge
(
s•t_fûe
 *
fûe
, 
off£t_addr
);

56 
s•t_put_∑ge
(
s•t_∑ge
 *
∑ge
);

58 
s•t_fûe_check_ö°Æl_∑ges
(
s•t_fûe
 *
fûe
);

59 
s•t_fûe_ö°Æl
(
s•t_fûe
 *
fûe
);

60 
s•t_fûe_unö°Æl
(
s•t_fûe
 *
fûe
, 
èsk_°ru˘
 *
èsk
, 
US_FLAGS
 
Êag
);

61 
s•t_fûe_£t_m≠pög
(
s•t_fûe
 *
fûe
, 
vm_¨ó_°ru˘
 *
vma
);

	@us_manager/sspt/sspt_page.c

25 
	~"s•t.h
"

26 
	~"s•t_∑ge.h
"

27 
	~"s•t_fûe.h
"

28 
	~"ù.h
"

29 
	~<löux/¶ab.h
>

30 
	~<löux/li°.h
>

32 
s•t_∑ge
 *
	$s•t_∑ge_¸óã
(
off£t
)

34 
s•t_∑ge
 *
obj
 = 
	`kmÆloc
((*obj), 
GFP_ATOMIC
);

35 i‡(
obj
) {

36 
	`INIT_LIST_HEAD
(&
obj
->
ù_li°_ö°
);

37 
	`INIT_LIST_HEAD
(&
obj
->
ù_li°_no_ö°
);

38 
obj
->
off£t
 = offset;

39 
	`•ö_lock_öô
(&
obj
->
lock
);

40 
obj
->
fûe
 = 
NULL
;

41 
	`INIT_HLIST_NODE
(&
obj
->
hli°
);

44  
obj
;

45 
	}
}

47 
	$s•t_∑ge_‰ì
(
s•t_∑ge
 *
∑ge
)

49 
us_ù
 *
ù
, *
n
;

51 
	`li°_f‹_óch_íåy_ß„
(
ù
, 
n
, &
∑ge
->
ù_li°_ö°
, 
li°
) {

52 
	`li°_dñ
(&
ù
->
li°
);

53 
	`‰ì_ù
(
ù
);

56 
	`li°_f‹_óch_íåy_ß„
(
ù
, 
n
, &
∑ge
->
ù_li°_no_ö°
, 
li°
) {

57 
	`li°_dñ
(&
ù
->
li°
);

58 
	`‰ì_ù
(
ù
);

61 
	`k‰ì
(
∑ge
);

62 
	}
}

64 
	$s•t_li°_add_ù
(
s•t_∑ge
 *
∑ge
, 
us_ù
 *
ù
)

66 
	`li°_add
(&
ù
->
li°
, &
∑ge
->
ù_li°_no_ö°
);

67 
ù
->
∑ge
 =Öage;

68 
	}
}

70 
	$s•t_li°_dñ_ù
(
us_ù
 *
ù
)

72 
	`li°_dñ
(&
ù
->
li°
);

73 
	}
}

75 
	$s•t_add_ù
(
s•t_∑ge
 *
∑ge
, 
us_ù
 *
ù
)

77 
ù
->
off£t
 &~
PAGE_MASK
;

79 
	`s•t_li°_add_ù
(
∑ge
, 
ù
);

80 
	}
}

82 
	$s•t_dñ_ù
(
us_ù
 *
ù
)

84 
	`s•t_li°_dñ_ù
(
ù
);

85 
	`‰ì_ù
(
ù
);

86 
	}
}

88 
	$s•t_∑ge_is_ö°ÆÀd
(
s•t_∑ge
 *
∑ge
)

90 
em±y
;

92 
	`•ö_lock
(&
∑ge
->
lock
);

93 
em±y
 = 
	`li°_em±y
(&
∑ge
->
ù_li°_ö°
);

94 
	`•ö_u∆ock
(&
∑ge
->
lock
);

96  !
em±y
;

97 
	}
}

99 
	$s•t_ªgi°î_∑ge
(
s•t_∑ge
 *
∑ge
, 
s•t_fûe
 *
fûe
)

101 
îr
 = 0;

102 
us_ù
 *
ù
, *
n
;

103 
li°_hód
 
ù_li°_tmp
;

104 
addr
;

106 
	`•ö_lock
(&
∑ge
->
lock
);

107 i‡(
	`li°_em±y
(&
∑ge
->
ù_li°_no_ö°
)) {

108 
èsk_°ru˘
 *
èsk
 = 
∑ge
->
fûe
->
¥oc
->task;

110 
	`¥ötk
("page %lx in %sÅask[tgid=%u,Öid=%u]álready installed\n",

111 
∑ge
->
off£t
, 
fûe
->
díåy
->
d_öame
, 
èsk
->
tgid
,Åask->
pid
);

112 
u∆ock
;

115 
	`INIT_LIST_HEAD
(&
ù_li°_tmp
);

116 
	`li°_ª∂a˚_öô
(&
∑ge
->
ù_li°_no_ö°
, &
ù_li°_tmp
);

117 
	`•ö_u∆ock
(&
∑ge
->
lock
);

119 
	`li°_f‹_óch_íåy_ß„
(
ù
, 
n
, &
ù_li°_tmp
, 
li°
) {

121 
addr
 = 
fûe
->
vm_°¨t
 + 
∑ge
->
off£t
 + 
ù
->offset;

123 
ù
->
‹ig_addr
 = 
addr
;

124 
ù
->
ªçrobe
.
up
.
kp
.
addr
 = (
k¥obe_›code_t
 *)addr;

126 
îr
 = 
	`s•t_ªgi°î_u•robe
(
ù
);

127 i‡(
îr
 =-
ENOEXEC
) {

129 
	`li°_dñ
(&
ù
->
li°
);

130 
	`‰ì_ù
(
ù
);

132 } i‡(
îr
) {

133 
	`¥ötk
("FailedÅo installÖrobe\n");

137 
	`•ö_lock
(&
∑ge
->
lock
);

138 
	`li°_•li˚
(&
ù_li°_tmp
, &
∑ge
->
ù_li°_ö°
);

140 
u∆ock
:

141 
	`•ö_u∆ock
(&
∑ge
->
lock
);

144 
	}
}

146 
	$s•t_uƒegi°î_∑ge
(
s•t_∑ge
 *
∑ge
,

147 
US_FLAGS
 
Êag
,

148 
èsk_°ru˘
 *
èsk
)

150 
îr
 = 0;

151 
us_ù
 *
ù
;

152 
li°_hód
 
ù_li°_tmp
, *
hód
;

154 
	`•ö_lock
(&
∑ge
->
lock
);

155 i‡(
	`li°_em±y
(&
∑ge
->
ù_li°_ö°
)) {

156 
	`•ö_u∆ock
(&
∑ge
->
lock
);

160 
	`INIT_LIST_HEAD
(&
ù_li°_tmp
);

161 
	`li°_ª∂a˚_öô
(&
∑ge
->
ù_li°_ö°
, &
ù_li°_tmp
);

163 
	`•ö_u∆ock
(&
∑ge
->
lock
);

165 
	`li°_f‹_óch_íåy
(
ù
, &
ù_li°_tmp
, 
li°
) {

166 
îr
 = 
	`s•t_uƒegi°î_u•robe
(
èsk
, 
ù
, 
Êag
);

167 i‡(
îr
 != 0) {

173 
hód
 = (
Êag
 =
US_DISARM
Ë? &
∑ge
->
ù_li°_ö°
 : &∑ge->
ù_li°_no_ö°
;

175 
	`•ö_lock
(&
∑ge
->
lock
);

177 
	`li°_•li˚
(&
ù_li°_tmp
, 
hód
);

178 
	`•ö_u∆ock
(&
∑ge
->
lock
);

180  
îr
;

181 
	}
}

	@us_manager/sspt/sspt_page.h

1 #i‚de‡
__SSPT_PAGE__


2 
	#__SSPT_PAGE__


	)

28 
	~<löux/ty≥s.h
>

29 
	~<löux/•ölock.h
>

31 
	gus_ù
;

32 
	gs•t_fûe
;

33 
	gèsk_°ru˘
;

34 
	gUS_FLAGS
;

36 
	ss•t_∑ge
 {

37 
li°_hód
 
	mù_li°_ö°
;

38 
li°_hód
 
	mù_li°_no_ö°
;

39 
	moff£t
;

40 
•ölock_t
 
	mlock
;

42 
s•t_fûe
 *
	mfûe
;

43 
hli°_node
 
	mhli°
;

46 
s•t_∑ge
 *
s•t_∑ge_¸óã
(
off£t
);

47 
s•t_∑ge_‰ì
(
s•t_∑ge
 *
∑ge
);

49 
s•t_add_ù
(
s•t_∑ge
 *
∑ge
, 
us_ù
 *
ù
);

50 
s•t_dñ_ù
(
us_ù
 *
ù
);

52 
s•t_∑ge_is_ö°ÆÀd
(
s•t_∑ge
 *
∑ge
);

54 
s•t_ªgi°î_∑ge
(
s•t_∑ge
 *
∑ge
, 
s•t_fûe
 *
fûe
);

56 
s•t_uƒegi°î_∑ge
(
s•t_∑ge
 *
∑ge
,

57 
US_FLAGS
 
Êag
,

58 
èsk_°ru˘
 *
èsk
);

	@us_manager/sspt/sspt_proc.c

25 
	~"s•t.h
"

26 
	~"s•t_¥oc.h
"

27 
	~"s•t_∑ge.h
"

28 
	~"s•t_„©uª.h
"

29 
	~<löux/moduÀ.h
>

30 
	~<löux/¶ab.h
>

31 
	~<löux/li°.h
>

32 
	~<us_m™agî/us_¶Ÿ_m™agî.h
>

33 
	~<wrôî/sw≠_wrôî_moduÀ.h
>

35 
	#mm_ªad_lock
(
èsk
, 
mm
, 
©omic
, 
lock
) \

36 
mm
 = 
©omic
 ? 
èsk
->
a˘ive_mm
 : 
	`gë_èsk_mm
(task); \

37 i‡(
mm
 =
NULL
) { \

39 
	`∑nic
("ERRR mm_read_lock: mm == NULL\n"); \

42 i‡(
©omic
) { \

43 
lock
 = 
	`down_ªad_åylock
(&
mm
->
mm≠_£m
); \

45 
lock
 = 1; \

46 
	`down_ªad
(&
mm
->
mm≠_£m
); \

47 }

	)

49 
	#mm_ªad_u∆ock
(
mm
, 
©omic
, 
lock
) \

50 i‡(
lock
) { \

51 
	`up_ªad
(&
mm
->
mm≠_£m
); \

54 i‡(!
©omic
) { \

55 
	`mmput
(
mm
); \

56 }

	)

58 
LIST_HEAD
(
¥oc_¥obes_li°
);

59 
DEFINE_SPINLOCK
(
¥oc_lock
);

61 
s•t_¥oc
 *
	$s•t_¥oc_¸óã
(
èsk_°ru˘
 *
èsk
, *
¥iv
)

63 
s•t_¥oc
 *
¥oc
 = 
	`kmÆloc
((*¥oc), 
GFP_ATOMIC
);

65 i‡(
¥oc
) {

66 
¥oc
->
„©uª
 = 
	`s•t_¸óã_„©uª
();

67 i‡(
¥oc
->
„©uª
 =
NULL
) {

68 
	`k‰ì
(
¥oc
);

69  
NULL
;

72 
	`INIT_LIST_HEAD
(&
¥oc
->
li°
);

73 
¥oc
->
tgid
 = 
èsk
->tgid;

74 
¥oc
->
èsk
 =Åask->
group_Àadî
;

75 
¥oc
->
sm
 = 
	`¸óã_sm_us
(
èsk
);

76 
¥oc
->
fú°_ö°Æl
 = 0;

77 
	`INIT_LIST_HEAD
(&
¥oc
->
fûe_li°
);

80 
	`li°_add
(&
¥oc
->
li°
, &
¥oc_¥obes_li°
);

83  
¥oc
;

84 
	}
}

86 
	$s•t_¥oc_‰ì
(
s•t_¥oc
 *
¥oc
)

88 
s•t_fûe
 *
fûe
, *
n
;

91 
	`•ö_lock
(&
¥oc_lock
);

92 
	`li°_dñ
(&
¥oc
->
li°
);

93 
	`•ö_u∆ock
(&
¥oc_lock
);

95 
	`li°_f‹_óch_íåy_ß„
(
fûe
, 
n
, &
¥oc
->
fûe_li°
, 
li°
) {

96 
	`li°_dñ
(&
fûe
->
li°
);

97 
	`s•t_fûe_‰ì
(
fûe
);

100 
	`s•t_de°roy_„©uª
(
¥oc
->
„©uª
);

102 
	`ãrmö©e_msg
(
¥oc
->
èsk
);

103 
	`k‰ì
(
¥oc
);

104 
	}
}

106 
s•t_¥oc
 *
	$s•t_¥oc_gë_by_èsk
(
èsk_°ru˘
 *
èsk
)

108 
s•t_¥oc
 *
¥oc
, *
tmp
;

110 
	`li°_f‹_óch_íåy_ß„
(
¥oc
, 
tmp
, &
¥oc_¥obes_li°
, 
li°
) {

111 i‡(
¥oc
->
tgid
 =
èsk
->tgid) {

112  
¥oc
;

116  
NULL
;

117 
	}
}

118 
EXPORT_SYMBOL_GPL
(
s•t_¥oc_gë_by_èsk
);

120 
⁄_óch_¥oc_no_lock
((*
func
)(
s•t_¥oc
 *, *), *
d©a
)

122 
s•t_¥oc
 *
¥oc
, *
tmp
;

124 
	`li°_f‹_óch_íåy_ß„
(
¥oc
, 
tmp
, &
¥oc_¥obes_li°
, 
li°
) {

125 
	`func
(
¥oc
, 
d©a
);

127 
	}
}

129 
⁄_óch_¥oc
((*
func
)(
s•t_¥oc
 *, *), *
d©a
)

131 
	`•ö_lock
(&
¥oc_lock
);

132 
	`⁄_óch_¥oc_no_lock
(
func
, 
d©a
);

133 
	`•ö_u∆ock
(&
¥oc_lock
);

134 
	}
}

135 
EXPORT_SYMBOL_GPL
(
⁄_óch_¥oc
);

137 
	$waô_¥oc_lock
()

139 
	`•ö_lock
(&
¥oc_lock
);

140 
	`•ö_u∆ock
(&
¥oc_lock
);

141 
	}
}

143 
s•t_¥oc
 *
	$s•t_¥oc_gë_by_èsk_‹_√w
(
èsk_°ru˘
 *
èsk
,

144 *
¥iv
)

146 
s•t_¥oc
 *
¥oc
 = 
	`s•t_¥oc_gë_by_èsk
(
èsk
);

147 i‡(
¥oc
 =
NULL
) {

148 
¥oc
 = 
	`s•t_¥oc_¸óã
(
èsk
, 
¥iv
);

151  
¥oc
;

152 
	}
}

154 
	$s•t_¥oc_‰ì_Æl
()

156 
s•t_¥oc
 *
¥oc
, *
n
;

157 
	`li°_f‹_óch_íåy_ß„
(
¥oc
, 
n
, &
¥oc_¥obes_li°
, 
li°
) {

158 
	`s•t_¥oc_‰ì
(
¥oc
);

160 
	}
}

162 
	$s•t_¥oc_add_fûe
(
s•t_¥oc
 *
¥oc
, 
s•t_fûe
 *
fûe
)

164 
	`li°_add
(&
fûe
->
li°
, &
¥oc
->
fûe_li°
);

165 
fûe
->
¥oc
 =Öroc;

166 
	}
}

168 
s•t_fûe
 *
	$s•t_¥oc_föd_fûe_‹_√w
(
s•t_¥oc
 *
¥oc
,

169 
díåy
 *dentry)

171 
s•t_fûe
 *
fûe
;

173 
fûe
 = 
	`s•t_¥oc_föd_fûe
(
¥oc
, 
díåy
);

174 i‡(
fûe
 =
NULL
) {

175 
fûe
 = 
	`s•t_fûe_¸óã
(
díåy
, 10);

176 
	`s•t_¥oc_add_fûe
(
¥oc
, 
fûe
);

179  
fûe
;

180 
	}
}

182 
s•t_fûe
 *
	$s•t_¥oc_föd_fûe
(
s•t_¥oc
 *
¥oc
, 
díåy
 *dentry)

184 
s•t_fûe
 *
fûe
;

186 
	`li°_f‹_óch_íåy
(
fûe
, &
¥oc
->
fûe_li°
, 
li°
) {

187 i‡(
díåy
 =
fûe
->dentry) {

188  
fûe
;

192  
NULL
;

193 
	}
}

195 
	$s•t_¥oc_ö°Æl_∑ge
(
s•t_¥oc
 *
¥oc
, 
∑ge_addr
)

197 
lock
, 
©omic
;

198 
mm_°ru˘
 *
mm
;

199 
vm_¨ó_°ru˘
 *
vma
;

200 
èsk_°ru˘
 *
èsk
 = 
¥oc
->task;

202 
©omic
 = 
	`ö_©omic
();

203 
	`mm_ªad_lock
(
èsk
, 
mm
, 
©omic
, 
lock
);

205 
vma
 = 
	`föd_vma
(
mm
, 
∑ge_addr
);

206 i‡(
vma
 && 
	`check_vma
(vma)) {

207 
díåy
 *díåy = 
vma
->
vm_fûe
->
f_díåy
;

208 
s•t_fûe
 *
fûe
 = 
	`s•t_¥oc_föd_fûe
(
¥oc
, 
díåy
);

209 i‡(
fûe
) {

210 
s•t_∑ge
 *
∑ge
;

211 i‡(!
fûe
->
lﬂded
) {

212 
	`s•t_fûe_£t_m≠pög
(
fûe
, 
vma
);

213 
fûe
->
lﬂded
 = 1;

216 
∑ge
 = 
	`s•t_föd_∑ge_m≠≥d
(
fûe
, 
∑ge_addr
);

217 i‡(
∑ge
) {

218 
	`s•t_ªgi°î_∑ge
(
∑ge
, 
fûe
);

223 
	`mm_ªad_u∆ock
(
mm
, 
©omic
, 
lock
);

224 
	}
}

226 
	$s•t_¥oc_ö°Æl
(
s•t_¥oc
 *
¥oc
)

228 
lock
, 
©omic
;

229 
vm_¨ó_°ru˘
 *
vma
;

230 
èsk_°ru˘
 *
èsk
 = 
¥oc
->task;

231 
mm_°ru˘
 *
mm
;

233 
¥oc
->
fú°_ö°Æl
 = 1;

235 
©omic
 = 
	`ö_©omic
();

236 
	`mm_ªad_lock
(
èsk
, 
mm
, 
©omic
, 
lock
);

238 
vma
 = 
mm
->
mm≠
; vma; vm®vma->
vm_√xt
) {

239 i‡(
	`check_vma
(
vma
)) {

240 
díåy
 *díåy = 
vma
->
vm_fûe
->
f_díåy
;

241 
s•t_fûe
 *
fûe
 = 
	`s•t_¥oc_föd_fûe
(
¥oc
, 
díåy
);

242 i‡(
fûe
) {

243 i‡(!
fûe
->
lﬂded
) {

244 
fûe
->
lﬂded
 = 1;

245 
	`s•t_fûe_£t_m≠pög
(
fûe
, 
vma
);

248 
	`s•t_fûe_ö°Æl
(
fûe
);

253 
	`mm_ªad_u∆ock
(
mm
, 
©omic
, 
lock
);

254 
	}
}

256 
	$s•t_¥oc_unö°Æl
(
s•t_¥oc
 *
¥oc
, 
èsk_°ru˘
 *
èsk
, 
US_FLAGS
 
Êag
)

258 
îr
 = 0;

259 
s•t_fûe
 *
fûe
;

261 
	`li°_f‹_óch_íåy_rcu
(
fûe
, &
¥oc
->
fûe_li°
, 
li°
) {

262 
îr
 = 
	`s•t_fûe_unö°Æl
(
fûe
, 
èsk
, 
Êag
);

263 i‡(
îr
 != 0) {

264 
	`¥ötk
("ERROR s•t_¥oc_unö°Æl:Éº=%d\n", 
îr
);

265  
îr
;

269  
îr
;

270 
	}
}

272 
	$öãr£˘i⁄
(
°¨t_a
, 
íd_a
,

273 
°¨t_b
, 
íd_b
)

275  
°¨t_a
 < 
°¨t_b
 ?

276 
íd_a
 > 
°¨t_b
 :

277 
°¨t_a
 < 
íd_b
;

278 
	}
}

280 
	$s•t_¥oc_gë_fûes_by_ªgi⁄
(
s•t_¥oc
 *
¥oc
,

281 
li°_hód
 *
hód
,

282 
°¨t
, 
size_t
 
Àn
)

284 
ªt
 = 0;

285 
s•t_fûe
 *
fûe
, *
n
;

286 
íd
 = 
°¨t
 + 
Àn
;

288 
	`li°_f‹_óch_íåy_ß„
(
fûe
, 
n
, &
¥oc
->
fûe_li°
, 
li°
) {

289 i‡(
	`öãr£˘i⁄
(
fûe
->
vm_°¨t
, fûe->
vm_íd
, 
°¨t
, 
íd
)) {

290 
ªt
 = 1;

291 
	`li°_move
(&
fûe
->
li°
, 
hód
);

295  
ªt
;

296 
	}
}

298 
	$s•t_¥oc_ö£π_fûes
(
s•t_¥oc
 *
¥oc
, 
li°_hód
 *
hód
)

300 
	`li°_•li˚
(
hód
, &
¥oc
->
fûe_li°
);

301 
	}
}

	@us_manager/sspt/sspt_proc.h

1 #i‚de‡
__SSPT_PROC__


2 
	#__SSPT_PROC__


	)

28 
	~<löux/ty≥s.h
>

29 
	~"s•t_fûe.h
"

31 
	g¶Ÿ_m™agî
;

32 
	gèsk_°ru˘
;

34 
	eUS_FLAGS
 {

35 
	mUS_UNREGS_PROBE
,

36 
	mUS_DISARM
,

37 
	mUS_UNINSTALL


40 
	ss•t_¥oc
 {

41 
li°_hód
 
	mli°
;

42 
pid_t
 
	mtgid
;

43 
èsk_°ru˘
 *
	mèsk
;

44 
¶Ÿ_m™agî
 *
	msm
;

45 
li°_hód
 
	mfûe_li°
;

46 
	mfú°_ö°Æl
:1;

47 
s•t_„©uª
 *
	m„©uª
;

51 
s•t_¥oc
 *
s•t_¥oc_¸óã
(
èsk_°ru˘
 *
èsk
, *
¥iv
);

52 
s•t_¥oc_‰ì
(
s•t_¥oc
 *
¥oc
);

54 
⁄_óch_¥oc_no_lock
((*
func
)(
s•t_¥oc
 *, *),

55 *
d©a
);

56 
	`⁄_óch_¥oc
((*
func
)(
s•t_¥oc
 *, *), *
d©a
);

57 
	`waô_¥oc_lock
();

59 
s•t_¥oc
 *
	`s•t_¥oc_gë_by_èsk
(
èsk_°ru˘
 *
èsk
);

60 
s•t_¥oc
 *
	`s•t_¥oc_gë_by_èsk_‹_√w
(
èsk_°ru˘
 *
èsk
,

61 *
¥iv
);

62 
	`s•t_¥oc_‰ì_Æl
();

64 
s•t_fûe
 *
	`s•t_¥oc_föd_fûe
(
s•t_¥oc
 *
¥oc
, 
díåy
 *dentry);

65 
s•t_fûe
 *
	`s•t_¥oc_föd_fûe_‹_√w
(
s•t_¥oc
 *
¥oc
,

66 
díåy
 *dentry);

68 
	`s•t_¥oc_ö°Æl_∑ge
(
s•t_¥oc
 *
¥oc
, 
∑ge_addr
);

69 
	`s•t_¥oc_ö°Æl
(
s•t_¥oc
 *
¥oc
);

70 
	`s•t_¥oc_unö°Æl
(
s•t_¥oc
 *
¥oc
, 
èsk_°ru˘
 *
èsk
, 
US_FLAGS
 
Êag
);

72 
	`s•t_¥oc_gë_fûes_by_ªgi⁄
(
s•t_¥oc
 *
¥oc
,

73 
li°_hód
 *
hód
,

74 
°¨t
, 
size_t
 
Àn
);

75 
	`s•t_¥oc_ö£π_fûes
(
s•t_¥oc
 *
¥oc
, 
li°_hód
 *
hód
);

	@us_manager/swap_us_manager.mod.c

1 
	~<löux/moduÀ.h
>

2 
	~<löux/vîmagic.h
>

3 
	~<löux/compûî.h
>

5 
MODULE_INFO
(
vîmagic
, 
VERMAGIC_STRING
);

7 
moduÀ
 
__this_moduÀ


8 
__©åibuã__
((
£˘i⁄
(".gnu.linkonce.this_module"))) = {

9 .
«me
 = 
KBUILD_MODNAME
,

10 .
	göô
 = 
öô_moduÀ
,

11 #ifde‡
CONFIG_MODULE_UNLOAD


12 .
	gexô
 = 
˛ónup_moduÀ
,

14 .
	g¨ch
 = 
MODULE_ARCH_INIT
,

17 c⁄° 
	g__moduÀ_dïíds
[]

18 
__u£d


19 
__©åibuã__
((
£˘i⁄
(".modinfo"))) =

23 
MODULE_INFO
(
§cvîsi⁄
, "45D4E47E9616BB2B061FD20");

	@us_manager/us_manager.c

25 
	~<löux/moduÀ.h
>

26 
	~<löux/muãx.h
>

27 
	~"pf/pf_group.h
"

28 
	~"s•t/s•t_¥oc.h
"

29 
	~"hñ≥r.h
"

30 
	~"us_m™agî.h
"

31 
	~"debugfs_us_m™agî.h
"

33 
	~<wrôî/evít_fûãr.h
>

36 
	~<wrôî/sw≠_wrôî_moduÀ.h
>

40 
DEFINE_MUTEX
(
muãx_ö°
);

41 
°©us_ty≥
 
	g°©us
 = 
ST_OFF
;

44 
	$do_usm_°›
()

46 
	`uƒegi°î_hñ≥r
();

47 
	`unö°Æl_Æl
();

48 
	`s•t_¥oc_‰ì_Æl
();

49 
	}
}

51 
	$do_usm_°¨t
()

53 
ªt
;

55 
ªt
 = 
	`ªgi°î_hñ≥r
();

56 i‡(
ªt
)

57  
ªt
;

59 
	`ö°Æl_Æl
();

62 
	}
}

64 
°©us_ty≥
 
	$usm_gë_°©us
()

66 
	`muãx_lock
(&
muãx_ö°
);

67  
°©us
;

68 
	}
}

69 
EXPORT_SYMBOL_GPL
(
usm_gë_°©us
);

71 
	$usm_put_°©us
(
°©us_ty≥
 
°
)

73 
°©us
 = 
°
;

74 
	`muãx_u∆ock
(&
muãx_ö°
);

75 
	}
}

76 
EXPORT_SYMBOL_GPL
(
usm_put_°©us
);

78 
	$usm_°›
()

80 
ªt
 = 0;

82 i‡(
	`usm_gë_°©us
(Ë=
ST_OFF
) {

83 
	`¥ötk
("US instrumentation isÇotÑunning!\n");

84 
ªt
 = -
EINVAL
;

85 
put
;

88 
	`do_usm_°›
();

90 
put
:

91 
	`usm_put_°©us
(
ST_OFF
);

93  
ªt
;

94 
	}
}

95 
EXPORT_SYMBOL_GPL
(
usm_°›
);

97 
	$usm_°¨t
()

99 
ªt
 = -
EINVAL
;

100 
°©us_ty≥
 
°
;

102 
°
 = 
	`usm_gë_°©us
();

103 i‡(
°
 =
ST_ON
) {

104 
	`¥ötk
("US instrumentation isálreadyÑun!\n");

105 
put
;

108 
ªt
 = 
	`do_usm_°¨t
();

109 i‡(
ªt
 == 0)

110 
°
 = 
ST_ON
;

112 
put
:

113 
	`usm_put_°©us
(
°
);

115  
ªt
;

116 
	}
}

117 
EXPORT_SYMBOL_GPL
(
usm_°¨t
);

127 
quõt_ty≥
 
	gquõt
 = 
QT_ON
;

129 
	$£t_quõt
(
quõt_ty≥
 
q
)

131 
quõt
 = 
q
;

132 
	}
}

133 
EXPORT_SYMBOL_GPL
(
£t_quõt
);

135 
quõt_ty≥
 
	$gë_quõt
()

137  
quõt
;

138 
	}
}

139 
EXPORT_SYMBOL_GPL
(
gë_quõt
);

149 
	$us_fûãr
(
èsk_°ru˘
 *
èsk
)

151  !!
	`s•t_¥oc_gë_by_èsk
(
èsk
);

152 
	}
}

154 
ev_fûãr
 
	gev_us_fûãr
 = {

155 .
«me
 = "traced_process_only",

156 .
	gfûãr
 = 
us_fûãr


159 
	$öô_us_fûãr
()

161 
ªt
;

163 
ªt
 = 
	`evít_fûãr_ªgi°î
(&
ev_us_fûãr
);

164 i‡(
ªt
)

165  
ªt
;

167  
	`evít_fûãr_£t
(
ev_us_fûãr
.
«me
);

168 
	}
}

170 
	$exô_us_fûãr
()

172 
	`evít_fûãr_uƒegi°î
(&
ev_us_fûãr
);

173 
	}
}

179 
__öô
 
	$öô_us_m™agî
()

181 
ªt
;

183 
ªt
 = 
	`öô_us_fûãr
();

184 i‡(
ªt
)

185 
us_fûãr_öô_Áû
;

187 
	`öô_msg
(32*1024);

189 
ªt
 = 
	`öô_hñ≥r
();

190 i‡(
ªt
)

191 
hñ≥r_öô_Áû
;

193 
ªt
 = 
	`öô_debugfs_us_m™agî
();

194 i‡(
ªt
)

195 
debugfs_öô_Áû
;

199 
debugfs_öô_Áû
:

200 
	`unöô_hñ≥r
();

202 
hñ≥r_öô_Áû
:

203 
	`unöô_msg
();

204 
	`exô_us_fûãr
();

206 
us_fûãr_öô_Áû
:

207  
ªt
;

208 
	}
}

210 
__exô
 
	$exô_us_m™agî
()

212 i‡(
°©us
 =
ST_ON
)

213 
	`do_usm_°›
();

215 
	`exô_debugfs_us_m™agî
();

216 
	`unöô_msg
();

217 
	`unöô_hñ≥r
();

218 
	`exô_us_fûãr
();

219 
	}
}

221 
moduÀ_öô
(
öô_us_m™agî
);

222 
moduÀ_exô
(
exô_us_m™agî
);

224 
MODULE_LICENSE
 ("GPL");

	@us_manager/us_manager.h

25 #i‚de‡
_US_MANAGER_H


26 
	#_US_MANAGER_H


	)

29 
	equõt_ty≥
 {

30 
	mQT_ON
,

31 
	mQT_OFF


34 
	e°©us_ty≥
 {

35 
	mST_OFF
,

36 
	mST_ON


39 
£t_quõt
(
quõt_ty≥
 
q
);

40 
quõt_ty≥
 
gë_quõt
();

42 
°©us_ty≥
 
usm_gë_°©us
();

43 
usm_put_°©us
(
°©us_ty≥
 
°
);

45 
usm_°¨t
();

46 
usm_°›
();

	@us_manager/us_manager_common.h

26 
	~<löux/mm.h
>

27 
	~<löux/vîsi⁄.h
>

30 
ölöe
 
	$sw≠_do_mm≠
(
fûe
 *
fûp
, 
addr
,

31 
Àn
, 
¥Ÿ
,

32 
Êag
,

33 
off£t
)

35 #i‡
LINUX_VERSION_CODE
 >
	`KERNEL_VERSION
(3, 9, 0)

36 
p›uœã
;

38  
	`do_mm≠_pgoff
(
fûp
, 
addr
, 
Àn
, 
¥Ÿ
, 
Êag
, 
off£t
, &
p›uœã
);

39 #ñi‡
LINUX_VERSION_CODE
 >
	`KERNEL_VERSION
(3, 5, 0)

40  
	`do_mm≠_pgoff
(
fûp
, 
addr
, 
Àn
, 
¥Ÿ
, 
Êag
, 
off£t
);

42  
	`do_mm≠
(
fûp
, 
addr
, 
Àn
, 
¥Ÿ
, 
Êag
, 
off£t
);

44 
	}
}

	@us_manager/us_slot_manager.c

26 
	~<löux/¶ab.h
>

27 
	~<löux/h¨dúq.h
>

28 
	~<löux/sched.h
>

29 
	~<löux/mm.h
>

30 
	~<löux/mm™.h
>

31 
	~<löux/li°.h
>

32 
	~<k¥obe/dbi_ö¢_¶Ÿs.h
>

33 
	~<k¥obe/¨ch/asm/dbi_k¥obes.h
>

34 
	~"us_m™agî_comm⁄.h
"

37 *
	$sm_Æloc_us
(
¶Ÿ_m™agî
 *
sm
)

39 
addr
;

41 
addr
 = 
	`sw≠_do_mm≠
(
NULL
, 0, 
PAGE_SIZE
, 
PROT_EXEC
|
PROT_READ
|
PROT_WRITE
,

42 
MAP_ANONYMOUS
|
MAP_PRIVATE
, 0);

43  (*)
addr
;

44 
	}
}

46 
	$sm_‰ì_us
(
¶Ÿ_m™agî
 *
sm
, *
±r
)

56 
èsk_°ru˘
 *
èsk
 = 
sm
->
d©a
;

58 
mm
 = 
	`gë_èsk_mm
(
èsk
);

59 i‡(
mm
) {

60 
	`down_wrôe
(&
mm
->
mm≠_£m
);

61 
	`do_munm≠
(
mm
, ()(
±r
), 
PAGE_SIZE
);

62 
	`up_wrôe
(&
mm
->
mm≠_£m
);

63 
	`mmput
(
mm
);

67 
	}
}

69 
¶Ÿ_m™agî
 *
	$¸óã_sm_us
(
èsk_°ru˘
 *
èsk
)

71 
¶Ÿ_m™agî
 *
sm
 = 
	`kmÆloc
((*sm), 
GFP_ATOMIC
);

72 
sm
->
¶Ÿ_size
 = 
UPROBES_TRAMP_LEN
;

73 
sm
->
Æloc
 = 
sm_Æloc_us
;

74 
sm
->
‰ì
 = 
sm_‰ì_us
;

75 
	`INIT_HLIST_HEAD
(&
sm
->
∑ge_li°
);

76 
sm
->
d©a
 = 
èsk
;

78  
sm
;

79 
	}
}

81 
	$‰ì_sm_us
(
¶Ÿ_m™agî
 *
sm
)

84 
	}
}

	@us_manager/us_slot_manager.h

26 #i‚de‡
_US_SLOT_MANAGER_H


27 
	#_US_SLOT_MANAGER_H


	)

29 
	gèsk_°ru˘
;

30 
	g¶Ÿ_m™agî
;

32 
¶Ÿ_m™agî
 *
¸óã_sm_us
(
èsk_°ru˘
 *
èsk
);

33 
‰ì_sm_us
(
¶Ÿ_m™agî
 *
sm
);

	@writer/debugfs_writer.c

26 
	~<löux/moduÀ.h
>

27 
	~<löux/debugfs.h
>

28 
	~<löux/vmÆloc.h
>

29 
	~<löux/¶ab.h
>

30 
	~<asm/uac˚ss.h
>

31 
	~<drivî/sw≠_debugfs.h
>

32 
	~"sw≠_wrôî_moduÀ.h
"

33 
	~"evít_fûãr.h
"

40 *
	gbuf
 = 
NULL
;

41 íum { 
	mbuf_size
 = 64*1024*1024 };

43 
	$öô_buf„r
()

45 
buf
 = 
	`vmÆloc
(
buf_size
);

47  
buf
 ? 0 : -
ENOMEM
;

48 
	}
}

50 
	$exô_buf„r
()

52 
	`v‰ì
(
buf
);

53 
buf
 = 
NULL
;

54 
	}
}

64 
ssize_t
 
	$wrôe_øw
(
fûe
 *fûe, c⁄° 
__u£r
 *
u£r_buf
,

65 
size_t
 
cou¡
, 
loff_t
 *
µos
)

67 i‡(
cou¡
 > 
buf_size
)

68  -
EINVAL
;

70 i‡(
	`c›y_‰om_u£r
(
buf
, 
u£r_buf
, 
cou¡
))

71  -
EFAULT
;

73  
	`øw_msg
(
buf
, 
cou¡
);

74 
	}
}

76 c⁄° 
fûe_›î©i⁄s
 
	gf›s_øw
 = {

77 .
ow√r
 = 
THIS_MODULE
,

78 .
	gwrôe
 = 
wrôe_øw
,

79 .
	gŒ£ek
 = 
deÁu…_Œ£ek


90 
	sªad_buf
 {

91 *
	mbegö
;

92 *
	m±r
;

93 *
	míd
;

96 
	$func_f‹_ªad
(
ev_fûãr
 *
f
, *
d©a
)

98 
ªad_buf
 *
rbuf
 = (ªad_bu‡*)
d©a
;

99 
Àn
 = 
	`°æí
(
f
->
«me
);

101 i‡(
rbuf
->
íd
 -Ñbuf->
±r
 < 
Àn
 + 2)

104 i‡(
rbuf
->
±r
 !rbuf->
begö
) {

105 *
rbuf
->
±r
 = ' ';

106 ++
rbuf
->
±r
;

109 
	`mem˝y
(
rbuf
->
±r
, 
f
->
«me
, 
Àn
);

110 
rbuf
->
±r
 +
Àn
;

111 
	}
}

113 
ssize_t
 
	$ªad_af
(
fûe
 *fûe, 
__u£r
 *
u£r_buf
,

114 
size_t
 
cou¡
, 
loff_t
 *
µos
)

116 
buf
[512];

117 
ªad_buf
 
rbuf
 = {

118 .
begö
 = 
buf
,

119 .
±r
 = 
buf
,

120 .
íd
 = 
buf
 + (buf)

123 
	`evít_fûãr_⁄_óch
(
func_f‹_ªad
, (*)&
rbuf
);

125 *
rbuf
.
±r
 = '\n';

126 ++
rbuf
.
±r
;

128  
	`sim∂e_ªad_‰om_buf„r
(
u£r_buf
, 
cou¡
, 
µos
,

129 
rbuf
.
begö
,Ñbuf.
±r
 -Ñbuf.begin);

130 
	}
}

132 c⁄° 
fûe_›î©i⁄s
 
	gf›s_avaûabÀ_fûãrs
 = {

133 .
ow√r
 = 
THIS_MODULE
,

134 .
	gªad
 = 
ªad_af
,

135 .
	gŒ£ek
 = 
deÁu…_Œ£ek


146 
ssize_t
 
	$ªad_fûãr
(
fûe
 *fûe, 
__u£r
 *
u£r_buf
,

147 
size_t
 
cou¡
, 
loff_t
 *
µos
)

149 c⁄° *
«me
 = 
	`evít_fûãr_gë
();

150 
Àn
 = 
	`°æí
(
«me
);

151 *
buf
;

152 
ssize_t
 
ªt
;

154 
buf
 = 
	`kmÆloc
(
Àn
 + 2, 
GFP_KERNEL
);

155 
	`mem˝y
(
buf
, 
«me
, 
Àn
);

157 
buf
[
Àn
] = '\0';

158 
buf
[
Àn
 + 1] = '\n';

160 
ªt
 = 
	`sim∂e_ªad_‰om_buf„r
(
u£r_buf
, 
cou¡
, 
µos
, 
buf
, 
Àn
 + 2);

161 
	`k‰ì
(
buf
);

163  
ªt
;

164 
	}
}

166 
ssize_t
 
	$wrôe_fûãr
(
fûe
 *fûe, c⁄° 
__u£r
 *
u£r_buf
,

167 
size_t
 
cou¡
, 
loff_t
 *
µos
)

169 íum { 
Àn
 = 32 };

170 
buf
[
Àn
], 
«me
[len];

171 
size_t
 
buf_size
;

172 
ssize_t
 
ªt
;

174 
buf_size
 = 
	`mö
(
cou¡
, (
size_t
)(
Àn
 - 1));

175 i‡(
	`c›y_‰om_u£r
(
buf
, 
u£r_buf
, 
buf_size
))

176  -
EFAULT
;

178 
buf
[
Àn
 - 1] = '\0';

179 
ªt
 = 
	`ssˇnf
(
buf
, "%31s", 
«me
);

180 i‡(
ªt
 != 1)

181  -
EINVAL
;

183 
ªt
 = 
	`evít_fûãr_£t
(
«me
);

184 i‡(
ªt
)

185  -
EINVAL
;

187  
cou¡
;

188 
	}
}

190 c⁄° 
fûe_›î©i⁄s
 
	gf›s_fûãr
 = {

191 .
ow√r
 = 
THIS_MODULE
,

192 .
	gªad
 = 
ªad_fûãr
,

193 .
	gwrôe
 = 
wrôe_fûãr
,

194 .
	gŒ£ek
 = 
deÁu…_Œ£ek


205 
díåy
 *
	gwrôî_dú
 = 
NULL
;

207 
	$exô_debugfs_wrôî
()

209 i‡(
wrôî_dú
)

210 
	`debugfs_ªmove_ªcursive
(
wrôî_dú
);

212 
wrôî_dú
 = 
NULL
;

214 
	`exô_buf„r
();

215 
	}
}

217 
	$öô_debugfs_wrôî
()

219 
ªt
;

220 
díåy
 *
sw≠_dú
, *dentry;

222 
ªt
 = 
	`öô_buf„r
();

223 i‡(
ªt
)

224  
ªt
;

226 
sw≠_dú
 = 
	`gë_sw≠_debugfs_dú
();

227 i‡(
sw≠_dú
 =
NULL
)

228  -
ENOENT
;

230 
wrôî_dú
 = 
	`debugfs_¸óã_dú
("wrôî", 
sw≠_dú
);

231 i‡(
wrôî_dú
 =
NULL
)

232  -
ENOMEM
;

234 
díåy
 = 
	`debugfs_¸óã_fûe
("øw", 0600, 
wrôî_dú
, 
NULL
, &
f›s_øw
);

235 i‡(
díåy
 =
NULL
)

236 
Áû
;

238 
díåy
 = 
	`debugfs_¸óã_fûe
("avaûabÀ_fûãrs", 0600, 
wrôî_dú
, 
NULL
, &
f›s_avaûabÀ_fûãrs
);

239 i‡(
díåy
 =
NULL
)

240 
Áû
;

242 
díåy
 = 
	`debugfs_¸óã_fûe
("fûãr", 0600, 
wrôî_dú
, 
NULL
, &
f›s_fûãr
);

243 i‡(
díåy
 =
NULL
)

244 
Áû
;

248 
Áû
:

249 
	`exô_debugfs_wrôî
();

250  -
ENOMEM
;

251 
	}
}

	@writer/debugfs_writer.h

1 #i‚de‡
_DEBUGFS_WRITER_H


2 
	#_DEBUGFS_WRITER_H


	)

28 
öô_debugfs_wrôî
();

29 
exô_debugfs_wrôî
();

	@writer/event_filter.c

26 
	~<löux/moduÀ.h
>

27 
	~<löux/li°.h
>

28 
	~"evít_fûãr.h
"

31 
LIST_HEAD
(
fûãr_li°
);

33 
	$func_n⁄e
(
èsk_°ru˘
 *
èsk
)

36 
	}
}

38 
ev_fûãr
 
	gfûãr_n⁄e
 = {

39 .
«me
 = "all",

40 .
	gfûãr
 = 
func_n⁄e


43 
ev_fûãr
 *
	gfûãr_cuºít
 = &
fûãr_n⁄e
;

45 
	$check_evít
(
èsk_°ru˘
 *
èsk
)

47  
fûãr_cuºít
->
	`fûãr
(
èsk
);

48 
	}
}

50 
ev_fûãr
 *
	$evít_fûãr_föd
(c⁄° *
«me
)

52 
ev_fûãr
 *
f
, *
tmp
;

54 
	`li°_f‹_óch_íåy_ß„
(
f
, 
tmp
, &
fûãr_li°
, 
li°
) {

55 i‡(
	`°rcmp
(
f
->
«me
,Çame) == 0)

56  
f
;

59  
NULL
;

60 
	}
}

62 
	$evít_fûãr_ªgi°î
(
ev_fûãr
 *
f
)

64 i‡(
	`evít_fûãr_föd
(
f
->
«me
))

65  -
EINVAL
;

67 
	`INIT_LIST_HEAD
(&
f
->
li°
);

68 
	`li°_add
(&
f
->
li°
, &
fûãr_li°
);

71 
	}
}

72 
EXPORT_SYMBOL_GPL
(
evít_fûãr_ªgi°î
);

74 
	$evít_fûãr_uƒegi°î
(
ev_fûãr
 *
f
)

76 
ev_fûãr
 *
fûãr
, *
tmp
;

78 i‡(
fûãr_cuºít
 =
f
)

79 
fûãr_cuºít
 = &
fûãr_n⁄e
;

81 
	`li°_f‹_óch_íåy_ß„
(
fûãr
, 
tmp
, &
fûãr_li°
, 
li°
) {

82 i‡(
fûãr
 =
f
) {

83 
	`li°_dñ
(&
fûãr
->
li°
);

87 
	}
}

88 
EXPORT_SYMBOL_GPL
(
evít_fûãr_uƒegi°î
);

90 
	$evít_fûãr_£t
(c⁄° *
«me
)

92 
ev_fûãr
 *
f
;

94 
f
 = 
	`evít_fûãr_föd
(
«me
);

95 i‡(
f
 =
NULL
)

96  -
EINVAL
;

98 
fûãr_cuºít
 = 
f
;

101 
	}
}

102 
EXPORT_SYMBOL_GPL
(
evít_fûãr_£t
);

104 c⁄° *
	$evít_fûãr_gë
()

106  
fûãr_cuºít
->
«me
;

107 
	}
}

109 
evít_fûãr_⁄_óch
((*
func
)(
ev_fûãr
 *, *),

110 *
d©a
)

112 
ev_fûãr
 *
f
, *
tmp
;

114 
	`li°_f‹_óch_íåy_ß„
(
f
, 
tmp
, &
fûãr_li°
, 
li°
)

115 
	`func
(
f
, 
d©a
);

116 
	}
}

118 
	$evít_fûãr_öô
()

120  
	`evít_fûãr_ªgi°î
(&
fûãr_n⁄e
);

121 
	}
}

123 
	$evít_fûãr_exô
()

125 
	`evít_fûãr_uƒegi°î
(&
fûãr_n⁄e
);;

126 
	}
}

	@writer/event_filter.h

1 #i‚de‡
_EVENT_FILTER_H


2 
	#_EVENT_FILTER_H


	)

29 
	~<löux/li°.h
>

31 
	gèsk_°ru˘
;

33 
	sev_fûãr
 {

34 
li°_hód
 
	mli°
;

35 *
	m«me
;

36 (*
	mfûãr
)(
	mèsk_°ru˘
 *);

40 
check_evít
(
èsk_°ru˘
 *
èsk
);

42 
evít_fûãr_ªgi°î
(
ev_fûãr
 *
f
);

43 
evít_fûãr_uƒegi°î
(
ev_fûãr
 *
f
);

44 
evít_fûãr_£t
(c⁄° *
«me
);

45 c⁄° *
evít_fûãr_gë
();

47 
evít_fûãr_⁄_óch
((*
func
)(
ev_fûãr
 *, *),

48 *
d©a
);

50 
	`evít_fûãr_öô
();

51 
	`evít_fûãr_exô
();

	@writer/kernel_operations.h

27 #i‚de‡
__KERNEL_OPERATIONS_H__


28 
	#__KERNEL_OPERATIONS_H__


	)

30 
	~<löux/kî√l.h
>

31 
	~<asm/±ø˚.h
>

35 
	#¥öt_debug
(
msg
, 
¨gs
...) \

36 
	`¥ötk
(
KERN_DEBUG
 "SWAP_WRITER DEBUG : " 
msg
, ##
¨gs
)

	)

37 
	#¥öt_msg
(
msg
, 
¨gs
...) \

38 
	`¥ötk
(
KERN_INFO
 "SWAP_WRITER : " 
msg
, ##
¨gs
)

	)

39 
	#¥öt_w¨n
(
msg
, 
¨gs
...) \

40 
	`¥ötk
(
KERN_WARNING
 "SWAP_WRITER WARNING : " 
msg
, ##
¨gs
)

	)

41 
	#¥öt_îr
(
msg
, 
¨gs
...) \

42 
	`¥ötk
(
KERN_ERR
 "SWAP_WRITER ERROR : " 
msg
, ##
¨gs
)

	)

43 
	#¥öt_¸ô
(
msg
, 
¨gs
...) \

44 
	`¥ötk
(
KERN_CRIT
 "SWAP_WRITER CRITICAL : " 
msg
, ##
¨gs
)

	)

50 #i‡
deföed
(
CONFIG_ARM
)

52 
	#gë_ªgs_ù
(
ªgs
Ëªgs->
ARM_pc


	)

53 
	#gë_ªgs_ªt_func
(
ªgs
Ëªgs->
ARM_Ã


	)

54 
	#gë_ªgs_ªt_vÆ
(
ªgs
Ëªgs->
ARM_r0


	)

55 
	#gë_ªgs_°ack_±r
(
ªgs
Ëªgs->
ARM_•


	)

57 #ñi‡
deföed
(
CONFIG_X86_32
)

59 
	#gë_ªgs_ù
(
ªgs
Ëªgs->
ù
 - 1

	)

60 
	#gë_ªgs_ªt_vÆ
(
ªgs
Ëªgs->
ax


	)

61 
	#gë_ªgs_°ack_±r
(
ªgs
Ëªgs->
•


	)

63 
ölöe
 
u32
 
	$gë_ªgs_ªt_func
(
±_ªgs
 *
ªgs
)

65 
u32
 *
•
, 
addr
 = 0;

67 i‡(
	`u£r_mode
(
ªgs
)) {

68 
•
 = (
u32
 *)
ªgs
->sp;

69 i‡(
	`gë_u£r
(
addr
, 
•
))

70 
	`¥ötk
("failedÅo dereferenceáÖointer, sp=%p, "

71 "pc=%lx\n", 
•
, 
	`gë_ªgs_ù
(
ªgs
));

73 
•
 = (
u32
 *)
	`kî√l_°ack_poöãr
(
ªgs
);

74 
addr
 = *
•
;

77  
addr
;

78 
	}
}

82 
gë_¨gs
(
¨gs
[], 
˙t
, 
±_ªgs
 *
ªgs
);

85 c⁄° *
gë_sh¨ed_kmem
(
mm_°ru˘
 *
mm
, *
°¨t
,

86 *
íd
);

	@writer/kernel_operations_arm.c

26 
	~<asm/±ø˚.h
>

27 
	~<asm/uac˚ss.h
>

28 
	~<asm/∑ge.h
>

29 
	~<löux/kî√l.h
>

30 
	~<löux/mm.h
>

31 
	~<gíî©ed/autoc⁄f.h
>

33 
	~"kî√l_›î©i⁄s.h
"

38 
	$gë_¨gs
(
¨gs
[], 
˙t
, 
±_ªgs
 *
ªgs
)

41 íum { 
°ack_¨gs
 = 4 };

42 
i
, 
¨gs_ö_ªgs
;

44 
¨gs_ö_ªgs
 = 
˙t
 < 3 ? cnt : 3;

47 
¨gs_ö_ªgs
) {

49 
¨gs
[3] = 
ªgs
->
ARM_r3
;

51 
¨gs
[2] = 
ªgs
->
ARM_r2
;

53 
¨gs
[1] = 
ªgs
->
ARM_r1
;

55 
¨gs
[0] = 
ªgs
->
ARM_r0
;

59 
i
 = 
°ack_¨gs
; i < 
˙t
; ++i) {

60 *
¨gs_ö_•
 = (*)
ªgs
->
ARM_•
 +

61 
i
 - 
°ack_¨gs
;

62 i‡(
	`gë_u£r
(
¨gs
[
i
], 
¨gs_ö_•
))

63 
	`¥ötk
("failedÅo dereferenceáÖointer,áddr=%p\n",

64 
¨gs_ö_•
);

68 
	}
}

79 c⁄° *
	$gë_sh¨ed_kmem
(
mm_°ru˘
 *
mm
, *
°¨t
,

80 *
íd
)

82 *
°¨t
 = 
CONFIG_VECTORS_BASE
;

83 *
íd
 = 
CONFIG_VECTORS_BASE
 + 
PAGE_SIZE
;

86 
	}
}

	@writer/kernel_operations_x86.c

26 
	~<asm/±ø˚.h
>

27 
	~<asm/uac˚ss.h
>

28 
	~<asm/ñf.h
>

29 
	~<löux/kî√l.h
>

30 
	~<löux/sched.h
>

31 
	~<löux/mm.h
>

33 
	~"kî√l_›î©i⁄s.h
"

38 
	$gë_¨gs
(
¨gs
[], 
˙t
, 
±_ªgs
 *
ªgs
)

40 
i
, 
°ack_¨gs
 = 0;

45 i‡(!
	`u£r_mode
(
ªgs
)) {

46 
¨gs_ö_ªgs
;

47 
¨gs_ö_ªgs
 = 
˙t
 < 5 ? cnt : 5;

48 
°ack_¨gs
 = 6;

50 
¨gs_ö_ªgs
) {

52 
¨gs
[5] = 
ªgs
->
bp
;

54 
¨gs
[4] = 
ªgs
->
di
;

56 
¨gs
[3] = 
ªgs
->
si
;

58 
¨gs
[2] = 
ªgs
->
dx
;

60 
¨gs
[1] = 
ªgs
->
cx
;

62 
¨gs
[0] = 
ªgs
->
bx
;

67 
i
 = 
°ack_¨gs
; i < 
˙t
; ++i) {

68 *
¨gs_ö_•
 = (*)
ªgs
->
•
 +

69 1 + 
i
 - 
°ack_¨gs
;

70 i‡(
	`gë_u£r
(
¨gs
[
i
], 
¨gs_ö_•
))

71 
	`¥ötk
("failedÅo dereferenceáÖointer,áddr=%p\n",

72 
¨gs_ö_•
);

76 
	}
}

81 c⁄° *
	$gë_sh¨ed_kmem
(
mm_°ru˘
 *
mm
, *
°¨t
,

82 *
íd
)

84 
vdso
;

85 
vm_¨ó_°ru˘
 *
vma_vdso
;

87 
vdso
 = ()
mm
->
c⁄ãxt
.vdso;

88 
vma_vdso
 = 
	`föd_vma_öãr£˘i⁄
(
mm
, 
vdso
, vdso + 1);

90 i‡(
vma_vdso
 =
NULL
) {

91 
	`¥öt_îr
("Cannot get VDSO mapping\n");

92  
NULL
;

95 *
°¨t
 = 
vma_vdso
->
vm_°¨t
;

96 *
íd
 = 
vma_vdso
->
vm_íd
;

99 
	}
}

	@writer/swap_writer.mod.c

1 
	~<löux/moduÀ.h
>

2 
	~<löux/vîmagic.h
>

3 
	~<löux/compûî.h
>

5 
MODULE_INFO
(
vîmagic
, 
VERMAGIC_STRING
);

7 
moduÀ
 
__this_moduÀ


8 
__©åibuã__
((
£˘i⁄
(".gnu.linkonce.this_module"))) = {

9 .
«me
 = 
KBUILD_MODNAME
,

10 .
	göô
 = 
öô_moduÀ
,

11 #ifde‡
CONFIG_MODULE_UNLOAD


12 .
	gexô
 = 
˛ónup_moduÀ
,

14 .
	g¨ch
 = 
MODULE_ARCH_INIT
,

17 c⁄° 
	g__moduÀ_dïíds
[]

18 
__u£d


19 
__©åibuã__
((
£˘i⁄
(".modinfo"))) =

23 
MODULE_INFO
(
§cvîsi⁄
, "4700BD92505F234472036A6");

	@writer/swap_writer_errors.h

26 #i‚de‡
__SWAP_WRITER_ERRORS_H__


27 
	#__SWAP_WRITER_ERRORS_H__


	)

29 
	e_sw≠_wrôî_îr‹s
 {

30 
	mE_SW_SUCCESS
 = 0

	@writer/swap_writer_module.c

26 
	~<löux/ty≥s.h
>

27 
	~<löux/î∫o.h
>

28 
	~<löux/sched.h
>

29 
	~<löux/dˇche.h
>

30 
	~<löux/mm.h
>

31 
	~<löux/mm_ty≥s.h
>

32 
	~<löux/fs.h
>

33 
	~<löux/îr.h
>

34 
	~<löux/moduÀ.h
>

35 
	~<löux/¶ab.h
>

36 
	~<asm/uac˚ss.h
>

37 
	~<k¥obe/¨ch/asm/dbi_k¥obes.h
>

38 
	~<u¥obe/¨ch/asm/sw≠_u¥obes.h
>

40 
	~<buf„r/sw≠_buf„r_moduÀ.h
>

41 
	~<buf„r/sw≠_buf„r_îr‹s.h
>

43 
	~"sw≠_wrôî_moduÀ.h
"

44 
	~"sw≠_wrôî_îr‹s.h
"

45 
	~"kî√l_›î©i⁄s.h
"

46 
	~"debugfs_wrôî.h
"

47 
	~"evít_fûãr.h
"

50 
	eMSG_ID
 {

51 
	mMSG_PROC_INFO
 = 0x0001,

52 
	mMSG_TERMINATE
 = 0x0002,

53 
	mMSG_ERROR
 = 0x0003,

54 
	mMSG_SAMPLE
 = 0x0004,

55 
	mMSG_FUNCTION_ENTRY
 = 0x0008,

56 
	mMSG_FUNCTION_EXIT
 = 0x0009,

57 
	mMSG_CONTEXT_SWITCH_ENTRY
 = 0x0010,

58 
	mMSG_CONTEXT_SWITCH_EXIT
 = 0x0011,

59 
	mMSG_PROC_MAP
 = 0x0012,

60 
	mMSG_PROC_UNMAP
 = 0x0013

63 *
	g˝u_buf
[
NR_CPUS
];

64 
u32
 
	g£q_num
 = 0;

65 
	gdisˇrded
 = 0;

67 
	$öô_msg
(
size_t
 
buf_size
)

69 
i
;

71 
i
 = 0; i < 
NR_CPUS
; ++i)

72 
˝u_buf
[
i
] = 
	`kmÆloc
(
buf_size
, 
GFP_KERNEL
);

74  
E_SW_SUCCESS
;

75 
	}
}

76 
EXPORT_SYMBOL_GPL
(
öô_msg
);

78 
	$unöô_msg
()

80 
i
;

82 
i
 = 0; i < 
NR_CPUS
; ++i)

83 
	`k‰ì
(
˝u_buf
[
i
]);

84 
	}
}

85 
EXPORT_SYMBOL_GPL
(
unöô_msg
);

87 
	$ª£t_disˇrded
()

89 
disˇrded
 = 0;

90 
	}
}

91 
EXPORT_SYMBOL_GPL
(
ª£t_disˇrded
);

93 
	$ª£t_£q_num
()

95 
£q_num
 = 0;

96 
	}
}

97 
EXPORT_SYMBOL_GPL
(
ª£t_£q_num
);

99 
	$gë_disˇrded_cou¡
()

101  
disˇrded
;

102 
	}
}

103 
EXPORT_SYMBOL_GPL
(
gë_disˇrded_cou¡
);

105 *
	$gë_cuºít_buf
()

107  
˝u_buf
[
	`smp_¥o˚ss‹_id
()];

108 
	}
}

110 
ölöe
 
u64
 
	$time•ec2time
(
time•ec
 *
ts
)

112  ((
u64
)
ts
->
tv_n£c
Ë<< 32 |Ås->
tv_£c
;

113 
	}
}

120 
	sbasic_msg_fmt
 {

121 
u32
 
	mmsg_id
;

122 
u32
 
	m£q_numbî
;

123 
u64
 
	mtime
;

124 
u32
 
	mÀn
;

125 
	m∑ylﬂd
[0];

126 } 
__©åibuã__
((
∑cked
));

129 
	$¥öt_hex
(*
±r
, 
Àn
)

131 
i
;

133 
	`¥ötk
("print_hex:\n");

134 
i
 = 0; i < 
Àn
; ++i) {

135 
	`¥ötk
("[%x] [%3d]=%2x\n", &
±r
[
i
], i,Ötr[i]);

137 
	}
}

140 
	$wrôe_to_buf„r
(*
d©a
)

142 
ªsu…
;

143 
basic_msg_fmt
 *
bmf
 = (basic_msg_fmà*)
d©a
;

145 
ªsu…
 = 
	`sw≠_buf„r_wrôe
(
bmf
, bmf->
Àn
 + (*bmf));

146 i‡(
ªsu…
 < 0) {

147 
disˇrded
++;

150  
ªsu…
;

151 
	}
}

153 
	$£t_Àn_msg
(*
buf
, *
íd
)

155 
basic_msg_fmt
 *
bmf
 = (basic_msg_fmà*)
buf
;

156 
bmf
->
Àn
 = 
íd
 - 
buf
 - (*bmf);

157 
	}
}

159 
ölöe
 
	$£t_£q_num
(
basic_msg_fmt
 *
bmf
)

161 
bmf
->
£q_numbî
 = 
£q_num
;

162 
£q_num
++;

163 
	}
}

165 
ölöe
 
	$£t_time
(
basic_msg_fmt
 *
bmf
)

167 
time•ec
 
ts
;

169 
	`gën°imeofday
(&
ts
);

170 
bmf
->
time
 = 
	`time•ec2time
(&
ts
);

171 
	}
}

173 * 
	$∑ck_basic_msg_fmt
(*
buf
, 
MSG_ID
 
id
)

175 
basic_msg_fmt
 *
bmf
 = (basic_msg_fmà*)
buf
;

177 
	`£t_time
(
bmf
);

178 
	`£t_£q_num
(
bmf
);

179 
bmf
->
msg_id
 = 
id
;

181  
bmf
->
∑ylﬂd
;

182 
	}
}

193 
	s¥oc_öfo
 {

194 
u32
 
	mpid
;

195 
u32
 
	mµid
;

196 
u32
 
	m°¨t_£c
;

197 
u32
 
	m°¨t_n£c
;

198 
u64
 
	mlow_addr
;

199 
u64
 
	mhigh_addr
;

200 
	mbö_∑th
[0];

201 } 
__©åibuã__
((
∑cked
));

203 
	s¥oc_öfo_∑π
 {

204 
u32
 
	mlib_˙t
;

205 
	mlibs
[0];

206 } 
__©åibuã__
((
∑cked
));

208 
	slib_obj
 {

209 
u64
 
	mlow_addr
;

210 
u64
 
	mhigh_addr
;

211 
	mlib_∑th
[0];

212 } 
__©åibuã__
((
∑cked
));

214 *
	$∑ck_∑th
(*
buf
, 
fûe
 *file)

216 íum { 
TMP_BUF_LEN
 = 512 };

217 
tmp_buf
[
TMP_BUF_LEN
];

218 
NA
[] = "N/A";

219 *
fûíame
;

220 
size_t
 
Àn
;

222 i‡(
fûe
 =
NULL
)

223  
	`°r˝y
(
buf
, 
NA
) + (NA);

225 
fûíame
 = 
	`d_∑th
(&
fûe
->
f_∑th
, 
tmp_buf
, 
TMP_BUF_LEN
);

226 i‡(
	`IS_ERR_OR_NULL
(
fûíame
))

227  
	`°r˝y
(
buf
, 
NA
) + (NA);

229 
Àn
 = 
	`°æí
(
fûíame
) + 1;

230 
	`mem˝y
(
buf
, 
fûíame
, 
Àn
);

232  
buf
 + 
Àn
;

233 
	}
}

235 *
	$∑ck_lib_obj
(*
lib_obj
, 
vm_¨ó_°ru˘
 *
vma
)

237 
lib_obj
 *
lo
 = (lib_obj *)lib_obj;

239 
lo
->
low_addr
 = 
vma
->
vm_°¨t
;

240 
lo
->
high_addr
 = 
vma
->
vm_íd
;

242  
	`∑ck_∑th
(
lo
->
lib_∑th
, 
vma
->
vm_fûe
);

243 
	}
}

246 
	$check_vma
(
vm_¨ó_°ru˘
 *
vma
)

248  
vma
->
vm_fûe
 &&

249 !(
vma
->
vm_pgoff
 != 0 ||

250 !(
vma
->
vm_Êags
 & 
VM_EXEC
) ||

251 !(
vma
->
vm_Êags
 & (
VM_READ
 | 
VM_MAYREAD
)));

252 
	}
}

254 
vm_¨ó_°ru˘
 *
	$föd_vma_exe_by_díåy
(
mm_°ru˘
 *
mm
, 
díåy
 *dentry)

256 
vm_¨ó_°ru˘
 *
vma
;

258 
	`down_ªad
(&
mm
->
mm≠_£m
);

259 
vma
 = 
mm
->
mm≠
; vma; vm®vma->
vm_√xt
) {

260 i‡(
vma
->
vm_fûe
 && (vma->
vm_Êags
 & 
VM_EXEC
) &&

261 (
vma
->
vm_fûe
->
f_díåy
 =
díåy
))

262 
out
;

265 
vma
 = 
NULL
;

266 
out
:

267 
	`up_ªad
(&
mm
->
mm≠_£m
);

269  
vma
;

270 
	}
}

272 *
	$∑ck_sh¨ed_kmem
(*
lib_obj
, 
mm_°ru˘
 *
mm
,

273 
u32
 *
lib_˙t_p
)

275 
lib_obj
 *
so
 = (lib_obj *)lib_obj;

276 *
so_obj
;

277 
°¨t
 = 0, 
íd
 = 0;

279 c⁄° *
kmem_«me
 = 
	`gë_sh¨ed_kmem
(
mm
, &
°¨t
, &
íd
);

280 
size_t
 
«me_Àn
;

282 i‡(
kmem_«me
 =
NULL
)

283  
lib_obj
;

285 
«me_Àn
 = 
	`°æí
(
kmem_«me
) + 1;

286 
so
->
low_addr
 = (
u64
)
°¨t
;

287 
so
->
high_addr
 = (
u64
)
íd
;

288 
	`mem˝y
(
so
->
lib_∑th
, 
kmem_«me
, 
«me_Àn
);

289 (*
lib_˙t_p
)++;

290 
so_obj
 = 
so
->
lib_∑th
 + 
«me_Àn
;

292  
so_obj
;

293 
	}
}

295 *
	$∑ck_libs
(*
lib_obj
, 
mm_°ru˘
 *
mm
, 
u32
 *
lib_˙t_p
)

297 
vm_¨ó_°ru˘
 *
vma
;

299 
	`down_ªad
(&
mm
->
mm≠_£m
);

300 
vma
 = 
mm
->
mm≠
; vma; vm®vma->
vm_√xt
) {

301 i‡(
	`check_vma
(
vma
)) {

302 
lib_obj
 = 
	`∑ck_lib_obj
÷ib_obj, 
vma
);

303 ++(*
lib_˙t_p
);

306 
	`up_ªad
(&
mm
->
mm≠_£m
);

308  
lib_obj
;

309 
	}
}

311 *
	$∑ck_¥oc_öfo_∑π
(*
íd_∑th
, 
mm_°ru˘
 *
mm
)

313 
¥oc_öfo_∑π
 *
pù
;

314 *
lib_obj
;

315 
u32
 *
lib_˙t_p
;

317 
pù
 = (
¥oc_öfo_∑π
 *)
íd_∑th
;

318 
pù
->
lib_˙t
 = 0;

319 
lib_obj
 = 
pù
->
libs
;

320 
lib_˙t_p
 = &
pù
->
lib_˙t
;

322 
lib_obj
 = 
	`∑ck_libs
÷ib_obj, 
mm
, 
lib_˙t_p
);

323 
lib_obj
 = 
	`∑ck_sh¨ed_kmem
÷ib_obj, 
mm
, 
lib_˙t_p
);

325  
lib_obj
;

326 
	}
}

328 *
	$∑ck_¥oc_öfo
(*
∑ylﬂd
, 
èsk_°ru˘
 *
èsk
,

329 
díåy
 *dentry)

331 
¥oc_öfo
 *
pi
 = (¥oc_öfÿ*)
∑ylﬂd
;

332 
vm_¨ó_°ru˘
 *
vma
 = 
	`föd_vma_exe_by_díåy
(
èsk
->
mm
, 
díåy
);

333 
time•ec
 
boŸ_time
;

334 
time•ec
 
°¨t_time
;

335 *
íd_∑th
 = 
NULL
;

337 
	`gëboŸtime
(&
boŸ_time
);

338 
°¨t_time
 = 
	`time•ec_add
(
boŸ_time
, 
èsk
->
ªÆ_°¨t_time
);

340 
pi
->
pid
 = 
èsk
->
tgid
;

341 
pi
->
µid
 = 
èsk
->
ªÆ_∑ª¡
->
tgid
;

342 
pi
->
°¨t_£c
 = (
u32
)
°¨t_time
.
tv_£c
;

343 
pi
->
°¨t_n£c
 = (
u32
)
°¨t_time
.
tv_n£c
;

345 i‡(
vma
) {

346 
pi
->
low_addr
 = 
vma
->
vm_°¨t
;

347 
pi
->
high_addr
 = 
vma
->
vm_íd
;

348 
íd_∑th
 = 
	`∑ck_∑th
(
pi
->
bö_∑th
, 
vma
->
vm_fûe
);

350 
pi
->
low_addr
 = 0;

351 
pi
->
high_addr
 = 0;

352 
íd_∑th
 = 
	`∑ck_∑th
(
pi
->
bö_∑th
, 
NULL
);

354  
	`∑ck_¥oc_öfo_∑π
(
íd_∑th
, 
èsk
->
mm
);

355 
	}
}

357 
	$¥oc_öfo_msg
(
èsk_°ru˘
 *
èsk
, 
díåy
 *dentry)

359 *
buf
, *
∑ylﬂd
, *
buf_íd
;

361 
buf
 = 
	`gë_cuºít_buf
();

362 
∑ylﬂd
 = 
	`∑ck_basic_msg_fmt
(
buf
, 
MSG_PROC_INFO
);

363 
buf_íd
 = 
	`∑ck_¥oc_öfo
(
∑ylﬂd
, 
èsk
, 
díåy
);

365 
	`£t_Àn_msg
(
buf
, 
buf_íd
);

367  
	`wrôe_to_buf„r
(
buf
);

368 
	}
}

369 
EXPORT_SYMBOL_GPL
(
¥oc_öfo_msg
);

380 
	s¥oc_ãrmö©e
 {

381 
u32
 
	mpid
;

382 } 
__©åibuã__
((
∑cked
));

384 *
	$∑ck_¥oc_ãrmö©e
(*
∑ylﬂd
, 
èsk_°ru˘
 *
èsk
)

386 
¥oc_ãrmö©e
 *
±
 = (¥oc_ãrmö©ê*)
∑ylﬂd
;

388 
±
->
pid
 = 
èsk
->pid;

389  
∑ylﬂd
 + (*
±
);

390 
	}
}

392 
	$ãrmö©e_msg
(
èsk_°ru˘
 *
èsk
)

394 *
buf
, *
∑ylﬂd
, *
buf_íd
;

396 
buf
 = 
	`gë_cuºít_buf
();

397 
∑ylﬂd
 = 
	`∑ck_basic_msg_fmt
(
buf
, 
MSG_TERMINATE
);

398 
buf_íd
 = 
	`∑ck_¥oc_ãrmö©e
(
∑ylﬂd
, 
èsk
);

400 
	`£t_Àn_msg
(
buf
, 
buf_íd
);

402 
	`wrôe_to_buf„r
(
buf
);

403 
	}
}

404 
EXPORT_SYMBOL_GPL
(
ãrmö©e_msg
);

414 
	s¥oc_m≠
 {

415 
u32
 
	mpid
;

416 
u64
 
	mlow_addr
;

417 
u64
 
	mhigh_addr
;

418 
	mbö_∑th
[0];

419 } 
__©åibuã__
((
∑cked
));

421 *
	$∑ck_¥oc_m≠
(*
∑ylﬂd
, 
vm_¨ó_°ru˘
 *
vma
)

423 
¥oc_m≠
 *
pm
 = (¥oc_m≠ *)
∑ylﬂd
;

425 
pm
->
pid
 = 
cuºít
->
tgid
;

426 
pm
->
low_addr
 = 
vma
->
vm_°¨t
;

427 
pm
->
high_addr
 = 
vma
->
vm_íd
;

429  
	`∑ck_∑th
(
pm
->
bö_∑th
, 
vma
->
vm_fûe
);

430 
	}
}

432 
	$pcoc_m≠_msg
(
vm_¨ó_°ru˘
 *
vma
)

434 *
buf
, *
∑ylﬂd
, *
buf_íd
;

436 
buf
 = 
	`gë_cuºít_buf
();

437 
∑ylﬂd
 = 
	`∑ck_basic_msg_fmt
(
buf
, 
MSG_PROC_MAP
);

438 
buf_íd
 = 
	`∑ck_¥oc_m≠
(
∑ylﬂd
, 
vma
);

440 
	`£t_Àn_msg
(
buf
, 
buf_íd
);

442 
	`wrôe_to_buf„r
(
buf
);

443 
	}
}

444 
EXPORT_SYMBOL_GPL
(
pcoc_m≠_msg
);

454 
	s¥oc_unm≠
 {

455 
u32
 
	mpid
;

456 
u64
 
	mlow_addr
;

457 
u64
 
	mhigh_addr
;

458 } 
__©åibuã__
((
∑cked
));

460 *
	$∑ck_¥oc_unm≠
(*
∑ylﬂd
, 
°¨t
,

461 
íd
)

463 
¥oc_unm≠
 *
pum
 = (¥oc_unm≠ *)
∑ylﬂd
;

465 
pum
->
pid
 = 
cuºít
->
tgid
;

466 
pum
->
low_addr
 = 
°¨t
;

467 
pum
->
high_addr
 = 
íd
;

469  
∑ylﬂd
 + (*
pum
);

470 
	}
}

472 
	$¥oc_unm≠_msg
(
°¨t
, 
íd
)

474 *
buf
, *
∑ylﬂd
, *
buf_íd
;

476 
buf
 = 
	`gë_cuºít_buf
();

477 
∑ylﬂd
 = 
	`∑ck_basic_msg_fmt
(
buf
, 
MSG_PROC_UNMAP
);

478 
buf_íd
 = 
	`∑ck_¥oc_unm≠
(
∑ylﬂd
, 
°¨t
, 
íd
);

480 
	`£t_Àn_msg
(
buf
, 
buf_íd
);

482 
	`wrôe_to_buf„r
(
buf
);

483 
	}
}

484 
EXPORT_SYMBOL_GPL
(
¥oc_unm≠_msg
);

495 
	sßm∂e
 {

496 
u32
 
	mpid
;

497 
u64
 
	mpc_addr
;

498 
u32
 
	mtid
;

499 
u32
 
	m˝u_num
;

500 } 
__©åibuã__
((
∑cked
));

502 *
	$∑ck_ßm∂e
(*
∑ylﬂd
, 
±_ªgs
 *
ªgs
)

504 
ßm∂e
 *
s
 = (ßm∂ê*)
∑ylﬂd
;

505 
èsk_°ru˘
 *
èsk
 = 
cuºít
;

507 
s
->
pid
 = 
èsk
->
tgid
;

508 
s
->
pc_addr
 = 
	`gë_ªgs_ù
(
ªgs
);

509 
s
->
tid
 = 
èsk
->
pid
;

510 
s
->
˝u_num
 = 
	`smp_¥o˚ss‹_id
();

512  
∑ylﬂd
 + (*
s
);

513 
	}
}

515 
	$ßm∂e_msg
(
±_ªgs
 *
ªgs
)

517 *
buf
, *
∑ylﬂd
, *
buf_íd
;

519 i‡(!
	`check_evít
(
cuºít
))

522 
buf
 = 
	`gë_cuºít_buf
();

523 
∑ylﬂd
 = 
	`∑ck_basic_msg_fmt
(
buf
, 
MSG_SAMPLE
);

524 
buf_íd
 = 
	`∑ck_ßm∂e
(
∑ylﬂd
, 
ªgs
);

526 
	`£t_Àn_msg
(
buf
, 
buf_íd
);

528  
	`wrôe_to_buf„r
(
buf
);

529 
	}
}

530 
EXPORT_SYMBOL_GPL
(
ßm∂e_msg
);

540 
	smsg_func_íåy
 {

541 
u64
 
	mpc_addr
;

542 
u64
 
	mˇŒî_pc_addr
;

543 
u16
 
	m¥obe_ty≥
;

544 
u16
 
	m¥obe_sub_ty≥
;

545 
u32
 
	mpid
;

546 
u32
 
	mtid
;

547 
u32
 
	m˝u_num
;

548 
u32
 
	m˙t_¨gs
;

549 
	m¨gs
[0];

550 } 
__©åibuã__
((
∑cked
));

552 *
	$∑ck_msg_func_íåy
(*
∑ylﬂd
, c⁄° *
fmt
,

553 
func_addr
, 
±_ªgs
 *
ªgs
,

554 
PROBE_TYPE
 
±
, 
sub_ty≥
)

556 
msg_func_íåy
 *
m„
 = (msg_func_íåy *)
∑ylﬂd
;

557 
èsk_°ru˘
 *
èsk
 = 
cuºít
;

559 
m„
->
pid
 = 
èsk
->
tgid
;

560 
m„
->
tid
 = 
èsk
->
pid
;

561 
m„
->
˝u_num
 = 
	`smp_¥o˚ss‹_id
();

562 
m„
->
pc_addr
 = 
func_addr
;

563 
m„
->
ˇŒî_pc_addr
 = 
	`gë_ªgs_ªt_func
(
ªgs
);

564 
m„
->
¥obe_ty≥
 = 
±
;

565 
m„
->
¥obe_sub_ty≥
 = 
sub_ty≥
;

566 
m„
->
˙t_¨gs
 = 
	`°æí
(
fmt
);

568  
∑ylﬂd
 + (*
m„
);

569 
	}
}

571 
	$gë_¨g
(
±_ªgs
 *
ªgs
, 
n
)

573  
	`u£r_mode
(
ªgs
) ?

574 
	`sw≠_gë_u¨g
(
ªgs
, 
n
) :

575 
	`sw≠_gë_ßrg
(
ªgs
, 
n
);

576 
	}
}

578 
	$∑ck_¨gs
(*
buf
, 
Àn
, c⁄° *
fmt
, 
±_ªgs
 *
ªgs
)

580 *
buf_ﬁd
 = 
buf
;

581 
u32
 *
tmp_u32
;

582 
u64
 *
tmp_u64
;

583 
i
,

584 
fmt_i
,

585 
fmt_Àn
;

587 
fmt_Àn
 = 
	`°æí
(
fmt
);

589 
i
 = 0, 
fmt_i
 = 0; fmt_ò< 
fmt_Àn
; ++i, ++fmt_i) {

590 i‡(
Àn
 < 2)

591  -
ENOMEM
;

593 *
buf
 = 
fmt
[
fmt_i
];

594 
buf
 += 1;

595 
Àn
 -= 1;

597 
fmt
[
fmt_i
]) {

599 *
buf
 = ()!!
	`gë_¨g
(
ªgs
, 
i
);

600 
buf
 += 1;

601 
Àn
 -= 1;

604 *
buf
 = ()
	`gë_¨g
(
ªgs
, 
i
);

605 
buf
 += 1;

606 
Àn
 -= 1;

610 i‡(
Àn
 < 4)

611  -
ENOMEM
;

612 
tmp_u32
 = (
u32
 *)
buf
;

613 *
tmp_u32
 = (
u32
)
	`gë_¨g
(
ªgs
, 
i
);

614 
buf
 += 4;

615 
Àn
 -= 4;

619 i‡(
Àn
 < 8)

620  -
ENOMEM
;

621 
tmp_u64
 = (
u64
 *)
buf
;

622 *
tmp_u64
 = (
u64
)
	`gë_¨g
(
ªgs
, 
i
);

623 
buf
 += 8;

624 
Àn
 -= 8;

627 i‡(
Àn
 < 8)

628  -
ENOMEM
;

629 
tmp_u64
 = (
u64
 *)
buf
;

630 *
tmp_u64
 = 
	`gë_¨g
(
ªgs
, 
i
);

631 ++
i
;

632 *
tmp_u64
 |(
u64
)
	`gë_¨g
(
ªgs
, 
i
) << 32;

633 
buf
 += 8;

634 
Àn
 -= 8;

638 íum { 
max_°r_Àn
 = 512 };

639 c⁄° 
__u£r
 *
u£r_s
;

640 
Àn_s
, 
ªt
;

642 
u£r_s
 = (c⁄° 
__u£r
 *)
	`gë_¨g
(
ªgs
, 
i
);

643 
Àn_s
 = 
	`°∫Àn_u£r
(
u£r_s
, 
max_°r_Àn
);

644 i‡(
Àn
 < 
Àn_s
)

645  -
ENOMEM
;

647 
ªt
 = 
	`°∫˝y_‰om_u£r
(
buf
, 
u£r_s
, 
Àn_s
);

648 i‡(
ªt
 < 0)

649  -
EFAULT
;

651 
buf
[
ªt
] = '\0';

653 
buf
 +
ªt
 + 1;

654 
Àn
 -
ªt
 + 1;

658  -
EINVAL
;

662  
buf
 - 
buf_ﬁd
;

663 
	}
}

665 
	$íåy_evít
(c⁄° *
fmt
, 
func_addr
, 
±_ªgs
 *
ªgs
,

666 
PROBE_TYPE
 
±
, 
sub_ty≥
)

668 *
buf
, *
∑ylﬂd
, *
¨gs
, *
buf_íd
;

669 
ªt
;

671 i‡(
±
 =
PT_KS
 && !
	`check_evít
(
cuºít
))

674 
buf
 = 
	`gë_cuºít_buf
();

675 
∑ylﬂd
 = 
	`∑ck_basic_msg_fmt
(
buf
, 
MSG_FUNCTION_ENTRY
);

676 
¨gs
 = 
	`∑ck_msg_func_íåy
(
∑ylﬂd
, 
fmt
, 
func_addr
,

677 
ªgs
, 
±
, 
sub_ty≥
);

680 
ªt
 = 
	`∑ck_¨gs
(
¨gs
, 1024, 
fmt
, 
ªgs
);

681 i‡(
ªt
 < 0) {

682 
	`¥ötk
("ERROR: !!!!!\n");

683  
ªt
;

686 
buf_íd
 = 
¨gs
 + 
ªt
;

688 
	`£t_Àn_msg
(
buf
, 
buf_íd
);

690  
	`wrôe_to_buf„r
(
buf
);

691 
	}
}

692 
EXPORT_SYMBOL_GPL
(
íåy_evít
);

703 
	smsg_func_exô
 {

704 
u32
 
	mpid
;

705 
u32
 
	mtid
;

706 
u64
 
	mpc_addr
;

707 
u64
 
	mˇŒî_pc_addr
;

708 
u32
 
	m˝u_num
;

709 
	mªt_vÆ
[0];

710 } 
__©åibuã__
((
∑cked
));

712 
	$∑ck_msg_ªt_vÆ
(*
buf
, 
Àn
, 
ªt_ty≥
,

713 
±_ªgs
 *
ªgs
)

715 c⁄° *
buf_ﬁd
 = 
buf
;

716 
u32
 *
tmp_u32
;

717 
u64
 *
tmp_u64
;

719 *
buf
 = 
ªt_ty≥
;

720 ++
buf
;

722 
ªt_ty≥
) {

724 i‡(
Àn
 < 1)

725  -
ENOMEM
;

726 *
buf
 = ()!!
	`gë_ªgs_ªt_vÆ
(
ªgs
);

727 ++
buf
;

730 i‡(
Àn
 < 1)

731  -
ENOMEM
;

732 *
buf
 = ()
	`gë_ªgs_ªt_vÆ
(
ªgs
);

733 ++
buf
;

736 i‡(
Àn
 < 4)

737  -
ENOMEM
;

738 
tmp_u32
 = (
u32
 *)
buf
;

739 *
tmp_u32
 = 
	`gë_ªgs_ªt_vÆ
(
ªgs
);

740 
buf
 += 4;

744 i‡(
Àn
 < 8)

745  -
ENOMEM
;

746 
tmp_u64
 = (
u64
 *)
buf
;

747 *
tmp_u64
 = (
u64
)
	`gë_ªgs_ªt_vÆ
(
ªgs
);

748 
buf
 += 8;

752 íum { 
max_°r_Àn
 = 512 };

753 c⁄° 
__u£r
 *
u£r_s
;

754 
Àn_s
, 
ªt
;

756 
u£r_s
 = (c⁄° 
__u£r
 *)
	`gë_ªgs_ªt_vÆ
(
ªgs
);

757 
Àn_s
 = 
	`°∫Àn_u£r
(
u£r_s
, 
max_°r_Àn
);

758 i‡(
Àn
 < 
Àn_s
)

759  -
ENOMEM
;

761 
ªt
 = 
	`°∫˝y_‰om_u£r
(
buf
, 
u£r_s
, 
Àn_s
);

762 i‡(
ªt
 < 0)

763  -
EFAULT
;

765 
buf
[
ªt
] = '\0';

766 
buf
 +
ªt
 + 1;

773 i‡(
Àn
 < 4)

774  -
ENOMEM
;

775 
tmp_u32
 = (
u32
 *)
buf
;

776 *
tmp_u32
 = 
	`sw≠_gë_uΩ_Êﬂt
(
ªgs
);

777 
buf
 += 4;

780 i‡(
Àn
 < 8)

781  -
ENOMEM
;

782 
tmp_u64
 = (
u64
 *)
buf
;

783 *
tmp_u64
 = 
	`sw≠_gë_uΩ_doubÀ
(
ªgs
);

784 
buf
 += 8;

787  -
EINVAL
;

790  
buf
 - 
buf_ﬁd
;

791 
	}
}

794 
	$∑ck_msg_func_exô
(*
buf
, 
Àn
, 
ªt_ty≥
,

795 
±_ªgs
 *
ªgs
, 
func_addr
,

796 
ªt_addr
)

798 
msg_func_exô
 *
m„
 = (msg_func_exô *)
buf
;

799 
èsk_°ru˘
 *
èsk
 = 
cuºít
;

800 
ªt
;

802 
m„
->
pid
 = 
èsk
->
tgid
;

803 
m„
->
tid
 = 
èsk
->
pid
;

804 
m„
->
˝u_num
 = 
	`smp_¥o˚ss‹_id
();

805 
m„
->
pc_addr
 = 
func_addr
;

806 
m„
->
ˇŒî_pc_addr
 = 
ªt_addr
;

808 
ªt
 = 
	`∑ck_msg_ªt_vÆ
(
m„
->
ªt_vÆ
, 
Àn
, 
ªt_ty≥
, 
ªgs
);

809 i‡(
ªt
 < 0) {

810 
	`¥ötk
("ERROR:Öackög MSG_FUNCTION_EXIT (ªt=%d)\n", 
ªt
);

811  
ªt
;

814  (*
m„
Ë+ 
ªt
;

815 
	}
}

817 
	$exô_evít
(
ªt_ty≥
, 
±_ªgs
 *
ªgs
, 
func_addr
,

818 
ªt_addr
)

820 *
buf
, *
∑ylﬂd
, *
buf_íd
;

821 
ªt
;

823 i‡(!
	`check_evít
(
cuºít
))

826 
buf
 = 
	`gë_cuºít_buf
();

827 
∑ylﬂd
 = 
	`∑ck_basic_msg_fmt
(
buf
, 
MSG_FUNCTION_EXIT
);

829 
ªt
 = 
	`∑ck_msg_func_exô
(
∑ylﬂd
, 1024, 
ªt_ty≥
, 
ªgs
,

830 
func_addr
, 
ªt_addr
);

831 i‡(
ªt
 < 0)

832  
ªt
;

834 
buf_íd
 = 
∑ylﬂd
 + 
ªt
;

835 
	`£t_Àn_msg
(
buf
, 
buf_íd
);

837  
	`wrôe_to_buf„r
(
buf
);

838 
	}
}

839 
EXPORT_SYMBOL_GPL
(
exô_evít
);

850 
	smsg_c⁄ãxt_swôch
 {

851 
u64
 
	mpc_addr
;

852 
u32
 
	mpid
;

853 
u32
 
	mtid
;

854 
u32
 
	m˝u_num
;

855 } 
__©åibuã__
((
∑cked
));

857 *
	$∑ck_msg_c⁄ãxt_swôch
(*
∑ylﬂd
, 
±_ªgs
 *
ªgs
)

859 
msg_c⁄ãxt_swôch
 *
mcs
 = (msg_c⁄ãxt_swôch *)
∑ylﬂd
;

860 
èsk_°ru˘
 *
èsk
 = 
cuºít
;

862 
mcs
->
pc_addr
 = 0;

863 
mcs
->
pid
 = 
èsk
->
tgid
;

864 
mcs
->
tid
 = 
èsk
->
pid
;

865 
mcs
->
˝u_num
 = 
	`smp_¥o˚ss‹_id
();

867  
∑ylﬂd
 + (*
mcs
);

868 
	}
}

870 
	$c⁄ãxt_swôch
(
±_ªgs
 *
ªgs
, 
MSG_ID
 
id
)

872 *
buf
, *
∑ylﬂd
, *
buf_íd
;

874 
buf
 = 
	`gë_cuºít_buf
();

875 
∑ylﬂd
 = 
	`∑ck_basic_msg_fmt
(
buf
, 
id
);

876 
buf_íd
 = 
	`∑ck_msg_c⁄ãxt_swôch
(
∑ylﬂd
, 
ªgs
);

877 
	`£t_Àn_msg
(
buf
, 
buf_íd
);

879  
	`wrôe_to_buf„r
(
buf
);

880 
	}
}

882 
	$swôch_íåy
(
±_ªgs
 *
ªgs
)

884 i‡(!
	`check_evít
(
cuºít
))

887  
	`c⁄ãxt_swôch
(
ªgs
, 
MSG_CONTEXT_SWITCH_ENTRY
);

888 
	}
}

889 
EXPORT_SYMBOL_GPL
(
swôch_íåy
);

891 
	$swôch_exô
(
±_ªgs
 *
ªgs
)

893 i‡(!
	`check_evít
(
cuºít
))

896  
	`c⁄ãxt_swôch
(
ªgs
, 
MSG_CONTEXT_SWITCH_EXIT
);

897 
	}
}

898 
EXPORT_SYMBOL_GPL
(
swôch_exô
);

908 
	smsg_îr
 {

909 
	mmsg
[0];

910 } 
__©åibuã__
((
∑cked
));

912 *
	$∑ck_msg_îr
(*
∑ylﬂd
, c⁄° *
fmt
, 
va_li°
 
¨gs
)

914 
msg_îr
 *
me
 = (msg_î∏*)
∑ylﬂd
;

915 
ªt
;

917 
ªt
 = 
	`v•rötf
(
me
->
msg
, 
fmt
, 
¨gs
);

918 i‡(
ªt
 < 0)

919  
∑ylﬂd
;

921  
∑ylﬂd
 + (*
me
Ë+ 
ªt
 + 1;

922 
	}
}

924 
	$îr‹_msg
(c⁄° *
fmt
, ...)

926 *
buf
, *
∑ylﬂd
, *
buf_íd
;

927 
va_li°
 
¨gs
;

929 
buf
 = 
	`gë_cuºít_buf
();

930 
∑ylﬂd
 = 
	`∑ck_basic_msg_fmt
(
buf
, 
MSG_ERROR
);

932 
	`va_°¨t
(
¨gs
, 
fmt
);

933 
buf_íd
 = 
	`∑ck_msg_îr
(
∑ylﬂd
, 
fmt
, 
¨gs
);

934 
	`va_íd
(
¨gs
);

936 
	`£t_Àn_msg
(
buf
, 
buf_íd
);

938  
	`wrôe_to_buf„r
(
buf
);

939 
	}
}

940 
EXPORT_SYMBOL_GPL
(
îr‹_msg
);

951 
	$øw_msg
(*
buf
, 
size_t
 
Àn
)

953 
basic_msg_fmt
 *
bmf
 = (basic_msg_fmà*)
buf
;

955 i‡((*
bmf
Ë> 
Àn
)

956  -
EINVAL
;

958 i‡(
bmf
->
Àn
 + (*bmf) !=Üen)

959  -
EINVAL
;

961 
	`£t_£q_num
(
bmf
);

962 
	`wrôe_to_buf„r
(
buf
);

964  
Àn
;

965 
	}
}

967 
__öô
 
	$sw≠_wrôî_moduÀ_öô
()

969 
ªt
;

971 
ªt
 = 
	`evít_fûãr_öô
();

972 i‡(
ªt
)

973  
ªt
;

975 
ªt
 = 
	`öô_debugfs_wrôî
();

976 i‡(
ªt
)

977 
	`evít_fûãr_exô
();

979  
ªt
;

980 
	}
}

982 
__exô
 
	$sw≠_wrôî_moduÀ_exô
()

984 
	`exô_debugfs_wrôî
();

985 
	`evít_fûãr_exô
();

986 
	}
}

988 
moduÀ_öô
(
sw≠_wrôî_moduÀ_öô
);

989 
moduÀ_exô
(
sw≠_wrôî_moduÀ_exô
);

991 
MODULE_LICENSE
("GPL");

992 
MODULE_DESCRIPTION
("SWAP Writer module");

993 
MODULE_AUTHOR
("Cherkashin V., Aksenov A.S.");

	@writer/swap_writer_module.h

26 #i‚de‡
_SWAP_MSG_H


27 
	#_SWAP_MSG_H


	)

29 
	~<löux/ty≥s.h
>

31 
	ePROBE_TYPE
 {

32 
	mPT_US
 = 1,

33 
	mPT_KS
 = 3

36 
	ePROBE_SUB_TYPE
 {

37 
	mPST_NONE
 = 0x00,

38 
	mPST_KS_FILE
 = 0x01,

39 
	mPST_KS_IPC
 = 0x02,

40 
	mPST_KS_PROCESS
 = 0x04,

41 
	mPST_KS_SIGNAL
 = 0x08,

42 
	mPST_KS_NETWORK
 = 0x10,

43 
	mPST_KS_DESC
 = 0x20

46 
	g±_ªgs
;

47 
	gdíåy
;

48 
	gèsk_°ru˘
;

49 
	gvm_¨ó_°ru˘
;

51 
öô_msg
(
size_t
 
buf_size
);

52 
unöô_msg
();

54 
ª£t_disˇrded
();

55 
gë_disˇrded_cou¡
();

56 
ª£t_£q_num
();

58 
¥oc_öfo_msg
(
èsk_°ru˘
 *
èsk
, 
díåy
 *dentry);

59 
ãrmö©e_msg
(
èsk_°ru˘
 *
èsk
);

60 
pcoc_m≠_msg
(
vm_¨ó_°ru˘
 *
vma
);

61 
¥oc_unm≠_msg
(
°¨t
, 
íd
);

62 
ßm∂e_msg
(
±_ªgs
 *
ªgs
);

64 
íåy_evít
(c⁄° *
fmt
, 
func_addr
, 
±_ªgs
 *
ªgs
,

65 
PROBE_TYPE
 
±
, 
sub_ty≥
);

66 
exô_evít
(
ªt_ty≥
, 
±_ªgs
 *
ªgs
, 
func_addr
,

67 
ªt_addr
);

69 
swôch_íåy
(
±_ªgs
 *
ªgs
);

70 
swôch_exô
(
±_ªgs
 *
ªgs
);

72 
îr‹_msg
(c⁄° *
fmt
, ...);

74 
øw_msg
(*
buf
, 
size_t
 
Àn
);

	@/usr/include/asm/errno.h

1 
	~<asm-gíîic/î∫o.h
>

	@/usr/include/asm/fcntl.h

1 
	~<asm-gíîic/f˙é.h
>

	@/usr/include/asm/ptrace.h

1 #i‚de‡
_ASM_X86_PTRACE_H


2 
	#_ASM_X86_PTRACE_H


	)

5 
	~<asm/±ø˚-abi.h
>

6 
	~<asm/¥o˚ss‹-Êags.h
>

9 #i‚de‡
__ASSEMBLY__


11 #ifde‡
__i386__


16 
	s±_ªgs
 {

17 
	mebx
;

18 
	mecx
;

19 
	medx
;

20 
	mesi
;

21 
	medi
;

22 
	mebp
;

23 
	móx
;

24 
	mxds
;

25 
	mxes
;

26 
	mxfs
;

27 
	mxgs
;

28 
	m‹ig_óx
;

29 
	meù
;

30 
	mxcs
;

31 
	meÊags
;

32 
	me•
;

33 
	mxss
;

40 
	s±_ªgs
 {

41 
	mr15
;

42 
	mr14
;

43 
	mr13
;

44 
	mr12
;

45 
	mrbp
;

46 
	mrbx
;

48 
	mr11
;

49 
	mr10
;

50 
	mr9
;

51 
	mr8
;

52 
	møx
;

53 
	mrcx
;

54 
	mrdx
;

55 
	mrsi
;

56 
	mrdi
;

57 
	m‹ig_øx
;

60 
	mrù
;

61 
	mcs
;

62 
	meÊags
;

63 
	mr•
;

64 
	mss
;

	@/usr/include/features.h

18 #i‚def 
_FEATURES_H


19 
	#_FEATURES_H
 1

	)

98 #unde‡
__USE_ISOC11


99 #unde‡
__USE_ISOC99


100 #unde‡
__USE_ISOC95


101 #unde‡
__USE_ISOCXX11


102 #unde‡
__USE_POSIX


103 #unde‡
__USE_POSIX2


104 #unde‡
__USE_POSIX199309


105 #unde‡
__USE_POSIX199506


106 #unde‡
__USE_XOPEN


107 #unde‡
__USE_XOPEN_EXTENDED


108 #unde‡
__USE_UNIX98


109 #unde‡
__USE_XOPEN2K


110 #unde‡
__USE_XOPEN2KXSI


111 #unde‡
__USE_XOPEN2K8


112 #unde‡
__USE_XOPEN2K8XSI


113 #unde‡
__USE_LARGEFILE


114 #unde‡
__USE_LARGEFILE64


115 #unde‡
__USE_FILE_OFFSET64


116 #unde‡
__USE_BSD


117 #unde‡
__USE_SVID


118 #unde‡
__USE_MISC


119 #unde‡
__USE_ATFILE


120 #unde‡
__USE_GNU


121 #unde‡
__USE_REENTRANT


122 #unde‡
__USE_FORTIFY_LEVEL


123 #unde‡
__FAVOR_BSD


124 #unde‡
__KERNEL_STRICT_NAMES


128 #i‚de‡
_LOOSE_KERNEL_NAMES


129 
	#__KERNEL_STRICT_NAMES


	)

133 
	#__USE_ANSI
 1

	)

142 #i‡
deföed
 
__GNUC__
 && deföed 
__GNUC_MINOR__


143 
	#__GNUC_PREREQ
(
maj
, 
mö
) \

144 ((
__GNUC__
 << 16Ë+ 
__GNUC_MINOR__
 >((
maj
Ë<< 16Ë+ (
mö
))

	)

146 
	#__GNUC_PREREQ
(
maj
, 
mö
Ë0

	)

151 #i‡
deföed
 
_BSD_SOURCE
 && \

152 !(
deföed
 
	g_POSIX_SOURCE
 || deföed 
	g_POSIX_C_SOURCE
 || \

153 
deföed
 
	g_XOPEN_SOURCE
 || deföed 
	g_GNU_SOURCE
 || deföed 
	g_SVID_SOURCE
)

154 
	#__FAVOR_BSD
 1

	)

158 #ifde‡
_GNU_SOURCE


159 #unde‡
_ISOC95_SOURCE


160 
	#_ISOC95_SOURCE
 1

	)

161 #unde‡
_ISOC99_SOURCE


162 
	#_ISOC99_SOURCE
 1

	)

163 #unde‡
_ISOC11_SOURCE


164 
	#_ISOC11_SOURCE
 1

	)

165 #unde‡
_POSIX_SOURCE


166 
	#_POSIX_SOURCE
 1

	)

167 #unde‡
_POSIX_C_SOURCE


168 
	#_POSIX_C_SOURCE
 200809L

	)

169 #unde‡
_XOPEN_SOURCE


170 
	#_XOPEN_SOURCE
 700

	)

171 #unde‡
_XOPEN_SOURCE_EXTENDED


172 
	#_XOPEN_SOURCE_EXTENDED
 1

	)

173 #unde‡
_LARGEFILE64_SOURCE


174 
	#_LARGEFILE64_SOURCE
 1

	)

175 #unde‡
_BSD_SOURCE


176 
	#_BSD_SOURCE
 1

	)

177 #unde‡
_SVID_SOURCE


178 
	#_SVID_SOURCE
 1

	)

179 #unde‡
_ATFILE_SOURCE


180 
	#_ATFILE_SOURCE
 1

	)

185 #i‡(!
deföed
 
__STRICT_ANSI__
 && !deföed 
_ISOC99_SOURCE
 && \

186 !
deföed
 
	g_POSIX_SOURCE
 && !deföed 
	g_POSIX_C_SOURCE
 && \

187 !
deföed
 
	g_XOPEN_SOURCE
 && !deföed 
	g_BSD_SOURCE
 && !deföed 
	g_SVID_SOURCE
)

188 
	#_BSD_SOURCE
 1

	)

189 
	#_SVID_SOURCE
 1

	)

193 #i‡(
deföed
 
_ISOC11_SOURCE
 \

194 || (
deföed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ >= 201112L))

195 
	#__USE_ISOC11
 1

	)

199 #i‡(
deföed
 
_ISOC99_SOURCE
 || deföed 
_ISOC11_SOURCE
 \

200 || (
deföed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L))

201 
	#__USE_ISOC99
 1

	)

205 #i‡(
deföed
 
_ISOC99_SOURCE
 || deföed 
_ISOC11_SOURCE
 \

206 || (
deföed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199409L))

207 
	#__USE_ISOC95
 1

	)

214 #i‡((
deföed
 
__˝lu•lus
 && __cplusplus >= 201103L) \

215 || 
deföed
 
__GXX_EXPERIMENTAL_CXX0X__
)

216 
	#__USE_ISOCXX11
 1

	)

221 #i‡((!
deföed
 
__STRICT_ANSI__
 || (
_XOPEN_SOURCE
 - 0) >= 500) && \

222 !
deföed
 
_POSIX_SOURCE
 && !deföed 
_POSIX_C_SOURCE
)

223 
	#_POSIX_SOURCE
 1

	)

224 #i‡
deföed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 500

225 
	#_POSIX_C_SOURCE
 2

	)

226 #ñi‡
deföed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 600

227 
	#_POSIX_C_SOURCE
 199506L

	)

228 #ñi‡
deföed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 700

229 
	#_POSIX_C_SOURCE
 200112L

	)

231 
	#_POSIX_C_SOURCE
 200809L

	)

233 
	#__USE_POSIX_IMPLICITLY
 1

	)

236 #i‡
deföed
 
_POSIX_SOURCE
 || 
_POSIX_C_SOURCE
 >1 || deföed 
_XOPEN_SOURCE


237 
	#__USE_POSIX
 1

	)

240 #i‡
deföed
 
_POSIX_C_SOURCE
 && _POSIX_C_SOURCE >2 || deföed 
_XOPEN_SOURCE


241 
	#__USE_POSIX2
 1

	)

244 #i‡(
_POSIX_C_SOURCE
 - 0) >= 199309L

245 
	#__USE_POSIX199309
 1

	)

248 #i‡(
_POSIX_C_SOURCE
 - 0) >= 199506L

249 
	#__USE_POSIX199506
 1

	)

252 #i‡(
_POSIX_C_SOURCE
 - 0) >= 200112L

253 
	#__USE_XOPEN2K
 1

	)

254 #unde‡
__USE_ISOC95


255 
	#__USE_ISOC95
 1

	)

256 #unde‡
__USE_ISOC99


257 
	#__USE_ISOC99
 1

	)

260 #i‡(
_POSIX_C_SOURCE
 - 0) >= 200809L

261 
	#__USE_XOPEN2K8
 1

	)

262 #unde‡
_ATFILE_SOURCE


263 
	#_ATFILE_SOURCE
 1

	)

266 #ifdef 
_XOPEN_SOURCE


267 
	#__USE_XOPEN
 1

	)

268 #i‡(
_XOPEN_SOURCE
 - 0) >= 500

269 
	#__USE_XOPEN_EXTENDED
 1

	)

270 
	#__USE_UNIX98
 1

	)

271 #unde‡
_LARGEFILE_SOURCE


272 
	#_LARGEFILE_SOURCE
 1

	)

273 #i‡(
_XOPEN_SOURCE
 - 0) >= 600

274 #i‡(
_XOPEN_SOURCE
 - 0) >= 700

275 
	#__USE_XOPEN2K8
 1

	)

276 
	#__USE_XOPEN2K8XSI
 1

	)

278 
	#__USE_XOPEN2K
 1

	)

279 
	#__USE_XOPEN2KXSI
 1

	)

280 #unde‡
__USE_ISOC95


281 
	#__USE_ISOC95
 1

	)

282 #unde‡
__USE_ISOC99


283 
	#__USE_ISOC99
 1

	)

286 #ifde‡
_XOPEN_SOURCE_EXTENDED


287 
	#__USE_XOPEN_EXTENDED
 1

	)

292 #ifde‡
_LARGEFILE_SOURCE


293 
	#__USE_LARGEFILE
 1

	)

296 #ifde‡
_LARGEFILE64_SOURCE


297 
	#__USE_LARGEFILE64
 1

	)

300 #i‡
deföed
 
_FILE_OFFSET_BITS
 && _FILE_OFFSET_BITS == 64

301 
	#__USE_FILE_OFFSET64
 1

	)

304 #i‡
deföed
 
_BSD_SOURCE
 || deföed 
_SVID_SOURCE


305 
	#__USE_MISC
 1

	)

308 #ifdef 
_BSD_SOURCE


309 
	#__USE_BSD
 1

	)

312 #ifdef 
_SVID_SOURCE


313 
	#__USE_SVID
 1

	)

316 #ifdef 
_ATFILE_SOURCE


317 
	#__USE_ATFILE
 1

	)

320 #ifdef 
_GNU_SOURCE


321 
	#__USE_GNU
 1

	)

324 #i‡
deföed
 
_REENTRANT
 || deföed 
_THREAD_SAFE


325 
	#__USE_REENTRANT
 1

	)

328 #i‡!
deföed
 
__OPTIMIZE__
 || __OPTIMIZE__ <= 0

329 #unde‡
_FORTIFY_SOURCE


331 #i‡
deföed
 
_FORTIFY_SOURCE
 && _FORTIFY_SOURCE > 0

332 #i‡!
__GNUC_PREREQ
 (4, 1)

333 #w¨nög 
_FORTIFY_SOURCE
 
ªquúes
 
GCC
 4.1 
‹
 
œãr


334 #ñi‡
_FORTIFY_SOURCE
 > 1

335 
	#__USE_FORTIFY_LEVEL
 2

	)

337 
	#__USE_FORTIFY_LEVEL
 1

	)

340 #i‚de‡
__USE_FORTIFY_LEVEL


341 
	#__USE_FORTIFY_LEVEL
 0

	)

346 
	~<°dc-¥edef.h
>

354 #unde‡
__GNU_LIBRARY__


355 
	#__GNU_LIBRARY__
 6

	)

359 
	#__GLIBC__
 2

	)

360 
	#__GLIBC_MINOR__
 17

	)

362 
	#__GLIBC_PREREQ
(
maj
, 
mö
) \

363 ((
__GLIBC__
 << 16Ë+ 
__GLIBC_MINOR__
 >((
maj
Ë<< 16Ë+ (
mö
))

	)

366 #i‡
deföed
 
__GNUC__
 \

367 || (
deföed
 
	g__PGI
 && deföed 
	g__i386__
 ) \

368 || (
deföed
 
	g__INTEL_COMPILER
 && (deföed 
	g__i386__
 || deföed 
	g__ü64__
)) \

369 || (
deföed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L)

370 
	#__GLIBC_HAVE_LONG_LONG
 1

	)

374 #i‚de‡
__ASSEMBLER__


375 #i‚de‡
_SYS_CDEFS_H


376 
	~<sys/cdefs.h
>

381 #i‡
deföed
 
__USE_FILE_OFFSET64
 && !deföed 
__REDIRECT


382 
	#__USE_LARGEFILE
 1

	)

383 
	#__USE_LARGEFILE64
 1

	)

389 #i‡
__GNUC_PREREQ
 (2, 7Ë&& 
deföed
 
__OPTIMIZE__
 \

390 && !
deföed
 
	g__OPTIMIZE_SIZE__
 && !deföed 
	g__NO_INLINE__
 \

391 && 
deföed
 
	g__exã∫_ölöe


392 
	#__USE_EXTERN_INLINES
 1

	)

400 
	~<gnu/°ubs.h
>

	@/usr/include/linux/connector.h

22 #i‚de‡
__CONNECTOR_H


23 
	#__CONNECTOR_H


	)

25 
	~<löux/ty≥s.h
>

30 
	#CN_IDX_PROC
 0x1

	)

31 
	#CN_VAL_PROC
 0x1

	)

32 
	#CN_IDX_CIFS
 0x2

	)

33 
	#CN_VAL_CIFS
 0x1

	)

34 
	#CN_W1_IDX
 0x3

	)

35 
	#CN_W1_VAL
 0x1

	)

36 
	#CN_IDX_V86D
 0x4

	)

37 
	#CN_VAL_V86D_UVESAFB
 0x1

	)

38 
	#CN_IDX_BB
 0x5

	)

39 
	#CN_DST_IDX
 0x6

	)

40 
	#CN_DST_VAL
 0x1

	)

41 
	#CN_IDX_DM
 0x7

	)

42 
	#CN_VAL_DM_USERSPACE_LOG
 0x1

	)

43 
	#CN_IDX_DRBD
 0x8

	)

44 
	#CN_VAL_DRBD
 0x1

	)

45 
	#CN_KVP_IDX
 0x9

	)

46 
	#CN_KVP_VAL
 0x1

	)

48 
	#CN_NETLINK_USERS
 10

	)

53 
	#CONNECTOR_MAX_MSG_SIZE
 16384

	)

61 
	scb_id
 {

62 
__u32
 
	midx
;

63 
__u32
 
	mvÆ
;

66 
	s˙_msg
 {

67 
cb_id
 
	mid
;

69 
__u32
 
	m£q
;

70 
__u32
 
	mack
;

72 
__u16
 
	mÀn
;

73 
__u16
 
	mÊags
;

74 
__u8
 
	md©a
[0];

	@/usr/include/linux/errno.h

1 
	~<asm/î∫o.h
>

	@/usr/include/linux/fb.h

1 #i‚de‡
_LINUX_FB_H


2 
	#_LINUX_FB_H


	)

4 
	~<löux/ty≥s.h
>

5 
	~<löux/i2c.h
>

9 
	#FB_MAX
 32

	)

13 
	#FBIOGET_VSCREENINFO
 0x4600

	)

14 
	#FBIOPUT_VSCREENINFO
 0x4601

	)

15 
	#FBIOGET_FSCREENINFO
 0x4602

	)

16 
	#FBIOGETCMAP
 0x4604

	)

17 
	#FBIOPUTCMAP
 0x4605

	)

18 
	#FBIOPAN_DISPLAY
 0x4606

	)

19 
	#FBIO_CURSOR
 
	`_IOWR
('F', 0x08, 
fb_curs‹
)

	)

24 
	#FBIOGET_CON2FBMAP
 0x460F

	)

25 
	#FBIOPUT_CON2FBMAP
 0x4610

	)

26 
	#FBIOBLANK
 0x4611

	)

27 
	#FBIOGET_VBLANK
 
	`_IOR
('F', 0x12, 
fb_vbœnk
)

	)

28 
	#FBIO_ALLOC
 0x4613

	)

29 
	#FBIO_FREE
 0x4614

	)

30 
	#FBIOGET_GLYPH
 0x4615

	)

31 
	#FBIOGET_HWCINFO
 0x4616

	)

32 
	#FBIOPUT_MODEINFO
 0x4617

	)

33 
	#FBIOGET_DISPINFO
 0x4618

	)

34 
	#FBIO_WAITFORVSYNC
 
	`_IOW
('F', 0x20, 
__u32
)

	)

36 
	#FB_TYPE_PACKED_PIXELS
 0

	)

37 
	#FB_TYPE_PLANES
 1

	)

38 
	#FB_TYPE_INTERLEAVED_PLANES
 2

	)

39 
	#FB_TYPE_TEXT
 3

	)

40 
	#FB_TYPE_VGA_PLANES
 4

	)

41 
	#FB_TYPE_FOURCC
 5

	)

43 
	#FB_AUX_TEXT_MDA
 0

	)

44 
	#FB_AUX_TEXT_CGA
 1

	)

45 
	#FB_AUX_TEXT_S3_MMIO
 2

	)

46 
	#FB_AUX_TEXT_MGA_STEP16
 3

	)

47 
	#FB_AUX_TEXT_MGA_STEP8
 4

	)

48 
	#FB_AUX_TEXT_SVGA_GROUP
 8

	)

49 
	#FB_AUX_TEXT_SVGA_MASK
 7

	)

50 
	#FB_AUX_TEXT_SVGA_STEP2
 8

	)

51 
	#FB_AUX_TEXT_SVGA_STEP4
 9

	)

52 
	#FB_AUX_TEXT_SVGA_STEP8
 10

	)

53 
	#FB_AUX_TEXT_SVGA_STEP16
 11

	)

54 
	#FB_AUX_TEXT_SVGA_LAST
 15

	)

56 
	#FB_AUX_VGA_PLANES_VGA4
 0

	)

57 
	#FB_AUX_VGA_PLANES_CFB4
 1

	)

58 
	#FB_AUX_VGA_PLANES_CFB8
 2

	)

60 
	#FB_VISUAL_MONO01
 0

	)

61 
	#FB_VISUAL_MONO10
 1

	)

62 
	#FB_VISUAL_TRUECOLOR
 2

	)

63 
	#FB_VISUAL_PSEUDOCOLOR
 3

	)

64 
	#FB_VISUAL_DIRECTCOLOR
 4

	)

65 
	#FB_VISUAL_STATIC_PSEUDOCOLOR
 5

	)

66 
	#FB_VISUAL_FOURCC
 6

	)

68 
	#FB_ACCEL_NONE
 0

	)

69 
	#FB_ACCEL_ATARIBLITT
 1

	)

70 
	#FB_ACCEL_AMIGABLITT
 2

	)

71 
	#FB_ACCEL_S3_TRIO64
 3

	)

72 
	#FB_ACCEL_NCR_77C32BLT
 4

	)

73 
	#FB_ACCEL_S3_VIRGE
 5

	)

74 
	#FB_ACCEL_ATI_MACH64GX
 6

	)

75 
	#FB_ACCEL_DEC_TGA
 7

	)

76 
	#FB_ACCEL_ATI_MACH64CT
 8

	)

77 
	#FB_ACCEL_ATI_MACH64VT
 9

	)

78 
	#FB_ACCEL_ATI_MACH64GT
 10

	)

79 
	#FB_ACCEL_SUN_CREATOR
 11

	)

80 
	#FB_ACCEL_SUN_CGSIX
 12

	)

81 
	#FB_ACCEL_SUN_LEO
 13

	)

82 
	#FB_ACCEL_IMS_TWINTURBO
 14

	)

83 
	#FB_ACCEL_3DLABS_PERMEDIA2
 15

	)

84 
	#FB_ACCEL_MATROX_MGA2064W
 16

	)

85 
	#FB_ACCEL_MATROX_MGA1064SG
 17

	)

86 
	#FB_ACCEL_MATROX_MGA2164W
 18

	)

87 
	#FB_ACCEL_MATROX_MGA2164W_AGP
 19

	)

88 
	#FB_ACCEL_MATROX_MGAG100
 20

	)

89 
	#FB_ACCEL_MATROX_MGAG200
 21

	)

90 
	#FB_ACCEL_SUN_CG14
 22

	)

91 
	#FB_ACCEL_SUN_BWTWO
 23

	)

92 
	#FB_ACCEL_SUN_CGTHREE
 24

	)

93 
	#FB_ACCEL_SUN_TCX
 25

	)

94 
	#FB_ACCEL_MATROX_MGAG400
 26

	)

95 
	#FB_ACCEL_NV3
 27

	)

96 
	#FB_ACCEL_NV4
 28

	)

97 
	#FB_ACCEL_NV5
 29

	)

98 
	#FB_ACCEL_CT_6555x
 30

	)

99 
	#FB_ACCEL_3DFX_BANSHEE
 31

	)

100 
	#FB_ACCEL_ATI_RAGE128
 32

	)

101 
	#FB_ACCEL_IGS_CYBER2000
 33

	)

102 
	#FB_ACCEL_IGS_CYBER2010
 34

	)

103 
	#FB_ACCEL_IGS_CYBER5000
 35

	)

104 
	#FB_ACCEL_SIS_GLAMOUR
 36

	)

105 
	#FB_ACCEL_3DLABS_PERMEDIA3
 37

	)

106 
	#FB_ACCEL_ATI_RADEON
 38

	)

107 
	#FB_ACCEL_I810
 39

	)

108 
	#FB_ACCEL_SIS_GLAMOUR_2
 40

	)

109 
	#FB_ACCEL_SIS_XABRE
 41

	)

110 
	#FB_ACCEL_I830
 42

	)

111 
	#FB_ACCEL_NV_10
 43

	)

112 
	#FB_ACCEL_NV_20
 44

	)

113 
	#FB_ACCEL_NV_30
 45

	)

114 
	#FB_ACCEL_NV_40
 46

	)

115 
	#FB_ACCEL_XGI_VOLARI_V
 47

	)

116 
	#FB_ACCEL_XGI_VOLARI_Z
 48

	)

117 
	#FB_ACCEL_OMAP1610
 49

	)

118 
	#FB_ACCEL_TRIDENT_TGUI
 50

	)

119 
	#FB_ACCEL_TRIDENT_3DIMAGE
 51

	)

120 
	#FB_ACCEL_TRIDENT_BLADE3D
 52

	)

121 
	#FB_ACCEL_TRIDENT_BLADEXP
 53

	)

122 
	#FB_ACCEL_CIRRUS_ALPINE
 53

	)

123 
	#FB_ACCEL_NEOMAGIC_NM2070
 90

	)

124 
	#FB_ACCEL_NEOMAGIC_NM2090
 91

	)

125 
	#FB_ACCEL_NEOMAGIC_NM2093
 92

	)

126 
	#FB_ACCEL_NEOMAGIC_NM2097
 93

	)

127 
	#FB_ACCEL_NEOMAGIC_NM2160
 94

	)

128 
	#FB_ACCEL_NEOMAGIC_NM2200
 95

	)

129 
	#FB_ACCEL_NEOMAGIC_NM2230
 96

	)

130 
	#FB_ACCEL_NEOMAGIC_NM2360
 97

	)

131 
	#FB_ACCEL_NEOMAGIC_NM2380
 98

	)

132 
	#FB_ACCEL_PXA3XX
 99

	)

134 
	#FB_ACCEL_SAVAGE4
 0x80

	)

135 
	#FB_ACCEL_SAVAGE3D
 0x81

	)

136 
	#FB_ACCEL_SAVAGE3D_MV
 0x82

	)

137 
	#FB_ACCEL_SAVAGE2000
 0x83

	)

138 
	#FB_ACCEL_SAVAGE_MX_MV
 0x84

	)

139 
	#FB_ACCEL_SAVAGE_MX
 0x85

	)

140 
	#FB_ACCEL_SAVAGE_IX_MV
 0x86

	)

141 
	#FB_ACCEL_SAVAGE_IX
 0x87

	)

142 
	#FB_ACCEL_PROSAVAGE_PM
 0x88

	)

143 
	#FB_ACCEL_PROSAVAGE_KM
 0x89

	)

144 
	#FB_ACCEL_S3TWISTER_P
 0x8®

	)

145 
	#FB_ACCEL_S3TWISTER_K
 0x8b

	)

146 
	#FB_ACCEL_SUPERSAVAGE
 0x8¯

	)

147 
	#FB_ACCEL_PROSAVAGE_DDR
 0x8d

	)

148 
	#FB_ACCEL_PROSAVAGE_DDRK
 0x8ê

	)

150 
	#FB_ACCEL_PUV3_UNIGFX
 0xa0

	)

152 
	#FB_CAP_FOURCC
 1

	)

154 
	sfb_fix_s¸ìnöfo
 {

155 
	mid
[16];

156 
	msmem_°¨t
;

158 
__u32
 
	msmem_Àn
;

159 
__u32
 
	mty≥
;

160 
__u32
 
	mty≥_aux
;

161 
__u32
 
	mvisuÆ
;

162 
__u16
 
	mx∑n°ï
;

163 
__u16
 
	my∑n°ï
;

164 
__u16
 
	mywøp°ï
;

165 
__u32
 
	mlöe_Àngth
;

166 
	mmmio_°¨t
;

168 
__u32
 
	mmmio_Àn
;

169 
__u32
 
	mac˚l
;

171 
__u16
 
	mˇ∑bûôõs
;

172 
__u16
 
	mª£rved
[2];

185 
	sfb_bôfõld
 {

186 
__u32
 
	moff£t
;

187 
__u32
 
	mÀngth
;

188 
__u32
 
	mmsb_right
;

192 
	#FB_NONSTD_HAM
 1

	)

193 
	#FB_NONSTD_REV_PIX_IN_B
 2

	)

195 
	#FB_ACTIVATE_NOW
 0

	)

196 
	#FB_ACTIVATE_NXTOPEN
 1

	)

197 
	#FB_ACTIVATE_TEST
 2

	)

198 
	#FB_ACTIVATE_MASK
 15

	)

200 
	#FB_ACTIVATE_VBL
 16

	)

201 
	#FB_CHANGE_CMAP_VBL
 32

	)

202 
	#FB_ACTIVATE_ALL
 64

	)

203 
	#FB_ACTIVATE_FORCE
 128

	)

204 
	#FB_ACTIVATE_INV_MODE
 256

	)

206 
	#FB_ACCELF_TEXT
 1

	)

208 
	#FB_SYNC_HOR_HIGH_ACT
 1

	)

209 
	#FB_SYNC_VERT_HIGH_ACT
 2

	)

210 
	#FB_SYNC_EXT
 4

	)

211 
	#FB_SYNC_COMP_HIGH_ACT
 8

	)

212 
	#FB_SYNC_BROADCAST
 16

	)

215 
	#FB_SYNC_ON_GREEN
 32

	)

217 
	#FB_VMODE_NONINTERLACED
 0

	)

218 
	#FB_VMODE_INTERLACED
 1

	)

219 
	#FB_VMODE_DOUBLE
 2

	)

220 
	#FB_VMODE_ODD_FLD_FIRST
 4

	)

221 
	#FB_VMODE_MASK
 255

	)

223 
	#FB_VMODE_YWRAP
 256

	)

224 
	#FB_VMODE_SMOOTH_XPAN
 512

	)

225 
	#FB_VMODE_CONUPDATE
 512

	)

230 
	#FB_ROTATE_UR
 0

	)

231 
	#FB_ROTATE_CW
 1

	)

232 
	#FB_ROTATE_UD
 2

	)

233 
	#FB_ROTATE_CCW
 3

	)

235 
	#PICOS2KHZ
(
a
Ë(1000000000UL/◊))

	)

236 
	#KHZ2PICOS
(
a
Ë(1000000000UL/◊))

	)

238 
	sfb_v¨_s¸ìnöfo
 {

239 
__u32
 
	mxªs
;

240 
__u32
 
	myªs
;

241 
__u32
 
	mxªs_vútuÆ
;

242 
__u32
 
	myªs_vútuÆ
;

243 
__u32
 
	mxoff£t
;

244 
__u32
 
	myoff£t
;

246 
__u32
 
	mbôs_≥r_pixñ
;

247 
__u32
 
	mgøysˇÀ
;

249 
fb_bôfõld
 
	mªd
;

250 
fb_bôfõld
 
	mgªí
;

251 
fb_bôfõld
 
	mblue
;

252 
fb_bôfõld
 
	må™•
;

254 
__u32
 
	mn⁄°d
;

256 
__u32
 
	ma˘iv©e
;

258 
__u32
 
	mheight
;

259 
__u32
 
	mwidth
;

261 
__u32
 
	mac˚l_Êags
;

264 
__u32
 
	mpix˛ock
;

265 
__u32
 
	mÀ·_m¨gö
;

266 
__u32
 
	mright_m¨gö
;

267 
__u32
 
	muµî_m¨gö
;

268 
__u32
 
	mlowî_m¨gö
;

269 
__u32
 
	mhsync_Àn
;

270 
__u32
 
	mvsync_Àn
;

271 
__u32
 
	msync
;

272 
__u32
 
	mvmode
;

273 
__u32
 
	mrŸ©e
;

274 
__u32
 
	mcﬁ‹•a˚
;

275 
__u32
 
	mª£rved
[4];

278 
	sfb_cm≠
 {

279 
__u32
 
	m°¨t
;

280 
__u32
 
	mÀn
;

281 
__u16
 *
	mªd
;

282 
__u16
 *
	mgªí
;

283 
__u16
 *
	mblue
;

284 
__u16
 *
	må™•
;

287 
	sfb_c⁄2fbm≠
 {

288 
__u32
 
	mc⁄sﬁe
;

289 
__u32
 
	m‰amebuf„r
;

293 
	#VESA_NO_BLANKING
 0

	)

294 
	#VESA_VSYNC_SUSPEND
 1

	)

295 
	#VESA_HSYNC_SUSPEND
 2

	)

296 
	#VESA_POWERDOWN
 3

	)

301 
	mFB_BLANK_UNBLANK
 = 
VESA_NO_BLANKING
,

304 
	mFB_BLANK_NORMAL
 = 
VESA_NO_BLANKING
 + 1,

307 
	mFB_BLANK_VSYNC_SUSPEND
 = 
VESA_VSYNC_SUSPEND
 + 1,

310 
	mFB_BLANK_HSYNC_SUSPEND
 = 
VESA_HSYNC_SUSPEND
 + 1,

313 
	mFB_BLANK_POWERDOWN
 = 
VESA_POWERDOWN
 + 1

316 
	#FB_VBLANK_VBLANKING
 0x001

	)

317 
	#FB_VBLANK_HBLANKING
 0x002

	)

318 
	#FB_VBLANK_HAVE_VBLANK
 0x004

	)

319 
	#FB_VBLANK_HAVE_HBLANK
 0x008

	)

320 
	#FB_VBLANK_HAVE_COUNT
 0x010

	)

321 
	#FB_VBLANK_HAVE_VCOUNT
 0x020

	)

322 
	#FB_VBLANK_HAVE_HCOUNT
 0x040

	)

323 
	#FB_VBLANK_VSYNCING
 0x080

	)

324 
	#FB_VBLANK_HAVE_VSYNC
 0x100

	)

326 
	sfb_vbœnk
 {

327 
__u32
 
	mÊags
;

328 
__u32
 
	mcou¡
;

329 
__u32
 
	mvcou¡
;

330 
__u32
 
	mhcou¡
;

331 
__u32
 
	mª£rved
[4];

335 
	#ROP_COPY
 0

	)

336 
	#ROP_XOR
 1

	)

338 
	sfb_c›y¨ó
 {

339 
__u32
 
	mdx
;

340 
__u32
 
	mdy
;

341 
__u32
 
	mwidth
;

342 
__u32
 
	mheight
;

343 
__u32
 
	msx
;

344 
__u32
 
	msy
;

347 
	sfb_fûÃe˘
 {

348 
__u32
 
	mdx
;

349 
__u32
 
	mdy
;

350 
__u32
 
	mwidth
;

351 
__u32
 
	mheight
;

352 
__u32
 
	mcﬁ‹
;

353 
__u32
 
	mr›
;

356 
	sfb_image
 {

357 
__u32
 
	mdx
;

358 
__u32
 
	mdy
;

359 
__u32
 
	mwidth
;

360 
__u32
 
	mheight
;

361 
__u32
 
	mfg_cﬁ‹
;

362 
__u32
 
	mbg_cﬁ‹
;

363 
__u8
 
	mdïth
;

364 c⁄° *
	md©a
;

365 
fb_cm≠
 
	mcm≠
;

372 
	#FB_CUR_SETIMAGE
 0x01

	)

373 
	#FB_CUR_SETPOS
 0x02

	)

374 
	#FB_CUR_SETHOT
 0x04

	)

375 
	#FB_CUR_SETCMAP
 0x08

	)

376 
	#FB_CUR_SETSHAPE
 0x10

	)

377 
	#FB_CUR_SETSIZE
 0x20

	)

378 
	#FB_CUR_SETALL
 0xFF

	)

380 
	sfbcuΩos
 {

381 
__u16
 
	mx
, 
	my
;

384 
	sfb_curs‹
 {

385 
__u16
 
	m£t
;

386 
__u16
 
	míabÀ
;

387 
__u16
 
	mr›
;

388 c⁄° *
	mmask
;

389 
fbcuΩos
 
	mhŸ
;

390 
fb_image
 
	mimage
;

393 #ifde‡
CONFIG_FB_BACKLIGHT


395 
	#FB_BACKLIGHT_LEVELS
 128

	)

396 
	#FB_BACKLIGHT_MAX
 0xFF

	)

	@/usr/include/linux/fs.h

1 #i‚de‡
_LINUX_FS_H


2 
	#_LINUX_FS_H


	)

9 
	~<löux/limôs.h
>

10 
	~<löux/io˘l.h
>

11 
	~<löux/ty≥s.h
>

24 #unde‡
NR_OPEN


25 
	#INR_OPEN_CUR
 1024

	)

26 
	#INR_OPEN_MAX
 4096

	)

28 
	#BLOCK_SIZE_BITS
 10

	)

29 
	#BLOCK_SIZE
 (1<<
BLOCK_SIZE_BITS
)

	)

31 
	#SEEK_SET
 0

	)

32 
	#SEEK_CUR
 1

	)

33 
	#SEEK_END
 2

	)

34 
	#SEEK_DATA
 3

	)

35 
	#SEEK_HOLE
 4

	)

36 
	#SEEK_MAX
 
SEEK_HOLE


	)

38 
	sf°rim_ønge
 {

39 
__u64
 
	m°¨t
;

40 
__u64
 
	mÀn
;

41 
__u64
 
	mmöÀn
;

45 
	sfûes_°©_°ru˘
 {

46 
	mƒ_fûes
;

47 
	mƒ_‰ì_fûes
;

48 
	mmax_fûes
;

51 
	söodes_°©_t
 {

52 
	mƒ_öodes
;

53 
	mƒ_unu£d
;

54 
	mdummy
[5];

58 
	#NR_FILE
 8192

	)

64 
	#MS_RDONLY
 1

	)

65 
	#MS_NOSUID
 2

	)

66 
	#MS_NODEV
 4

	)

67 
	#MS_NOEXEC
 8

	)

68 
	#MS_SYNCHRONOUS
 16

	)

69 
	#MS_REMOUNT
 32

	)

70 
	#MS_MANDLOCK
 64

	)

71 
	#MS_DIRSYNC
 128

	)

72 
	#MS_NOATIME
 1024

	)

73 
	#MS_NODIRATIME
 2048

	)

74 
	#MS_BIND
 4096

	)

75 
	#MS_MOVE
 8192

	)

76 
	#MS_REC
 16384

	)

77 
	#MS_VERBOSE
 32768

	)

79 
	#MS_SILENT
 32768

	)

80 
	#MS_POSIXACL
 (1<<16Ë

	)

81 
	#MS_UNBINDABLE
 (1<<17Ë

	)

82 
	#MS_PRIVATE
 (1<<18Ë

	)

83 
	#MS_SLAVE
 (1<<19Ë

	)

84 
	#MS_SHARED
 (1<<20Ë

	)

85 
	#MS_RELATIME
 (1<<21Ë

	)

86 
	#MS_KERNMOUNT
 (1<<22Ë

	)

87 
	#MS_I_VERSION
 (1<<23Ë

	)

88 
	#MS_STRICTATIME
 (1<<24Ë

	)

91 
	#MS_SNAP_STABLE
 (1<<27Ë

	)

92 
	#MS_NOSEC
 (1<<28)

	)

93 
	#MS_BORN
 (1<<29)

	)

94 
	#MS_ACTIVE
 (1<<30)

	)

95 
	#MS_NOUSER
 (1<<31)

	)

100 
	#MS_RMT_MASK
 (
MS_RDONLY
|
MS_SYNCHRONOUS
|
MS_MANDLOCK
|
MS_I_VERSION
)

	)

105 
	#MS_MGC_VAL
 0xC0ED0000

	)

106 
	#MS_MGC_MSK
 0xffff0000

	)

111 
	#BLKROSET
 
	`_IO
(0x12,93Ë

	)

112 
	#BLKROGET
 
	`_IO
(0x12,94Ë

	)

113 
	#BLKRRPART
 
	`_IO
(0x12,95Ë

	)

114 
	#BLKGETSIZE
 
	`_IO
(0x12,96Ë

	)

115 
	#BLKFLSBUF
 
	`_IO
(0x12,97Ë

	)

116 
	#BLKRASET
 
	`_IO
(0x12,98Ë

	)

117 
	#BLKRAGET
 
	`_IO
(0x12,99Ë

	)

118 
	#BLKFRASET
 
	`_IO
(0x12,100)

	)

119 
	#BLKFRAGET
 
	`_IO
(0x12,101)

	)

120 
	#BLKSECTSET
 
	`_IO
(0x12,102)

	)

121 
	#BLKSECTGET
 
	`_IO
(0x12,103)

	)

122 
	#BLKSSZGET
 
	`_IO
(0x12,104)

	)

124 
	#BLKPG
 
	`_IO
(0x12,105)

	)

128 
	#BLKELVGET
 
	`_IOR
(0x12,106,
size_t
)

	)

129 
	#BLKELVSET
 
	`_IOW
(0x12,107,
size_t
)

	)

134 
	#BLKBSZGET
 
	`_IOR
(0x12,112,
size_t
)

	)

135 
	#BLKBSZSET
 
	`_IOW
(0x12,113,
size_t
)

	)

136 
	#BLKGETSIZE64
 
	`_IOR
(0x12,114,
size_t
Ë

	)

137 
	#BLKTRACESETUP
 
	`_IOWR
(0x12,115,
blk_u£r_åa˚_£tup
)

	)

138 
	#BLKTRACESTART
 
	`_IO
(0x12,116)

	)

139 
	#BLKTRACESTOP
 
	`_IO
(0x12,117)

	)

140 
	#BLKTRACETEARDOWN
 
	`_IO
(0x12,118)

	)

141 
	#BLKDISCARD
 
	`_IO
(0x12,119)

	)

142 
	#BLKIOMIN
 
	`_IO
(0x12,120)

	)

143 
	#BLKIOOPT
 
	`_IO
(0x12,121)

	)

144 
	#BLKALIGNOFF
 
	`_IO
(0x12,122)

	)

145 
	#BLKPBSZGET
 
	`_IO
(0x12,123)

	)

146 
	#BLKDISCARDZEROES
 
	`_IO
(0x12,124)

	)

147 
	#BLKSECDISCARD
 
	`_IO
(0x12,125)

	)

148 
	#BLKROTATIONAL
 
	`_IO
(0x12,126)

	)

149 
	#BLKZEROOUT
 
	`_IO
(0x12,127)

	)

151 
	#BMAP_IOCTL
 1

	)

152 
	#FIBMAP
 
	`_IO
(0x00,1Ë

	)

153 
	#FIGETBSZ
 
	`_IO
(0x00,2Ë

	)

154 
	#FIFREEZE
 
	`_IOWR
('X', 119, Ë

	)

155 
	#FITHAW
 
	`_IOWR
('X', 120, Ë

	)

156 
	#FITRIM
 
	`_IOWR
('X', 121, 
f°rim_ønge
Ë

	)

158 
	#FS_IOC_GETFLAGS
 
	`_IOR
('f', 1, )

	)

159 
	#FS_IOC_SETFLAGS
 
	`_IOW
('f', 2, )

	)

160 
	#FS_IOC_GETVERSION
 
	`_IOR
('v', 1, )

	)

161 
	#FS_IOC_SETVERSION
 
	`_IOW
('v', 2, )

	)

162 
	#FS_IOC_FIEMAP
 
	`_IOWR
('f', 11, 
fõm≠
)

	)

163 
	#FS_IOC32_GETFLAGS
 
	`_IOR
('f', 1, )

	)

164 
	#FS_IOC32_SETFLAGS
 
	`_IOW
('f', 2, )

	)

165 
	#FS_IOC32_GETVERSION
 
	`_IOR
('v', 1, )

	)

166 
	#FS_IOC32_SETVERSION
 
	`_IOW
('v', 2, )

	)

171 
	#FS_SECRM_FL
 0x00000001

	)

172 
	#FS_UNRM_FL
 0x00000002

	)

173 
	#FS_COMPR_FL
 0x00000004

	)

174 
	#FS_SYNC_FL
 0x00000008

	)

175 
	#FS_IMMUTABLE_FL
 0x00000010

	)

176 
	#FS_APPEND_FL
 0x00000020

	)

177 
	#FS_NODUMP_FL
 0x00000040

	)

178 
	#FS_NOATIME_FL
 0x00000080

	)

180 
	#FS_DIRTY_FL
 0x00000100

	)

181 
	#FS_COMPRBLK_FL
 0x00000200

	)

182 
	#FS_NOCOMP_FL
 0x00000400

	)

183 
	#FS_ECOMPR_FL
 0x00000800

	)

185 
	#FS_BTREE_FL
 0x00001000

	)

186 
	#FS_INDEX_FL
 0x00001000

	)

187 
	#FS_IMAGIC_FL
 0x00002000

	)

188 
	#FS_JOURNAL_DATA_FL
 0x00004000

	)

189 
	#FS_NOTAIL_FL
 0x00008000

	)

190 
	#FS_DIRSYNC_FL
 0x00010000

	)

191 
	#FS_TOPDIR_FL
 0x00020000

	)

192 
	#FS_EXTENT_FL
 0x00080000

	)

193 
	#FS_DIRECTIO_FL
 0x00100000

	)

194 
	#FS_NOCOW_FL
 0x00800000

	)

195 
	#FS_RESERVED_FL
 0x80000000

	)

197 
	#FS_FL_USER_VISIBLE
 0x0003DFFF

	)

198 
	#FS_FL_USER_MODIFIABLE
 0x000380FF

	)

201 
	#SYNC_FILE_RANGE_WAIT_BEFORE
 1

	)

202 
	#SYNC_FILE_RANGE_WRITE
 2

	)

203 
	#SYNC_FILE_RANGE_WAIT_AFTER
 4

	)

	@/usr/include/linux/ioctl.h

1 #i‚de‡
_LINUX_IOCTL_H


2 
	#_LINUX_IOCTL_H


	)

4 
	~<asm/io˘l.h
>

	@/usr/include/linux/kernel.h

1 #i‚de‡
_LINUX_KERNEL_H


2 
	#_LINUX_KERNEL_H


	)

4 
	~<löux/sysöfo.h
>

9 
	#__ALIGN_KERNEL
(
x
, 
a
Ë
	`__ALIGN_KERNEL_MASK
(x, (
	`ty≥of
(x))◊Ë- 1)

	)

10 
	#__ALIGN_KERNEL_MASK
(
x
, 
mask
Ë(((xË+ (mask)Ë& ~(mask))

	)

	@/usr/include/linux/magic.h

1 #i‚de‡
__LINUX_MAGIC_H__


2 
	#__LINUX_MAGIC_H__


	)

4 
	#ADFS_SUPER_MAGIC
 0xadf5

	)

5 
	#AFFS_SUPER_MAGIC
 0xadff

	)

6 
	#AFS_SUPER_MAGIC
 0x5346414F

	)

7 
	#AUTOFS_SUPER_MAGIC
 0x0187

	)

8 
	#CODA_SUPER_MAGIC
 0x73757245

	)

9 
	#CRAMFS_MAGIC
 0x28cd3d45

	)

10 
	#CRAMFS_MAGIC_WEND
 0x453dcd28

	)

11 
	#DEBUGFS_MAGIC
 0x64626720

	)

12 
	#SECURITYFS_MAGIC
 0x73636673

	)

13 
	#SELINUX_MAGIC
 0xf97cff8c

	)

14 
	#RAMFS_MAGIC
 0x858458f6

	)

15 
	#TMPFS_MAGIC
 0x01021994

	)

16 
	#HUGETLBFS_MAGIC
 0x958458f6

	)

17 
	#SQUASHFS_MAGIC
 0x73717368

	)

18 
	#ECRYPTFS_SUPER_MAGIC
 0xf15f

	)

19 
	#EFS_SUPER_MAGIC
 0x414A53

	)

20 
	#EXT2_SUPER_MAGIC
 0xEF53

	)

21 
	#EXT3_SUPER_MAGIC
 0xEF53

	)

22 
	#XENFS_SUPER_MAGIC
 0xabba1974

	)

23 
	#EXT4_SUPER_MAGIC
 0xEF53

	)

24 
	#BTRFS_SUPER_MAGIC
 0x9123683E

	)

25 
	#NILFS_SUPER_MAGIC
 0x3434

	)

26 
	#F2FS_SUPER_MAGIC
 0xF2F52010

	)

27 
	#HPFS_SUPER_MAGIC
 0xf995e849

	)

28 
	#ISOFS_SUPER_MAGIC
 0x9660

	)

29 
	#JFFS2_SUPER_MAGIC
 0x72b6

	)

30 
	#PSTOREFS_MAGIC
 0x6165676C

	)

31 
	#EFIVARFS_MAGIC
 0xde5e81e4

	)

33 
	#MINIX_SUPER_MAGIC
 0x137F

	)

34 
	#MINIX_SUPER_MAGIC2
 0x138F

	)

35 
	#MINIX2_SUPER_MAGIC
 0x2468

	)

36 
	#MINIX2_SUPER_MAGIC2
 0x2478

	)

37 
	#MINIX3_SUPER_MAGIC
 0x4d5®

	)

39 
	#MSDOS_SUPER_MAGIC
 0x4d44

	)

40 
	#NCP_SUPER_MAGIC
 0x564¯

	)

41 
	#NFS_SUPER_MAGIC
 0x6969

	)

42 
	#OPENPROM_SUPER_MAGIC
 0x9Á1

	)

43 
	#QNX4_SUPER_MAGIC
 0x002‡

	)

44 
	#QNX6_SUPER_MAGIC
 0x68191122

	)

46 
	#REISERFS_SUPER_MAGIC
 0x52654973

	)

49 
	#REISERFS_SUPER_MAGIC_STRING
 "ReIsErFs"

	)

50 
	#REISER2FS_SUPER_MAGIC_STRING
 "ReIsEr2Fs"

	)

51 
	#REISER2FS_JR_SUPER_MAGIC_STRING
 "ReIsEr3Fs"

	)

53 
	#SMB_SUPER_MAGIC
 0x517B

	)

54 
	#CGROUP_SUPER_MAGIC
 0x27e0eb

	)

57 
	#STACK_END_MAGIC
 0x57AC6E9D

	)

59 
	#V9FS_MAGIC
 0x01021997

	)

61 
	#BDEVFS_MAGIC
 0x62646576

	)

62 
	#BINFMTFS_MAGIC
 0x42494e4d

	)

63 
	#DEVPTS_SUPER_MAGIC
 0x1cd1

	)

64 
	#FUTEXFS_SUPER_MAGIC
 0xBAD1DEA

	)

65 
	#PIPEFS_MAGIC
 0x50495045

	)

66 
	#PROC_SUPER_MAGIC
 0x9Á0

	)

67 
	#SOCKFS_MAGIC
 0x534F434B

	)

68 
	#SYSFS_MAGIC
 0x62656572

	)

69 
	#USBDEVICE_SUPER_MAGIC
 0x9Á2

	)

70 
	#MTD_INODE_FS_MAGIC
 0x11307854

	)

71 
	#ANON_INODE_FS_MAGIC
 0x09041934

	)

	@/usr/include/linux/mempolicy.h

5 #i‚de‡
_LINUX_MEMPOLICY_H


6 
	#_LINUX_MEMPOLICY_H


	)

8 
	~<löux/î∫o.h
>

19 
	mMPOL_DEFAULT
,

20 
	mMPOL_PREFERRED
,

21 
	mMPOL_BIND
,

22 
	mMPOL_INTERLEAVE
,

23 
	mMPOL_LOCAL
,

24 
	mMPOL_MAX
,

27 
	empﬁ_ªböd_°ï
 {

28 
	mMPOL_REBIND_ONCE
,

29 
	mMPOL_REBIND_STEP1
,

30 
	mMPOL_REBIND_STEP2
,

31 
	mMPOL_REBIND_NSTEP
,

35 
	#MPOL_F_STATIC_NODES
 (1 << 15)

	)

36 
	#MPOL_F_RELATIVE_NODES
 (1 << 14)

	)

42 
	#MPOL_MODE_FLAGS
 (
MPOL_F_STATIC_NODES
 | 
MPOL_F_RELATIVE_NODES
)

	)

45 
	#MPOL_F_NODE
 (1<<0Ë

	)

46 
	#MPOL_F_ADDR
 (1<<1Ë

	)

47 
	#MPOL_F_MEMS_ALLOWED
 (1<<2Ë

	)

50 
	#MPOL_MF_STRICT
 (1<<0Ë

	)

51 
	#MPOL_MF_MOVE
 (1<<1Ë

	)

53 
	#MPOL_MF_MOVE_ALL
 (1<<2Ë

	)

54 
	#MPOL_MF_LAZY
 (1<<3Ë

	)

55 
	#MPOL_MF_INTERNAL
 (1<<4Ë

	)

57 
	#MPOL_MF_VALID
 (
MPOL_MF_STRICT
 | \

58 
MPOL_MF_MOVE
 | \

59 
MPOL_MF_MOVE_ALL
)

	)

66 
	#MPOL_F_SHARED
 (1 << 0Ë

	)

67 
	#MPOL_F_LOCAL
 (1 << 1Ë

	)

68 
	#MPOL_F_REBINDING
 (1 << 2Ë

	)

69 
	#MPOL_F_MOF
 (1 << 3Ë

	)

70 
	#MPOL_F_MORON
 (1 << 4Ë

	)

	@/usr/include/linux/mman.h

1 #i‚de‡
_LINUX_MMAN_H


2 
	#_LINUX_MMAN_H


	)

4 
	~<asm/mm™.h
>

6 
	#MREMAP_MAYMOVE
 1

	)

7 
	#MREMAP_FIXED
 2

	)

9 
	#OVERCOMMIT_GUESS
 0

	)

10 
	#OVERCOMMIT_ALWAYS
 1

	)

11 
	#OVERCOMMIT_NEVER
 2

	)

	@/usr/include/linux/sched.h

1 #i‚de‡
_LINUX_SCHED_H


2 
	#_LINUX_SCHED_H


	)

7 
	#CSIGNAL
 0x000000f‡

	)

8 
	#CLONE_VM
 0x00000100

	)

9 
	#CLONE_FS
 0x00000200

	)

10 
	#CLONE_FILES
 0x00000400

	)

11 
	#CLONE_SIGHAND
 0x00000800

	)

12 
	#CLONE_PTRACE
 0x00002000

	)

13 
	#CLONE_VFORK
 0x00004000

	)

14 
	#CLONE_PARENT
 0x00008000

	)

15 
	#CLONE_THREAD
 0x00010000

	)

16 
	#CLONE_NEWNS
 0x00020000

	)

17 
	#CLONE_SYSVSEM
 0x00040000

	)

18 
	#CLONE_SETTLS
 0x00080000

	)

19 
	#CLONE_PARENT_SETTID
 0x00100000

	)

20 
	#CLONE_CHILD_CLEARTID
 0x00200000

	)

21 
	#CLONE_DETACHED
 0x00400000

	)

22 
	#CLONE_UNTRACED
 0x00800000

	)

23 
	#CLONE_CHILD_SETTID
 0x01000000

	)

26 
	#CLONE_NEWUTS
 0x04000000

	)

27 
	#CLONE_NEWIPC
 0x08000000

	)

28 
	#CLONE_NEWUSER
 0x10000000

	)

29 
	#CLONE_NEWPID
 0x20000000

	)

30 
	#CLONE_NEWNET
 0x40000000

	)

31 
	#CLONE_IO
 0x80000000

	)

36 
	#SCHED_NORMAL
 0

	)

37 
	#SCHED_FIFO
 1

	)

38 
	#SCHED_RR
 2

	)

39 
	#SCHED_BATCH
 3

	)

41 
	#SCHED_IDLE
 5

	)

43 
	#SCHED_RESET_ON_FORK
 0x40000000

	)

	@/usr/include/linux/string.h

1 #i‚de‡
_LINUX_STRING_H_


2 
	#_LINUX_STRING_H_


	)

6 
	~<°rög.h
>

	@/usr/include/linux/time.h

1 #i‚de‡
_LINUX_TIME_H


2 
	#_LINUX_TIME_H


	)

4 
	~<löux/ty≥s.h
>

7 #i‚de‡
_STRUCT_TIMESPEC


8 
	#_STRUCT_TIMESPEC


	)

9 
	stime•ec
 {

10 
__kî√l_time_t
 
	mtv_£c
;

11 
	mtv_n£c
;

15 
	stimevÆ
 {

16 
__kî√l_time_t
 
	mtv_£c
;

17 
__kî√l_su£c⁄ds_t
 
	mtv_u£c
;

20 
	stimez⁄e
 {

21 
	mtz_möuãswe°
;

22 
	mtz_d°time
;

30 
	#ITIMER_REAL
 0

	)

31 
	#ITIMER_VIRTUAL
 1

	)

32 
	#ITIMER_PROF
 2

	)

34 
	sôimî•ec
 {

35 
time•ec
 
	mô_öãrvÆ
;

36 
time•ec
 
	mô_vÆue
;

39 
	sôimîvÆ
 {

40 
timevÆ
 
	mô_öãrvÆ
;

41 
timevÆ
 
	mô_vÆue
;

47 
	#CLOCK_REALTIME
 0

	)

48 
	#CLOCK_MONOTONIC
 1

	)

49 
	#CLOCK_PROCESS_CPUTIME_ID
 2

	)

50 
	#CLOCK_THREAD_CPUTIME_ID
 3

	)

51 
	#CLOCK_MONOTONIC_RAW
 4

	)

52 
	#CLOCK_REALTIME_COARSE
 5

	)

53 
	#CLOCK_MONOTONIC_COARSE
 6

	)

54 
	#CLOCK_BOOTTIME
 7

	)

55 
	#CLOCK_REALTIME_ALARM
 8

	)

56 
	#CLOCK_BOOTTIME_ALARM
 9

	)

61 
	#CLOCK_SGI_CYCLE
 10

	)

62 
	#MAX_CLOCKS
 16

	)

63 
	#CLOCKS_MASK
 (
CLOCK_REALTIME
 | 
CLOCK_MONOTONIC
)

	)

64 
	#CLOCKS_MONO
 
CLOCK_MONOTONIC


	)

69 
	#TIMER_ABSTIME
 0x01

	)

	@/usr/include/linux/types.h

1 #i‚de‡
_LINUX_TYPES_H


2 
	#_LINUX_TYPES_H


	)

4 
	~<asm/ty≥s.h
>

6 #i‚de‡
__ASSEMBLY__


8 
	~<löux/posix_ty≥s.h
>

16 #ifde‡
__CHECKER__


17 
	#__bôwi£__
 
	`__©åibuã__
((
bôwi£
))

	)

19 
	#__bôwi£__


	)

21 #ifde‡
__CHECK_ENDIAN__


22 
	#__bôwi£
 
__bôwi£__


	)

24 
	#__bôwi£


	)

27 
__u16
 
	t__bôwi£
 
	t__À16
;

28 
__u16
 
	t__bôwi£
 
	t__be16
;

29 
__u32
 
	t__bôwi£
 
	t__À32
;

30 
__u32
 
	t__bôwi£
 
	t__be32
;

31 
__u64
 
	t__bôwi£
 
	t__À64
;

32 
__u64
 
	t__bôwi£
 
	t__be64
;

34 
__u16
 
	t__bôwi£
 
	t__sum16
;

35 
__u32
 
	t__bôwi£
 
	t__wsum
;

46 
	#__Æig√d_u64
 
__u64
 
	`__©åibuã__
((
	`Æig√d
(8)))

	)

47 
	#__Æig√d_be64
 
__be64
 
	`__©åibuã__
((
	`Æig√d
(8)))

	)

48 
	#__Æig√d_À64
 
__À64
 
	`__©åibuã__
((
	`Æig√d
(8)))

	)

	@/usr/include/linux/version.h

1 
	#LINUX_VERSION_CODE
 198912

	)

2 
	#KERNEL_VERSION
(
a
,
b
,
c
Ë((◊Ë<< 16Ë+ ((bË<< 8Ë+ (c))

	)

	@/usr/include/linux/wait.h

1 #i‚de‡
_LINUX_WAIT_H


2 
	#_LINUX_WAIT_H


	)

4 
	#WNOHANG
 0x00000001

	)

5 
	#WUNTRACED
 0x00000002

	)

6 
	#WSTOPPED
 
WUNTRACED


	)

7 
	#WEXITED
 0x00000004

	)

8 
	#WCONTINUED
 0x00000008

	)

9 
	#WNOWAIT
 0x01000000

	)

11 
	#__WNOTHREAD
 0x20000000

	)

12 
	#__WALL
 0x40000000

	)

13 
	#__WCLONE
 0x80000000

	)

16 
	#P_ALL
 0

	)

17 
	#P_PID
 1

	)

18 
	#P_PGID
 2

	)

	@/usr/include/asm-generic/errno.h

1 #i‚de‡
_ASM_GENERIC_ERRNO_H


2 
	#_ASM_GENERIC_ERRNO_H


	)

4 
	~<asm-gíîic/î∫o-ba£.h
>

6 
	#EDEADLK
 35

	)

7 
	#ENAMETOOLONG
 36

	)

8 
	#ENOLCK
 37

	)

9 
	#ENOSYS
 38

	)

10 
	#ENOTEMPTY
 39

	)

11 
	#ELOOP
 40

	)

12 
	#EWOULDBLOCK
 
EAGAIN


	)

13 
	#ENOMSG
 42

	)

14 
	#EIDRM
 43

	)

15 
	#ECHRNG
 44

	)

16 
	#EL2NSYNC
 45

	)

17 
	#EL3HLT
 46

	)

18 
	#EL3RST
 47

	)

19 
	#ELNRNG
 48

	)

20 
	#EUNATCH
 49

	)

21 
	#ENOCSI
 50

	)

22 
	#EL2HLT
 51

	)

23 
	#EBADE
 52

	)

24 
	#EBADR
 53

	)

25 
	#EXFULL
 54

	)

26 
	#ENOANO
 55

	)

27 
	#EBADRQC
 56

	)

28 
	#EBADSLT
 57

	)

30 
	#EDEADLOCK
 
EDEADLK


	)

32 
	#EBFONT
 59

	)

33 
	#ENOSTR
 60

	)

34 
	#ENODATA
 61

	)

35 
	#ETIME
 62

	)

36 
	#ENOSR
 63

	)

37 
	#ENONET
 64

	)

38 
	#ENOPKG
 65

	)

39 
	#EREMOTE
 66

	)

40 
	#ENOLINK
 67

	)

41 
	#EADV
 68

	)

42 
	#ESRMNT
 69

	)

43 
	#ECOMM
 70

	)

44 
	#EPROTO
 71

	)

45 
	#EMULTIHOP
 72

	)

46 
	#EDOTDOT
 73

	)

47 
	#EBADMSG
 74

	)

48 
	#EOVERFLOW
 75

	)

49 
	#ENOTUNIQ
 76

	)

50 
	#EBADFD
 77

	)

51 
	#EREMCHG
 78

	)

52 
	#ELIBACC
 79

	)

53 
	#ELIBBAD
 80

	)

54 
	#ELIBSCN
 81

	)

55 
	#ELIBMAX
 82

	)

56 
	#ELIBEXEC
 83

	)

57 
	#EILSEQ
 84

	)

58 
	#ERESTART
 85

	)

59 
	#ESTRPIPE
 86

	)

60 
	#EUSERS
 87

	)

61 
	#ENOTSOCK
 88

	)

62 
	#EDESTADDRREQ
 89

	)

63 
	#EMSGSIZE
 90

	)

64 
	#EPROTOTYPE
 91

	)

65 
	#ENOPROTOOPT
 92

	)

66 
	#EPROTONOSUPPORT
 93

	)

67 
	#ESOCKTNOSUPPORT
 94

	)

68 
	#EOPNOTSUPP
 95

	)

69 
	#EPFNOSUPPORT
 96

	)

70 
	#EAFNOSUPPORT
 97

	)

71 
	#EADDRINUSE
 98

	)

72 
	#EADDRNOTAVAIL
 99

	)

73 
	#ENETDOWN
 100

	)

74 
	#ENETUNREACH
 101

	)

75 
	#ENETRESET
 102

	)

76 
	#ECONNABORTED
 103

	)

77 
	#ECONNRESET
 104

	)

78 
	#ENOBUFS
 105

	)

79 
	#EISCONN
 106

	)

80 
	#ENOTCONN
 107

	)

81 
	#ESHUTDOWN
 108

	)

82 
	#ETOOMANYREFS
 109

	)

83 
	#ETIMEDOUT
 110

	)

84 
	#ECONNREFUSED
 111

	)

85 
	#EHOSTDOWN
 112

	)

86 
	#EHOSTUNREACH
 113

	)

87 
	#EALREADY
 114

	)

88 
	#EINPROGRESS
 115

	)

89 
	#ESTALE
 116

	)

90 
	#EUCLEAN
 117

	)

91 
	#ENOTNAM
 118

	)

92 
	#ENAVAIL
 119

	)

93 
	#EISNAM
 120

	)

94 
	#EREMOTEIO
 121

	)

95 
	#EDQUOT
 122

	)

97 
	#ENOMEDIUM
 123

	)

98 
	#EMEDIUMTYPE
 124

	)

99 
	#ECANCELED
 125

	)

100 
	#ENOKEY
 126

	)

101 
	#EKEYEXPIRED
 127

	)

102 
	#EKEYREVOKED
 128

	)

103 
	#EKEYREJECTED
 129

	)

106 
	#EOWNERDEAD
 130

	)

107 
	#ENOTRECOVERABLE
 131

	)

109 
	#ERFKILL
 132

	)

111 
	#EHWPOISON
 133

	)

	@/usr/include/asm-generic/fcntl.h

1 #i‚de‡
_ASM_GENERIC_FCNTL_H


2 
	#_ASM_GENERIC_FCNTL_H


	)

4 
	~<löux/ty≥s.h
>

18 
	#O_ACCMODE
 00000003

	)

19 
	#O_RDONLY
 00000000

	)

20 
	#O_WRONLY
 00000001

	)

21 
	#O_RDWR
 00000002

	)

22 #i‚de‡
O_CREAT


23 
	#O_CREAT
 00000100

	)

25 #i‚de‡
O_EXCL


26 
	#O_EXCL
 00000200

	)

28 #i‚de‡
O_NOCTTY


29 
	#O_NOCTTY
 00000400

	)

31 #i‚de‡
O_TRUNC


32 
	#O_TRUNC
 00001000

	)

34 #i‚de‡
O_APPEND


35 
	#O_APPEND
 00002000

	)

37 #i‚de‡
O_NONBLOCK


38 
	#O_NONBLOCK
 00004000

	)

40 #i‚de‡
O_DSYNC


41 
	#O_DSYNC
 00010000

	)

43 #i‚de‡
FASYNC


44 
	#FASYNC
 00020000

	)

46 #i‚de‡
O_DIRECT


47 
	#O_DIRECT
 00040000

	)

49 #i‚de‡
O_LARGEFILE


50 
	#O_LARGEFILE
 00100000

	)

52 #i‚de‡
O_DIRECTORY


53 
	#O_DIRECTORY
 00200000

	)

55 #i‚de‡
O_NOFOLLOW


56 
	#O_NOFOLLOW
 00400000

	)

58 #i‚de‡
O_NOATIME


59 
	#O_NOATIME
 01000000

	)

61 #i‚de‡
O_CLOEXEC


62 
	#O_CLOEXEC
 02000000

	)

78 #i‚de‡
O_SYNC


79 
	#__O_SYNC
 04000000

	)

80 
	#O_SYNC
 (
__O_SYNC
|
O_DSYNC
)

	)

83 #i‚de‡
O_PATH


84 
	#O_PATH
 010000000

	)

87 #i‚de‡
O_NDELAY


88 
	#O_NDELAY
 
O_NONBLOCK


	)

91 
	#F_DUPFD
 0

	)

92 
	#F_GETFD
 1

	)

93 
	#F_SETFD
 2

	)

94 
	#F_GETFL
 3

	)

95 
	#F_SETFL
 4

	)

96 #i‚de‡
F_GETLK


97 
	#F_GETLK
 5

	)

98 
	#F_SETLK
 6

	)

99 
	#F_SETLKW
 7

	)

101 #i‚de‡
F_SETOWN


102 
	#F_SETOWN
 8

	)

103 
	#F_GETOWN
 9

	)

105 #i‚de‡
F_SETSIG


106 
	#F_SETSIG
 10

	)

107 
	#F_GETSIG
 11

	)

110 #i‚de‡
CONFIG_64BIT


111 #i‚de‡
F_GETLK64


112 
	#F_GETLK64
 12

	)

113 
	#F_SETLK64
 13

	)

114 
	#F_SETLKW64
 14

	)

118 #i‚de‡
F_SETOWN_EX


119 
	#F_SETOWN_EX
 15

	)

120 
	#F_GETOWN_EX
 16

	)

123 #i‚de‡
F_GETOWNER_UIDS


124 
	#F_GETOWNER_UIDS
 17

	)

127 
	#F_OWNER_TID
 0

	)

128 
	#F_OWNER_PID
 1

	)

129 
	#F_OWNER_PGRP
 2

	)

131 
	s__kî√l_f_ow√r_ex
 {

132 
	mty≥
;

133 
__kî√l_pid_t
 
	mpid
;

137 
	#FD_CLOEXEC
 1

	)

140 #i‚de‡
F_RDLCK


141 
	#F_RDLCK
 0

	)

142 
	#F_WRLCK
 1

	)

143 
	#F_UNLCK
 2

	)

147 #i‚de‡
F_EXLCK


148 
	#F_EXLCK
 4

	)

149 
	#F_SHLCK
 8

	)

153 
	#LOCK_SH
 1

	)

154 
	#LOCK_EX
 2

	)

155 
	#LOCK_NB
 4

	)

157 
	#LOCK_UN
 8

	)

159 
	#LOCK_MAND
 32

	)

160 
	#LOCK_READ
 64

	)

161 
	#LOCK_WRITE
 128

	)

162 
	#LOCK_RW
 192

	)

164 
	#F_LINUX_SPECIFIC_BASE
 1024

	)

166 #i‚de‡
HAVE_ARCH_STRUCT_FLOCK


167 #i‚de‡
__ARCH_FLOCK_PAD


168 
	#__ARCH_FLOCK_PAD


	)

171 
	s__kî√l_Êock
 {

172 
	ml_ty≥
;

173 
	ml_whí˚
;

174 
__kî√l_off_t
 
	ml_°¨t
;

175 
__kî√l_off_t
 
	ml_Àn
;

176 
__kî√l_pid_t
 
	ml_pid
;

177 
	m__ARCH_FLOCK_PAD


181 #i‚de‡
CONFIG_64BIT


183 #i‚de‡
HAVE_ARCH_STRUCT_FLOCK64


184 #i‚de‡
__ARCH_FLOCK64_PAD


185 
	#__ARCH_FLOCK64_PAD


	)

188 
	s__kî√l_Êock64
 {

189 
	ml_ty≥
;

190 
	ml_whí˚
;

191 
__kî√l_loff_t
 
	ml_°¨t
;

192 
__kî√l_loff_t
 
	ml_Àn
;

193 
__kî√l_pid_t
 
	ml_pid
;

194 
	m__ARCH_FLOCK64_PAD


	@/usr/include/asm/ioctl.h

1 
	~<asm-gíîic/io˘l.h
>

	@/usr/include/asm/mman.h

1 #i‚de‡
_ASM_X86_MMAN_H


2 
	#_ASM_X86_MMAN_H


	)

4 
	#MAP_32BIT
 0x40

	)

6 
	#MAP_HUGE_2MB
 (21 << 
MAP_HUGE_SHIFT
)

	)

7 
	#MAP_HUGE_1GB
 (30 << 
MAP_HUGE_SHIFT
)

	)

9 
	~<asm-gíîic/mm™.h
>

	@/usr/include/asm/processor-flags.h

1 #i‚de‡
_ASM_X86_PROCESSOR_FLAGS_H


2 
	#_ASM_X86_PROCESSOR_FLAGS_H


	)

8 
	#X86_EFLAGS_CF
 0x00000001

	)

9 
	#X86_EFLAGS_BIT1
 0x00000002

	)

10 
	#X86_EFLAGS_PF
 0x00000004

	)

11 
	#X86_EFLAGS_AF
 0x00000010

	)

12 
	#X86_EFLAGS_ZF
 0x00000040

	)

13 
	#X86_EFLAGS_SF
 0x00000080

	)

14 
	#X86_EFLAGS_TF
 0x00000100

	)

15 
	#X86_EFLAGS_IF
 0x00000200

	)

16 
	#X86_EFLAGS_DF
 0x00000400

	)

17 
	#X86_EFLAGS_OF
 0x00000800

	)

18 
	#X86_EFLAGS_IOPL
 0x00003000

	)

19 
	#X86_EFLAGS_NT
 0x00004000

	)

20 
	#X86_EFLAGS_RF
 0x00010000

	)

21 
	#X86_EFLAGS_VM
 0x00020000

	)

22 
	#X86_EFLAGS_AC
 0x00040000

	)

23 
	#X86_EFLAGS_VIF
 0x00080000

	)

24 
	#X86_EFLAGS_VIP
 0x00100000

	)

25 
	#X86_EFLAGS_ID
 0x00200000

	)

30 
	#X86_CR0_PE
 0x00000001

	)

31 
	#X86_CR0_MP
 0x00000002

	)

32 
	#X86_CR0_EM
 0x00000004

	)

33 
	#X86_CR0_TS
 0x00000008

	)

34 
	#X86_CR0_ET
 0x00000010

	)

35 
	#X86_CR0_NE
 0x00000020

	)

36 
	#X86_CR0_WP
 0x00010000

	)

37 
	#X86_CR0_AM
 0x00040000

	)

38 
	#X86_CR0_NW
 0x20000000

	)

39 
	#X86_CR0_CD
 0x40000000

	)

40 
	#X86_CR0_PG
 0x80000000

	)

45 
	#X86_CR3_PWT
 0x00000008

	)

46 
	#X86_CR3_PCD
 0x00000010

	)

47 
	#X86_CR3_PCID_MASK
 0x00000ff‡

	)

52 
	#X86_CR4_VME
 0x00000001

	)

53 
	#X86_CR4_PVI
 0x00000002

	)

54 
	#X86_CR4_TSD
 0x00000004

	)

55 
	#X86_CR4_DE
 0x00000008

	)

56 
	#X86_CR4_PSE
 0x00000010

	)

57 
	#X86_CR4_PAE
 0x00000020

	)

58 
	#X86_CR4_MCE
 0x00000040

	)

59 
	#X86_CR4_PGE
 0x00000080

	)

60 
	#X86_CR4_PCE
 0x00000100

	)

61 
	#X86_CR4_OSFXSR
 0x00000200

	)

62 
	#X86_CR4_OSXMMEXCPT
 0x00000400

	)

63 
	#X86_CR4_VMXE
 0x00002000

	)

64 
	#X86_CR4_RDWRGSFS
 0x00010000

	)

65 
	#X86_CR4_PCIDE
 0x00020000

	)

66 
	#X86_CR4_OSXSAVE
 0x00040000

	)

67 
	#X86_CR4_SMEP
 0x00100000

	)

68 
	#X86_CR4_SMAP
 0x00200000

	)

73 
	#X86_CR8_TPR
 0x0000000F

	)

82 
	#CX86_PCR0
 0x20

	)

83 
	#CX86_GCR
 0xb8

	)

84 
	#CX86_CCR0
 0xc0

	)

85 
	#CX86_CCR1
 0xc1

	)

86 
	#CX86_CCR2
 0xc2

	)

87 
	#CX86_CCR3
 0xc3

	)

88 
	#CX86_CCR4
 0xe8

	)

89 
	#CX86_CCR5
 0xe9

	)

90 
	#CX86_CCR6
 0xó

	)

91 
	#CX86_CCR7
 0xeb

	)

92 
	#CX86_PCR1
 0xf0

	)

93 
	#CX86_DIR0
 0x„

	)

94 
	#CX86_DIR1
 0xff

	)

95 
	#CX86_ARR_BASE
 0xc4

	)

96 
	#CX86_RCR_BASE
 0xdc

	)

	@/usr/include/asm/ptrace-abi.h

1 #i‚de‡
_ASM_X86_PTRACE_ABI_H


2 
	#_ASM_X86_PTRACE_ABI_H


	)

4 #ifde‡
__i386__


6 
	#EBX
 0

	)

7 
	#ECX
 1

	)

8 
	#EDX
 2

	)

9 
	#ESI
 3

	)

10 
	#EDI
 4

	)

11 
	#EBP
 5

	)

12 
	#EAX
 6

	)

13 
	#DS
 7

	)

14 
	#ES
 8

	)

15 
	#FS
 9

	)

16 
	#GS
 10

	)

17 
	#ORIG_EAX
 11

	)

18 
	#EIP
 12

	)

19 
	#CS
 13

	)

20 
	#EFL
 14

	)

21 
	#UESP
 15

	)

22 
	#SS
 16

	)

23 
	#FRAME_SIZE
 17

	)

27 #i‡
deföed
(
__ASSEMBLY__
Ë|| deföed(
__FRAME_OFFSETS
)

28 
	#R15
 0

	)

29 
	#R14
 8

	)

30 
	#R13
 16

	)

31 
	#R12
 24

	)

32 
	#RBP
 32

	)

33 
	#RBX
 40

	)

35 
	#R11
 48

	)

36 
	#R10
 56

	)

37 
	#R9
 64

	)

38 
	#R8
 72

	)

39 
	#RAX
 80

	)

40 
	#RCX
 88

	)

41 
	#RDX
 96

	)

42 
	#RSI
 104

	)

43 
	#RDI
 112

	)

44 
	#ORIG_RAX
 120

	)

47 
	#RIP
 128

	)

48 
	#CS
 136

	)

49 
	#EFLAGS
 144

	)

50 
	#RSP
 152

	)

51 
	#SS
 160

	)

52 
	#ARGOFFSET
 
R11


	)

56 
	#FRAME_SIZE
 168

	)

61 
	#PTRACE_GETREGS
 12

	)

62 
	#PTRACE_SETREGS
 13

	)

63 
	#PTRACE_GETFPREGS
 14

	)

64 
	#PTRACE_SETFPREGS
 15

	)

65 
	#PTRACE_GETFPXREGS
 18

	)

66 
	#PTRACE_SETFPXREGS
 19

	)

68 
	#PTRACE_OLDSETOPTIONS
 21

	)

71 
	#PTRACE_GET_THREAD_AREA
 25

	)

72 
	#PTRACE_SET_THREAD_AREA
 26

	)

74 #ifde‡
__x86_64__


75 
	#PTRACE_ARCH_PRCTL
 30

	)

78 
	#PTRACE_SYSEMU
 31

	)

79 
	#PTRACE_SYSEMU_SINGLESTEP
 32

	)

81 
	#PTRACE_SINGLEBLOCK
 33

	)

83 #i‚de‡
__ASSEMBLY__


84 
	~<löux/ty≥s.h
>

	@/usr/include/asm/types.h

1 #i‚de‡
_ASM_X86_TYPES_H


2 
	#_ASM_X86_TYPES_H


	)

4 
	~<asm-gíîic/ty≥s.h
>

	@/usr/include/gnu/stubs.h

6 #i‡!
deföed
 
__x86_64__


7 
	~<gnu/°ubs-32.h
>

9 #i‡
deföed
 
__x86_64__
 && deföed 
__LP64__


10 
	~<gnu/°ubs-64.h
>

12 #i‡
deföed
 
__x86_64__
 && deföed 
__ILP32__


13 
	~<gnu/°ubs-x32.h
>

	@/usr/include/linux/i2c.h

27 #i‚de‡
_LINUX_I2C_H


28 
	#_LINUX_I2C_H


	)

30 
	~<löux/ty≥s.h
>

68 
	si2c_msg
 {

69 
__u16
 
	maddr
;

70 
__u16
 
	mÊags
;

71 
	#I2C_M_TEN
 0x0010

	)

72 
	#I2C_M_RD
 0x0001

	)

73 
	#I2C_M_STOP
 0x8000

	)

74 
	#I2C_M_NOSTART
 0x4000

	)

75 
	#I2C_M_REV_DIR_ADDR
 0x2000

	)

76 
	#I2C_M_IGNORE_NAK
 0x1000

	)

77 
	#I2C_M_NO_RD_ACK
 0x0800

	)

78 
	#I2C_M_RECV_LEN
 0x0400

	)

79 
__u16
 
	mÀn
;

80 
__u8
 *
	mbuf
;

85 
	#I2C_FUNC_I2C
 0x00000001

	)

86 
	#I2C_FUNC_10BIT_ADDR
 0x00000002

	)

87 
	#I2C_FUNC_PROTOCOL_MANGLING
 0x00000004

	)

88 
	#I2C_FUNC_SMBUS_PEC
 0x00000008

	)

89 
	#I2C_FUNC_NOSTART
 0x00000010

	)

90 
	#I2C_FUNC_SMBUS_BLOCK_PROC_CALL
 0x00008000

	)

91 
	#I2C_FUNC_SMBUS_QUICK
 0x00010000

	)

92 
	#I2C_FUNC_SMBUS_READ_BYTE
 0x00020000

	)

93 
	#I2C_FUNC_SMBUS_WRITE_BYTE
 0x00040000

	)

94 
	#I2C_FUNC_SMBUS_READ_BYTE_DATA
 0x00080000

	)

95 
	#I2C_FUNC_SMBUS_WRITE_BYTE_DATA
 0x00100000

	)

96 
	#I2C_FUNC_SMBUS_READ_WORD_DATA
 0x00200000

	)

97 
	#I2C_FUNC_SMBUS_WRITE_WORD_DATA
 0x00400000

	)

98 
	#I2C_FUNC_SMBUS_PROC_CALL
 0x00800000

	)

99 
	#I2C_FUNC_SMBUS_READ_BLOCK_DATA
 0x01000000

	)

100 
	#I2C_FUNC_SMBUS_WRITE_BLOCK_DATA
 0x02000000

	)

101 
	#I2C_FUNC_SMBUS_READ_I2C_BLOCK
 0x04000000

	)

102 
	#I2C_FUNC_SMBUS_WRITE_I2C_BLOCK
 0x08000000

	)

104 
	#I2C_FUNC_SMBUS_BYTE
 (
I2C_FUNC_SMBUS_READ_BYTE
 | \

105 
I2C_FUNC_SMBUS_WRITE_BYTE
)

	)

106 
	#I2C_FUNC_SMBUS_BYTE_DATA
 (
I2C_FUNC_SMBUS_READ_BYTE_DATA
 | \

107 
I2C_FUNC_SMBUS_WRITE_BYTE_DATA
)

	)

108 
	#I2C_FUNC_SMBUS_WORD_DATA
 (
I2C_FUNC_SMBUS_READ_WORD_DATA
 | \

109 
I2C_FUNC_SMBUS_WRITE_WORD_DATA
)

	)

110 
	#I2C_FUNC_SMBUS_BLOCK_DATA
 (
I2C_FUNC_SMBUS_READ_BLOCK_DATA
 | \

111 
I2C_FUNC_SMBUS_WRITE_BLOCK_DATA
)

	)

112 
	#I2C_FUNC_SMBUS_I2C_BLOCK
 (
I2C_FUNC_SMBUS_READ_I2C_BLOCK
 | \

113 
I2C_FUNC_SMBUS_WRITE_I2C_BLOCK
)

	)

115 
	#I2C_FUNC_SMBUS_EMUL
 (
I2C_FUNC_SMBUS_QUICK
 | \

116 
I2C_FUNC_SMBUS_BYTE
 | \

117 
I2C_FUNC_SMBUS_BYTE_DATA
 | \

118 
I2C_FUNC_SMBUS_WORD_DATA
 | \

119 
I2C_FUNC_SMBUS_PROC_CALL
 | \

120 
I2C_FUNC_SMBUS_WRITE_BLOCK_DATA
 | \

121 
I2C_FUNC_SMBUS_I2C_BLOCK
 | \

122 
I2C_FUNC_SMBUS_PEC
)

	)

127 
	#I2C_SMBUS_BLOCK_MAX
 32

	)

128 
	ui2c_smbus_d©a
 {

129 
__u8
 
	mbyã
;

130 
__u16
 
	mw‹d
;

131 
__u8
 
	mblock
[
I2C_SMBUS_BLOCK_MAX
 + 2];

136 
	#I2C_SMBUS_READ
 1

	)

137 
	#I2C_SMBUS_WRITE
 0

	)

141 
	#I2C_SMBUS_QUICK
 0

	)

142 
	#I2C_SMBUS_BYTE
 1

	)

143 
	#I2C_SMBUS_BYTE_DATA
 2

	)

144 
	#I2C_SMBUS_WORD_DATA
 3

	)

145 
	#I2C_SMBUS_PROC_CALL
 4

	)

146 
	#I2C_SMBUS_BLOCK_DATA
 5

	)

147 
	#I2C_SMBUS_I2C_BLOCK_BROKEN
 6

	)

148 
	#I2C_SMBUS_BLOCK_PROC_CALL
 7

	)

149 
	#I2C_SMBUS_I2C_BLOCK_DATA
 8

	)

	@/usr/include/linux/limits.h

1 #i‚de‡
_LINUX_LIMITS_H


2 
	#_LINUX_LIMITS_H


	)

4 
	#NR_OPEN
 1024

	)

6 
	#NGROUPS_MAX
 65536

	)

7 
	#ARG_MAX
 131072

	)

8 
	#LINK_MAX
 127

	)

9 
	#MAX_CANON
 255

	)

10 
	#MAX_INPUT
 255

	)

11 
	#NAME_MAX
 255

	)

12 
	#PATH_MAX
 4096

	)

13 
	#PIPE_BUF
 4096

	)

14 
	#XATTR_NAME_MAX
 255

	)

15 
	#XATTR_SIZE_MAX
 65536

	)

16 
	#XATTR_LIST_MAX
 65536

	)

18 
	#RTSIG_MAX
 32

	)

	@/usr/include/linux/posix_types.h

1 #i‚de‡
_LINUX_POSIX_TYPES_H


2 
	#_LINUX_POSIX_TYPES_H


	)

4 
	~<löux/°ddef.h
>

21 #unde‡
__FD_SETSIZE


22 
	#__FD_SETSIZE
 1024

	)

25 
	mfds_bôs
[
__FD_SETSIZE
 / (8 * ())];

26 } 
	t__kî√l_fd_£t
;

29 (*
	t__kî√l_sigh™dÀr_t
)();

32 
	t__kî√l_key_t
;

33 
	t__kî√l_mqd_t
;

35 
	~<asm/posix_ty≥s.h
>

	@/usr/include/linux/sysinfo.h

1 #i‚de‡
_LINUX_SYSINFO_H


2 
	#_LINUX_SYSINFO_H


	)

4 
	~<löux/ty≥s.h
>

6 
	#SI_LOAD_SHIFT
 16

	)

7 
	ssysöfo
 {

8 
__kî√l_l⁄g_t
 
	mu±ime
;

9 
__kî√l_ul⁄g_t
 
	mlﬂds
[3];

10 
__kî√l_ul⁄g_t
 
	mtŸÆøm
;

11 
__kî√l_ul⁄g_t
 
	m‰ìøm
;

12 
__kî√l_ul⁄g_t
 
	msh¨edøm
;

13 
__kî√l_ul⁄g_t
 
	mbuf„ºam
;

14 
__kî√l_ul⁄g_t
 
	mtŸÆsw≠
;

15 
__kî√l_ul⁄g_t
 
	m‰ìsw≠
;

16 
__u16
 
	m¥ocs
;

17 
__u16
 
	m∑d
;

18 
__kî√l_ul⁄g_t
 
	mtŸÆhigh
;

19 
__kî√l_ul⁄g_t
 
	m‰ìhigh
;

20 
__u32
 
	mmem_unô
;

21 
	m_f
[20-2*(
__kî√l_ul⁄g_t
)-(
__u32
)];

	@/usr/include/stdc-predef.h

18 #i‚def 
_STDC_PREDEF_H


19 
	#_STDC_PREDEF_H
 1

	)

30 
	#__STDC_IEC_559__
 1

	)

31 
	#__STDC_IEC_559_COMPLEX__
 1

	)

35 
	#__STDC_ISO_10646__
 201103L

	)

38 
	#__STDC_NO_THREADS__
 1

	)

	@/usr/include/string.h

22 #i‚def 
_STRING_H


23 
	#_STRING_H
 1

	)

25 
	~<„©uªs.h
>

27 
	g__BEGIN_DECLS


30 
	#__√ed_size_t


	)

31 
	#__√ed_NULL


	)

32 
	~<°ddef.h
>

35 #i‡
deföed
 
__˝lu•lus
 && 
__GNUC_PREREQ
 (4, 4)

36 
	#__CORRECT_ISO_CPP_STRING_H_PROTO


	)

40 
__BEGIN_NAMESPACE_STD


42 *
	$mem˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
,

43 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

46 *
	$memmove
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__n
)

47 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

48 
__END_NAMESPACE_STD


53 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_BSD
 || deföed 
__USE_XOPEN


54 *
	$memc˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
,

55 
__c
, 
size_t
 
__n
)

56 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

60 
__BEGIN_NAMESPACE_STD


62 *
	$mem£t
 (*
__s
, 
__c
, 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

65 
	$memcmp
 (c⁄° *
__s1
, c⁄° *
__s2
, 
size_t
 
__n
)

66 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

69 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


72 *
	`memchr
 (*
__s
, 
__c
, 
size_t
 
__n
)

73 
__THROW
 
	`__asm
 ("memchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

74 c⁄° *
	`memchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
)

75 
__THROW
 
	`__asm
 ("memchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

77 #ifde‡
__OPTIMIZE__


78 
__exã∫_Æways_ölöe
 *

79 
	`memchr
 (*
__s
, 
__c
, 
size_t
 
__n
Ë
__THROW


81  
	`__buûtö_memchr
 (
__s
, 
__c
, 
__n
);

84 
__exã∫_Æways_ölöe
 const *

85 
	`memchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
Ë
__THROW


87  
	`__buûtö_memchr
 (
__s
, 
__c
, 
__n
);

90 
	}
}

92 *
	$memchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
)

93 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

95 
__END_NAMESPACE_STD


97 #ifde‡
__USE_GNU


100 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


101 "C++" *
	$øwmemchr
 (*
__s
, 
__c
)

102 
__THROW
 
	`__asm
 ("øwmemchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

103 "C++" c⁄° *
	$øwmemchr
 (c⁄° *
__s
, 
__c
)

104 
__THROW
 
	`__asm
 ("øwmemchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

106 *
	$øwmemchr
 (c⁄° *
__s
, 
__c
)

107 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

111 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


112 "C++" *
	$memrchr
 (*
__s
, 
__c
, 
size_t
 
__n
)

113 
__THROW
 
	`__asm
 ("memrchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

114 "C++" c⁄° *
	$memrchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
)

115 
__THROW
 
	`__asm
 ("memrchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

117 *
	$memrchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
)

118 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

123 
__BEGIN_NAMESPACE_STD


125 *
	$°r˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
)

126 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

128 *
	$°∫˝y
 (*
__ª°ri˘
 
__de°
,

129 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

130 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

133 *
	$°rˇt
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
)

134 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

136 *
	$°∫ˇt
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
,

137 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

140 
	$°rcmp
 (c⁄° *
__s1
, c⁄° *
__s2
)

141 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

143 
	$°∫cmp
 (c⁄° *
__s1
, c⁄° *
__s2
, 
size_t
 
__n
)

144 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

147 
	$°rcﬁl
 (c⁄° *
__s1
, c⁄° *
__s2
)

148 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

150 
size_t
 
	$°rx‰m
 (*
__ª°ri˘
 
__de°
,

151 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

152 
__THROW
 
	`__n⁄nuŒ
 ((2));

153 
__END_NAMESPACE_STD


155 #ifde‡
__USE_XOPEN2K8


159 
	~<xloˇÀ.h
>

162 
	$°rcﬁl_l
 (c⁄° *
__s1
, c⁄° *
__s2
, 
__loˇÀ_t
 
__l
)

163 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2, 3));

165 
size_t
 
	$°rx‰m_l
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__n
,

166 
__loˇÀ_t
 
__l
Ë
__THROW
 
	`__n⁄nuŒ
 ((2, 4));

169 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED
 \

170 || 
deföed
 
__USE_XOPEN2K8


172 *
	$°rdup
 (c⁄° *
__s
)

173 
__THROW
 
__©åibuã_mÆloc__
 
	`__n⁄nuŒ
 ((1));

179 #i‡
deföed
 
__USE_XOPEN2K8


180 *
	$°∫dup
 (c⁄° *
__°rög
, 
size_t
 
__n
)

181 
__THROW
 
__©åibuã_mÆloc__
 
	`__n⁄nuŒ
 ((1));

184 #i‡
deföed
 
__USE_GNU
 && deföed 
__GNUC__


186 
	#°rdu∑
(
s
) \

187 (
__exãnsi⁄__
 \

189 c⁄° *
__ﬁd
 = (
s
); \

190 
size_t
 
__Àn
 = 
	`°æí
 (
__ﬁd
) + 1; \

191 *
__√w
 = (*Ë
	`__buûtö_Æloˇ
 (
__Àn
); \

192 (*Ë
	`mem˝y
 (
__√w
, 
__ﬁd
, 
__Àn
); \

193 
	}
}))

	)

196 
	#°∫du∑
(
s
, 
n
) \

197 (
__exãnsi⁄__
 \

199 c⁄° *
__ﬁd
 = (
s
); \

200 
size_t
 
__Àn
 = 
	`°∫Àn
 (
__ﬁd
, (
n
)); \

201 *
__√w
 = (*Ë
	`__buûtö_Æloˇ
 (
__Àn
 + 1); \

202 
__√w
[
__Àn
] = '\0'; \

203 (*Ë
	`mem˝y
 (
__√w
, 
__ﬁd
, 
__Àn
); \

204 }))

	)

207 
	g__BEGIN_NAMESPACE_STD


209 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


212 *
°rchr
 (*
__s
, 
__c
)

213 
__THROW
 
__asm
 ("°rchr"Ë
__©åibuã_puª__
 
__n⁄nuŒ
 ((1));

214 c⁄° *
°rchr
 (c⁄° *
__s
, 
__c
)

215 
__THROW
 
__asm
 ("°rchr"Ë
__©åibuã_puª__
 
__n⁄nuŒ
 ((1));

217 #ifde‡
__OPTIMIZE__


218 
__exã∫_Æways_ölöe
 *

219 
°rchr
 (*
__s
, 
__c
Ë
	g__THROW


221  
__buûtö_°rchr
 (
__s
, 
__c
);

224 
__exã∫_Æways_ölöe
 const *

225 
°rchr
 (c⁄° *
__s
, 
__c
Ë
	g__THROW


227  
__buûtö_°rchr
 (
__s
, 
__c
);

232 *
	$°rchr
 (c⁄° *
__s
, 
__c
)

233 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

236 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


239 *
	`°ºchr
 (*
__s
, 
__c
)

240 
__THROW
 
	`__asm
 ("°ºchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

241 c⁄° *
	`°ºchr
 (c⁄° *
__s
, 
__c
)

242 
__THROW
 
	`__asm
 ("°ºchr"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

244 #ifde‡
__OPTIMIZE__


245 
__exã∫_Æways_ölöe
 *

246 
	`°ºchr
 (*
__s
, 
__c
Ë
__THROW


248  
	`__buûtö_°ºchr
 (
__s
, 
__c
);

251 
__exã∫_Æways_ölöe
 const *

252 
	`°ºchr
 (c⁄° *
__s
, 
__c
Ë
__THROW


254  
	`__buûtö_°ºchr
 (
__s
, 
__c
);

257 
	}
}

259 *
	$°ºchr
 (c⁄° *
__s
, 
__c
)

260 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

262 
__END_NAMESPACE_STD


264 #ifde‡
__USE_GNU


267 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


268 "C++" *
	$°rch∫ul
 (*
__s
, 
__c
)

269 
__THROW
 
	`__asm
 ("°rch∫ul"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

270 "C++" c⁄° *
	$°rch∫ul
 (c⁄° *
__s
, 
__c
)

271 
__THROW
 
	`__asm
 ("°rch∫ul"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

273 *
	$°rch∫ul
 (c⁄° *
__s
, 
__c
)

274 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

278 
__BEGIN_NAMESPACE_STD


281 
size_t
 
	$°rc•n
 (c⁄° *
__s
, c⁄° *
__ªje˘
)

282 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

285 
size_t
 
	$°r•n
 (c⁄° *
__s
, c⁄° *
__ac˚±
)

286 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

288 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


291 *
	`°Ωbrk
 (*
__s
, c⁄° *
__ac˚±
)

292 
__THROW
 
	`__asm
 ("°Ωbrk"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

293 c⁄° *
	`°Ωbrk
 (c⁄° *
__s
, c⁄° *
__ac˚±
)

294 
__THROW
 
	`__asm
 ("°Ωbrk"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

296 #ifde‡
__OPTIMIZE__


297 
__exã∫_Æways_ölöe
 *

298 
	`°Ωbrk
 (*
__s
, c⁄° *
__ac˚±
Ë
__THROW


300  
	`__buûtö_°Ωbrk
 (
__s
, 
__ac˚±
);

303 
__exã∫_Æways_ölöe
 const *

304 
	`°Ωbrk
 (c⁄° *
__s
, c⁄° *
__ac˚±
Ë
__THROW


306  
	`__buûtö_°Ωbrk
 (
__s
, 
__ac˚±
);

309 
	}
}

311 *
	$°Ωbrk
 (c⁄° *
__s
, c⁄° *
__ac˚±
)

312 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

315 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


318 *
	`°r°r
 (*
__hay°ack
, c⁄° *
__√edÀ
)

319 
__THROW
 
	`__asm
 ("°r°r"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

320 c⁄° *
	`°r°r
 (c⁄° *
__hay°ack
, c⁄° *
__√edÀ
)

321 
__THROW
 
	`__asm
 ("°r°r"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

323 #ifde‡
__OPTIMIZE__


324 
__exã∫_Æways_ölöe
 *

325 
	`°r°r
 (*
__hay°ack
, c⁄° *
__√edÀ
Ë
__THROW


327  
	`__buûtö_°r°r
 (
__hay°ack
, 
__√edÀ
);

330 
__exã∫_Æways_ölöe
 const *

331 
	`°r°r
 (c⁄° *
__hay°ack
, c⁄° *
__√edÀ
Ë
__THROW


333  
	`__buûtö_°r°r
 (
__hay°ack
, 
__√edÀ
);

336 
	}
}

338 *
	$°r°r
 (c⁄° *
__hay°ack
, c⁄° *
__√edÀ
)

339 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

344 *
	$°πok
 (*
__ª°ri˘
 
__s
, c⁄° *__ª°ri˘ 
__dñim
)

345 
__THROW
 
	`__n⁄nuŒ
 ((2));

346 
__END_NAMESPACE_STD


350 *
	$__°πok_r
 (*
__ª°ri˘
 
__s
,

351 c⁄° *
__ª°ri˘
 
__dñim
,

352 **
__ª°ri˘
 
__ßve_±r
)

353 
__THROW
 
	`__n⁄nuŒ
 ((2, 3));

354 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


355 *
	$°πok_r
 (*
__ª°ri˘
 
__s
, c⁄° *__ª°ri˘ 
__dñim
,

356 **
__ª°ri˘
 
__ßve_±r
)

357 
__THROW
 
	`__n⁄nuŒ
 ((2, 3));

360 #ifde‡
__USE_GNU


362 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


363 "C++" *
	$°rˇ£°r
 (*
__hay°ack
, c⁄° *
__√edÀ
)

364 
__THROW
 
	`__asm
 ("°rˇ£°r"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

365 "C++" c⁄° *
	$°rˇ£°r
 (c⁄° *
__hay°ack
,

366 c⁄° *
__√edÀ
)

367 
__THROW
 
	`__asm
 ("°rˇ£°r"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

369 *
	$°rˇ£°r
 (c⁄° *
__hay°ack
, c⁄° *
__√edÀ
)

370 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

374 #ifde‡
__USE_GNU


378 *
	$memmem
 (c⁄° *
__hay°ack
, 
size_t
 
__hay°ackÀn
,

379 c⁄° *
__√edÀ
, 
size_t
 
__√edÀÀn
)

380 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 3));

384 *
	$__memp˝y
 (*
__ª°ri˘
 
__de°
,

385 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

386 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

387 *
	$memp˝y
 (*
__ª°ri˘
 
__de°
,

388 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

389 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

393 
__BEGIN_NAMESPACE_STD


395 
size_t
 
	$°æí
 (c⁄° *
__s
)

396 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

397 
__END_NAMESPACE_STD


399 #ifdef 
__USE_XOPEN2K8


402 
size_t
 
	$°∫Àn
 (c⁄° *
__°rög
, 
size_t
 
__maxÀn
)

403 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

407 
__BEGIN_NAMESPACE_STD


409 *
	$°ªº‹
 (
__î∫um
Ë
__THROW
;

410 
__END_NAMESPACE_STD


411 #i‡
deföed
 
__USE_XOPEN2K
 || deföed 
__USE_MISC


419 #i‡
deföed
 
__USE_XOPEN2K
 && !deföed 
__USE_GNU


422 #ifde‡
__REDIRECT_NTH


423 
	`__REDIRECT_NTH
 (
°ªº‹_r
,

424 (
__î∫um
, *
__buf
, 
size_t
 
__buÊí
),

425 
__xpg_°ªº‹_r
Ë
	`__n⁄nuŒ
 ((2));

427 
	$__xpg_°ªº‹_r
 (
__î∫um
, *
__buf
, 
size_t
 
__buÊí
)

428 
__THROW
 
	`__n⁄nuŒ
 ((2));

429 
	#°ªº‹_r
 
__xpg_°ªº‹_r


	)

434 *
	$°ªº‹_r
 (
__î∫um
, *
__buf
, 
size_t
 
__buÊí
)

435 
__THROW
 
	`__n⁄nuŒ
 ((2)Ë
__wur
;

439 #ifde‡
__USE_XOPEN2K8


441 *
	$°ªº‹_l
 (
__î∫um
, 
__loˇÀ_t
 
__l
Ë
__THROW
;

447 
	$__bzîo
 (*
__s
, 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

449 #ifde‡
__USE_BSD


451 
	$bc›y
 (c⁄° *
__§c
, *
__de°
, 
size_t
 
__n
)

452 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

455 
	$bzîo
 (*
__s
, 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

458 
	$bcmp
 (c⁄° *
__s1
, c⁄° *
__s2
, 
size_t
 
__n
)

459 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

462 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


465 *
	`ödex
 (*
__s
, 
__c
)

466 
__THROW
 
	`__asm
 ("ödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

467 c⁄° *
	`ödex
 (c⁄° *
__s
, 
__c
)

468 
__THROW
 
	`__asm
 ("ödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

470 #i‡
deföed
 
__OPTIMIZE__
 && !deföed 
__CORRECT_ISO_CPP_STRINGS_H_PROTO


471 
__exã∫_Æways_ölöe
 *

472 
	`ödex
 (*
__s
, 
__c
Ë
__THROW


474  
	`__buûtö_ödex
 (
__s
, 
__c
);

477 
__exã∫_Æways_ölöe
 const *

478 
	`ödex
 (c⁄° *
__s
, 
__c
Ë
__THROW


480  
	`__buûtö_ödex
 (
__s
, 
__c
);

483 
	}
}

485 *
	$ödex
 (c⁄° *
__s
, 
__c
)

486 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

490 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


493 *
	`rödex
 (*
__s
, 
__c
)

494 
__THROW
 
	`__asm
 ("rödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

495 c⁄° *
	`rödex
 (c⁄° *
__s
, 
__c
)

496 
__THROW
 
	`__asm
 ("rödex"Ë
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

498 #i‡
deföed
 
__OPTIMIZE__
 && !deföed 
__CORRECT_ISO_CPP_STRINGS_H_PROTO


499 
__exã∫_Æways_ölöe
 *

500 
	`rödex
 (*
__s
, 
__c
Ë
__THROW


502  
	`__buûtö_rödex
 (
__s
, 
__c
);

505 
__exã∫_Æways_ölöe
 const *

506 
	`rödex
 (c⁄° *
__s
, 
__c
Ë
__THROW


508  
	`__buûtö_rödex
 (
__s
, 
__c
);

511 
	}
}

513 *
	$rödex
 (c⁄° *
__s
, 
__c
)

514 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1));

519 
	$ffs
 (
__i
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

523 #ifdef 
__USE_GNU


524 
	$ff¶
 (
__l
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

525 #ifde‡
__GNUC__


526 
__exãnsi⁄__
 
	$ff¶l
 (
__Œ
)

527 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

532 
	$°rˇ£cmp
 (c⁄° *
__s1
, c⁄° *
__s2
)

533 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

536 
	$°∫ˇ£cmp
 (c⁄° *
__s1
, c⁄° *
__s2
, 
size_t
 
__n
)

537 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

540 #ifdef 
__USE_GNU


543 
	$°rˇ£cmp_l
 (c⁄° *
__s1
, c⁄° *
__s2
,

544 
__loˇÀ_t
 
__loc
)

545 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2, 3));

547 
	$°∫ˇ£cmp_l
 (c⁄° *
__s1
, c⁄° *
__s2
,

548 
size_t
 
__n
, 
__loˇÀ_t
 
__loc
)

549 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2, 4));

552 #ifdef 
__USE_BSD


555 *
	$°r£p
 (**
__ª°ri˘
 
__°rögp
,

556 c⁄° *
__ª°ri˘
 
__dñim
)

557 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

560 #ifdef 
__USE_XOPEN2K8


562 *
	$°rsig«l
 (
__sig
Ë
__THROW
;

565 *
	$__°p˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
)

566 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

567 *
	$°p˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
)

568 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

572 *
	$__°≤˝y
 (*
__ª°ri˘
 
__de°
,

573 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

574 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

575 *
	$°≤˝y
 (*
__ª°ri˘
 
__de°
,

576 c⁄° *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

577 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

580 #ifdef 
__USE_GNU


582 
	$°rvîscmp
 (c⁄° *
__s1
, c⁄° *
__s2
)

583 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1, 2));

586 *
	$°r‰y
 (*
__°rög
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

589 *
	$mem‰ob
 (*
__s
, 
size_t
 
__n
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

591 #i‚de‡
ba£«me


596 #ifde‡
__CORRECT_ISO_CPP_STRING_H_PROTO


597 "C++" *
	$ba£«me
 (*
__fûíame
)

598 
__THROW
 
	`__asm
 ("ba£«me"Ë
	`__n⁄nuŒ
 ((1));

599 "C++" c⁄° *
	$ba£«me
 (c⁄° *
__fûíame
)

600 
__THROW
 
	`__asm
 ("ba£«me"Ë
	`__n⁄nuŒ
 ((1));

602 *
	$ba£«me
 (c⁄° *
__fûíame
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

608 #i‡
deföed
 
__GNUC__
 && __GNUC__ >= 2

609 #i‡
deföed
 
__OPTIMIZE__
 && !deföed 
__OPTIMIZE_SIZE__
 \

610 && !
deföed
 
__NO_INLINE__
 && !deföed 
__˝lu•lus


630 
	~<bôs/°rög.h
>

633 
	~<bôs/°rög2.h
>

636 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__f‹tify_fun˘i⁄


638 
	~<bôs/°rög3.h
>

642 
__END_DECLS


	@/usr/include/sys/cdefs.h

19 #i‚def 
_SYS_CDEFS_H


20 
	#_SYS_CDEFS_H
 1

	)

23 #i‚de‡
_FEATURES_H


24 
	~<„©uªs.h
>

30 #i‡
deföed
 
__GNUC__
 && !deföed 
__STDC__


35 #unde‡
__P


36 #unde‡
__PMT


38 #ifde‡
__GNUC__


42 #i‡
__GNUC_PREREQ
 (4, 6Ë&& !
deföed
 
_LIBC


43 
	#__LEAF
 , 
__Àaf__


	)

44 
	#__LEAF_ATTR
 
	`__©åibuã__
 ((
__Àaf__
))

	)

46 
	#__LEAF


	)

47 
	#__LEAF_ATTR


	)

55 #i‡!
deföed
 
__˝lu•lus
 && 
__GNUC_PREREQ
 (3, 3)

56 
	#__THROW
 
	`__©åibuã__
 ((
__nŸhrow__
 
__LEAF
))

	)

57 
	#__THROWNL
 
	`__©åibuã__
 ((
__nŸhrow__
))

	)

58 
	#__NTH
(
f˘
Ë
	`__©åibuã__
 ((
__nŸhrow__
 
__LEAF
)Ë
	)
fct

60 #i‡
deföed
 
__˝lu•lus
 && 
__GNUC_PREREQ
 (2,8)

61 
	#__THROW
 
	`throw
 ()

	)

62 
	#__THROWNL
 
	`throw
 ()

	)

63 
	#__NTH
(
f˘
Ë
__LEAF_ATTR
 f˘ 
	`throw
 ()

	)

65 
	#__THROW


	)

66 
	#__THROWNL


	)

67 
	#__NTH
(
f˘
Ë
	)
fct

73 
	#__ölöe


	)

75 
	#__THROW


	)

76 
	#__THROWNL


	)

77 
	#__NTH
(
f˘
Ë
	)
fct

83 
	#__P
(
¨gs
Ë
	)
args

84 
	#__PMT
(
¨gs
Ë
	)
args

89 
	#__CONCAT
(
x
,
y
Ëx ## 
	)
y

90 
	#__STRING
(
x
Ë#x

	)

93 
	#__±r_t
 *

	)

94 
	#__l⁄g_doubÀ_t
 

	)

98 #ifdef 
__˝lu•lus


99 
	#__BEGIN_DECLS
 "C" {

	)

100 
	#__END_DECLS
 }

	)

102 
	#__BEGIN_DECLS


	)

103 
	#__END_DECLS


	)

112 #i‡
deföed
 
__˝lu•lus
 && deföed 
_GLIBCPP_USE_NAMESPACES


113 
	#__BEGIN_NAMESPACE_STD
 
«me•a˚
 
°d
 {

	)

114 
	#__END_NAMESPACE_STD
 }

	)

115 
	#__USING_NAMESPACE_STD
(
«me
Ë
usög
 
°d
::«me;

	)

116 
	#__BEGIN_NAMESPACE_C99
 
«me•a˚
 
__c99
 {

	)

117 
	#__END_NAMESPACE_C99
 }

	)

118 
	#__USING_NAMESPACE_C99
(
«me
Ë
usög
 
__c99
::«me;

	)

123 
	#__BEGIN_NAMESPACE_STD


	)

124 
	#__END_NAMESPACE_STD


	)

125 
	#__USING_NAMESPACE_STD
(
«me
)

	)

126 
	#__BEGIN_NAMESPACE_C99


	)

127 
	#__END_NAMESPACE_C99


	)

128 
	#__USING_NAMESPACE_C99
(
«me
)

	)

133 #i‚de‡
__BOUNDED_POINTERS__


134 
	#__bounded


	)

135 
	#__unbounded


	)

136 
	#__±rvÆue


	)

141 
	#__bos
(
±r
Ë
	`__buûtö_obje˘_size
 (±r, 
__USE_FORTIFY_LEVEL
 > 1)

	)

142 
	#__bos0
(
±r
Ë
	`__buûtö_obje˘_size
 (±r, 0)

	)

143 
	#__f‹tify_fun˘i⁄
 
__exã∫_Æways_ölöe
 
__©åibuã_¨tificül__


	)

145 #i‡
__GNUC_PREREQ
 (4,3)

146 
	#__w¨nde˛
(
«me
, 
msg
) \

147 
	`«me
 (Ë
	`__©åibuã__
((
	`__w¨nög__
 (
msg
)))

	)

148 
	#__w¨«âr
(
msg
Ë
	`__©åibuã__
((
	`__w¨nög__
 (msg)))

	)

149 
	#__îr‹de˛
(
«me
, 
msg
) \

150 
	`«me
 (Ë
	`__©åibuã__
((
	`__îr‹__
 (
msg
)))

	)

152 
	#__w¨nde˛
(
«me
, 
msg
Ë
	`«me
 ()

	)

153 
	#__w¨«âr
(
msg
)

	)

154 
	#__îr‹de˛
(
«me
, 
msg
Ë
	`«me
 ()

	)

158 #i‡
__GNUC_PREREQ
 (2,97)

160 
	#__Êex¨r
 []

	)

162 #ifde‡
__GNUC__


163 
	#__Êex¨r
 [0]

	)

165 #i‡
deföed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L

166 
	#__Êex¨r
 []

	)

169 
	#__Êex¨r
 [1]

	)

185 #i‡
deföed
 
__GNUC__
 && __GNUC__ >= 2

187 
	#__REDIRECT
(
«me
, 
¥Ÿo
, 
Æüs
Ë«mê¥Ÿÿ
	`__asm__
 (
	`__ASMNAME
 (#Æüs))

	)

188 #ifde‡
__˝lu•lus


189 
	#__REDIRECT_NTH
(
«me
, 
¥Ÿo
, 
Æüs
) \

190 
«me
 
¥Ÿo
 
__THROW
 
	`__asm__
 (
	`__ASMNAME
 (#Æüs))

	)

191 
	#__REDIRECT_NTHNL
(
«me
, 
¥Ÿo
, 
Æüs
) \

192 
«me
 
¥Ÿo
 
__THROWNL
 
	`__asm__
 (
	`__ASMNAME
 (#Æüs))

	)

194 
	#__REDIRECT_NTH
(
«me
, 
¥Ÿo
, 
Æüs
) \

195 
«me
 
¥Ÿo
 
	`__asm__
 (
	`__ASMNAME
 (#Æüs)Ë
__THROW


	)

196 
	#__REDIRECT_NTHNL
(
«me
, 
¥Ÿo
, 
Æüs
) \

197 
«me
 
¥Ÿo
 
	`__asm__
 (
	`__ASMNAME
 (#Æüs)Ë
__THROWNL


	)

199 
	#__ASMNAME
(
˙ame
Ë
	`__ASMNAME2
 (
__USER_LABEL_PREFIX__
, c«me)

	)

200 
	#__ASMNAME2
(
¥efix
, 
˙ame
Ë
	`__STRING
 (¥efixË
	)
cname

213 #i‡!
deföed
 
__GNUC__
 || __GNUC__ < 2

214 
	#__©åibuã__
(
xyz
Ë

	)

220 #i‡
__GNUC_PREREQ
 (2,96)

221 
	#__©åibuã_mÆloc__
 
	`__©åibuã__
 ((
__mÆloc__
))

	)

223 
	#__©åibuã_mÆloc__


	)

229 #i‡
__GNUC_PREREQ
 (2,96)

230 
	#__©åibuã_puª__
 
	`__©åibuã__
 ((
__puª__
))

	)

232 
	#__©åibuã_puª__


	)

236 #i‡
__GNUC_PREREQ
 (2,5)

237 
	#__©åibuã_c⁄°__
 
	`__©åibuã__
 ((
__c⁄°__
))

	)

239 
	#__©åibuã_c⁄°__


	)

245 #i‡
__GNUC_PREREQ
 (3,1)

246 
	#__©åibuã_u£d__
 
	`__©åibuã__
 ((
__u£d__
))

	)

247 
	#__©åibuã_noölöe__
 
	`__©åibuã__
 ((
__noölöe__
))

	)

249 
	#__©åibuã_u£d__
 
	`__©åibuã__
 ((
__unu£d__
))

	)

250 
	#__©åibuã_noölöe__


	)

254 #i‡
__GNUC_PREREQ
 (3,2)

255 
	#__©åibuã_dïªˇãd__
 
	`__©åibuã__
 ((
__dïªˇãd__
))

	)

257 
	#__©åibuã_dïªˇãd__


	)

266 #i‡
__GNUC_PREREQ
 (2,8)

267 
	#__©åibuã_f‹m©_¨g__
(
x
Ë
	`__©åibuã__
 ((
	`__f‹m©_¨g__
 (x)))

	)

269 
	#__©åibuã_f‹m©_¨g__
(
x
Ë

	)

276 #i‡
__GNUC_PREREQ
 (2,97)

277 
	#__©åibuã_f‹m©_°rfm⁄__
(
a
,
b
) \

278 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__°rfm⁄__
, 
a
, 
b
)))

	)

280 
	#__©åibuã_f‹m©_°rfm⁄__
(
a
,
b
Ë

	)

285 #i‡
__GNUC_PREREQ
 (3,3)

286 
	#__n⁄nuŒ
(
∑øms
Ë
	`__©åibuã__
 ((
__n⁄nuŒ__
Ö¨ams))

	)

288 
	#__n⁄nuŒ
(
∑øms
)

	)

293 #i‡
__GNUC_PREREQ
 (3,4)

294 
	#__©åibuã_w¨n_unu£d_ªsu…__
 \

295 
	`__©åibuã__
 ((
__w¨n_unu£d_ªsu…__
))

	)

296 #i‡
__USE_FORTIFY_LEVEL
 > 0

297 
	#__wur
 
__©åibuã_w¨n_unu£d_ªsu…__


	)

300 
	#__©åibuã_w¨n_unu£d_ªsu…__


	)

302 #i‚de‡
__wur


303 
	#__wur


	)

307 #i‡
__GNUC_PREREQ
 (3,2)

308 
	#__Æways_ölöe
 
__ölöe
 
	`__©åibuã__
 ((
__Æways_ölöe__
))

	)

310 
	#__Æways_ölöe
 
__ölöe


	)

315 #i‡
__GNUC_PREREQ
 (4,3)

316 
	#__©åibuã_¨tificül__
 
	`__©åibuã__
 ((
__¨tificül__
))

	)

318 
	#__©åibuã_¨tificül__


	)

323 #i‡(!
deföed
 
__˝lu•lus
 || 
__GNUC_PREREQ
 (4,3)Ë&& deföed 
__GNUC__


324 #i‡
deföed
 
__GNUC_STDC_INLINE__
 || deföed 
__˝lu•lus


325 
	#__exã∫_ölöe
 
__ölöe
 
	`__©åibuã__
 ((
__gnu_ölöe__
))

	)

326 
	#__exã∫_Æways_ölöe
 \

327 
__Æways_ölöe
 
	`__©åibuã__
 ((
__gnu_ölöe__
))

	)

329 
	#__exã∫_ölöe
 
__ölöe


	)

330 
	#__exã∫_Æways_ölöe
 
__Æways_ölöe


	)

332 #ñi‡
deföed
 
__GNUC__


333 
	#__exã∫_ölöe
 
__ölöe


	)

334 
	#__exã∫_Æways_ölöe
 \

335 
__Æways_ölöe


	)

337 
	#__exã∫_ölöe


	)

338 
	#__exã∫_Æways_ölöe


	)

343 #i‡
__GNUC_PREREQ
 (4,3)

344 
	#__va_¨g_∑ck
(Ë
	`__buûtö_va_¨g_∑ck
 ()

	)

345 
	#__va_¨g_∑ck_Àn
(Ë
	`__buûtö_va_¨g_∑ck_Àn
 ()

	)

352 #i‡!
__GNUC_PREREQ
 (2,8)

353 
	#__exãnsi⁄__


	)

357 #i‡!
__GNUC_PREREQ
 (2,92)

358 
	#__ª°ri˘


	)

364 #i‡
__GNUC_PREREQ
 (3,1Ë&& !
deföed
 
__GNUG__


365 
	#__ª°ri˘_¨r
 
__ª°ri˘


	)

367 #ifde‡
__GNUC__


368 
	#__ª°ri˘_¨r


	)

370 #i‡
deföed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L

371 
	#__ª°ri˘_¨r
 
ª°ri˘


	)

374 
	#__ª°ri˘_¨r


	)

379 #i‡
__GNUC__
 >= 3

380 
	#__glibc_u∆ikñy
(
c⁄d
Ë
	`__buûtö_ex≥˘
((c⁄d), 0)

	)

382 
	#__glibc_u∆ikñy
(
c⁄d
Ë(c⁄d)

	)

385 
	~<bôs/w‹dsize.h
>

387 #i‡
deföed
 
__LONG_DOUBLE_MATH_OPTIONAL
 && deföed 
__NO_LONG_DOUBLE_MATH


388 
	#__LDBL_COMPAT
 1

	)

389 #ifde‡
__REDIRECT


390 
	#__LDBL_REDIR1
(
«me
, 
¥Ÿo
, 
Æüs
Ë
	`__REDIRECT
 («me,ÖrŸo,álüs)

	)

391 
	#__LDBL_REDIR
(
«me
, 
¥Ÿo
) \

392 
	`__LDBL_REDIR1
 (
«me
, 
¥Ÿo
, 
__∆dbl_
##«me)

	)

393 
	#__LDBL_REDIR1_NTH
(
«me
, 
¥Ÿo
, 
Æüs
Ë
	`__REDIRECT_NTH
 («me,ÖrŸo,álüs)

	)

394 
	#__LDBL_REDIR_NTH
(
«me
, 
¥Ÿo
) \

395 
	`__LDBL_REDIR1_NTH
 (
«me
, 
¥Ÿo
, 
__∆dbl_
##«me)

	)

396 
	#__LDBL_REDIR1_DECL
(
«me
, 
Æüs
) \

397 
	`__ty≥of
 (
«me
Ë«mê
	`__asm
 (
	`__ASMNAME
 (#Æüs));

	)

398 
	#__LDBL_REDIR_DECL
(
«me
) \

399 
	`__ty≥of
 (
«me
Ë«mê
	`__asm
 (
	`__ASMNAME
 ("__∆dbl_" #«me));

	)

400 
	#__REDIRECT_LDBL
(
«me
, 
¥Ÿo
, 
Æüs
) \

401 
	`__LDBL_REDIR1
 (
«me
, 
¥Ÿo
, 
__∆dbl_
##
Æüs
)

	)

402 
	#__REDIRECT_NTH_LDBL
(
«me
, 
¥Ÿo
, 
Æüs
) \

403 
	`__LDBL_REDIR1_NTH
 (
«me
, 
¥Ÿo
, 
__∆dbl_
##
Æüs
)

	)

406 #i‡!
deföed
 
__LDBL_COMPAT
 || !deföed 
__REDIRECT


407 
	#__LDBL_REDIR1
(
«me
, 
¥Ÿo
, 
Æüs
Ë«mê
	)
proto

408 
	#__LDBL_REDIR
(
«me
, 
¥Ÿo
Ë«mê
	)
proto

409 
	#__LDBL_REDIR1_NTH
(
«me
, 
¥Ÿo
, 
Æüs
Ë«mê¥Ÿÿ
__THROW


	)

410 
	#__LDBL_REDIR_NTH
(
«me
, 
¥Ÿo
Ë«mê¥Ÿÿ
__THROW


	)

411 
	#__LDBL_REDIR_DECL
(
«me
)

	)

412 #ifde‡
__REDIRECT


413 
	#__REDIRECT_LDBL
(
«me
, 
¥Ÿo
, 
Æüs
Ë
	`__REDIRECT
 («me,ÖrŸo,álüs)

	)

414 
	#__REDIRECT_NTH_LDBL
(
«me
, 
¥Ÿo
, 
Æüs
) \

415 
	`__REDIRECT_NTH
 (
«me
, 
¥Ÿo
, 
Æüs
)

	)

	@/usr/include/asm-generic/errno-base.h

1 #i‚de‡
_ASM_GENERIC_ERRNO_BASE_H


2 
	#_ASM_GENERIC_ERRNO_BASE_H


	)

4 
	#EPERM
 1

	)

5 
	#ENOENT
 2

	)

6 
	#ESRCH
 3

	)

7 
	#EINTR
 4

	)

8 
	#EIO
 5

	)

9 
	#ENXIO
 6

	)

10 
	#E2BIG
 7

	)

11 
	#ENOEXEC
 8

	)

12 
	#EBADF
 9

	)

13 
	#ECHILD
 10

	)

14 
	#EAGAIN
 11

	)

15 
	#ENOMEM
 12

	)

16 
	#EACCES
 13

	)

17 
	#EFAULT
 14

	)

18 
	#ENOTBLK
 15

	)

19 
	#EBUSY
 16

	)

20 
	#EEXIST
 17

	)

21 
	#EXDEV
 18

	)

22 
	#ENODEV
 19

	)

23 
	#ENOTDIR
 20

	)

24 
	#EISDIR
 21

	)

25 
	#EINVAL
 22

	)

26 
	#ENFILE
 23

	)

27 
	#EMFILE
 24

	)

28 
	#ENOTTY
 25

	)

29 
	#ETXTBSY
 26

	)

30 
	#EFBIG
 27

	)

31 
	#ENOSPC
 28

	)

32 
	#ESPIPE
 29

	)

33 
	#EROFS
 30

	)

34 
	#EMLINK
 31

	)

35 
	#EPIPE
 32

	)

36 
	#EDOM
 33

	)

37 
	#ERANGE
 34

	)

	@/usr/include/asm-generic/ioctl.h

1 #i‚de‡
_ASM_GENERIC_IOCTL_H


2 
	#_ASM_GENERIC_IOCTL_H


	)

22 
	#_IOC_NRBITS
 8

	)

23 
	#_IOC_TYPEBITS
 8

	)

30 #i‚de‡
_IOC_SIZEBITS


31 
	#_IOC_SIZEBITS
 14

	)

34 #i‚de‡
_IOC_DIRBITS


35 
	#_IOC_DIRBITS
 2

	)

38 
	#_IOC_NRMASK
 ((1 << 
_IOC_NRBITS
)-1)

	)

39 
	#_IOC_TYPEMASK
 ((1 << 
_IOC_TYPEBITS
)-1)

	)

40 
	#_IOC_SIZEMASK
 ((1 << 
_IOC_SIZEBITS
)-1)

	)

41 
	#_IOC_DIRMASK
 ((1 << 
_IOC_DIRBITS
)-1)

	)

43 
	#_IOC_NRSHIFT
 0

	)

44 
	#_IOC_TYPESHIFT
 (
_IOC_NRSHIFT
+
_IOC_NRBITS
)

	)

45 
	#_IOC_SIZESHIFT
 (
_IOC_TYPESHIFT
+
_IOC_TYPEBITS
)

	)

46 
	#_IOC_DIRSHIFT
 (
_IOC_SIZESHIFT
+
_IOC_SIZEBITS
)

	)

53 #i‚de‡
_IOC_NONE


54 
	#_IOC_NONE
 0U

	)

57 #i‚de‡
_IOC_WRITE


58 
	#_IOC_WRITE
 1U

	)

61 #i‚de‡
_IOC_READ


62 
	#_IOC_READ
 2U

	)

65 
	#_IOC
(
dú
,
ty≥
,
ƒ
,
size
) \

66 (((
dú
Ë<< 
_IOC_DIRSHIFT
) | \

67 ((
ty≥
Ë<< 
_IOC_TYPESHIFT
) | \

68 ((
ƒ
Ë<< 
_IOC_NRSHIFT
) | \

69 ((
size
Ë<< 
_IOC_SIZESHIFT
))

	)

71 
	#_IOC_TYPECHECK
(
t
Ë(—))

	)

74 
	#_IO
(
ty≥
,
ƒ
Ë
	`_IOC
(
_IOC_NONE
,—y≥),“r),0)

	)

75 
	#_IOR
(
ty≥
,
ƒ
,
size
Ë
	`_IOC
(
_IOC_READ
,—y≥),“r),(
	`_IOC_TYPECHECK
(size)))

	)

76 
	#_IOW
(
ty≥
,
ƒ
,
size
Ë
	`_IOC
(
_IOC_WRITE
,—y≥),“r),(
	`_IOC_TYPECHECK
(size)))

	)

77 
	#_IOWR
(
ty≥
,
ƒ
,
size
Ë
	`_IOC
(
_IOC_READ
|
_IOC_WRITE
,—y≥),“r),(
	`_IOC_TYPECHECK
(size)))

	)

78 
	#_IOR_BAD
(
ty≥
,
ƒ
,
size
Ë
	`_IOC
(
_IOC_READ
,—y≥),“r),(size))

	)

79 
	#_IOW_BAD
(
ty≥
,
ƒ
,
size
Ë
	`_IOC
(
_IOC_WRITE
,—y≥),“r),(size))

	)

80 
	#_IOWR_BAD
(
ty≥
,
ƒ
,
size
Ë
	`_IOC
(
_IOC_READ
|
_IOC_WRITE
,—y≥),“r),(size))

	)

83 
	#_IOC_DIR
(
ƒ
Ë((“rË>> 
_IOC_DIRSHIFT
Ë& 
_IOC_DIRMASK
)

	)

84 
	#_IOC_TYPE
(
ƒ
Ë((“rË>> 
_IOC_TYPESHIFT
Ë& 
_IOC_TYPEMASK
)

	)

85 
	#_IOC_NR
(
ƒ
Ë((“rË>> 
_IOC_NRSHIFT
Ë& 
_IOC_NRMASK
)

	)

86 
	#_IOC_SIZE
(
ƒ
Ë((“rË>> 
_IOC_SIZESHIFT
Ë& 
_IOC_SIZEMASK
)

	)

90 
	#IOC_IN
 (
_IOC_WRITE
 << 
_IOC_DIRSHIFT
)

	)

91 
	#IOC_OUT
 (
_IOC_READ
 << 
_IOC_DIRSHIFT
)

	)

92 
	#IOC_INOUT
 ((
_IOC_WRITE
|
_IOC_READ
Ë<< 
_IOC_DIRSHIFT
)

	)

93 
	#IOCSIZE_MASK
 (
_IOC_SIZEMASK
 << 
_IOC_SIZESHIFT
)

	)

94 
	#IOCSIZE_SHIFT
 (
_IOC_SIZESHIFT
)

	)

	@/usr/include/asm-generic/mman.h

1 #i‚de‡
__ASM_GENERIC_MMAN_H


2 
	#__ASM_GENERIC_MMAN_H


	)

4 
	~<asm-gíîic/mm™-comm⁄.h
>

6 
	#MAP_GROWSDOWN
 0x0100

	)

7 
	#MAP_DENYWRITE
 0x0800

	)

8 
	#MAP_EXECUTABLE
 0x1000

	)

9 
	#MAP_LOCKED
 0x2000

	)

10 
	#MAP_NORESERVE
 0x4000

	)

11 
	#MAP_POPULATE
 0x8000

	)

12 
	#MAP_NONBLOCK
 0x10000

	)

13 
	#MAP_STACK
 0x20000

	)

14 
	#MAP_HUGETLB
 0x40000

	)

18 
	#MCL_CURRENT
 1

	)

19 
	#MCL_FUTURE
 2

	)

	@/usr/include/asm-generic/types.h

1 #i‚de‡
_ASM_GENERIC_TYPES_H


2 
	#_ASM_GENERIC_TYPES_H


	)

7 
	~<asm-gíîic/öt-Œ64.h
>

	@/usr/include/asm/posix_types.h

1 #ifde‡
__i386__


2 
	~<asm/posix_ty≥s_32.h
>

3 #ñi‡
deföed
(
__ILP32__
)

4 
	~<asm/posix_ty≥s_x32.h
>

6 
	~<asm/posix_ty≥s_64.h
>

	@/usr/include/bits/string.h

19 #i‚de‡
_STRING_H


24 
	#_STRING_ARCH_u«lig√d
 1

	)

28 #i‡!
deföed
 
__x86_64__
 && (deföed 
__i486__
 || deföed 
__≥¡ium__
 \

29 || 
deföed
 
	g__≥¡ium¥o__
 || deföed 
	g__≥¡ium4__
 \

30 || 
deföed
 
	g__noc⁄a__
 || deföed 
	g__©om__
 \

31 || 
deföed
 
	g__c‹e2__
 || deföed 
	g__c‹ei7__
 \

32 || 
deföed
 
	g__k6__
 || deföed 
	g__geode__
 \

33 || 
deföed
 
	g__k8__
 || deföed 
	g__©hl⁄__
 \

34 || 
deföed
 
	g__amdÁm10__
)

38 #i‡!
deföed
 
__NO_STRING_INLINES
 && deföed 
__USE_STRING_INLINES
 \

39 && 
deföed
 
	g__GNUC__
 && __GNUC__ >2 && !
__BOUNDED_POINTERS__


41 #i‚de‡
__STRING_INLINE


42 #i‚de‡
__exã∫_ölöe


43 
	#__STRING_INLINE
 
ölöe


	)

45 
	#__STRING_INLINE
 
__exã∫_ölöe


	)

50 
	#__STRING_SMALL_GET16
(
§c
, 
idx
) \

51 ((((c⁄° *Ë(
§c
))[
idx
 + 1] << 8) \

52 | ((c⁄° *Ë(
§c
))[
idx
])

	)

53 
	#__STRING_SMALL_GET32
(
§c
, 
idx
) \

54 (((((c⁄° *Ë(
§c
))[
idx
 + 3] << 8 \

55 | ((c⁄° *Ë(
§c
))[
idx
 + 2]) << 8 \

56 | ((c⁄° *Ë(
§c
))[
idx
 + 1]) << 8 \

57 | ((c⁄° *Ë(
§c
))[
idx
])

	)

61 
	#_HAVE_STRING_ARCH_mem˝y
 1

	)

62 
	#mem˝y
(
de°
, 
§c
, 
n
) \

63 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
n
) \

64 ? 
	`__mem˝y_c
 ((
de°
), (
§c
), (
n
)) \

65 : 
	`__mem˝y_g
 ((
de°
), (
§c
), (
n
))))

	)

66 
	#__mem˝y_c
(
de°
, 
§c
, 
n
) \

67 ((
n
) == 0 \

68 ? (
de°
) \

69 : (((
n
) % 4 == 0) \

70 ? 
	`__mem˝y_by4
 (
de°
, 
§c
, 
n
) \

71 : (((
n
) % 2 == 0) \

72 ? 
	`__mem˝y_by2
 (
de°
, 
§c
, 
n
) \

73 : 
	`__mem˝y_g
 (
de°
, 
§c
, 
n
))))

	)

75 
__STRING_INLINE
 *
__mem˝y_by4
 (*
__de°
, c⁄° *
__§c
,

76 
size_t
 
__n
);

78 
__STRING_INLINE
 *

79 
	$__mem˝y_by4
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__n
)

81 
__d0
, 
__d1
;

82 *
__tmp
 = 
__de°
;

83 
__asm__
 
__vﬁ©ûe__


91 : "=&r" (
__d0
), "=&r" (
__tmp
), "=&r" (
__§c
), "=&r" (
__d1
)

92 : "1" (
__tmp
), "2" (
__§c
), "3" (
__n
 / 4)

94  
__de°
;

95 
	}
}

97 
__STRING_INLINE
 *
__mem˝y_by2
 (*
__de°
, c⁄° *
__§c
,

98 
size_t
 
__n
);

100 
__STRING_INLINE
 *

101 
	$__mem˝y_by2
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__n
)

103 
__d0
, 
__d1
;

104 *
__tmp
 = 
__de°
;

105 
__asm__
 
__vﬁ©ûe__


118 : "=&q" (
__d0
), "=&r" (
__tmp
), "=&r" (
__§c
), "=&r" (
__d1
)

119 : "1" (
__tmp
), "2" (
__§c
), "3" (
__n
 / 2)

121  
__de°
;

122 
	}
}

124 
__STRING_INLINE
 *
__mem˝y_g
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__n
);

126 
__STRING_INLINE
 *

127 
	$__mem˝y_g
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__n
)

129 
__d0
, 
__d1
, 
__d2
;

130 *
__tmp
 = 
__de°
;

131 
__asm__
 
__vﬁ©ûe__


142 : "=&c" (
__d0
), "=&D" (
__d1
), "=&S" (
__d2
),

143 "=m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__de°
)

144 : "0" (
__n
), "1" (
__tmp
), "2" (
__§c
),

145 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__§c
)

147  
__de°
;

148 
	}
}

150 
	#_HAVE_STRING_ARCH_memmove
 1

	)

151 #i‚de‡
_FORCE_INLINES


154 
	#memmove
(
de°
, 
§c
, 
n
Ë
	`__memmove_g
 (de°, src,Ç)

	)

156 
__STRING_INLINE
 *
	$__memmove_g
 (*, c⁄° *, 
size_t
)

157 
	`__asm__
 ("memmove");

159 
__STRING_INLINE
 *

160 
	$__memmove_g
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__n
)

162 
__d0
, 
__d1
, 
__d2
;

163 *
__tmp
 = 
__de°
;

164 i‡(
__de°
 < 
__§c
)

165 
__asm__
 
__vﬁ©ûe__


168 : "=&c" (
__d0
), "=&S" (
__d1
), "=&D" (
__d2
),

169 "=m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__de°
)

170 : "0" (
__n
), "1" (
__§c
), "2" (
__tmp
),

171 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__§c
));

173 
__asm__
 
__vﬁ©ûe__


177 : "=&c" (
__d0
), "=&S" (
__d1
), "=&D" (
__d2
),

178 "=m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__de°
)

179 : "0" (
__n
), "1" (__¿- 1 + (c⁄° *Ë
__§c
),

180 "2" (
__n
 - 1 + (*Ë
__tmp
),

181 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__§c
));

182  
__de°
;

183 
	}
}

187 
	#_HAVE_STRING_ARCH_memcmp
 1

	)

188 #i‚de‡
_FORCE_INLINES


189 #i‚de‡
__PIC__


191 
__STRING_INLINE
 

192 
	$memcmp
 (c⁄° *
__s1
, c⁄° *
__s2
, 
size_t
 
__n
)

194 
__d0
, 
__d1
, 
__d2
;

195 
__ªs
;

196 
__asm__
 
__vﬁ©ûe__


204 : "=&a" (
__ªs
), "=&S" (
__d0
), "=&D" (
__d1
), "=&c" (
__d2
)

205 : "0" (0), "1" (
__s1
), "2" (
__s2
), "3" (
__n
),

206 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__s1
),

207 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__s2
)

209  
__ªs
;

210 
	}
}

215 
	#_HAVE_STRING_ARCH_mem£t
 1

	)

216 
	#_USE_STRING_ARCH_mem£t
 1

	)

217 
	#mem£t
(
s
, 
c
, 
n
) \

218 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
n
) && (n) <= 16 \

219 ? ((
n
) == 1 \

220 ? 
	`__mem£t_c1
 ((
s
), (
c
)) \

221 : 
	`__mem£t_gc
 ((
s
), (
c
), (
n
))) \

222 : (
	`__buûtö_c⁄°™t_p
 (
c
) \

223 ? (
	`__buûtö_c⁄°™t_p
 (
n
) \

224 ? 
	`__mem£t_c˙
 ((
s
), (
c
), (
n
)) \

225 : 
	`mem£t
 ((
s
), (
c
), (
n
))) \

226 : (
	`__buûtö_c⁄°™t_p
 (
n
) \

227 ? 
	`__mem£t_g˙
 ((
s
), (
c
), (
n
)) \

228 : 
	`mem£t
 ((
s
), (
c
), (
n
))))))

	)

230 
	#__mem£t_c1
(
s
, 
c
Ë({ *
__s
 = (s); \

231 *((*Ë
__s
Ë(Ë(
c
); \

232 
__s
; })

	)

234 
	#__mem£t_gc
(
s
, 
c
, 
n
) \

235 ({ *
__s
 = (
s
); \

237 
__ui
; \

238 
__usi
; \

239 
__uc
; \

240 } *
__u
 = 
__s
; \

241 
__c
 = ((Ë((Ë(
c
))) * 0x01010101; \

247 i‡((
n
) == 3 || (n) >= 5) \

248 
__asm__
 
	`__vﬁ©ûe__
 ("" : "Ù" (
__c
) : "0" (__c)); \

251 
n
) \

254 
__u
->
__ui
 = 
__c
; \

255 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

257 
__u
->
__ui
 = 
__c
; \

258 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

260 
__u
->
__ui
 = 
__c
; \

261 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

263 
__u
->
__usi
 = (Ë
__c
; \

264 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2); \

265 
__u
->
__uc
 = (Ë
__c
; \

269 
__u
->
__ui
 = 
__c
; \

270 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

272 
__u
->
__ui
 = 
__c
; \

273 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

275 
__u
->
__ui
 = 
__c
; \

276 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

278 
__u
->
__usi
 = (Ë
__c
; \

282 
__u
->
__ui
 = 
__c
; \

283 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

285 
__u
->
__ui
 = 
__c
; \

286 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

288 
__u
->
__ui
 = 
__c
; \

289 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

291 
__u
->
__uc
 = (Ë
__c
; \

295 
__u
->
__ui
 = 
__c
; \

296 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

298 
__u
->
__ui
 = 
__c
; \

299 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

301 
__u
->
__ui
 = 
__c
; \

302 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

304 
__u
->
__ui
 = 
__c
; \

309 
__s
; })

	)

311 
	#__mem£t_c˙
(
s
, 
c
, 
n
) \

312 (((
n
) % 4 == 0) \

313 ? 
	`__mem£t_c˙_by4
 (
s
, ((Ë((Ë(
c
))) * 0x01010101,\

314 
n
) \

315 : (((
n
) % 2 == 0) \

316 ? 
	`__mem£t_c˙_by2
 (
s
, \

317 ((Ë((Ë(
c
))) * 0x01010101,\

318 
n
) \

319 : 
	`mem£t
 (
s
, 
c
, 
n
)))

	)

321 
__STRING_INLINE
 *
__mem£t_c˙_by4
 (*
__s
, 
__c
,

322 
size_t
 
__n
);

324 
__STRING_INLINE
 *

325 
	$__mem£t_c˙_by4
 (*
__s
, 
__c
, 
size_t
 
__n
)

327 *
__tmp
 = 
__s
;

328 
__d0
;

329 #ifde‡
__i686__


330 
__asm__
 
__vﬁ©ûe__


333 : "=&a" (
__c
), "=&D" (
__tmp
), "=&c" (
__d0
),

334 "=m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__s
)

335 : "0" ((Ë
__c
), "1" (
__tmp
), "2" (
__n
 / 4)

338 
__asm__
 
__vﬁ©ûe__


344 : "=&r" (
__c
), "=&r" (
__tmp
), "=&r" (
__d0
),

345 "=m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__s
)

346 : "0" ((Ë
__c
), "1" (
__tmp
), "2" (
__n
 / 4)

349  
__s
;

350 
	}
}

352 
__STRING_INLINE
 *
__mem£t_c˙_by2
 (*
__s
, 
__c
,

353 
size_t
 
__n
);

355 
__STRING_INLINE
 *

356 
	$__mem£t_c˙_by2
 (*
__s
, 
__c
, 
size_t
 
__n
)

358 
__d0
, 
__d1
;

359 *
__tmp
 = 
__s
;

360 #ifde‡
__i686__


361 
__asm__
 
__vﬁ©ûe__


365 : "=&a" (
__d0
), "=&D" (
__tmp
), "=&c" (
__d1
),

366 "=m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__s
)

367 : "0" ((Ë
__c
), "1" (
__tmp
), "2" (
__n
 / 4)

370 
__asm__
 
__vﬁ©ûe__


376 : "=&q" (
__d0
), "=&r" (
__tmp
), "=&r" (
__d1
),

377 "=m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__s
)

378 : "0" ((Ë
__c
), "1" (
__tmp
), "2" (
__n
 / 4)

381  
__s
;

382 
	}
}

384 
	#__mem£t_g˙
(
s
, 
c
, 
n
) \

385 (((
n
) % 4 == 0) \

386 ? 
	`__mem£t_g˙_by4
 (
s
, 
c
, 
n
) \

387 : (((
n
) % 2 == 0) \

388 ? 
	`__mem£t_g˙_by2
 (
s
, 
c
, 
n
) \

389 : 
	`mem£t
 (
s
, 
c
, 
n
)))

	)

391 
__STRING_INLINE
 *
__mem£t_g˙_by4
 (*
__s
, 
__c
, 
size_t
 
__n
);

393 
__STRING_INLINE
 *

394 
	$__mem£t_g˙_by4
 (*
__s
, 
__c
, 
size_t
 
__n
)

396 *
__tmp
 = 
__s
;

397 
__d0
;

398 
__asm__
 
__vﬁ©ûe__


408 : "=&q" (
__c
), "=&r" (
__tmp
), "=&r" (
__d0
),

409 "=m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__s
)

410 : "0" ((Ë
__c
), "1" (
__tmp
), "2" (
__n
 / 4)

412  
__s
;

413 
	}
}

415 
__STRING_INLINE
 *
__mem£t_g˙_by2
 (*
__s
, 
__c
, 
size_t
 
__n
);

417 
__STRING_INLINE
 *

418 
	$__mem£t_g˙_by2
 (*
__s
, 
__c
, 
size_t
 
__n
)

420 
__d0
, 
__d1
;

421 *
__tmp
 = 
__s
;

422 
__asm__
 
__vﬁ©ûe__


433 : "=&q" (
__d0
), "=&r" (
__tmp
), "=&r" (
__d1
),

434 "=m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__s
)

435 : "0" ((Ë
__c
), "1" (
__tmp
), "2" (
__n
 / 4)

437  
__s
;

438 
	}
}

442 
	#_HAVE_STRING_ARCH_memchr
 1

	)

443 #i‚de‡
_FORCE_INLINES


444 
__STRING_INLINE
 *

445 
	$memchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
)

447 
__d0
;

448 #ifde‡
__i686__


449 
__d1
;

451 *
__ªs
;

452 i‡(
__n
 == 0)

453  
NULL
;

454 #ifde‡
__i686__


455 
__asm__
 
__vﬁ©ûe__


459 : "=D" (
__ªs
), "=&c" (
__d0
), "=&r" (
__d1
)

460 : "a" (
__c
), "0" (
__s
), "1" (
__n
), "2" (1),

461 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__s
)

464 
__asm__
 
__vﬁ©ûe__


470 : "=D" (
__ªs
), "=&c" (
__d0
)

471 : "a" (
__c
), "0" (
__s
), "1" (
__n
),

472 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__s
)

475  
__ªs
 - 1;

476 
	}
}

479 
	#_HAVE_STRING_ARCH_memrchr
 1

	)

480 #i‚de‡
_FORCE_INLINES


481 
__STRING_INLINE
 *
__memrchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
);

483 
__STRING_INLINE
 *

484 
	$__memrchr
 (c⁄° *
__s
, 
__c
, 
size_t
 
__n
)

486 
__d0
;

487 #ifde‡
__i686__


488 
__d1
;

490 *
__ªs
;

491 i‡(
__n
 == 0)

492  
NULL
;

493 #ifde‡
__i686__


494 
__asm__
 
__vﬁ©ûe__


500 : "=D" (
__ªs
), "=&c" (
__d0
), "=&r" (
__d1
)

501 : "a" (
__c
), "0" (
__s
 + 
__n
 - 1), "1" (__n), "2" (-1),

502 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__s
)

505 
__asm__
 
__vﬁ©ûe__


512 : "=D" (
__ªs
), "=&c" (
__d0
)

513 : "a" (
__c
), "0" (
__s
 + 
__n
 - 1), "1" (__n),

514 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__s
)

517  
__ªs
;

518 
	}
}

519 #ifde‡
__USE_GNU


520 
	#memrchr
(
s
, 
c
, 
n
Ë
	`__memrchr
 ((s), (c), (n))

	)

525 
	#_HAVE_STRING_ARCH_øwmemchr
 1

	)

526 
__STRING_INLINE
 *
__øwmemchr
 (c⁄° *
__s
, 
__c
);

528 #i‚de‡
_FORCE_INLINES


529 
__STRING_INLINE
 *

530 
	$__øwmemchr
 (c⁄° *
__s
, 
__c
)

532 
__d0
;

533 *
__ªs
;

534 
__asm__
 
__vﬁ©ûe__


537 : "=D" (
__ªs
), "=&c" (
__d0
)

538 : "a" (
__c
), "0" (
__s
), "1" (0xffffffff),

539 "m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__s
)

541  
__ªs
 - 1;

542 
	}
}

543 #ifde‡
__USE_GNU


544 
__STRING_INLINE
 *

545 
	$øwmemchr
 (c⁄° *
__s
, 
__c
)

547  
	`__øwmemchr
 (
__s
, 
__c
);

548 
	}
}

554 
	#_HAVE_STRING_ARCH_°æí
 1

	)

555 
	#°æí
(
°r
) \

556 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
°r
) \

557 ? 
	`__buûtö_°æí
 (
°r
) \

558 : 
	`__°æí_g
 (
°r
)))

	)

559 
__STRING_INLINE
 
size_t
 
__°æí_g
 (c⁄° *
__°r
);

561 
__STRING_INLINE
 
size_t


562 
	$__°æí_g
 (c⁄° *
__°r
)

564 
__dummy
;

565 c⁄° *
__tmp
 = 
__°r
;

566 
__asm__
 
__vﬁ©ûe__


572 : "Ù" (
__tmp
), "=&q" (
__dummy
)

573 : "0" (
__°r
),

574 "m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__°r
)

576  
__tmp
 - 
__°r
 - 1;

577 
	}
}

581 
	#_HAVE_STRING_ARCH_°r˝y
 1

	)

582 
	#°r˝y
(
de°
, 
§c
) \

583 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
§c
) \

584 ? ( ((
§c
)[0]Ë=1 && 
	`°æí
 (src) + 1 <= 8 \

585 ? 
	`__°r˝y_a_smÆl
 ((
de°
), (
§c
), 
	`°æí
 (src) + 1) \

586 : (*Ë
	`mem˝y
 ((*Ë(
de°
), \

587 (c⁄° *Ë(
§c
), \

588 
	`°æí
 (
§c
) + 1)) \

589 : 
	`__°r˝y_g
 ((
de°
), (
§c
))))

	)

591 
	#__°r˝y_a_smÆl
(
de°
, 
§c
, 
§˛í
) \

592 (
	`__exãnsi⁄__
 ({ *
__de°
 = (
de°
); \

594 
__ui
; \

595 
__usi
; \

596 
__uc
; \

597 
__c
; \

598 } *
__u
 = (*Ë
__de°
; \

599 
§˛í
) \

602 
__u
->
__uc
 = '\0'; \

605 
__u
->
__usi
 = 
	`__STRING_SMALL_GET16
 (
§c
, 0); \

608 
__u
->
__usi
 = 
	`__STRING_SMALL_GET16
 (
§c
, 0); \

609 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2); \

610 
__u
->
__uc
 = '\0'; \

613 
__u
->
__ui
 = 
	`__STRING_SMALL_GET32
 (
§c
, 0); \

616 
__u
->
__ui
 = 
	`__STRING_SMALL_GET32
 (
§c
, 0); \

617 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

618 
__u
->
__uc
 = '\0'; \

621 
__u
->
__ui
 = 
	`__STRING_SMALL_GET32
 (
§c
, 0); \

622 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

623 
__u
->
__usi
 = 
	`__STRING_SMALL_GET16
 (
§c
, 4); \

626 
__u
->
__ui
 = 
	`__STRING_SMALL_GET32
 (
§c
, 0); \

627 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

628 
__u
->
__usi
 = 
	`__STRING_SMALL_GET16
 (
§c
, 4); \

629 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2); \

630 
__u
->
__uc
 = '\0'; \

633 
__u
->
__ui
 = 
	`__STRING_SMALL_GET32
 (
§c
, 0); \

634 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

635 
__u
->
__ui
 = 
	`__STRING_SMALL_GET32
 (
§c
, 4); \

638 (*Ë
__de°
; }))

	)

640 
__STRING_INLINE
 *
__°r˝y_g
 (*
__de°
, c⁄° *
__§c
);

642 
__STRING_INLINE
 *

643 
	$__°r˝y_g
 (*
__de°
, c⁄° *
__§c
)

645 *
__tmp
 = 
__de°
;

646 
__dummy
;

647 
__asm__
 
__vﬁ©ûe__


656 : "=&r" (
__§c
), "=&r" (
__tmp
), "=&q" (
__dummy
),

657 "=m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__de°
)

658 : "0" (
__§c
), "1" (
__tmp
),

659 "m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__§c
)

661  
__de°
;

662 
	}
}

665 #ifde‡
__USE_GNU


666 
	#_HAVE_STRING_ARCH_°p˝y
 1

	)

668 
	#__°p˝y
(
de°
, 
§c
) \

669 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
§c
) \

670 ? (
	`°æí
 (
§c
) + 1 <= 8 \

671 ? 
	`__°p˝y_a_smÆl
 ((
de°
), (
§c
), 
	`°æí
 (src) + 1) \

672 : 
	`__°p˝y_c
 ((
de°
), (
§c
), 
	`°æí
 (src) + 1)) \

673 : 
	`__°p˝y_g
 ((
de°
), (
§c
))))

	)

674 
	#__°p˝y_c
(
de°
, 
§c
, 
§˛í
) \

675 ((
§˛í
) % 4 == 0 \

676 ? 
	`__memp˝y_by4
 (
de°
, 
§c
, 
§˛í
) - 1 \

677 : ((
§˛í
) % 2 == 0 \

678 ? 
	`__memp˝y_by2
 (
de°
, 
§c
, 
§˛í
) - 1 \

679 : 
	`__memp˝y_byn
 (
de°
, 
§c
, 
§˛í
Ë- 1))

	)

682 
	#°p˝y
(
de°
, 
§c
Ë
	`__°p˝y
 ((de°), (§c))

	)

684 
	#__°p˝y_a_smÆl
(
de°
, 
§c
, 
§˛í
) \

685 (
	`__exãnsi⁄__
 ({ union { \

686 
__ui
; \

687 
__usi
; \

688 
__uc
; \

689 
__c
; \

690 } *
__u
 = (*Ë(
de°
); \

691 
§˛í
) \

694 
__u
->
__uc
 = '\0'; \

697 
__u
->
__usi
 = 
	`__STRING_SMALL_GET16
 (
§c
, 0); \

698 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 1); \

701 
__u
->
__usi
 = 
	`__STRING_SMALL_GET16
 (
§c
, 0); \

702 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2); \

703 
__u
->
__uc
 = '\0'; \

706 
__u
->
__ui
 = 
	`__STRING_SMALL_GET32
 (
§c
, 0); \

707 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 3); \

710 
__u
->
__ui
 = 
	`__STRING_SMALL_GET32
 (
§c
, 0); \

711 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

712 
__u
->
__uc
 = '\0'; \

715 
__u
->
__ui
 = 
	`__STRING_SMALL_GET32
 (
§c
, 0); \

716 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

717 
__u
->
__usi
 = 
	`__STRING_SMALL_GET16
 (
§c
, 4); \

718 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 1); \

721 
__u
->
__ui
 = 
	`__STRING_SMALL_GET32
 (
§c
, 0); \

722 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

723 
__u
->
__usi
 = 
	`__STRING_SMALL_GET16
 (
§c
, 4); \

724 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2); \

725 
__u
->
__uc
 = '\0'; \

728 
__u
->
__ui
 = 
	`__STRING_SMALL_GET32
 (
§c
, 0); \

729 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

730 
__u
->
__ui
 = 
	`__STRING_SMALL_GET32
 (
§c
, 4); \

731 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 3); \

734 (*Ë
__u
; }))

	)

736 
__STRING_INLINE
 *
__memp˝y_by4
 (*
__de°
, c⁄° *
__§c
,

737 
size_t
 
__§˛í
);

739 
__STRING_INLINE
 *

740 
	$__memp˝y_by4
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__§˛í
)

742 *
__tmp
 = 
__de°
;

743 
__d0
, 
__d1
;

744 
__asm__
 
__vﬁ©ûe__


752 : "=&r" (
__d0
), "Ù" (
__tmp
), "=&r" (
__§c
), "=&r" (
__d1
)

753 : "1" (
__tmp
), "2" (
__§c
), "3" (
__§˛í
 / 4)

755  
__tmp
;

756 
	}
}

758 
__STRING_INLINE
 *
__memp˝y_by2
 (*
__de°
, c⁄° *
__§c
,

759 
size_t
 
__§˛í
);

761 
__STRING_INLINE
 *

762 
	$__memp˝y_by2
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__§˛í
)

764 *
__tmp
 = 
__de°
;

765 
__d0
, 
__d1
;

766 
__asm__
 
__vﬁ©ûe__


779 : "=&q" (
__d0
), "Ù" (
__tmp
), "=&r" (
__§c
), "=&r" (
__d1
),

780 "=m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__§˛í
]; } *)
__de°
)

781 : "1" (
__tmp
), "2" (
__§c
), "3" (
__§˛í
 / 2),

782 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__§˛í
]; } *)
__§c
)

784  
__tmp
 + 2;

785 
	}
}

787 
__STRING_INLINE
 *
__memp˝y_byn
 (*
__de°
, c⁄° *
__§c
,

788 
size_t
 
__§˛í
);

790 
__STRING_INLINE
 *

791 
	$__memp˝y_byn
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__§˛í
)

793 
__d0
, 
__d1
;

794 *
__tmp
 = 
__de°
;

795 
__asm__
 
__vﬁ©ûe__


806 : "=D" (
__tmp
), "=&c" (
__d0
), "=&S" (
__d1
),

807 "=m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__§˛í
]; } *)
__de°
)

808 : "0" (
__tmp
), "1" (
__§˛í
), "2" (
__§c
),

809 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__§˛í
]; } *)
__§c
)

811  
__tmp
;

812 
	}
}

814 
__STRING_INLINE
 *
__°p˝y_g
 (*
__de°
, c⁄° *
__§c
);

816 
__STRING_INLINE
 *

817 
	$__°p˝y_g
 (*
__de°
, c⁄° *
__§c
)

819 *
__tmp
 = 
__de°
;

820 
__dummy
;

821 
__asm__
 
__vﬁ©ûe__


830 : "=&r" (
__§c
), "Ù" (
__tmp
), "=&q" (
__dummy
),

831 "=m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__de°
)

832 : "0" (
__§c
), "1" (
__tmp
),

833 "m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__§c
)

835  
__tmp
 - 1;

836 
	}
}

841 
	#_HAVE_STRING_ARCH_°∫˝y
 1

	)

842 
	#°∫˝y
(
de°
, 
§c
, 
n
) \

843 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
§c
) \

844 ? ((
	`°æí
 (
§c
Ë+ 1 >((
size_t
Ë(
n
)) \

845 ? (*Ë
	`mem˝y
 ((*Ë(
de°
), \

846 (c⁄° *Ë(
§c
), 
n
) \

847 : 
	`__°∫˝y_cg
 ((
de°
), (
§c
), 
	`°æí
 (§cË+ 1, 
n
))) \

848 : 
	`__°∫˝y_gg
 ((
de°
), (
§c
), 
n
)))

	)

849 
	#__°∫˝y_cg
(
de°
, 
§c
, 
§˛í
, 
n
) \

850 (((
§˛í
) % 4 == 0) \

851 ? 
	`__°∫˝y_by4
 (
de°
, 
§c
, 
§˛í
, 
n
) \

852 : (((
§˛í
) % 2 == 0) \

853 ? 
	`__°∫˝y_by2
 (
de°
, 
§c
, 
§˛í
, 
n
) \

854 : 
	`__°∫˝y_byn
 (
de°
, 
§c
, 
§˛í
, 
n
)))

	)

856 
__STRING_INLINE
 *
__°∫˝y_by4
 (*
__de°
, c⁄° 
__§c
[],

857 
size_t
 
__§˛í
, size_à
__n
);

859 
__STRING_INLINE
 *

860 
	$__°∫˝y_by4
 (*
__de°
, c⁄° 
__§c
[], 
size_t
 
__§˛í
, size_à
__n
)

862 *
__tmp
 = 
__de°
;

863 
__dummy1
, 
__dummy2
;

864 
__asm__
 
__vﬁ©ûe__


872 : "=&r" (
__dummy1
), "Ù" (
__tmp
), "=&r" (
__§c
), "=&r" (
__dummy2
),

873 "=m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__§˛í
]; } *)
__de°
)

874 : "1" (
__tmp
), "2" (
__§c
), "3" (
__§˛í
 / 4),

875 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__§˛í
]; } *)
__§c
)

877 (Ë
	`mem£t
 (
__tmp
, '\0', 
__n
 - 
__§˛í
);

878  
__de°
;

879 
	}
}

881 
__STRING_INLINE
 *
__°∫˝y_by2
 (*
__de°
, c⁄° 
__§c
[],

882 
size_t
 
__§˛í
, size_à
__n
);

884 
__STRING_INLINE
 *

885 
	$__°∫˝y_by2
 (*
__de°
, c⁄° 
__§c
[], 
size_t
 
__§˛í
, size_à
__n
)

887 *
__tmp
 = 
__de°
;

888 
__dummy1
, 
__dummy2
;

889 
__asm__
 
__vﬁ©ûe__


902 : "=&q" (
__dummy1
), "Ù" (
__tmp
), "=&r" (
__§c
), "=&r" (
__dummy2
),

903 "=m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__§˛í
]; } *)
__de°
)

904 : "1" (
__tmp
), "2" (
__§c
), "3" (
__§˛í
 / 2),

905 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__§˛í
]; } *)
__§c
)

907 (Ë
	`mem£t
 (
__tmp
 + 2, '\0', 
__n
 - 
__§˛í
);

908  
__de°
;

909 
	}
}

911 
__STRING_INLINE
 *
__°∫˝y_byn
 (*
__de°
, c⁄° 
__§c
[],

912 
size_t
 
__§˛í
, size_à
__n
);

914 
__STRING_INLINE
 *

915 
	$__°∫˝y_byn
 (*
__de°
, c⁄° 
__§c
[], 
size_t
 
__§˛í
, size_à
__n
)

917 
__d0
, 
__d1
;

918 *
__tmp
 = 
__de°
;

919 
__asm__
 
__vﬁ©ûe__


930 : "=D" (
__tmp
), "=&c" (
__d0
), "=&S" (
__d1
),

931 "=m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__§˛í
]; } *)
__de°
)

932 : "1" (
__§˛í
), "0" (
__tmp
),"2" (
__§c
),

933 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__§˛í
]; } *)
__§c
)

935 (Ë
	`mem£t
 (
__tmp
, '\0', 
__n
 - 
__§˛í
);

936  
__de°
;

937 
	}
}

939 
__STRING_INLINE
 *
__°∫˝y_gg
 (*
__de°
, c⁄° *
__§c
,

940 
size_t
 
__n
);

942 
__STRING_INLINE
 *

943 
	$__°∫˝y_gg
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__n
)

945 *
__tmp
 = 
__de°
;

946 
__dummy
;

947 i‡(
__n
 > 0)

948 
__asm__
 
__vﬁ©ûe__


964 : "=&r" (
__§c
), "=&r" (
__tmp
), "=&q" (
__dummy
), "=&r" (
__n
)

965 : "0" (
__§c
), "1" (
__tmp
), "3" (
__n
)

968  
__de°
;

969 
	}
}

973 
	#_HAVE_STRING_ARCH_°rˇt
 1

	)

974 
	#°rˇt
(
de°
, 
§c
) \

975 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
§c
) \

976 ? 
	`__°rˇt_c
 ((
de°
), (
§c
), 
	`°æí
 (src) + 1) \

977 : 
	`__°rˇt_g
 ((
de°
), (
§c
))))

	)

979 
__STRING_INLINE
 *
__°rˇt_c
 (*
__de°
, c⁄° 
__§c
[],

980 
size_t
 
__§˛í
);

982 
__STRING_INLINE
 *

983 
	$__°rˇt_c
 (*
__de°
, c⁄° 
__§c
[], 
size_t
 
__§˛í
)

985 #ifde‡
__i686__


986 
__d0
;

987 *
__tmp
;

988 
__asm__
 
__vﬁ©ûe__


990 : "=D" (
__tmp
), "=&c" (
__d0
),

991 "=m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__de°
)

992 : "0" (
__de°
), "1" (0xffffffff), "a" (0),

993 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__§˛í
]; } *)
__§c
)

995 --
__tmp
;

997 *
__tmp
 = 
__de°
 - 1;

998 
__asm__
 
__vﬁ©ûe__


1003 : "Ù" (
__tmp
),

1004 "=m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__de°
)

1005 : "0" (
__tmp
),

1006 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__§˛í
]; } *)
__§c
)

1009 (Ë
	`mem˝y
 (
__tmp
, 
__§c
, 
__§˛í
);

1010  
__de°
;

1011 
	}
}

1013 
__STRING_INLINE
 *
__°rˇt_g
 (*
__de°
, c⁄° *
__§c
);

1015 
__STRING_INLINE
 *

1016 
	$__°rˇt_g
 (*
__de°
, c⁄° *
__§c
)

1018 *
__tmp
 = 
__de°
 - 1;

1019 
__dummy
;

1020 
__asm__
 
__vﬁ©ûe__


1032 : "=&q" (
__dummy
), "=&r" (
__tmp
), "=&r" (
__§c
),

1033 "=m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__de°
)

1034 : "1" (
__tmp
), "2" (
__§c
),

1035 "m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__§c
)

1037  
__de°
;

1038 
	}
}

1042 
	#_HAVE_STRING_ARCH_°∫ˇt
 1

	)

1043 
	#°∫ˇt
(
de°
, 
§c
, 
n
) \

1044 (
	`__exãnsi⁄__
 ({ *
__de°
 = (
de°
); \

1045 
	`__buûtö_c⁄°™t_p
 (
§c
Ë&& __buûtö_c⁄°™t_∞(
n
) \

1046 ? (
	`°æí
 (
§c
Ë< ((
size_t
Ë(
n
)) \

1047 ? 
	`°rˇt
 (
__de°
, (
§c
)) \

1048 : (*(*)
	`__memp˝y
 (
	`°rchr
 (
__de°
, '\0'), \

1049 (c⁄° *Ë(
§c
), \

1050 (
n
)Ë0, 
__de°
)) \

1051 : 
	`__°∫ˇt_g
 (
__de°
, (
§c
), (
n
)); }))

	)

1053 
__STRING_INLINE
 *
__°∫ˇt_g
 (*
__de°
, c⁄° 
__§c
[],

1054 
size_t
 
__n
);

1056 
__STRING_INLINE
 *

1057 
	$__°∫ˇt_g
 (*
__de°
, c⁄° 
__§c
[], 
size_t
 
__n
)

1059 *
__tmp
 = 
__de°
;

1060 
__dummy
;

1061 #ifde‡
__i686__


1062 
__asm__
 
__vﬁ©ûe__


1076 : "=&a" (
__dummy
), "=&D" (
__tmp
), "=&S" (
__§c
), "=&c" (
__n
)

1077 : "g" (
__n
), "0" (0), "1" (
__tmp
), "2" (
__§c
), "3" (0xffffffff)

1080 --
__tmp
;

1081 
__asm__
 
__vﬁ©ûe__


1098 : "=&q" (
__dummy
), "=&r" (
__tmp
), "=&r" (
__§c
), "=&r" (
__n
)

1099 : "1" (
__tmp
), "2" (
__§c
), "3" (
__n
)

1102  
__de°
;

1103 
	}
}

1107 
	#_HAVE_STRING_ARCH_°rcmp
 1

	)

1108 
	#°rcmp
(
s1
, 
s2
) \

1109 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
s1
Ë&& __buûtö_c⁄°™t_∞(
s2
) \

1110 && ( ((
s1
)[0]Ë!1 || 
	`°æí
 (s1) >= 4) \

1111 && ( ((
s2
)[0]Ë!1 || 
	`°æí
 (s2) >= 4) \

1112 ? 
	`memcmp
 ((c⁄° *Ë(
s1
), (c⁄° *Ë(
s2
), \

1113 (
	`°æí
 (
s1
Ë< såÀ¿(
s2
) \

1114 ? 
	`°æí
 (
s1
Ë: såÀ¿(
s2
)) + 1) \

1115 : (
	`__buûtö_c⁄°™t_p
 (
s1
) &&  ((s1)[0]) == 1 \

1116 &&  ((
s2
)[0]Ë=1 && 
	`°æí
 (
s1
) < 4 \

1117 ? (
	`__buûtö_c⁄°™t_p
 (
s2
) &&  ((s2)[0]) == 1 \

1118 ? 
	`__°rcmp_cc
 ((c⁄° *Ë(
s1
), \

1119 (c⁄° *Ë(
s2
), \

1120 
	`°æí
 (
s1
)) \

1121 : 
	`__°rcmp_cg
 ((c⁄° *Ë(
s1
), \

1122 (c⁄° *Ë(
s2
), \

1123 
	`°æí
 (
s1
))) \

1124 : (
	`__buûtö_c⁄°™t_p
 (
s2
Ë&&  ((
s1
)[0]) == 1 \

1125 &&  ((
s2
)[0]Ë=1 && 
	`°æí
 (s2) < 4 \

1126 ? (
	`__buûtö_c⁄°™t_p
 (
s1
) \

1127 ? 
	`__°rcmp_cc
 ((c⁄° *Ë(
s1
), \

1128 (c⁄° *Ë(
s2
), \

1129 
	`°æí
 (
s2
)) \

1130 : 
	`__°rcmp_gc
 ((c⁄° *Ë(
s1
), \

1131 (c⁄° *Ë(
s2
), \

1132 
	`°æí
 (
s2
))) \

1133 : 
	`__°rcmp_gg
 ((
s1
), (
s2
))))))

	)

1135 
	#__°rcmp_cc
(
s1
, 
s2
, 
l
) \

1136 (
	`__exãnsi⁄__
 ({ 
__ªsu…
 = (
s1
)[0] - (
s2
)[0]; \

1137 i‡(
l
 > 0 && 
__ªsu…
 == 0) \

1139 
__ªsu…
 = (
s1
)[1] - (
s2
)[1]; \

1140 i‡(
l
 > 1 && 
__ªsu…
 == 0) \

1142 
__ªsu…
 = (
s1
)[2] - (
s2
)[2]; \

1143 i‡(
l
 > 2 && 
__ªsu…
 == 0) \

1144 
__ªsu…
 = (
s1
)[3] - (
s2
)[3]; \

1147 
__ªsu…
; }))

	)

1149 
	#__°rcmp_cg
(
s1
, 
s2
, 
l1
) \

1150 (
	`__exãnsi⁄__
 ({ c⁄° *
__s2
 = (
s2
); \

1151 
__ªsu…
 = (
s1
)[0] - 
__s2
[0]; \

1152 i‡(
l1
 > 0 && 
__ªsu…
 == 0) \

1154 
__ªsu…
 = (
s1
)[1] - 
__s2
[1]; \

1155 i‡(
l1
 > 1 && 
__ªsu…
 == 0) \

1157 
__ªsu…
 = (
s1
)[2] - 
__s2
[2]; \

1158 i‡(
l1
 > 2 && 
__ªsu…
 == 0) \

1159 
__ªsu…
 = (
s1
)[3] - 
__s2
[3]; \

1162 
__ªsu…
; }))

	)

1164 
	#__°rcmp_gc
(
s1
, 
s2
, 
l2
) \

1165 (
	`__exãnsi⁄__
 ({ c⁄° *
__s1
 = (
s1
); \

1166 
__ªsu…
 = 
__s1
[0] - (
s2
)[0]; \

1167 i‡(
l2
 > 0 && 
__ªsu…
 == 0) \

1169 
__ªsu…
 = 
__s1
[1] - (
s2
)[1]; \

1170 i‡(
l2
 > 1 && 
__ªsu…
 == 0) \

1172 
__ªsu…
 = 
__s1
[2] - (
s2
)[2]; \

1173 i‡(
l2
 > 2 && 
__ªsu…
 == 0) \

1174 
__ªsu…
 = 
__s1
[3] - (
s2
)[3]; \

1177 
__ªsu…
; }))

	)

1179 
__STRING_INLINE
 
__°rcmp_gg
 (c⁄° *
__s1
, c⁄° *
__s2
);

1181 
__STRING_INLINE
 

1182 
	$__°rcmp_gg
 (c⁄° *
__s1
, c⁄° *
__s2
)

1184 
__ªs
;

1185 
__asm__
 
__vﬁ©ûe__


1201 : "=q" (
__ªs
), "=&r" (
__s1
), "=&r" (
__s2
)

1202 : "1" (
__s1
), "2" (
__s2
),

1203 "m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__s1
),

1204 "m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__s2
)

1206  
__ªs
;

1207 
	}
}

1211 
	#_HAVE_STRING_ARCH_°∫cmp
 1

	)

1212 
	#°∫cmp
(
s1
, 
s2
, 
n
) \

1213 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
s1
Ë&& 
	`°æí
 (s1Ë< ((
size_t
Ë(
n
)) \

1214 ? 
	`°rcmp
 ((
s1
), (
s2
)) \

1215 : (
	`__buûtö_c⁄°™t_p
 (
s2
Ë&& 
	`°æí
 (s2Ë< ((
size_t
Ë(
n
))\

1216 ? 
	`°rcmp
 ((
s1
), (
s2
)) \

1217 : 
	`__°∫cmp_g
 ((
s1
), (
s2
), (
n
)))))

	)

1219 
__STRING_INLINE
 
__°∫cmp_g
 (c⁄° *
__s1
, c⁄° *
__s2
,

1220 
size_t
 
__n
);

1222 
__STRING_INLINE
 

1223 
	$__°∫cmp_g
 (c⁄° *
__s1
, c⁄° *
__s2
, 
size_t
 
__n
)

1225 
__ªs
;

1226 
__asm__
 
__vﬁ©ûe__


1245 : "=q" (
__ªs
), "=&r" (
__s1
), "=&r" (
__s2
), "=&r" (
__n
)

1246 : "1" (
__s1
), "2" (
__s2
), "3" (
__n
),

1247 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__s1
),

1248 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__n
]; } *)
__s2
)

1250  
__ªs
;

1251 
	}
}

1255 
	#_HAVE_STRING_ARCH_°rchr
 1

	)

1256 
	#_USE_STRING_ARCH_°rchr
 1

	)

1257 
	#°rchr
(
s
, 
c
) \

1258 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
c
) \

1259 ? ((
c
) == '\0' \

1260 ? (*Ë
	`__øwmemchr
 ((
s
), (
c
)) \

1261 : 
	`__°rchr_c
 ((
s
), ((
c
) & 0xff) << 8)) \

1262 : 
	`__°rchr_g
 ((
s
), (
c
))))

	)

1264 
__STRING_INLINE
 *
__°rchr_c
 (c⁄° *
__s
, 
__c
);

1266 
__STRING_INLINE
 *

1267 
	$__°rchr_c
 (c⁄° *
__s
, 
__c
)

1269 
__d0
;

1270 *
__ªs
;

1271 
__asm__
 
__vﬁ©ûe__


1281 : "Ù" (
__ªs
), "=&a" (
__d0
)

1282 : "0" (
__s
), "1" (
__c
),

1283 "m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__s
)

1285  
__ªs
;

1286 
	}
}

1288 
__STRING_INLINE
 *
__°rchr_g
 (c⁄° *
__s
, 
__c
);

1290 
__STRING_INLINE
 *

1291 
	$__°rchr_g
 (c⁄° *
__s
, 
__c
)

1293 
__d0
;

1294 *
__ªs
;

1295 
__asm__
 
__vﬁ©ûe__


1306 : "Ù" (
__ªs
), "=&a" (
__d0
)

1307 : "0" (
__s
), "1" (
__c
),

1308 "m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__s
)

1310  
__ªs
;

1311 
	}
}

1315 
	#_HAVE_STRING_ARCH_°rch∫ul
 1

	)

1316 
	#__°rch∫ul
(
s
, 
c
) \

1317 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
c
) \

1318 ? ((
c
) == '\0' \

1319 ? (*Ë
	`__øwmemchr
 ((
s
), 
c
) \

1320 : 
	`__°rch∫ul_c
 ((
s
), ((
c
) & 0xff) << 8)) \

1321 : 
	`__°rch∫ul_g
 ((
s
), 
c
)))

	)

1323 
__STRING_INLINE
 *
__°rch∫ul_c
 (c⁄° *
__s
, 
__c
);

1325 
__STRING_INLINE
 *

1326 
	$__°rch∫ul_c
 (c⁄° *
__s
, 
__c
)

1328 
__d0
;

1329 *
__ªs
;

1330 
__asm__
 
__vﬁ©ûe__


1340 : "Ù" (
__ªs
), "=&a" (
__d0
)

1341 : "0" (
__s
), "1" (
__c
),

1342 "m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__s
)

1344  
__ªs
;

1345 
	}
}

1347 
__STRING_INLINE
 *
__°rch∫ul_g
 (c⁄° *
__s
, 
__c
);

1349 
__STRING_INLINE
 *

1350 
	$__°rch∫ul_g
 (c⁄° *
__s
, 
__c
)

1352 
__d0
;

1353 *
__ªs
;

1354 
__asm__
 
__vﬁ©ûe__


1365 : "Ù" (
__ªs
), "=&a" (
__d0
)

1366 : "0" (
__s
), "1" (
__c
),

1367 "m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__s
)

1369  
__ªs
;

1370 
	}
}

1371 #ifde‡
__USE_GNU


1372 
	#°rch∫ul
(
s
, 
c
Ë
	`__°rch∫ul
 ((s), (c))

	)

1376 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


1378 
	#_HAVE_STRING_ARCH_ödex
 1

	)

1379 
	#ödex
(
s
, 
c
) \

1380 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
c
) \

1381 ? 
	`__°rchr_c
 ((
s
), ((
c
) & 0xff) << 8) \

1382 : 
	`__°rchr_g
 ((
s
), (
c
))))

	)

1387 
	#_HAVE_STRING_ARCH_°ºchr
 1

	)

1388 
	#°ºchr
(
s
, 
c
) \

1389 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
c
) \

1390 ? 
	`__°ºchr_c
 ((
s
), ((
c
) & 0xff) << 8) \

1391 : 
	`__°ºchr_g
 ((
s
), (
c
))))

	)

1393 #ifde‡
__i686__


1394 
__STRING_INLINE
 *
__°ºchr_c
 (c⁄° *
__s
, 
__c
);

1396 
__STRING_INLINE
 *

1397 
	$__°ºchr_c
 (c⁄° *
__s
, 
__c
)

1399 
__d0
, 
__d1
;

1400 *
__ªs
;

1401 
__asm__
 
__vﬁ©ûe__


1409 : "=d" (
__ªs
), "=&S" (
__d0
), "=&a" (
__d1
)

1410 : "0" (1), "1" (
__s
), "2" (
__c
),

1411 "m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__s
)

1413  
__ªs
 - 1;

1414 
	}
}

1416 
__STRING_INLINE
 *
__°ºchr_g
 (c⁄° *
__s
, 
__c
);

1418 
__STRING_INLINE
 *

1419 
	$__°ºchr_g
 (c⁄° *
__s
, 
__c
)

1421 
__d0
, 
__d1
;

1422 *
__ªs
;

1423 
__asm__
 
__vﬁ©ûe__


1432 : "=d" (
__ªs
), "=&S" (
__d0
), "=&a" (
__d1
)

1433 : "0" (1), "1" (
__s
), "2" (
__c
),

1434 "m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__s
)

1436  
__ªs
 - 1;

1437 
	}
}

1439 
__STRING_INLINE
 *
__°ºchr_c
 (c⁄° *
__s
, 
__c
);

1441 
__STRING_INLINE
 *

1442 
	$__°ºchr_c
 (c⁄° *
__s
, 
__c
)

1444 
__d0
, 
__d1
;

1445 *
__ªs
;

1446 
__asm__
 
__vﬁ©ûe__


1456 : "=d" (
__ªs
), "=&S" (
__d0
), "=&a" (
__d1
)

1457 : "0" (0), "1" (
__s
), "2" (
__c
),

1458 "m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__s
)

1460  
__ªs
;

1461 
	}
}

1463 
__STRING_INLINE
 *
__°ºchr_g
 (c⁄° *
__s
, 
__c
);

1465 
__STRING_INLINE
 *

1466 
	$__°ºchr_g
 (c⁄° *
__s
, 
__c
)

1468 
__d0
, 
__d1
;

1469 *
__ªs
;

1470 
__asm__
 
__vﬁ©ûe__


1481 : "Ù" (
__ªs
), "=&S" (
__d0
), "=&a" (
__d1
)

1482 : "0" (0), "1" (
__s
), "2" (
__c
),

1483 "m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__s
)

1485  
__ªs
;

1486 
	}
}

1490 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


1492 
	#_HAVE_STRING_ARCH_rödex
 1

	)

1493 
	#rödex
(
s
, 
c
) \

1494 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
c
) \

1495 ? 
	`__°ºchr_c
 ((
s
), ((
c
) & 0xff) << 8) \

1496 : 
	`__°ºchr_g
 ((
s
), (
c
))))

	)

1502 
	#_HAVE_STRING_ARCH_°rc•n
 1

	)

1503 
	#°rc•n
(
s
, 
ªje˘
) \

1504 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
ªje˘
) &&  ((reject)[0]) == 1 \

1505 ? ((
ªje˘
)[0] == '\0' \

1506 ? 
	`°æí
 (
s
) \

1507 : ((
ªje˘
)[1] == '\0' \

1508 ? 
	`__°rc•n_c1
 ((
s
), (((
ªje˘
)[0] << 8) & 0xff00)) \

1509 : 
	`__°rc•n_cg
 ((
s
), (
ªje˘
), 
	`°æí
 (reject)))) \

1510 : 
	`__°rc•n_g
 ((
s
), (
ªje˘
))))

	)

1512 
__STRING_INLINE
 
size_t
 
__°rc•n_c1
 (c⁄° *
__s
, 
__ªje˘
);

1514 #i‚de‡
_FORCE_INLINES


1515 
__STRING_INLINE
 
size_t


1516 
	$__°rc•n_c1
 (c⁄° *
__s
, 
__ªje˘
)

1518 
__d0
;

1519 *
__ªs
;

1520 
__asm__
 
__vﬁ©ûe__


1529 : "Ù" (
__ªs
), "=&a" (
__d0
)

1530 : "0" (
__s
), "1" (
__ªje˘
),

1531 "m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__s
)

1533  (
__ªs
 - 1Ë- 
__s
;

1534 
	}
}

1537 
__STRING_INLINE
 
size_t
 
__°rc•n_cg
 (c⁄° *
__s
, c⁄° 
__ªje˘
[],

1538 
size_t
 
__ªje˘_Àn
);

1540 
__STRING_INLINE
 
size_t


1541 
	$__°rc•n_cg
 (c⁄° *
__s
, c⁄° 
__ªje˘
[], 
size_t
 
__ªje˘_Àn
)

1543 
__d0
, 
__d1
, 
__d2
;

1544 c⁄° *
__ªs
;

1545 
__asm__
 
__vﬁ©ûe__


1556 : "=S" (
__ªs
), "=&a" (
__d0
), "=&c" (
__d1
), "=&D" (
__d2
)

1557 : "0" (
__s
), "d" (
__ªje˘
), "g" (
__ªje˘_Àn
)

1559  (
__ªs
 - 1Ë- 
__s
;

1560 
	}
}

1562 
__STRING_INLINE
 
size_t
 
__°rc•n_g
 (c⁄° *
__s
, c⁄° *
__ªje˘
);

1563 #ifde‡
__PIC__


1565 
__STRING_INLINE
 
size_t


1566 
	$__°rc•n_g
 (c⁄° *
__s
, c⁄° *
__ªje˘
)

1568 
__d0
, 
__d1
, 
__d2
;

1569 c⁄° *
__ªs
;

1570 
__asm__
 
__vﬁ©ûe__


1587 : "=S" (
__ªs
), "=&a" (
__d0
), "=&c" (
__d1
), "=&D" (
__d2
)

1588 : "r" (
__ªje˘
), "0" (
__s
), "1" (0), "2" (0xffffffff)

1590  (
__ªs
 - 1Ë- 
__s
;

1591 
	}
}

1593 
__STRING_INLINE
 
size_t


1594 
	$__°rc•n_g
 (c⁄° *
__s
, c⁄° *
__ªje˘
)

1596 
__d0
, 
__d1
, 
__d2
, 
__d3
;

1597 c⁄° *
__ªs
;

1598 
__asm__
 
__vﬁ©ûe__


1612 : "=S" (
__ªs
), "=&a" (
__d0
), "=&c" (
__d1
), "=&D" (
__d2
), "=&d" (
__d3
)

1613 : "0" (
__s
), "1" (0), "2" (0xffffffff), "3" (
__ªje˘
), "b" (__reject)

1616  (
__ªs
 - 1Ë- 
__s
;

1617 
	}
}

1623 
	#_HAVE_STRING_ARCH_°r•n
 1

	)

1624 
	#°r•n
(
s
, 
ac˚±
) \

1625 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
ac˚±
) &&  ((accept)[0]) == 1 \

1626 ? ((
ac˚±
)[0] == '\0' \

1627 ? ((Ë(
s
), 0) \

1628 : ((
ac˚±
)[1] == '\0' \

1629 ? 
	`__°r•n_c1
 ((
s
), (((
ac˚±
)[0] << 8 ) & 0xff00)) \

1630 : 
	`__°r•n_cg
 ((
s
), (
ac˚±
), 
	`°æí
 (accept)))) \

1631 : 
	`__°r•n_g
 ((
s
), (
ac˚±
))))

	)

1633 #i‚de‡
_FORCE_INLINES


1634 
__STRING_INLINE
 
size_t
 
__°r•n_c1
 (c⁄° *
__s
, 
__ac˚±
);

1636 
__STRING_INLINE
 
size_t


1637 
	$__°r•n_c1
 (c⁄° *
__s
, 
__ac˚±
)

1639 
__d0
;

1640 *
__ªs
;

1642 
__asm__
 
__vﬁ©ûe__


1648 : "Ù" (
__ªs
), "=&q" (
__d0
)

1649 : "0" (
__s
), "1" (
__ac˚±
),

1650 "m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__s
)

1652  (
__ªs
 - 1Ë- 
__s
;

1653 
	}
}

1656 
__STRING_INLINE
 
size_t
 
__°r•n_cg
 (c⁄° *
__s
, c⁄° 
__ac˚±
[],

1657 
size_t
 
__ac˚±_Àn
);

1659 
__STRING_INLINE
 
size_t


1660 
	$__°r•n_cg
 (c⁄° *
__s
, c⁄° 
__ac˚±
[], 
size_t
 
__ac˚±_Àn
)

1662 
__d0
, 
__d1
, 
__d2
;

1663 c⁄° *
__ªs
;

1664 
__asm__
 
__vﬁ©ûe__


1675 : "=S" (
__ªs
), "=&a" (
__d0
), "=&c" (
__d1
), "=&D" (
__d2
)

1676 : "0" (
__s
), "g" (
__ac˚±
), "g" (
__ac˚±_Àn
),

1679 "m" ( *(°ru˘ { 
__x
[0xfffffff]; } *)
__s
),

1680 "m" ( *(°ru˘ { 
__exãnsi⁄__
 
__x
[
__ac˚±_Àn
]; } *)
__ac˚±
)

1682  (
__ªs
 - 1Ë- 
__s
;

1683 
	}
}

1685 
__STRING_INLINE
 
size_t
 
__°r•n_g
 (c⁄° *
__s
, c⁄° *
__ac˚±
);

1686 #ifde‡
__PIC__


1688 
__STRING_INLINE
 
size_t


1689 
	$__°r•n_g
 (c⁄° *
__s
, c⁄° *
__ac˚±
)

1691 
__d0
, 
__d1
, 
__d2
;

1692 c⁄° *
__ªs
;

1693 
__asm__
 
__vﬁ©ûe__


1709 : "=S" (
__ªs
), "=&a" (
__d0
), "=&c" (
__d1
), "=&D" (
__d2
)

1710 : "d" (
__ac˚±
), "0" (
__s
), "1" (0), "2" (0xffffffff), "3" (__accept)

1712  (
__ªs
 - 1Ë- 
__s
;

1713 
	}
}

1715 
__STRING_INLINE
 
size_t


1716 
	$__°r•n_g
 (c⁄° *
__s
, c⁄° *
__ac˚±
)

1718 
__d0
, 
__d1
, 
__d2
, 
__d3
;

1719 c⁄° *
__ªs
;

1720 
__asm__
 
__vﬁ©ûe__


1734 : "=S" (
__ªs
), "=&a" (
__d0
), "=&c" (
__d1
), "=&D" (
__d2
), "=&d" (
__d3
)

1735 : "0" (
__s
), "1" (0), "2" (0xffffffff), "3" (
__ac˚±
), "b" (__accept)

1737  (
__ªs
 - 1Ë- 
__s
;

1738 
	}
}

1743 
	#_HAVE_STRING_ARCH_°Ωbrk
 1

	)

1744 
	#°Ωbrk
(
s
, 
ac˚±
) \

1745 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
ac˚±
) &&  ((accept)[0]) == 1 \

1746 ? ((
ac˚±
)[0] == '\0' \

1747 ? ((Ë(
s
), (*) 0) \

1748 : ((
ac˚±
)[1] == '\0' \

1749 ? 
	`°rchr
 ((
s
), (
ac˚±
)[0]) \

1750 : 
	`__°Ωbrk_cg
 ((
s
), (
ac˚±
), 
	`°æí
 (accept)))) \

1751 : 
	`__°Ωbrk_g
 ((
s
), (
ac˚±
))))

	)

1753 
__STRING_INLINE
 *
__°Ωbrk_cg
 (c⁄° *
__s
, c⁄° 
__ac˚±
[],

1754 
size_t
 
__ac˚±_Àn
);

1756 
__STRING_INLINE
 *

1757 
	$__°Ωbrk_cg
 (c⁄° *
__s
, c⁄° 
__ac˚±
[], 
size_t
 
__ac˚±_Àn
)

1759 
__d0
, 
__d1
, 
__d2
;

1760 *
__ªs
;

1761 
__asm__
 
__vﬁ©ûe__


1776 : "=S" (
__ªs
), "=&a" (
__d0
), "=&c" (
__d1
), "=&D" (
__d2
)

1777 : "0" (
__s
), "d" (
__ac˚±
), "g" (
__ac˚±_Àn
)

1779  
__ªs
;

1780 
	}
}

1782 
__STRING_INLINE
 *
__°Ωbrk_g
 (c⁄° *
__s
, c⁄° *
__ac˚±
);

1783 #ifde‡
__PIC__


1785 
__STRING_INLINE
 *

1786 
	$__°Ωbrk_g
 (c⁄° *
__s
, c⁄° *
__ac˚±
)

1788 
__d0
, 
__d1
, 
__d2
;

1789 *
__ªs
;

1790 
__asm__
 
__vﬁ©ûe__


1811 : "=S" (
__ªs
), "=&a" (
__d0
), "=&c" (
__d1
), "=&D" (
__d2
)

1812 : "d" (
__ac˚±
), "0" (
__s
), "1" (0), "2" (0xffffffff)

1814  
__ªs
;

1815 
	}
}

1817 
__STRING_INLINE
 *

1818 
	$__°Ωbrk_g
 (c⁄° *
__s
, c⁄° *
__ac˚±
)

1820 
__d0
, 
__d1
, 
__d2
, 
__d3
;

1821 *
__ªs
;

1822 
__asm__
 
__vﬁ©ûe__


1841 : "=S" (
__ªs
), "=&a" (
__d0
), "=&c" (
__d1
), "=&d" (
__d2
), "=&D" (
__d3
)

1842 : "0" (
__s
), "1" (0), "2" (0xffffffff), "b" (
__ac˚±
)

1844  
__ªs
;

1845 
	}
}

1850 
	#_HAVE_STRING_ARCH_°r°r
 1

	)

1851 
	#°r°r
(
hay°ack
, 
√edÀ
) \

1852 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
√edÀ
) &&  ((needle)[0]) == 1 \

1853 ? ((
√edÀ
)[0] == '\0' \

1854 ? (
hay°ack
) \

1855 : ((
√edÀ
)[1] == '\0' \

1856 ? 
	`°rchr
 ((
hay°ack
), (
√edÀ
)[0]) \

1857 : 
	`__°r°r_cg
 ((
hay°ack
), (
√edÀ
), \

1858 
	`°æí
 (
√edÀ
)))) \

1859 : 
	`__°r°r_g
 ((
hay°ack
), (
√edÀ
))))

	)

1863 
__STRING_INLINE
 *
__°r°r_cg
 (c⁄° *
__hay°ack
,

1864 c⁄° 
__√edÀ
[],

1865 
size_t
 
__√edÀ_Àn
);

1867 
__STRING_INLINE
 *

1868 
	$__°r°r_cg
 (c⁄° *
__hay°ack
, c⁄° 
__√edÀ
[],

1869 
size_t
 
__√edÀ_Àn
)

1871 
__d0
, 
__d1
, 
__d2
;

1872 *
__ªs
;

1873 
__asm__
 
__vﬁ©ûe__


1886 : "=&a" (
__ªs
), "=&S" (
__d0
), "=&D" (
__d1
), "=&c" (
__d2
)

1887 : "g" (
__√edÀ_Àn
), "1" (
__hay°ack
), "d" (
__√edÀ
)

1889  
__ªs
;

1890 
	}
}

1892 
__STRING_INLINE
 *
__°r°r_g
 (c⁄° *
__hay°ack
,

1893 c⁄° *
__√edÀ
);

1894 #ifde‡
__PIC__


1896 
__STRING_INLINE
 *

1897 
	$__°r°r_g
 (c⁄° *
__hay°ack
, c⁄° *
__√edÀ
)

1899 
__d0
, 
__d1
, 
__d2
;

1900 *
__ªs
;

1901 
__asm__
 
__vﬁ©ûe__


1920 : "=&a" (
__ªs
), "=&c" (
__d0
), "=&S" (
__d1
), "=&D" (
__d2
)

1921 : "0" (0), "1" (0xffffffff), "2" (
__hay°ack
), "3" (
__√edÀ
),

1922 "d" (
__√edÀ
)

1924  
__ªs
;

1925 
	}
}

1927 
__STRING_INLINE
 *

1928 
	$__°r°r_g
 (c⁄° *
__hay°ack
, c⁄° *
__√edÀ
)

1930 
__d0
, 
__d1
, 
__d2
, 
__d3
;

1931 *
__ªs
;

1932 
__asm__
 
__vﬁ©ûe__


1949 : "=&a" (
__ªs
), "=&c" (
__d0
), "=&S" (
__d1
), "=&D" (
__d2
), "=&d" (
__d3
)

1950 : "0" (0), "1" (0xffffffff), "2" (
__hay°ack
), "3" (
__√edÀ
),

1951 "b" (
__√edÀ
)

1953  
__ªs
;

1954 
	}
}

1960 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


1961 #ifde‡
__i686__


1962 
	#_HAVE_STRING_ARCH_ffs
 1

	)

1963 
	#ffs
(
w‹d
Ë(
	`__buûtö_c⁄°™t_p
 (word) \

1964 ? 
	`__buûtö_ffs
 (
w‹d
) \

1965 : ({ 
__˙t
, 
__tmp
; \

1966 
__asm__
 
__vﬁ©ûe__
 \

1969 : "=&r" (
__˙t
), "Ù" (
__tmp
) \

1970 : "rm" (
w‹d
), "1" (-1)); \

1971 
__˙t
 + 1; }))

	)

1973 #i‚de‡
ff¶


1974 
	#ff¶
(
w‹d
Ë
	`ffs
(w‹d)

	)

1979 #i‚de‡
_FORCE_INLINES


1980 #unde‡
__STRING_INLINE


	@/usr/include/bits/string2.h

20 #i‚de‡
_STRING_H


24 #i‡!
deföed
 
__NO_STRING_INLINES
 && !deföed 
__BOUNDED_POINTERS__


41 #i‚de‡
__STRING_INLINE


42 #ifde‡
__˝lu•lus


43 
	#__STRING_INLINE
 
ölöe


	)

45 
	#__STRING_INLINE
 
__exã∫_ölöe


	)

49 #i‡
_STRING_ARCH_u«lig√d


51 
	~<ídün.h
>

52 
	~<bôs/ty≥s.h
>

54 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


55 
	#__STRING2_SMALL_GET16
(
§c
, 
idx
) \

56 (((c⁄° *Ë(c⁄° *Ë(
§c
))[
idx
 + 1] << 8 \

57 | ((c⁄° *Ë(c⁄° *Ë(
§c
))[
idx
])

	)

58 
	#__STRING2_SMALL_GET32
(
§c
, 
idx
) \

59 (((((c⁄° *Ë(c⁄° *Ë(
§c
))[
idx
 + 3] << 8 \

60 | ((c⁄° *Ë(c⁄° *Ë(
§c
))[
idx
 + 2]) << 8 \

61 | ((c⁄° *Ë(c⁄° *Ë(
§c
))[
idx
 + 1]) << 8 \

62 | ((c⁄° *Ë(c⁄° *Ë(
§c
))[
idx
])

	)

64 
	#__STRING2_SMALL_GET16
(
§c
, 
idx
) \

65 (((c⁄° *Ë(c⁄° *Ë(
§c
))[
idx
] << 8 \

66 | ((c⁄° *Ë(c⁄° *Ë(
§c
))[
idx
 + 1])

	)

67 
	#__STRING2_SMALL_GET32
(
§c
, 
idx
) \

68 (((((c⁄° *Ë(c⁄° *Ë(
§c
))[
idx
] << 8 \

69 | ((c⁄° *Ë(c⁄° *Ë(
§c
))[
idx
 + 1]) << 8 \

70 | ((c⁄° *Ë(c⁄° *Ë(
§c
))[
idx
 + 2]) << 8 \

71 | ((c⁄° *Ë(c⁄° *Ë(
§c
))[
idx
 + 3])

	)

76 
	#__STRING2_COPY_TYPE
(
N
) \

77 °ru˘ { 
__¨r
[
N
]; } \

78 
	t__©åibuã__
 ((
	t__∑cked__
)Ë
	t__STRING2_COPY_ARR
##
	tN


	)

79 
	t__STRING2_COPY_TYPE
 (2);

80 
__STRING2_COPY_TYPE
 (3);

81 
__STRING2_COPY_TYPE
 (4);

82 
__STRING2_COPY_TYPE
 (5);

83 
__STRING2_COPY_TYPE
 (6);

84 
__STRING2_COPY_TYPE
 (7);

85 
__STRING2_COPY_TYPE
 (8);

86 #unde‡
__STRING2_COPY_TYPE


92 
	#__°rög2_1b±r_p
(
__x
) \

93 ((
size_t
)(c⁄° *)((
__x
Ë+ 1Ë- (size_t)(c⁄° *)(__xË=1)

	)

96 #i‡!
deföed
 
_HAVE_STRING_ARCH_mem£t


97 #i‡!
__GNUC_PREREQ
 (3, 0)

98 #i‡
_STRING_ARCH_u«lig√d


99 
	#mem£t
(
s
, 
c
, 
n
) \

100 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
n
) && (n) <= 16 \

101 ? ((
n
) == 1 \

102 ? 
	`__mem£t_1
 (
s
, 
c
) \

103 : 
	`__mem£t_gc
 (
s
, 
c
, 
n
)) \

104 : (
	`__buûtö_c⁄°™t_p
 (
c
) && (c) == '\0' \

105 ? ({ *
__s
 = (
s
); 
	`__bzîo
 (__s, 
n
); __s; }) \

106 : 
	`mem£t
 (
s
, 
c
, 
n
))))

	)

108 
	#__mem£t_1
(
s
, 
c
Ë({ *
__s
 = (s); \

109 *((
__uöt8_t
 *Ë
__s
Ë(__uöt8_tË
c
; __s; })

	)

111 
	#__mem£t_gc
(
s
, 
c
, 
n
) \

112 ({ *
__s
 = (
s
); \

114 
__ui
; \

115 
__usi
; \

116 
__uc
; \

117 } *
__u
 = 
__s
; \

118 
__uöt8_t
 
__c
 = (__uöt8_tË(
c
); \

121 (Ë(
n
)) \

124 
__u
->
__ui
 = 
__c
 * 0x01010101; \

125 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

127 
__u
->
__ui
 = 
__c
 * 0x01010101; \

128 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

130 
__u
->
__ui
 = 
__c
 * 0x01010101; \

131 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

133 
__u
->
__usi
 = (Ë
__c
 * 0x0101; \

134 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2); \

135 
__u
->
__uc
 = (Ë
__c
; \

139 
__u
->
__ui
 = 
__c
 * 0x01010101; \

140 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

142 
__u
->
__ui
 = 
__c
 * 0x01010101; \

143 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

145 
__u
->
__ui
 = 
__c
 * 0x01010101; \

146 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

148 
__u
->
__usi
 = (Ë
__c
 * 0x0101; \

152 
__u
->
__ui
 = 
__c
 * 0x01010101; \

153 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

155 
__u
->
__ui
 = 
__c
 * 0x01010101; \

156 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

158 
__u
->
__ui
 = 
__c
 * 0x01010101; \

159 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

161 
__u
->
__uc
 = (Ë
__c
; \

165 
__u
->
__ui
 = 
__c
 * 0x01010101; \

166 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

168 
__u
->
__ui
 = 
__c
 * 0x01010101; \

169 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

171 
__u
->
__ui
 = 
__c
 * 0x01010101; \

172 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

174 
__u
->
__ui
 = 
__c
 * 0x01010101; \

179 
__s
; })

	)

181 
	#mem£t
(
s
, 
c
, 
n
) \

182 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
c
) && (c) == '\0' \

183 ? ({ *
__s
 = (
s
); 
	`__bzîo
 (__s, 
n
); __s; }) \

184 : 
	`mem£t
 (
s
, 
c
, 
n
)))

	)

193 #i‡
__GNUC_PREREQ
 (2, 91)

194 
	#__bzîo
(
s
, 
n
Ë
	`__buûtö_mem£t
 (s, '\0',Ç)

	)

202 #ifde‡
__USE_GNU


203 #i‡!
deföed
 
_HAVE_STRING_ARCH_memp˝y
 || deföed 
_FORCE_INLINES


204 #i‚de‡
_HAVE_STRING_ARCH_memp˝y


205 #i‡
__GNUC_PREREQ
 (3, 4)

206 
	#__memp˝y
(
de°
, 
§c
, 
n
Ë
	`__buûtö_memp˝y
 (de°, src,Ç)

	)

207 #ñi‡
__GNUC_PREREQ
 (3, 0)

208 
	#__memp˝y
(
de°
, 
§c
, 
n
) \

209 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
§c
Ë&& __buûtö_c⁄°™t_∞(
n
) \

210 && 
	`__°rög2_1b±r_p
 (
§c
Ë&& 
n
 <= 8 \

211 ? 
	`__buûtö_mem˝y
 (
de°
, 
§c
, 
n
) + (n) \

212 : 
	`__memp˝y
 (
de°
, 
§c
, 
n
)))

	)

214 
	#__memp˝y
(
de°
, 
§c
, 
n
) \

215 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
§c
Ë&& __buûtö_c⁄°™t_∞(
n
) \

216 && 
	`__°rög2_1b±r_p
 (
§c
Ë&& 
n
 <= 8 \

217 ? 
	`__memp˝y_smÆl
 (
de°
, 
	`__memp˝y_¨gs
 (
§c
), 
n
) \

218 : 
	`__memp˝y
 (
de°
, 
§c
, 
n
)))

	)

222 
	#memp˝y
(
de°
, 
§c
, 
n
Ë
	`__memp˝y
 (de°, src,Ç)

	)

225 #i‡!
__GNUC_PREREQ
 (3, 0Ë|| 
deföed
 
_FORCE_INLINES


226 #i‡
_STRING_ARCH_u«lig√d


227 #i‚de‡
_FORCE_INLINES


228 
	#__memp˝y_¨gs
(
§c
) \

229 ((c⁄° *Ë(
§c
))[0], ((const *) (src))[2], \

230 ((c⁄° *Ë(
§c
))[4], ((const *) (src))[6], \

231 
__exãnsi⁄__
 
	`__STRING2_SMALL_GET16
 (
§c
, 0), \

232 
__exãnsi⁄__
 
	`__STRING2_SMALL_GET16
 (
§c
, 4), \

233 
__exãnsi⁄__
 
	`__STRING2_SMALL_GET32
 (
§c
, 0), \

234 
__exãnsi⁄__
 
	`__STRING2_SMALL_GET32
 (
§c
, 4)

	)

236 
__STRING_INLINE
 *
__memp˝y_smÆl
 (*, , , , ,

237 
__uöt16_t
, __uöt16_t, 
__uöt32_t
,

238 
__uöt32_t
, 
size_t
);

239 
__STRING_INLINE
 *

240 
	$__memp˝y_smÆl
 (*
__de°1
,

241 
__§c0_1
, 
__§c2_1
, 
__§c4_1
, 
__§c6_1
,

242 
__uöt16_t
 
__§c0_2
, __uöt16_à
__§c4_2
,

243 
__uöt32_t
 
__§c0_4
, __uöt32_à
__§c4_4
,

244 
size_t
 
__§˛í
)

247 
__uöt32_t
 
__ui
;

248 
__uöt16_t
 
__usi
;

249 
__uc
;

250 
__c
;

251 } *
__u
 = 
__de°1
;

252 (Ë
__§˛í
)

255 
__u
->
__c
 = 
__§c0_1
;

256 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 1);

259 
__u
->
__usi
 = 
__§c0_2
;

260 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2);

263 
__u
->
__usi
 = 
__§c0_2
;

264 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2);

265 
__u
->
__c
 = 
__§c2_1
;

266 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 1);

269 
__u
->
__ui
 = 
__§c0_4
;

270 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

273 
__u
->
__ui
 = 
__§c0_4
;

274 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

275 
__u
->
__c
 = 
__§c4_1
;

276 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 1);

279 
__u
->
__ui
 = 
__§c0_4
;

280 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

281 
__u
->
__usi
 = 
__§c4_2
;

282 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2);

285 
__u
->
__ui
 = 
__§c0_4
;

286 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

287 
__u
->
__usi
 = 
__§c4_2
;

288 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2);

289 
__u
->
__c
 = 
__§c6_1
;

290 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 1);

293 
__u
->
__ui
 = 
__§c0_4
;

294 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

295 
__u
->
__ui
 = 
__§c4_4
;

296 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

299  (*Ë
__u
;

300 
	}
}

302 #i‚de‡
_FORCE_INLINES


303 
	#__memp˝y_¨gs
(
§c
) \

304 ((c⁄° *Ë(
§c
))[0], \

305 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR2
) \

306 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1] } }), \

307 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR3
) \

308 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1], \

309 ((c⁄° *Ë(
§c
))[2] } }), \

310 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR4
) \

311 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1], \

312 ((c⁄° *Ë(
§c
))[2], ((const *) (src))[3] } }), \

313 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR5
) \

314 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1], \

315 ((c⁄° *Ë(
§c
))[2], ((const *) (src))[3], \

316 ((c⁄° *Ë(
§c
))[4] } }), \

317 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR6
) \

318 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1], \

319 ((c⁄° *Ë(
§c
))[2], ((const *) (src))[3], \

320 ((c⁄° *Ë(
§c
))[4], ((const *) (src))[5] } }), \

321 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR7
) \

322 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1], \

323 ((c⁄° *Ë(
§c
))[2], ((const *) (src))[3], \

324 ((c⁄° *Ë(
§c
))[4], ((const *) (src))[5], \

325 ((c⁄° *Ë(
§c
))[6] } }), \

326 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR8
) \

327 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1], \

328 ((c⁄° *Ë(
§c
))[2], ((const *) (src))[3], \

329 ((c⁄° *Ë(
§c
))[4], ((const *) (src))[5], \

330 ((c⁄° *Ë(
§c
))[6], ((c⁄° *Ë(§c))[7] } })

	)

332 
__STRING_INLINE
 *
__memp˝y_smÆl
 (*, , 
__STRING2_COPY_ARR2
,

333 
__STRING2_COPY_ARR3
,

334 
__STRING2_COPY_ARR4
,

335 
__STRING2_COPY_ARR5
,

336 
__STRING2_COPY_ARR6
,

337 
__STRING2_COPY_ARR7
,

338 
__STRING2_COPY_ARR8
, 
size_t
);

339 
__STRING_INLINE
 *

340 
	$__memp˝y_smÆl
 (*
__de°
, 
__§c1
,

341 
__STRING2_COPY_ARR2
 
__§c2
, 
__STRING2_COPY_ARR3
 
__§c3
,

342 
__STRING2_COPY_ARR4
 
__§c4
, 
__STRING2_COPY_ARR5
 
__§c5
,

343 
__STRING2_COPY_ARR6
 
__§c6
, 
__STRING2_COPY_ARR7
 
__§c7
,

344 
__STRING2_COPY_ARR8
 
__§c8
, 
size_t
 
__§˛í
)

347 
__c
;

348 
__STRING2_COPY_ARR2
 
__sˇ2
;

349 
__STRING2_COPY_ARR3
 
__sˇ3
;

350 
__STRING2_COPY_ARR4
 
__sˇ4
;

351 
__STRING2_COPY_ARR5
 
__sˇ5
;

352 
__STRING2_COPY_ARR6
 
__sˇ6
;

353 
__STRING2_COPY_ARR7
 
__sˇ7
;

354 
__STRING2_COPY_ARR8
 
__sˇ8
;

355 } *
__u
 = 
__de°
;

356 (Ë
__§˛í
)

359 
__u
->
__c
 = 
__§c1
;

362 
__exãnsi⁄__
 
__u
->
__sˇ2
 = 
__§c2
;

365 
__exãnsi⁄__
 
__u
->
__sˇ3
 = 
__§c3
;

368 
__exãnsi⁄__
 
__u
->
__sˇ4
 = 
__§c4
;

371 
__exãnsi⁄__
 
__u
->
__sˇ5
 = 
__§c5
;

374 
__exãnsi⁄__
 
__u
->
__sˇ6
 = 
__§c6
;

377 
__exãnsi⁄__
 
__u
->
__sˇ7
 = 
__§c7
;

380 
__exãnsi⁄__
 
__u
->
__sˇ8
 = 
__§c8
;

383  
	`__exãnsi⁄__
 ((*Ë
__u
 + 
__§˛í
);

384 
	}
}

392 #i‚de‡
_HAVE_STRING_ARCH_°rchr


393 *
__øwmemchr
 (c⁄° *
__s
, 
__c
);

394 #i‡
__GNUC_PREREQ
 (3, 2)

395 
	#°rchr
(
s
, 
c
) \

396 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
c
Ë&& !__buûtö_c⁄°™t_∞(
s
) \

397 && (
c
) == '\0' \

398 ? (*Ë
	`__øwmemchr
 (
s
, 
c
) \

399 : 
	`__buûtö_°rchr
 (
s
, 
c
)))

	)

401 
	#°rchr
(
s
, 
c
) \

402 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
c
) && (c) == '\0' \

403 ? (*Ë
	`__øwmemchr
 (
s
, 
c
) \

404 : 
	`°rchr
 (
s
, 
c
)))

	)

410 #i‡(!
deföed
 
_HAVE_STRING_ARCH_°r˝y
 && !
__GNUC_PREREQ
 (3, 0)) \

411 || 
deföed
 
	g_FORCE_INLINES


412 #i‡!
deföed
 
_HAVE_STRING_ARCH_°r˝y
 && !
__GNUC_PREREQ
 (3, 0)

413 
	#°r˝y
(
de°
, 
§c
) \

414 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
§c
) \

415 ? (
	`__°rög2_1b±r_p
 (
§c
Ë&& 
	`°æí
 (src) + 1 <= 8 \

416 ? 
	`__°r˝y_smÆl
 (
de°
, 
	`__°r˝y_¨gs
 (
§c
), \

417 
	`°æí
 (
§c
) + 1) \

418 : (*Ë
	`mem˝y
 (
de°
, 
§c
, 
	`°æí
 (src) + 1)) \

419 : 
	`°r˝y
 (
de°
, 
§c
)))

	)

422 #i‡
_STRING_ARCH_u«lig√d


423 #i‚de‡
_FORCE_INLINES


424 
	#__°r˝y_¨gs
(
§c
) \

425 
__exãnsi⁄__
 
	`__STRING2_SMALL_GET16
 (
§c
, 0), \

426 
__exãnsi⁄__
 
	`__STRING2_SMALL_GET16
 (
§c
, 4), \

427 
__exãnsi⁄__
 
	`__STRING2_SMALL_GET32
 (
§c
, 0), \

428 
__exãnsi⁄__
 
	`__STRING2_SMALL_GET32
 (
§c
, 4)

	)

430 
__STRING_INLINE
 *
__°r˝y_smÆl
 (*, 
__uöt16_t
, __uint16_t,

431 
__uöt32_t
, __uöt32_t, 
size_t
);

432 
__STRING_INLINE
 *

433 
	$__°r˝y_smÆl
 (*
__de°
,

434 
__uöt16_t
 
__§c0_2
, __uöt16_à
__§c4_2
,

435 
__uöt32_t
 
__§c0_4
, __uöt32_à
__§c4_4
,

436 
size_t
 
__§˛í
)

439 
__uöt32_t
 
__ui
;

440 
__uöt16_t
 
__usi
;

441 
__uc
;

442 } *
__u
 = (*Ë
__de°
;

443 (Ë
__§˛í
)

446 
__u
->
__uc
 = '\0';

449 
__u
->
__usi
 = 
__§c0_2
;

452 
__u
->
__usi
 = 
__§c0_2
;

453 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2);

454 
__u
->
__uc
 = '\0';

457 
__u
->
__ui
 = 
__§c0_4
;

460 
__u
->
__ui
 = 
__§c0_4
;

461 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

462 
__u
->
__uc
 = '\0';

465 
__u
->
__ui
 = 
__§c0_4
;

466 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

467 
__u
->
__usi
 = 
__§c4_2
;

470 
__u
->
__ui
 = 
__§c0_4
;

471 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

472 
__u
->
__usi
 = 
__§c4_2
;

473 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2);

474 
__u
->
__uc
 = '\0';

477 
__u
->
__ui
 = 
__§c0_4
;

478 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

479 
__u
->
__ui
 = 
__§c4_4
;

482  
__de°
;

483 
	}
}

485 #i‚de‡
_FORCE_INLINES


486 
	#__°r˝y_¨gs
(
§c
) \

487 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR2
) \

488 { { ((c⁄° *Ë(
§c
))[0], '\0' } }), \

489 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR3
) \

490 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1], \

492 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR4
) \

493 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1], \

494 ((c⁄° *Ë(
§c
))[2], '\0' } }), \

495 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR5
) \

496 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1], \

497 ((c⁄° *Ë(
§c
))[2], ((const *) (src))[3], \

499 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR6
) \

500 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1], \

501 ((c⁄° *Ë(
§c
))[2], ((const *) (src))[3], \

502 ((c⁄° *Ë(
§c
))[4], '\0' } }), \

503 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR7
) \

504 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1], \

505 ((c⁄° *Ë(
§c
))[2], ((const *) (src))[3], \

506 ((c⁄° *Ë(
§c
))[4], ((const *) (src))[5], \

508 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR8
) \

509 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1], \

510 ((c⁄° *Ë(
§c
))[2], ((const *) (src))[3], \

511 ((c⁄° *Ë(
§c
))[4], ((const *) (src))[5], \

512 ((c⁄° *Ë(
§c
))[6], '\0' } })

	)

514 
__STRING_INLINE
 *
__°r˝y_smÆl
 (*, 
__STRING2_COPY_ARR2
,

515 
__STRING2_COPY_ARR3
,

516 
__STRING2_COPY_ARR4
,

517 
__STRING2_COPY_ARR5
,

518 
__STRING2_COPY_ARR6
,

519 
__STRING2_COPY_ARR7
,

520 
__STRING2_COPY_ARR8
, 
size_t
);

521 
__STRING_INLINE
 *

522 
	$__°r˝y_smÆl
 (*
__de°
,

523 
__STRING2_COPY_ARR2
 
__§c2
, 
__STRING2_COPY_ARR3
 
__§c3
,

524 
__STRING2_COPY_ARR4
 
__§c4
, 
__STRING2_COPY_ARR5
 
__§c5
,

525 
__STRING2_COPY_ARR6
 
__§c6
, 
__STRING2_COPY_ARR7
 
__§c7
,

526 
__STRING2_COPY_ARR8
 
__§c8
, 
size_t
 
__§˛í
)

529 
__c
;

530 
__STRING2_COPY_ARR2
 
__sˇ2
;

531 
__STRING2_COPY_ARR3
 
__sˇ3
;

532 
__STRING2_COPY_ARR4
 
__sˇ4
;

533 
__STRING2_COPY_ARR5
 
__sˇ5
;

534 
__STRING2_COPY_ARR6
 
__sˇ6
;

535 
__STRING2_COPY_ARR7
 
__sˇ7
;

536 
__STRING2_COPY_ARR8
 
__sˇ8
;

537 } *
__u
 = (*Ë
__de°
;

538 (Ë
__§˛í
)

541 
__u
->
__c
 = '\0';

544 
__exãnsi⁄__
 
__u
->
__sˇ2
 = 
__§c2
;

547 
__exãnsi⁄__
 
__u
->
__sˇ3
 = 
__§c3
;

550 
__exãnsi⁄__
 
__u
->
__sˇ4
 = 
__§c4
;

553 
__exãnsi⁄__
 
__u
->
__sˇ5
 = 
__§c5
;

556 
__exãnsi⁄__
 
__u
->
__sˇ6
 = 
__§c6
;

559 
__exãnsi⁄__
 
__u
->
__sˇ7
 = 
__§c7
;

562 
__exãnsi⁄__
 
__u
->
__sˇ8
 = 
__§c8
;

565  
__de°
;

566 
	}
}

572 #ifde‡
__USE_GNU


573 #i‡!
deföed
 
_HAVE_STRING_ARCH_°p˝y
 || deföed 
_FORCE_INLINES


574 #i‚de‡
_HAVE_STRING_ARCH_°p˝y


575 #i‡
__GNUC_PREREQ
 (3, 4)

576 
	#__°p˝y
(
de°
, 
§c
Ë
	`__buûtö_°p˝y
 (de°, src)

	)

577 #ñi‡
__GNUC_PREREQ
 (3, 0)

578 
	#__°p˝y
(
de°
, 
§c
) \

579 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
§c
) \

580 ? (
	`__°rög2_1b±r_p
 (
§c
Ë&& 
	`°æí
 (src) + 1 <= 8 \

581 ? 
	`__buûtö_°r˝y
 (
de°
, 
§c
Ë+ 
	`°æí
 (src) \

582 : ((*Ë(
__memp˝y
Ë(
de°
, 
§c
, 
	`°æí
 (src) + 1) \

584 : 
	`__°p˝y
 (
de°
, 
§c
)))

	)

586 
	#__°p˝y
(
de°
, 
§c
) \

587 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
§c
) \

588 ? (
	`__°rög2_1b±r_p
 (
§c
Ë&& 
	`°æí
 (src) + 1 <= 8 \

589 ? 
	`__°p˝y_smÆl
 (
de°
, 
	`__°p˝y_¨gs
 (
§c
), \

590 
	`°æí
 (
§c
) + 1) \

591 : ((*Ë(
__memp˝y
Ë(
de°
, 
§c
, 
	`°æí
 (src) + 1) \

593 : 
	`__°p˝y
 (
de°
, 
§c
)))

	)

597 
	#°p˝y
(
de°
, 
§c
Ë
	`__°p˝y
 (de°, src)

	)

600 #i‡!
__GNUC_PREREQ
 (3, 0Ë|| 
deföed
 
_FORCE_INLINES


601 #i‡
_STRING_ARCH_u«lig√d


602 #i‚de‡
_FORCE_INLINES


603 
	#__°p˝y_¨gs
(
§c
) \

604 
__exãnsi⁄__
 
	`__STRING2_SMALL_GET16
 (
§c
, 0), \

605 
__exãnsi⁄__
 
	`__STRING2_SMALL_GET16
 (
§c
, 4), \

606 
__exãnsi⁄__
 
	`__STRING2_SMALL_GET32
 (
§c
, 0), \

607 
__exãnsi⁄__
 
	`__STRING2_SMALL_GET32
 (
§c
, 4)

	)

609 
__STRING_INLINE
 *
__°p˝y_smÆl
 (*, 
__uöt16_t
, __uint16_t,

610 
__uöt32_t
, __uöt32_t, 
size_t
);

611 
__STRING_INLINE
 *

612 
	$__°p˝y_smÆl
 (*
__de°
,

613 
__uöt16_t
 
__§c0_2
, __uöt16_à
__§c4_2
,

614 
__uöt32_t
 
__§c0_4
, __uöt32_à
__§c4_4
,

615 
size_t
 
__§˛í
)

618 
__ui
;

619 
__usi
;

620 
__uc
;

621 
__c
;

622 } *
__u
 = (*Ë
__de°
;

623 (Ë
__§˛í
)

626 
__u
->
__uc
 = '\0';

629 
__u
->
__usi
 = 
__§c0_2
;

630 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 1);

633 
__u
->
__usi
 = 
__§c0_2
;

634 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2);

635 
__u
->
__uc
 = '\0';

638 
__u
->
__ui
 = 
__§c0_4
;

639 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 3);

642 
__u
->
__ui
 = 
__§c0_4
;

643 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

644 
__u
->
__uc
 = '\0';

647 
__u
->
__ui
 = 
__§c0_4
;

648 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

649 
__u
->
__usi
 = 
__§c4_2
;

650 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 1);

653 
__u
->
__ui
 = 
__§c0_4
;

654 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

655 
__u
->
__usi
 = 
__§c4_2
;

656 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2);

657 
__u
->
__uc
 = '\0';

660 
__u
->
__ui
 = 
__§c0_4
;

661 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

662 
__u
->
__ui
 = 
__§c4_4
;

663 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 3);

666  &
__u
->
__c
;

667 
	}
}

669 #i‚de‡
_FORCE_INLINES


670 
	#__°p˝y_¨gs
(
§c
) \

671 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR2
) \

672 { { ((c⁄° *Ë(
§c
))[0], '\0' } }), \

673 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR3
) \

674 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1], \

676 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR4
) \

677 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1], \

678 ((c⁄° *Ë(
§c
))[2], '\0' } }), \

679 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR5
) \

680 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1], \

681 ((c⁄° *Ë(
§c
))[2], ((const *) (src))[3], \

683 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR6
) \

684 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1], \

685 ((c⁄° *Ë(
§c
))[2], ((const *) (src))[3], \

686 ((c⁄° *Ë(
§c
))[4], '\0' } }), \

687 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR7
) \

688 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1], \

689 ((c⁄° *Ë(
§c
))[2], ((const *) (src))[3], \

690 ((c⁄° *Ë(
§c
))[4], ((const *) (src))[5], \

692 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR8
) \

693 { { ((c⁄° *Ë(
§c
))[0], ((const *) (src))[1], \

694 ((c⁄° *Ë(
§c
))[2], ((const *) (src))[3], \

695 ((c⁄° *Ë(
§c
))[4], ((const *) (src))[5], \

696 ((c⁄° *Ë(
§c
))[6], '\0' } })

	)

698 
__STRING_INLINE
 *
__°p˝y_smÆl
 (*, 
__STRING2_COPY_ARR2
,

699 
__STRING2_COPY_ARR3
,

700 
__STRING2_COPY_ARR4
,

701 
__STRING2_COPY_ARR5
,

702 
__STRING2_COPY_ARR6
,

703 
__STRING2_COPY_ARR7
,

704 
__STRING2_COPY_ARR8
, 
size_t
);

705 
__STRING_INLINE
 *

706 
	$__°p˝y_smÆl
 (*
__de°
,

707 
__STRING2_COPY_ARR2
 
__§c2
, 
__STRING2_COPY_ARR3
 
__§c3
,

708 
__STRING2_COPY_ARR4
 
__§c4
, 
__STRING2_COPY_ARR5
 
__§c5
,

709 
__STRING2_COPY_ARR6
 
__§c6
, 
__STRING2_COPY_ARR7
 
__§c7
,

710 
__STRING2_COPY_ARR8
 
__§c8
, 
size_t
 
__§˛í
)

713 
__c
;

714 
__STRING2_COPY_ARR2
 
__sˇ2
;

715 
__STRING2_COPY_ARR3
 
__sˇ3
;

716 
__STRING2_COPY_ARR4
 
__sˇ4
;

717 
__STRING2_COPY_ARR5
 
__sˇ5
;

718 
__STRING2_COPY_ARR6
 
__sˇ6
;

719 
__STRING2_COPY_ARR7
 
__sˇ7
;

720 
__STRING2_COPY_ARR8
 
__sˇ8
;

721 } *
__u
 = (*Ë
__de°
;

722 (Ë
__§˛í
)

725 
__u
->
__c
 = '\0';

728 
__exãnsi⁄__
 
__u
->
__sˇ2
 = 
__§c2
;

731 
__exãnsi⁄__
 
__u
->
__sˇ3
 = 
__§c3
;

734 
__exãnsi⁄__
 
__u
->
__sˇ4
 = 
__§c4
;

737 
__exãnsi⁄__
 
__u
->
__sˇ5
 = 
__§c5
;

740 
__exãnsi⁄__
 
__u
->
__sˇ6
 = 
__§c6
;

743 
__exãnsi⁄__
 
__u
->
__sˇ7
 = 
__§c7
;

746 
__exãnsi⁄__
 
__u
->
__sˇ8
 = 
__§c8
;

749  
__de°
 + 
__§˛í
 - 1;

750 
	}
}

758 #i‚de‡
_HAVE_STRING_ARCH_°∫˝y


759 #i‡
__GNUC_PREREQ
 (3, 2)

760 
	#°∫˝y
(
de°
, 
§c
, 
n
Ë
	`__buûtö_°∫˝y
 (de°, src,Ç)

	)

762 
	#°∫˝y
(
de°
, 
§c
, 
n
) \

763 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
§c
Ë&& __buûtö_c⁄°™t_∞(
n
) \

764 ? (
	`°æí
 (
§c
Ë+ 1 >((
size_t
Ë(
n
)) \

765 ? (*Ë
	`mem˝y
 (
de°
, 
§c
, 
n
) \

766 : 
	`°∫˝y
 (
de°
, 
§c
, 
n
)) \

767 : 
	`°∫˝y
 (
de°
, 
§c
, 
n
)))

	)

773 #i‚de‡
_HAVE_STRING_ARCH_°∫ˇt


774 #ifde‡
_USE_STRING_ARCH_°rchr


775 
	#°∫ˇt
(
de°
, 
§c
, 
n
) \

776 (
	`__exãnsi⁄__
 ({ *
__de°
 = (
de°
); \

777 
	`__buûtö_c⁄°™t_p
 (
§c
Ë&& __buûtö_c⁄°™t_∞(
n
) \

778 ? (
	`°æí
 (
§c
Ë< ((
size_t
Ë(
n
)) \

779 ? 
	`°rˇt
 (
__de°
, 
§c
) \

780 : (*((*Ë
	`__memp˝y
 (
	`°rchr
 (
__de°
, '\0'), \

781 
§c
, 
n
)Ë'\0', 
__de°
)) \

782 : 
	`°∫ˇt
 (
de°
, 
§c
, 
n
); }))

	)

783 #ñi‡
__GNUC_PREREQ
 (3, 2)

784 
	#°∫ˇt
(
de°
, 
§c
, 
n
Ë
	`__buûtö_°∫ˇt
 (de°, src,Ç)

	)

786 
	#°∫ˇt
(
de°
, 
§c
, 
n
) \

787 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
§c
Ë&& __buûtö_c⁄°™t_∞(
n
) \

788 ? (
	`°æí
 (
§c
Ë< ((
size_t
Ë(
n
)) \

789 ? 
	`°rˇt
 (
de°
, 
§c
) \

790 : 
	`°∫ˇt
 (
de°
, 
§c
, 
n
)) \

791 : 
	`°∫ˇt
 (
de°
, 
§c
, 
n
)))

	)

797 #i‚de‡
_HAVE_STRING_ARCH_°rcmp


798 #i‡
__GNUC_PREREQ
 (3, 2)

799 
	#°rcmp
(
s1
, 
s2
) \

800 
__exãnsi⁄__
 \

801 ({ 
size_t
 
__s1_Àn
, 
__s2_Àn
; \

802 (
	`__buûtö_c⁄°™t_p
 (
s1
Ë&& __buûtö_c⁄°™t_∞(
s2
) \

803 && (
__s1_Àn
 = 
	`°æí
 (
s1
), 
__s2_Àn
 = såÀ¿(
s2
), \

804 (!
	`__°rög2_1b±r_p
 (
s1
Ë|| 
__s1_Àn
 >= 4) \

805 && (!
	`__°rög2_1b±r_p
 (
s2
Ë|| 
__s2_Àn
 >= 4)) \

806 ? 
	`__buûtö_°rcmp
 (
s1
, 
s2
) \

807 : (
	`__buûtö_c⁄°™t_p
 (
s1
Ë&& 
	`__°rög2_1b±r_p
 (s1) \

808 && (
__s1_Àn
 = 
	`°æí
 (
s1
), __s1_len < 4) \

809 ? (
	`__buûtö_c⁄°™t_p
 (
s2
Ë&& 
	`__°rög2_1b±r_p
 (s2) \

810 ? 
	`__buûtö_°rcmp
 (
s1
, 
s2
) \

811 : 
	`__°rcmp_cg
 (
s1
, 
s2
, 
__s1_Àn
)) \

812 : (
	`__buûtö_c⁄°™t_p
 (
s2
Ë&& 
	`__°rög2_1b±r_p
 (s2) \

813 && (
__s2_Àn
 = 
	`°æí
 (
s2
), __s2_len < 4) \

814 ? (
	`__buûtö_c⁄°™t_p
 (
s1
Ë&& 
	`__°rög2_1b±r_p
 (s1) \

815 ? 
	`__buûtö_°rcmp
 (
s1
, 
s2
) \

816 : 
	`__°rcmp_gc
 (
s1
, 
s2
, 
__s2_Àn
)) \

817 : 
	`__buûtö_°rcmp
 (
s1
, 
s2
)))); })

	)

819 
	#°rcmp
(
s1
, 
s2
) \

820 
__exãnsi⁄__
 \

821 ({ 
size_t
 
__s1_Àn
, 
__s2_Àn
; \

822 (
	`__buûtö_c⁄°™t_p
 (
s1
Ë&& __buûtö_c⁄°™t_∞(
s2
) \

823 && (
__s1_Àn
 = 
	`°æí
 (
s1
), 
__s2_Àn
 = såÀ¿(
s2
), \

824 (!
	`__°rög2_1b±r_p
 (
s1
Ë|| 
__s1_Àn
 >= 4) \

825 && (!
	`__°rög2_1b±r_p
 (
s2
Ë|| 
__s2_Àn
 >= 4)) \

826 ? 
	`memcmp
 ((c⁄° *Ë(
s1
), (c⁄° *Ë(
s2
), \

827 (
__s1_Àn
 < 
__s2_Àn
 ? __s1_len : __s2_len) + 1) \

828 : (
	`__buûtö_c⁄°™t_p
 (
s1
Ë&& 
	`__°rög2_1b±r_p
 (s1) \

829 && (
__s1_Àn
 = 
	`°æí
 (
s1
), __s1_len < 4) \

830 ? (
	`__buûtö_c⁄°™t_p
 (
s2
Ë&& 
	`__°rög2_1b±r_p
 (s2) \

831 ? 
	`__°rcmp_cc
 (
s1
, 
s2
, 
__s1_Àn
) \

832 : 
	`__°rcmp_cg
 (
s1
, 
s2
, 
__s1_Àn
)) \

833 : (
	`__buûtö_c⁄°™t_p
 (
s2
Ë&& 
	`__°rög2_1b±r_p
 (s2) \

834 && (
__s2_Àn
 = 
	`°æí
 (
s2
), __s2_len < 4) \

835 ? (
	`__buûtö_c⁄°™t_p
 (
s1
Ë&& 
	`__°rög2_1b±r_p
 (s1) \

836 ? 
	`__°rcmp_cc
 (
s1
, 
s2
, 
__s2_Àn
) \

837 : 
	`__°rcmp_gc
 (
s1
, 
s2
, 
__s2_Àn
)) \

838 : 
	`°rcmp
 (
s1
, 
s2
)))); })

	)

841 
	#__°rcmp_cc
(
s1
, 
s2
, 
l
) \

842 (
	`__exãnsi⁄__
 ({ 
__ªsu…
 = \

843 (((c⁄° *Ë(c⁄° *Ë(
s1
))[0] \

844 - ((c⁄° *Ë(c⁄° *)(
s2
))[0]); \

845 i‡(
l
 > 0 && 
__ªsu…
 == 0) \

847 
__ªsu…
 = (((const *) \

848 (c⁄° *Ë(
s1
))[1] \

850 (c⁄° *Ë(
s2
))[1]); \

851 i‡(
l
 > 1 && 
__ªsu…
 == 0) \

853 
__ªsu…
 = \

855 (c⁄° *Ë(
s1
))[2] \

857 (c⁄° *Ë(
s2
))[2]); \

858 i‡(
l
 > 2 && 
__ªsu…
 == 0) \

859 
__ªsu…
 = \

861 (c⁄° *Ë(
s1
))[3] \

863 (c⁄° *Ë(
s2
))[3]); \

866 
__ªsu…
; }))

	)

868 
	#__°rcmp_cg
(
s1
, 
s2
, 
l1
) \

869 (
	`__exãnsi⁄__
 ({ c⁄° *
__s2
 = \

870 (c⁄° *Ë(c⁄° *Ë(
s2
); \

871 
__ªsu…
 = \

872 (((c⁄° *Ë(c⁄° *Ë(
s1
))[0] \

873 - 
__s2
[0]); \

874 i‡(
l1
 > 0 && 
__ªsu…
 == 0) \

876 
__ªsu…
 = (((const *) \

877 (c⁄° *Ë(
s1
))[1] - 
__s2
[1]); \

878 i‡(
l1
 > 1 && 
__ªsu…
 == 0) \

880 
__ªsu…
 = (((const *) \

881 (c⁄° *Ë(
s1
))[2] - 
__s2
[2]); \

882 i‡(
l1
 > 2 && 
__ªsu…
 == 0) \

883 
__ªsu…
 = (((const *) \

884 (c⁄° *Ë(
s1
))[3] \

885 - 
__s2
[3]); \

888 
__ªsu…
; }))

	)

890 
	#__°rcmp_gc
(
s1
, 
s2
, 
l2
) \

891 (
	`__exãnsi⁄__
 ({ c⁄° *
__s1
 = \

892 (c⁄° *Ë(c⁄° *Ë(
s1
); \

893 
__ªsu…
 = \

894 
__s1
[0] - ((const *) \

895 (c⁄° *Ë(
s2
))[0]; \

896 i‡(
l2
 > 0 && 
__ªsu…
 == 0) \

898 
__ªsu…
 = (
__s1
[1] \

900 (c⁄° *Ë(
s2
))[1]); \

901 i‡(
l2
 > 1 && 
__ªsu…
 == 0) \

903 
__ªsu…
 = \

904 (
__s1
[2] - ((const *) \

905 (c⁄° *Ë(
s2
))[2]); \

906 i‡(
l2
 > 2 && 
__ªsu…
 == 0) \

907 
__ªsu…
 = \

908 (
__s1
[3] \

910 (c⁄° *Ë(
s2
))[3]); \

913 
__ªsu…
; }))

	)

918 #i‚de‡
_HAVE_STRING_ARCH_°∫cmp


919 
	#°∫cmp
(
s1
, 
s2
, 
n
) \

920 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
n
) \

921 && ((
	`__buûtö_c⁄°™t_p
 (
s1
) \

922 && 
	`°æí
 (
s1
Ë< ((
size_t
Ë(
n
))) \

923 || (
	`__buûtö_c⁄°™t_p
 (
s2
) \

924 && 
	`°æí
 (
s2
Ë< ((
size_t
Ë(
n
)))) \

925 ? 
	`°rcmp
 (
s1
, 
s2
Ë: 
	`°∫cmp
 (s1, s2, 
n
)))

	)

931 #i‡!
deföed
 
_HAVE_STRING_ARCH_°rc•n
 || deföed 
_FORCE_INLINES


932 #i‚de‡
_HAVE_STRING_ARCH_°rc•n


933 #i‡
__GNUC_PREREQ
 (3, 2)

934 
	#°rc•n
(
s
, 
ªje˘
) \

935 
__exãnsi⁄__
 \

936 ({ 
__r0
, 
__r1
, 
__r2
; \

937 (
	`__buûtö_c⁄°™t_p
 (
ªje˘
Ë&& 
	`__°rög2_1b±r_p
 (reject) \

938 ? ((
	`__buûtö_c⁄°™t_p
 (
s
Ë&& 
	`__°rög2_1b±r_p
 (s)) \

939 ? 
	`__buûtö_°rc•n
 (
s
, 
ªje˘
) \

940 : ((
__r0
 = ((c⁄° *Ë(
ªje˘
))[0], __r0 == '\0') \

941 ? 
	`°æí
 (
s
) \

942 : ((
__r1
 = ((c⁄° *Ë(
ªje˘
))[1], __r1 == '\0') \

943 ? 
	`__°rc•n_c1
 (
s
, 
__r0
) \

944 : ((
__r2
 = ((c⁄° *Ë(
ªje˘
))[2], __r2 == '\0') \

945 ? 
	`__°rc•n_c2
 (
s
, 
__r0
, 
__r1
) \

946 : (((c⁄° *Ë(
ªje˘
))[3] == '\0' \

947 ? 
	`__°rc•n_c3
 (
s
, 
__r0
, 
__r1
, 
__r2
) \

948 : 
	`__buûtö_°rc•n
 (
s
, 
ªje˘
)))))) \

949 : 
	`__buûtö_°rc•n
 (
s
, 
ªje˘
)); })

	)

951 
	#°rc•n
(
s
, 
ªje˘
) \

952 
__exãnsi⁄__
 \

953 ({ 
__r0
, 
__r1
, 
__r2
; \

954 (
	`__buûtö_c⁄°™t_p
 (
ªje˘
Ë&& 
	`__°rög2_1b±r_p
 (reject) \

955 ? ((
__r0
 = ((c⁄° *Ë(
ªje˘
))[0], __r0 == '\0') \

956 ? 
	`°æí
 (
s
) \

957 : ((
__r1
 = ((c⁄° *Ë(
ªje˘
))[1], __r1 == '\0') \

958 ? 
	`__°rc•n_c1
 (
s
, 
__r0
) \

959 : ((
__r2
 = ((c⁄° *Ë(
ªje˘
))[2], __r2 == '\0') \

960 ? 
	`__°rc•n_c2
 (
s
, 
__r0
, 
__r1
) \

961 : (((c⁄° *Ë(
ªje˘
))[3] == '\0' \

962 ? 
	`__°rc•n_c3
 (
s
, 
__r0
, 
__r1
, 
__r2
) \

963 : 
	`°rc•n
 (
s
, 
ªje˘
))))) \

964 : 
	`°rc•n
 (
s
, 
ªje˘
)); })

	)

968 
__STRING_INLINE
 
size_t
 
__°rc•n_c1
 (c⁄° *
__s
, 
__ªje˘
);

969 
__STRING_INLINE
 
size_t


970 
	$__°rc•n_c1
 (c⁄° *
__s
, 
__ªje˘
)

972 
size_t
 
__ªsu…
 = 0;

973 
__s
[
__ªsu…
] !'\0' && __s[__ªsu…] !
__ªje˘
)

974 ++
__ªsu…
;

975  
__ªsu…
;

976 
	}
}

978 
__STRING_INLINE
 
size_t
 
__°rc•n_c2
 (c⁄° *
__s
, 
__ªje˘1
,

979 
__ªje˘2
);

980 
__STRING_INLINE
 
size_t


981 
	$__°rc•n_c2
 (c⁄° *
__s
, 
__ªje˘1
, 
__ªje˘2
)

983 
size_t
 
__ªsu…
 = 0;

984 
__s
[
__ªsu…
] !'\0' && __s[__ªsu…] !
__ªje˘1


985 && 
__s
[
__ªsu…
] !
__ªje˘2
)

986 ++
__ªsu…
;

987  
__ªsu…
;

988 
	}
}

990 
__STRING_INLINE
 
size_t
 
__°rc•n_c3
 (c⁄° *
__s
, 
__ªje˘1
,

991 
__ªje˘2
, 
__ªje˘3
);

992 
__STRING_INLINE
 
size_t


993 
	$__°rc•n_c3
 (c⁄° *
__s
, 
__ªje˘1
, 
__ªje˘2
,

994 
__ªje˘3
)

996 
size_t
 
__ªsu…
 = 0;

997 
__s
[
__ªsu…
] !'\0' && __s[__ªsu…] !
__ªje˘1


998 && 
__s
[
__ªsu…
] !
__ªje˘2
 && __s[__ªsu…] !
__ªje˘3
)

999 ++
__ªsu…
;

1000  
__ªsu…
;

1001 
	}
}

1007 #i‡!
deföed
 
_HAVE_STRING_ARCH_°r•n
 || deföed 
_FORCE_INLINES


1008 #i‚de‡
_HAVE_STRING_ARCH_°r•n


1009 #i‡
__GNUC_PREREQ
 (3, 2)

1010 
	#°r•n
(
s
, 
ac˚±
) \

1011 
__exãnsi⁄__
 \

1012 ({ 
__a0
, 
__a1
, 
__a2
; \

1013 (
	`__buûtö_c⁄°™t_p
 (
ac˚±
Ë&& 
	`__°rög2_1b±r_p
 (accept) \

1014 ? ((
	`__buûtö_c⁄°™t_p
 (
s
Ë&& 
	`__°rög2_1b±r_p
 (s)) \

1015 ? 
	`__buûtö_°r•n
 (
s
, 
ac˚±
) \

1016 : ((
__a0
 = ((c⁄° *Ë(
ac˚±
))[0], __a0 == '\0') \

1017 ? ((Ë(
s
), (
size_t
) 0) \

1018 : ((
__a1
 = ((c⁄° *Ë(
ac˚±
))[1], __a1 == '\0') \

1019 ? 
	`__°r•n_c1
 (
s
, 
__a0
) \

1020 : ((
__a2
 = ((c⁄° *Ë(
ac˚±
))[2], __a2 == '\0') \

1021 ? 
	`__°r•n_c2
 (
s
, 
__a0
, 
__a1
) \

1022 : (((c⁄° *Ë(
ac˚±
))[3] == '\0' \

1023 ? 
	`__°r•n_c3
 (
s
, 
__a0
, 
__a1
, 
__a2
) \

1024 : 
	`__buûtö_°r•n
 (
s
, 
ac˚±
)))))) \

1025 : 
	`__buûtö_°r•n
 (
s
, 
ac˚±
)); })

	)

1027 
	#°r•n
(
s
, 
ac˚±
) \

1028 
__exãnsi⁄__
 \

1029 ({ 
__a0
, 
__a1
, 
__a2
; \

1030 (
	`__buûtö_c⁄°™t_p
 (
ac˚±
Ë&& 
	`__°rög2_1b±r_p
 (accept) \

1031 ? ((
__a0
 = ((c⁄° *Ë(
ac˚±
))[0], __a0 == '\0') \

1032 ? ((Ë(
s
), (
size_t
) 0) \

1033 : ((
__a1
 = ((c⁄° *Ë(
ac˚±
))[1], __a1 == '\0') \

1034 ? 
	`__°r•n_c1
 (
s
, 
__a0
) \

1035 : ((
__a2
 = ((c⁄° *Ë(
ac˚±
))[2], __a2 == '\0') \

1036 ? 
	`__°r•n_c2
 (
s
, 
__a0
, 
__a1
) \

1037 : (((c⁄° *Ë(
ac˚±
))[3] == '\0' \

1038 ? 
	`__°r•n_c3
 (
s
, 
__a0
, 
__a1
, 
__a2
) \

1039 : 
	`°r•n
 (
s
, 
ac˚±
))))) \

1040 : 
	`°r•n
 (
s
, 
ac˚±
)); })

	)

1044 
__STRING_INLINE
 
size_t
 
__°r•n_c1
 (c⁄° *
__s
, 
__ac˚±
);

1045 
__STRING_INLINE
 
size_t


1046 
	$__°r•n_c1
 (c⁄° *
__s
, 
__ac˚±
)

1048 
size_t
 
__ªsu…
 = 0;

1050 
__s
[
__ªsu…
] =
__ac˚±
)

1051 ++
__ªsu…
;

1052  
__ªsu…
;

1053 
	}
}

1055 
__STRING_INLINE
 
size_t
 
__°r•n_c2
 (c⁄° *
__s
, 
__ac˚±1
,

1056 
__ac˚±2
);

1057 
__STRING_INLINE
 
size_t


1058 
	$__°r•n_c2
 (c⁄° *
__s
, 
__ac˚±1
, 
__ac˚±2
)

1060 
size_t
 
__ªsu…
 = 0;

1062 
__s
[
__ªsu…
] =
__ac˚±1
 || __s[__ªsu…] =
__ac˚±2
)

1063 ++
__ªsu…
;

1064  
__ªsu…
;

1065 
	}
}

1067 
__STRING_INLINE
 
size_t
 
__°r•n_c3
 (c⁄° *
__s
, 
__ac˚±1
,

1068 
__ac˚±2
, 
__ac˚±3
);

1069 
__STRING_INLINE
 
size_t


1070 
	$__°r•n_c3
 (c⁄° *
__s
, 
__ac˚±1
, 
__ac˚±2
, 
__ac˚±3
)

1072 
size_t
 
__ªsu…
 = 0;

1074 
__s
[
__ªsu…
] =
__ac˚±1
 || __s[__ªsu…] =
__ac˚±2


1075 || 
__s
[
__ªsu…
] =
__ac˚±3
)

1076 ++
__ªsu…
;

1077  
__ªsu…
;

1078 
	}
}

1083 #i‡!
deföed
 
_HAVE_STRING_ARCH_°Ωbrk
 || deföed 
_FORCE_INLINES


1084 #i‚de‡
_HAVE_STRING_ARCH_°Ωbrk


1085 #i‡
__GNUC_PREREQ
 (3, 2)

1086 
	#°Ωbrk
(
s
, 
ac˚±
) \

1087 
__exãnsi⁄__
 \

1088 ({ 
__a0
, 
__a1
, 
__a2
; \

1089 (
	`__buûtö_c⁄°™t_p
 (
ac˚±
Ë&& 
	`__°rög2_1b±r_p
 (accept) \

1090 ? ((
	`__buûtö_c⁄°™t_p
 (
s
Ë&& 
	`__°rög2_1b±r_p
 (s)) \

1091 ? 
	`__buûtö_°Ωbrk
 (
s
, 
ac˚±
) \

1092 : ((
__a0
 = ((c⁄° *Ë(
ac˚±
))[0], __a0 == '\0') \

1093 ? ((Ë(
s
), (*Ë
NULL
) \

1094 : ((
__a1
 = ((c⁄° *Ë(
ac˚±
))[1], __a1 == '\0') \

1095 ? 
	`__buûtö_°rchr
 (
s
, 
__a0
) \

1096 : ((
__a2
 = ((c⁄° *Ë(
ac˚±
))[2], __a2 == '\0') \

1097 ? 
	`__°Ωbrk_c2
 (
s
, 
__a0
, 
__a1
) \

1098 : (((c⁄° *Ë(
ac˚±
))[3] == '\0' \

1099 ? 
	`__°Ωbrk_c3
 (
s
, 
__a0
, 
__a1
, 
__a2
) \

1100 : 
	`__buûtö_°Ωbrk
 (
s
, 
ac˚±
)))))) \

1101 : 
	`__buûtö_°Ωbrk
 (
s
, 
ac˚±
)); })

	)

1103 
	#°Ωbrk
(
s
, 
ac˚±
) \

1104 
__exãnsi⁄__
 \

1105 ({ 
__a0
, 
__a1
, 
__a2
; \

1106 (
	`__buûtö_c⁄°™t_p
 (
ac˚±
Ë&& 
	`__°rög2_1b±r_p
 (accept) \

1107 ? ((
__a0
 = ((c⁄° *Ë(
ac˚±
))[0], __a0 == '\0') \

1108 ? ((Ë(
s
), (*Ë
NULL
) \

1109 : ((
__a1
 = ((c⁄° *Ë(
ac˚±
))[1], __a1 == '\0') \

1110 ? 
	`°rchr
 (
s
, 
__a0
) \

1111 : ((
__a2
 = ((c⁄° *Ë(
ac˚±
))[2], __a2 == '\0') \

1112 ? 
	`__°Ωbrk_c2
 (
s
, 
__a0
, 
__a1
) \

1113 : (((c⁄° *Ë(
ac˚±
))[3] == '\0' \

1114 ? 
	`__°Ωbrk_c3
 (
s
, 
__a0
, 
__a1
, 
__a2
) \

1115 : 
	`°Ωbrk
 (
s
, 
ac˚±
))))) \

1116 : 
	`°Ωbrk
 (
s
, 
ac˚±
)); })

	)

1120 
__STRING_INLINE
 *
__°Ωbrk_c2
 (c⁄° *
__s
, 
__ac˚±1
,

1121 
__ac˚±2
);

1122 
__STRING_INLINE
 *

1123 
	$__°Ωbrk_c2
 (c⁄° *
__s
, 
__ac˚±1
, 
__ac˚±2
)

1126 *
__s
 !'\0' && *__†!
__ac˚±1
 && *__†!
__ac˚±2
)

1127 ++
__s
;

1128  *
__s
 ='\0' ? 
NULL
 : (*Ë(
size_t
) __s;

1129 
	}
}

1131 
__STRING_INLINE
 *
__°Ωbrk_c3
 (c⁄° *
__s
, 
__ac˚±1
,

1132 
__ac˚±2
, 
__ac˚±3
);

1133 
__STRING_INLINE
 *

1134 
	$__°Ωbrk_c3
 (c⁄° *
__s
, 
__ac˚±1
, 
__ac˚±2
, 
__ac˚±3
)

1137 *
__s
 !'\0' && *__†!
__ac˚±1
 && *__†!
__ac˚±2


1138 && *
__s
 !
__ac˚±3
)

1139 ++
__s
;

1140  *
__s
 ='\0' ? 
NULL
 : (*Ë(
size_t
) __s;

1141 
	}
}

1147 #i‡!
deföed
 
_HAVE_STRING_ARCH_°r°r
 && !
__GNUC_PREREQ
 (2, 97)

1148 
	#°r°r
(
hay°ack
, 
√edÀ
) \

1149 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
√edÀ
Ë&& 
	`__°rög2_1b±r_p
 (needle) \

1150 ? (((c⁄° *Ë(
√edÀ
))[0] == '\0' \

1151 ? (*Ë(
size_t
Ë(
hay°ack
) \

1152 : (((c⁄° *Ë(
√edÀ
))[1] == '\0' \

1153 ? 
	`°rchr
 (
hay°ack
, \

1154 ((c⁄° *Ë(
√edÀ
))[0]) \

1155 : 
	`°r°r
 (
hay°ack
, 
√edÀ
))) \

1156 : 
	`°r°r
 (
hay°ack
, 
√edÀ
)))

	)

1160 #i‡!
deföed
 
_HAVE_STRING_ARCH_°πok_r
 || deföed 
_FORCE_INLINES


1161 #i‚de‡
_HAVE_STRING_ARCH_°πok_r


1162 
	#__°πok_r
(
s
, 
£p
, 
√xç
) \

1163 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
£p
Ë&& 
	`__°rög2_1b±r_p
 (sep) \

1164 && ((c⁄° *Ë(
£p
))[0] != '\0' \

1165 && ((c⁄° *Ë(
£p
))[1] == '\0' \

1166 ? 
	`__°πok_r_1c
 (
s
, ((c⁄° *Ë(
£p
))[0], 
√xç
) \

1167 : 
	`__°πok_r
 (
s
, 
£p
, 
√xç
)))

	)

1170 
__STRING_INLINE
 *
__°πok_r_1c
 (*
__s
, 
__£p
, **
__√xç
);

1171 
__STRING_INLINE
 *

1172 
	$__°πok_r_1c
 (*
__s
, 
__£p
, **
__√xç
)

1174 *
__ªsu…
;

1175 i‡(
__s
 =
NULL
)

1176 
__s
 = *
__√xç
;

1177 *
__s
 =
__£p
)

1178 ++
__s
;

1179 
__ªsu…
 = 
NULL
;

1180 i‡(*
__s
 != '\0')

1182 
__ªsu…
 = 
__s
++;

1183 *
__s
 != '\0')

1184 i‡(*
__s
++ =
__£p
)

1186 
__s
[-1] = '\0';

1190 *
__√xç
 = 
__s
;

1191  
__ªsu…
;

1192 
	}
}

1193 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


1194 
	#°πok_r
(
s
, 
£p
, 
√xç
Ë
	`__°πok_r
 (s, sï,Çexç)

	)

1199 #i‡!
deföed
 
_HAVE_STRING_ARCH_°r£p
 || deföed 
_FORCE_INLINES


1200 #i‚de‡
_HAVE_STRING_ARCH_°r£p


1202 *
__°r£p_g
 (**
__°rögp
, c⁄° *
__dñim
);

1203 
	#__°r£p
(
s
, 
ªje˘
) \

1204 
__exãnsi⁄__
 \

1205 ({ 
__r0
, 
__r1
, 
__r2
; \

1206 (
	`__buûtö_c⁄°™t_p
 (
ªje˘
Ë&& 
	`__°rög2_1b±r_p
 (reject) \

1207 && (
__r0
 = ((c⁄° *Ë(
ªje˘
))[0], \

1208 ((c⁄° *Ë(
ªje˘
))[0] != '\0') \

1209 ? ((
__r1
 = ((c⁄° *Ë(
ªje˘
))[1], \

1210 ((c⁄° *Ë(
ªje˘
))[1] == '\0') \

1211 ? 
	`__°r£p_1c
 (
s
, 
__r0
) \

1212 : ((
__r2
 = ((c⁄° *Ë(
ªje˘
))[2], __r2 == '\0') \

1213 ? 
	`__°r£p_2c
 (
s
, 
__r0
, 
__r1
) \

1214 : (((c⁄° *Ë(
ªje˘
))[3] == '\0' \

1215 ? 
	`__°r£p_3c
 (
s
, 
__r0
, 
__r1
, 
__r2
) \

1216 : 
	`__°r£p_g
 (
s
, 
ªje˘
)))) \

1217 : 
	`__°r£p_g
 (
s
, 
ªje˘
)); })

	)

1220 
__STRING_INLINE
 *
__°r£p_1c
 (**
__s
, 
__ªje˘
);

1221 
__STRING_INLINE
 *

1222 
	$__°r£p_1c
 (**
__s
, 
__ªje˘
)

1224 *
__ªtvÆ
 = *
__s
;

1225 i‡(
__ªtvÆ
 !
NULL
 && (*
__s
 = 
	`°rchr
 (__ªtvÆ, 
__ªje˘
)) != NULL)

1226 *(*
__s
)++ = '\0';

1227  
__ªtvÆ
;

1228 
	}
}

1230 
__STRING_INLINE
 *
__°r£p_2c
 (**
__s
, 
__ªje˘1
, 
__ªje˘2
);

1231 
__STRING_INLINE
 *

1232 
	$__°r£p_2c
 (**
__s
, 
__ªje˘1
, 
__ªje˘2
)

1234 *
__ªtvÆ
 = *
__s
;

1235 i‡(
__ªtvÆ
 !
NULL
)

1237 *
__˝
 = 
__ªtvÆ
;

1240 i‡(*
__˝
 == '\0')

1242 
__˝
 = 
NULL
;

1245 i‡(*
__˝
 =
__ªje˘1
 || *__˝ =
__ªje˘2
)

1247 *
__˝
++ = '\0';

1250 ++
__˝
;

1252 *
__s
 = 
__˝
;

1254  
__ªtvÆ
;

1255 
	}
}

1257 
__STRING_INLINE
 *
__°r£p_3c
 (**
__s
, 
__ªje˘1
, 
__ªje˘2
,

1258 
__ªje˘3
);

1259 
__STRING_INLINE
 *

1260 
	$__°r£p_3c
 (**
__s
, 
__ªje˘1
, 
__ªje˘2
, 
__ªje˘3
)

1262 *
__ªtvÆ
 = *
__s
;

1263 i‡(
__ªtvÆ
 !
NULL
)

1265 *
__˝
 = 
__ªtvÆ
;

1268 i‡(*
__˝
 == '\0')

1270 
__˝
 = 
NULL
;

1273 i‡(*
__˝
 =
__ªje˘1
 || *__˝ =
__ªje˘2
 || *__˝ =
__ªje˘3
)

1275 *
__˝
++ = '\0';

1278 ++
__˝
;

1280 *
__s
 = 
__˝
;

1282  
__ªtvÆ
;

1283 
	}
}

1284 #ifde‡
__USE_BSD


1285 
	#°r£p
(
s
, 
ªje˘
Ë
	`__°r£p
 (s,Ñeje˘)

	)

1292 #ifde‡
__USE_MISC


1294 #i‡!
deföed
 
_HAVE_STRING_ARCH_°rdup
 || !deföed 
_HAVE_STRING_ARCH_°∫dup


1295 
	#__√ed_mÆloc_™d_ˇŒoc


	)

1296 
	~<°dlib.h
>

1299 #i‚de‡
_HAVE_STRING_ARCH_°rdup


1301 *
	$__°rdup
 (c⁄° *
__°rög
Ë
__THROW
 
__©åibuã_mÆloc__
;

1302 
	#__°rdup
(
s
) \

1303 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
s
Ë&& 
	`__°rög2_1b±r_p
 (s) \

1304 ? (((c⁄° *Ë(
s
))[0] == '\0' \

1305 ? (*Ë
	`ˇŒoc
 ((
size_t
) 1, (size_t) 1) \

1306 : ({ 
size_t
 
__Àn
 = 
	`°æí
 (
s
) + 1; \

1307 *
__ªtvÆ
 = (*Ë
	`mÆloc
 (
__Àn
); \

1308 i‡(
__ªtvÆ
 !
NULL
) \

1309 
__ªtvÆ
 = (*Ë
	`mem˝y
 (__ªtvÆ, 
s
, 
__Àn
); \

1310 
__ªtvÆ
; 
	}
})) \

1311 : 
	`__°rdup
 (
s
)))

	)

1313 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


1314 
	#°rdup
(
s
Ë
	`__°rdup
 (s)

	)

1318 #i‚de‡
_HAVE_STRING_ARCH_°∫dup


1320 *
	$__°∫dup
 (c⁄° *
__°rög
, 
size_t
 
__n
)

1321 
__THROW
 
__©åibuã_mÆloc__
;

1322 
	#__°∫dup
(
s
, 
n
) \

1323 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
s
Ë&& 
	`__°rög2_1b±r_p
 (s) \

1324 ? (((c⁄° *Ë(
s
))[0] == '\0' \

1325 ? (*Ë
	`ˇŒoc
 ((
size_t
) 1, (size_t) 1) \

1326 : ({ 
size_t
 
__Àn
 = 
	`°æí
 (
s
) + 1; \

1327 
size_t
 
__n
 = (
n
); \

1328 *
__ªtvÆ
; \

1329 i‡(
__n
 < 
__Àn
) \

1330 
__Àn
 = 
__n
 + 1; \

1331 
__ªtvÆ
 = (*Ë
	`mÆloc
 (
__Àn
); \

1332 i‡(
__ªtvÆ
 !
NULL
) \

1334 
__ªtvÆ
[
__Àn
 - 1] = '\0'; \

1335 
__ªtvÆ
 = (*Ë
	`mem˝y
 (__ªtvÆ, 
s
, \

1336 
__Àn
 - 1); \

1338 
__ªtvÆ
; 
	}
})) \

1339 : 
	`__°∫dup
 (
s
, 
n
)))

	)

1341 #ifde‡
__USE_GNU


1342 
	#°∫dup
(
s
, 
n
Ë
	`__°∫dup
 (s,Ç)

	)

1348 #i‚de‡
_FORCE_INLINES


1349 #unde‡
__STRING_INLINE


	@/usr/include/bits/string3.h

18 #i‚de‡
_STRING_H


22 
__w¨nde˛
 (
__w¨n_mem£t_zîo_Àn
,

25 #i‚de‡
__˝lu•lus


29 #unde‡
mem˝y


30 #unde‡
memmove


31 #unde‡
mem£t


32 #unde‡
°rˇt


33 #unde‡
°r˝y


34 #unde‡
°∫ˇt


35 #unde‡
°∫˝y


36 #ifde‡
__USE_GNU


37 #unde‡
memp˝y


38 #unde‡
°p˝y


40 #ifde‡
__USE_BSD


41 #unde‡
bc›y


42 #unde‡
bzîo


47 
__f‹tify_fun˘i⁄
 *

48 
__NTH
 (
	$mem˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
,

49 
size_t
 
__Àn
))

51  
	`__buûtö___mem˝y_chk
 (
__de°
, 
__§c
, 
__Àn
, 
	`__bos0
 (__dest));

52 
	}
}

54 
__f‹tify_fun˘i⁄
 *

55 
__NTH
 (
	$memmove
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__Àn
))

57  
	`__buûtö___memmove_chk
 (
__de°
, 
__§c
, 
__Àn
, 
	`__bos0
 (__dest));

58 
	}
}

60 #ifde‡
__USE_GNU


61 
__f‹tify_fun˘i⁄
 *

62 
__NTH
 (
	$memp˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
,

63 
size_t
 
__Àn
))

65  
	`__buûtö___memp˝y_chk
 (
__de°
, 
__§c
, 
__Àn
, 
	`__bos0
 (__dest));

66 
	}
}

75 
__f‹tify_fun˘i⁄
 *

76 
__NTH
 (
	$mem£t
 (*
__de°
, 
__ch
, 
size_t
 
__Àn
))

78 i‡(
	`__buûtö_c⁄°™t_p
 (
__Àn
) && __len == 0

79 && (!
	`__buûtö_c⁄°™t_p
 (
__ch
) || __ch != 0))

81 
	`__w¨n_mem£t_zîo_Àn
 ();

82  
__de°
;

84  
	`__buûtö___mem£t_chk
 (
__de°
, 
__ch
, 
__Àn
, 
	`__bos0
 (__dest));

85 
	}
}

87 #ifde‡
__USE_BSD


88 
__f‹tify_fun˘i⁄
 

89 
__NTH
 (
	$bc›y
 (c⁄° *
__§c
, *
__de°
, 
size_t
 
__Àn
))

91 (Ë
	`__buûtö___memmove_chk
 (
__de°
, 
__§c
, 
__Àn
, 
	`__bos0
 (__dest));

92 
	}
}

94 
__f‹tify_fun˘i⁄
 

95 
__NTH
 (
	$bzîo
 (*
__de°
, 
size_t
 
__Àn
))

97 (Ë
	`__buûtö___mem£t_chk
 (
__de°
, '\0', 
__Àn
, 
	`__bos0
 (__dest));

98 
	}
}

101 
__f‹tify_fun˘i⁄
 *

102 
__NTH
 (
	$°r˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
))

104  
	`__buûtö___°r˝y_chk
 (
__de°
, 
__§c
, 
	`__bos
 (__dest));

105 
	}
}

107 #ifde‡
__USE_GNU


108 
__f‹tify_fun˘i⁄
 *

109 
__NTH
 (
	$°p˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
))

111  
	`__buûtö___°p˝y_chk
 (
__de°
, 
__§c
, 
	`__bos
 (__dest));

112 
	}
}

116 
__f‹tify_fun˘i⁄
 *

117 
__NTH
 (
	$°∫˝y
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
,

118 
size_t
 
__Àn
))

120  
	`__buûtö___°∫˝y_chk
 (
__de°
, 
__§c
, 
__Àn
, 
	`__bos
 (__dest));

121 
	}
}

124 *
	$__°≤˝y_chk
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__n
,

125 
size_t
 
__de°Àn
Ë
__THROW
;

126 *
	`__REDIRECT_NTH
 (
__°≤˝y_Æüs
, (*
__de°
, c⁄° *
__§c
,

127 
size_t
 
__n
), 
°≤˝y
);

129 
__f‹tify_fun˘i⁄
 *

130 
	`__NTH
 (
	$°≤˝y
 (*
__de°
, c⁄° *
__§c
, 
size_t
 
__n
))

132 i‡(
	`__bos
 (
__de°
Ë!(
size_t
) -1

133 && (!
	`__buûtö_c⁄°™t_p
 (
__n
Ë|| __¿<
	`__bos
 (
__de°
)))

134  
	`__°≤˝y_chk
 (
__de°
, 
__§c
, 
__n
, 
	`__bos
 (__dest));

135  
	`__°≤˝y_Æüs
 (
__de°
, 
__§c
, 
__n
);

136 
	}
}

139 
__f‹tify_fun˘i⁄
 *

140 
__NTH
 (
	$°rˇt
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
))

142  
	`__buûtö___°rˇt_chk
 (
__de°
, 
__§c
, 
	`__bos
 (__dest));

143 
	}
}

146 
__f‹tify_fun˘i⁄
 *

147 
__NTH
 (
	$°∫ˇt
 (*
__ª°ri˘
 
__de°
, c⁄° *__ª°ri˘ 
__§c
,

148 
size_t
 
__Àn
))

150  
	`__buûtö___°∫ˇt_chk
 (
__de°
, 
__§c
, 
__Àn
, 
	`__bos
 (__dest));

151 
	}
}

	@/usr/include/bits/wordsize.h

3 #i‡
deföed
 
__x86_64__
 && !deföed 
__ILP32__


4 
	#__WORDSIZE
 64

	)

6 
	#__WORDSIZE
 32

	)

9 #ifde‡
__x86_64__


10 
	#__WORDSIZE_TIME64_COMPAT32
 1

	)

12 
	#__SYSCALL_WORDSIZE
 64

	)

	@/usr/include/gnu/stubs-32.h

6 #ifde‡
_LIBC


7 #îr‹ 
Aµliˇti⁄s
 
may
 
nŸ
 
deföe
 
the
 
ma¸o
 
_LIBC


10 
	#__°ub_chÊags


	)

11 
	#__°ub_Áâach


	)

12 
	#__°ub_fchÊags


	)

13 
	#__°ub_fdëach


	)

14 
	#__°ub_gây


	)

15 
	#__°ub_lchmod


	)

16 
	#__°ub_ªvoke


	)

17 
	#__°ub_£éogö


	)

18 
	#__°ub_sigªtu∫


	)

19 
	#__°ub_s°k


	)

20 
	#__°ub_°ty


	)

	@/usr/include/gnu/stubs-64.h

6 #ifde‡
_LIBC


7 #îr‹ 
Aµliˇti⁄s
 
may
 
nŸ
 
deföe
 
the
 
ma¸o
 
_LIBC


10 
	#__°ub_bdÊush


	)

11 
	#__°ub_chÊags


	)

12 
	#__°ub_Áâach


	)

13 
	#__°ub_fchÊags


	)

14 
	#__°ub_fdëach


	)

15 
	#__°ub_gëmsg


	)

16 
	#__°ub_gây


	)

17 
	#__°ub_lchmod


	)

18 
	#__°ub_putmsg


	)

19 
	#__°ub_ªvoke


	)

20 
	#__°ub_£éogö


	)

21 
	#__°ub_sigªtu∫


	)

22 
	#__°ub_s°k


	)

23 
	#__°ub_°ty


	)

	@/usr/include/linux/stddef.h

	@/usr/include/xlocale.h

20 #i‚de‡
_XLOCALE_H


21 
	#_XLOCALE_H
 1

	)

27 
	s__loˇÀ_°ru˘


30 
__loˇÀ_d©a
 *
	m__loˇÀs
[13];

33 c⁄° *
	m__˘y≥_b
;

34 c⁄° *
	m__˘y≥_tﬁowî
;

35 c⁄° *
	m__˘y≥_touµî
;

38 c⁄° *
	m__«mes
[13];

39 } *
	t__loˇÀ_t
;

42 
__loˇÀ_t
 
	tloˇÀ_t
;

	@/usr/include/asm-generic/int-ll64.h

8 #i‚de‡
_ASM_GENERIC_INT_LL64_H


9 
	#_ASM_GENERIC_INT_LL64_H


	)

11 
	~<asm/bô•îl⁄g.h
>

13 #i‚de‡
__ASSEMBLY__


19 
__sig√d__
 
	t__s8
;

20 
	t__u8
;

22 
__sig√d__
 
	t__s16
;

23 
	t__u16
;

25 
__sig√d__
 
	t__s32
;

26 
	t__u32
;

28 #ifde‡
__GNUC__


29 
__exãnsi⁄__
 
__sig√d__
 
	t__s64
;

30 
__exãnsi⁄__
 
	t__u64
;

32 
__sig√d__
 
	t__s64
;

33 
	t__u64
;

	@/usr/include/asm-generic/mman-common.h

1 #i‚de‡
__ASM_GENERIC_MMAN_COMMON_H


2 
	#__ASM_GENERIC_MMAN_COMMON_H


	)

9 
	#PROT_READ
 0x1

	)

10 
	#PROT_WRITE
 0x2

	)

11 
	#PROT_EXEC
 0x4

	)

12 
	#PROT_SEM
 0x8

	)

13 
	#PROT_NONE
 0x0

	)

14 
	#PROT_GROWSDOWN
 0x01000000

	)

15 
	#PROT_GROWSUP
 0x02000000

	)

17 
	#MAP_SHARED
 0x01

	)

18 
	#MAP_PRIVATE
 0x02

	)

19 
	#MAP_TYPE
 0x0‡

	)

20 
	#MAP_FIXED
 0x10

	)

21 
	#MAP_ANONYMOUS
 0x20

	)

22 #ifde‡
CONFIG_MMAP_ALLOW_UNINITIALIZED


23 
	#MAP_UNINITIALIZED
 0x4000000

	)

25 
	#MAP_UNINITIALIZED
 0x0

	)

28 
	#MS_ASYNC
 1

	)

29 
	#MS_INVALIDATE
 2

	)

30 
	#MS_SYNC
 4

	)

32 
	#MADV_NORMAL
 0

	)

33 
	#MADV_RANDOM
 1

	)

34 
	#MADV_SEQUENTIAL
 2

	)

35 
	#MADV_WILLNEED
 3

	)

36 
	#MADV_DONTNEED
 4

	)

39 
	#MADV_REMOVE
 9

	)

40 
	#MADV_DONTFORK
 10

	)

41 
	#MADV_DOFORK
 11

	)

42 
	#MADV_HWPOISON
 100

	)

43 
	#MADV_SOFT_OFFLINE
 101

	)

45 
	#MADV_MERGEABLE
 12

	)

46 
	#MADV_UNMERGEABLE
 13

	)

48 
	#MADV_HUGEPAGE
 14

	)

49 
	#MADV_NOHUGEPAGE
 15

	)

51 
	#MADV_DONTDUMP
 16

	)

53 
	#MADV_DODUMP
 17

	)

56 
	#MAP_FILE
 0

	)

66 
	#MAP_HUGE_SHIFT
 26

	)

67 
	#MAP_HUGE_MASK
 0x3f

	)

	@/usr/include/asm/posix_types_32.h

1 #i‚de‡
_ASM_X86_POSIX_TYPES_32_H


2 
	#_ASM_X86_POSIX_TYPES_32_H


	)

10 
	t__kî√l_mode_t
;

11 
	#__kî√l_mode_t
 
__kî√l_mode_t


	)

13 
	t__kî√l_ùc_pid_t
;

14 
	#__kî√l_ùc_pid_t
 
__kî√l_ùc_pid_t


	)

16 
	t__kî√l_uid_t
;

17 
	t__kî√l_gid_t
;

18 
	#__kî√l_uid_t
 
__kî√l_uid_t


	)

20 
	t__kî√l_ﬁd_dev_t
;

21 
	#__kî√l_ﬁd_dev_t
 
__kî√l_ﬁd_dev_t


	)

23 
	~<asm-gíîic/posix_ty≥s.h
>

	@/usr/include/asm/posix_types_64.h

1 #i‚de‡
_ASM_X86_POSIX_TYPES_64_H


2 
	#_ASM_X86_POSIX_TYPES_64_H


	)

10 
	t__kî√l_ﬁd_uid_t
;

11 
	t__kî√l_ﬁd_gid_t
;

12 
	#__kî√l_ﬁd_uid_t
 
__kî√l_ﬁd_uid_t


	)

14 
	t__kî√l_ﬁd_dev_t
;

15 
	#__kî√l_ﬁd_dev_t
 
__kî√l_ﬁd_dev_t


	)

17 
	~<asm-gíîic/posix_ty≥s.h
>

	@/usr/include/asm/posix_types_x32.h

1 #i‚de‡
_ASM_X86_POSIX_TYPES_X32_H


2 
	#_ASM_X86_POSIX_TYPES_X32_H


	)

13 
	t__kî√l_l⁄g_t
;

14 
	t__kî√l_ul⁄g_t
;

15 
	#__kî√l_l⁄g_t
 
__kî√l_l⁄g_t


	)

17 
	~<asm/posix_ty≥s_64.h
>

	@/usr/include/bits/types.h

23 #i‚def 
_BITS_TYPES_H


24 
	#_BITS_TYPES_H
 1

	)

26 
	~<„©uªs.h
>

27 
	~<bôs/w‹dsize.h
>

30 
	t__u_ch¨
;

31 
	t__u_sh‹t
;

32 
	t__u_öt
;

33 
	t__u_l⁄g
;

36 sig√d 
	t__öt8_t
;

37 
	t__uöt8_t
;

38 sig√d 
	t__öt16_t
;

39 
	t__uöt16_t
;

40 sig√d 
	t__öt32_t
;

41 
	t__uöt32_t
;

42 #i‡
__WORDSIZE
 == 64

43 sig√d 
	t__öt64_t
;

44 
	t__uöt64_t
;

45 #ñi‡
deföed
 
__GLIBC_HAVE_LONG_LONG


46 
__exãnsi⁄__
 sig√d 
	t__öt64_t
;

47 
__exãnsi⁄__
 
	t__uöt64_t
;

51 #i‡
__WORDSIZE
 == 64

52 
	t__quad_t
;

53 
	t__u_quad_t
;

54 #ñi‡
deföed
 
__GLIBC_HAVE_LONG_LONG


55 
__exãnsi⁄__
 
	t__quad_t
;

56 
__exãnsi⁄__
 
	t__u_quad_t
;

60 
	m__vÆ
[2];

61 } 
	t__quad_t
;

64 
__u_l⁄g
 
	m__vÆ
[2];

65 } 
	t__u_quad_t
;

98 
	#__S16_TYPE
 

	)

99 
	#__U16_TYPE
 

	)

100 
	#__S32_TYPE
 

	)

101 
	#__U32_TYPE
 

	)

102 
	#__SLONGWORD_TYPE
 

	)

103 
	#__ULONGWORD_TYPE
 

	)

104 #i‡
__WORDSIZE
 == 32

105 
	#__SQUAD_TYPE
 
__quad_t


	)

106 
	#__UQUAD_TYPE
 
__u_quad_t


	)

107 
	#__SWORD_TYPE
 

	)

108 
	#__UWORD_TYPE
 

	)

109 
	#__SLONG32_TYPE
 

	)

110 
	#__ULONG32_TYPE
 

	)

111 
	#__S64_TYPE
 
__quad_t


	)

112 
	#__U64_TYPE
 
__u_quad_t


	)

115 
	#__STD_TYPE
 
__exãnsi⁄__
 

	)

116 #ñi‡
__WORDSIZE
 == 64

117 
	t__SQUAD_TYPE
 

	)

118 
	t__UQUAD_TYPE
 

	)

119 
	t__SWORD_TYPE
 

	)

120 
	t__UWORD_TYPE
 

	)

121 
	t__SLONG32_TYPE
 

	)

122 
	t__ULONG32_TYPE
 

	)

123 
	t__S64_TYPE
 

	)

124 
	t__U64_TYPE
 

	)

126 
	t__STD_TYPE
 

	)

130 
	~<bôs/ty≥sizes.h
>

133 
__STD_TYPE
 
	t__DEV_T_TYPE
 
	t__dev_t
;

134 
__STD_TYPE
 
__UID_T_TYPE
 
	g__uid_t
;

135 
__STD_TYPE
 
__GID_T_TYPE
 
	g__gid_t
;

136 
__STD_TYPE
 
__INO_T_TYPE
 
	g__öo_t
;

137 
__STD_TYPE
 
__INO64_T_TYPE
 
	g__öo64_t
;

138 
__STD_TYPE
 
__MODE_T_TYPE
 
	g__mode_t
;

139 
__STD_TYPE
 
__NLINK_T_TYPE
 
	g__∆ök_t
;

140 
__STD_TYPE
 
__OFF_T_TYPE
 
	g__off_t
;

141 
__STD_TYPE
 
__OFF64_T_TYPE
 
	g__off64_t
;

142 
__STD_TYPE
 
__PID_T_TYPE
 
	g__pid_t
;

143 
__STD_TYPE
 
__FSID_T_TYPE
 
	g__fsid_t
;

144 
__STD_TYPE
 
__CLOCK_T_TYPE
 
	g__˛ock_t
;

145 
__STD_TYPE
 
__RLIM_T_TYPE
 
	g__æim_t
;

146 
__STD_TYPE
 
__RLIM64_T_TYPE
 
	g__æim64_t
;

147 
__STD_TYPE
 
__ID_T_TYPE
 
	g__id_t
;

148 
__STD_TYPE
 
__TIME_T_TYPE
 
	g__time_t
;

149 
__STD_TYPE
 
__USECONDS_T_TYPE
 
	g__u£c⁄ds_t
;

150 
__STD_TYPE
 
__SUSECONDS_T_TYPE
 
	g__su£c⁄ds_t
;

152 
__STD_TYPE
 
__DADDR_T_TYPE
 
	g__daddr_t
;

153 
__STD_TYPE
 
__KEY_T_TYPE
 
	g__key_t
;

156 
__STD_TYPE
 
__CLOCKID_T_TYPE
 
	g__˛ockid_t
;

159 
__STD_TYPE
 
__TIMER_T_TYPE
 
	g__timî_t
;

162 
__STD_TYPE
 
__BLKSIZE_T_TYPE
 
	g__blksize_t
;

167 
__STD_TYPE
 
__BLKCNT_T_TYPE
 
	g__blk˙t_t
;

168 
__STD_TYPE
 
__BLKCNT64_T_TYPE
 
	g__blk˙t64_t
;

171 
__STD_TYPE
 
__FSBLKCNT_T_TYPE
 
	g__fsblk˙t_t
;

172 
__STD_TYPE
 
__FSBLKCNT64_T_TYPE
 
	g__fsblk˙t64_t
;

175 
__STD_TYPE
 
__FSFILCNT_T_TYPE
 
	g__fsfû˙t_t
;

176 
__STD_TYPE
 
__FSFILCNT64_T_TYPE
 
	g__fsfû˙t64_t
;

179 
__STD_TYPE
 
__FSWORD_T_TYPE
 
	g__fsw‹d_t
;

181 
__STD_TYPE
 
__SSIZE_T_TYPE
 
	g__ssize_t
;

184 
__STD_TYPE
 
__SYSCALL_SLONG_TYPE
 
	g__sysˇŒ_¶⁄g_t
;

186 
__STD_TYPE
 
__SYSCALL_ULONG_TYPE
 
	g__sysˇŒ_ul⁄g_t
;

190 
__off64_t
 
	t__loff_t
;

191 
__quad_t
 *
	t__qaddr_t
;

192 *
	t__ˇddr_t
;

195 
__STD_TYPE
 
__SWORD_TYPE
 
	g__öçå_t
;

198 
__STD_TYPE
 
__U32_TYPE
 
	g__sockÀn_t
;

201 #unde‡
__STD_TYPE


	@/usr/include/endian.h

18 #i‚def 
_ENDIAN_H


19 
	#_ENDIAN_H
 1

	)

21 
	~<„©uªs.h
>

31 
	#__LITTLE_ENDIAN
 1234

	)

32 
	#__BIG_ENDIAN
 4321

	)

33 
	#__PDP_ENDIAN
 3412

	)

36 
	~<bôs/ídün.h
>

40 #i‚de‡
__FLOAT_WORD_ORDER


41 
	#__FLOAT_WORD_ORDER
 
__BYTE_ORDER


	)

44 #ifdef 
__USE_BSD


45 
	#LITTLE_ENDIAN
 
__LITTLE_ENDIAN


	)

46 
	#BIG_ENDIAN
 
__BIG_ENDIAN


	)

47 
	#PDP_ENDIAN
 
__PDP_ENDIAN


	)

48 
	#BYTE_ORDER
 
__BYTE_ORDER


	)

51 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


52 
	#__LONG_LONG_PAIR
(
HI
, 
LO
ËLO, 
	)
HI

53 #ñi‡
__BYTE_ORDER
 =
__BIG_ENDIAN


54 
	#__LONG_LONG_PAIR
(
HI
, 
LO
ËHI, 
	)
LO

58 #i‡
deföed
 
__USE_BSD
 && !deföed 
__ASSEMBLER__


60 
	~<bôs/byãsw≠.h
>

62 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


63 
	#htobe16
(
x
Ë
	`__bsw≠_16
 (x)

	)

64 
	#htﬁe16
(
x
Ë(x)

	)

65 
	#be16toh
(
x
Ë
	`__bsw≠_16
 (x)

	)

66 
	#À16toh
(
x
Ë(x)

	)

68 
	#htobe32
(
x
Ë
	`__bsw≠_32
 (x)

	)

69 
	#htﬁe32
(
x
Ë(x)

	)

70 
	#be32toh
(
x
Ë
	`__bsw≠_32
 (x)

	)

71 
	#À32toh
(
x
Ë(x)

	)

73 #i‡
__GLIBC_HAVE_LONG_LONG


74 
	#htobe64
(
x
Ë
	`__bsw≠_64
 (x)

	)

75 
	#htﬁe64
(
x
Ë(x)

	)

76 
	#be64toh
(
x
Ë
	`__bsw≠_64
 (x)

	)

77 
	#À64toh
(
x
Ë(x)

	)

81 
	#htobe16
(
x
Ë(x)

	)

82 
	#htﬁe16
(
x
Ë
	`__bsw≠_16
 (x)

	)

83 
	#be16toh
(
x
Ë(x)

	)

84 
	#À16toh
(
x
Ë
	`__bsw≠_16
 (x)

	)

86 
	#htobe32
(
x
Ë(x)

	)

87 
	#htﬁe32
(
x
Ë
	`__bsw≠_32
 (x)

	)

88 
	#be32toh
(
x
Ë(x)

	)

89 
	#À32toh
(
x
Ë
	`__bsw≠_32
 (x)

	)

91 #i‡
__GLIBC_HAVE_LONG_LONG


92 
	#htobe64
(
x
Ë(x)

	)

93 
	#htﬁe64
(
x
Ë
	`__bsw≠_64
 (x)

	)

94 
	#be64toh
(
x
Ë(x)

	)

95 
	#À64toh
(
x
Ë
	`__bsw≠_64
 (x)

	)

	@/usr/include/stdlib.h

22 #i‚def 
_STDLIB_H


24 
	~<„©uªs.h
>

27 
	#__√ed_size_t


	)

28 #i‚de‡
__√ed_mÆloc_™d_ˇŒoc


29 
	#__√ed_wch¨_t


	)

30 
	#__√ed_NULL


	)

32 
	~<°ddef.h
>

34 
	g__BEGIN_DECLS


36 #i‚de‡
__√ed_mÆloc_™d_ˇŒoc


37 
	#_STDLIB_H
 1

	)

39 #i‡(
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K8
Ë&& !deföed 
_SYS_WAIT_H


41 
	~<bôs/waôÊags.h
>

42 
	~<bôs/waô°©us.h
>

44 #ifde‡
__USE_BSD


49 #i‡
deföed
 
__GNUC__
 && !deföed 
__˝lu•lus


50 
	#__WAIT_INT
(
°©us
) \

51 (
	`__exãnsi⁄__
 (((uni⁄ { 
	`__ty≥of
(
°©us
Ë
__ö
; 
__i
; }) \

52 { .
__ö
 = (
°©us
Ë}).
__i
))

	)

54 
	#__WAIT_INT
(
°©us
Ë(*(*Ë&(°©us))

	)

62 #i‡!
deföed
 
__GNUC__
 || __GNUC__ < 2 || deföed 
__˝lu•lus


63 
	#__WAIT_STATUS
 *

	)

64 
	#__WAIT_STATUS_DEFN
 *

	)

69 
waô
 *
	m__u±r
;

70 *
	m__ùå
;

71 } 
	t__WAIT_STATUS
 
	t__©åibuã__
 ((
	t__å™•¨ít_uni⁄__
));

72 
	#__WAIT_STATUS_DEFN
 *

	)

77 
	#__WAIT_INT
(
°©us
Ë(°©us)

	)

78 
	#__WAIT_STATUS
 *

	)

79 
	#__WAIT_STATUS_DEFN
 *

	)

84 
	#WEXITSTATUS
(
°©us
Ë
	`__WEXITSTATUS
 (
	`__WAIT_INT
 (°©us))

	)

85 
	#WTERMSIG
(
°©us
Ë
	`__WTERMSIG
 (
	`__WAIT_INT
 (°©us))

	)

86 
	#WSTOPSIG
(
°©us
Ë
	`__WSTOPSIG
 (
	`__WAIT_INT
 (°©us))

	)

87 
	#WIFEXITED
(
°©us
Ë
	`__WIFEXITED
 (
	`__WAIT_INT
 (°©us))

	)

88 
	#WIFSIGNALED
(
°©us
Ë
	`__WIFSIGNALED
 (
	`__WAIT_INT
 (°©us))

	)

89 
	#WIFSTOPPED
(
°©us
Ë
	`__WIFSTOPPED
 (
	`__WAIT_INT
 (°©us))

	)

90 #ifde‡
__WIFCONTINUED


91 
	#WIFCONTINUED
(
°©us
Ë
	`__WIFCONTINUED
 (
	`__WAIT_INT
 (°©us))

	)

95 
__BEGIN_NAMESPACE_STD


99 
	mquŸ
;

100 
	mªm
;

101 } 
	tdiv_t
;

104 #i‚de‡
__ldiv_t_deföed


107 
	mquŸ
;

108 
	mªm
;

109 } 
	tldiv_t
;

110 
	#__ldiv_t_deföed
 1

	)

112 
	g__END_NAMESPACE_STD


114 #i‡
deföed
 
__USE_ISOC99
 && !deföed 
__Œdiv_t_deföed


115 
__BEGIN_NAMESPACE_C99


117 
__exãnsi⁄__
 struct

119 
	mquŸ
;

120 
	mªm
;

121 } 
	tŒdiv_t
;

122 
	#__Œdiv_t_deföed
 1

	)

123 
	g__END_NAMESPACE_C99


128 
	#RAND_MAX
 2147483647

	)

133 
	#EXIT_FAILURE
 1

	)

134 
	#EXIT_SUCCESS
 0

	)

138 
	#MB_CUR_MAX
 (
	`__˘y≥_gë_mb_cur_max
 ())

	)

139 
size_t
 
	$__˘y≥_gë_mb_cur_max
 (Ë
__THROW
 
__wur
;

142 
__BEGIN_NAMESPACE_STD


144 
	$©of
 (c⁄° *
__≈å
)

145 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

147 
	$©oi
 (c⁄° *
__≈å
)

148 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

150 
	$©ﬁ
 (c⁄° *
__≈å
)

151 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

152 
__END_NAMESPACE_STD


154 #i‡
deföed
 
__USE_ISOC99
 || (deföed 
__GLIBC_HAVE_LONG_LONG
 && deföed 
__USE_MISC
)

155 
__BEGIN_NAMESPACE_C99


157 
__exãnsi⁄__
 
	$©ﬁl
 (c⁄° *
__≈å
)

158 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

159 
__END_NAMESPACE_C99


162 
__BEGIN_NAMESPACE_STD


164 
	$°πod
 (c⁄° *
__ª°ri˘
 
__≈å
,

165 **
__ª°ri˘
 
__íd±r
)

166 
__THROW
 
	`__n⁄nuŒ
 ((1));

167 
__END_NAMESPACE_STD


169 #ifdef 
__USE_ISOC99


170 
__BEGIN_NAMESPACE_C99


172 
	$°πof
 (c⁄° *
__ª°ri˘
 
__≈å
,

173 **
__ª°ri˘
 
__íd±r
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

175 
	$°πﬁd
 (c⁄° *
__ª°ri˘
 
__≈å
,

176 **
__ª°ri˘
 
__íd±r
)

177 
__THROW
 
	`__n⁄nuŒ
 ((1));

178 
__END_NAMESPACE_C99


181 
__BEGIN_NAMESPACE_STD


183 
	$°πﬁ
 (c⁄° *
__ª°ri˘
 
__≈å
,

184 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

185 
__THROW
 
	`__n⁄nuŒ
 ((1));

187 
	$°πoul
 (c⁄° *
__ª°ri˘
 
__≈å
,

188 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

189 
__THROW
 
	`__n⁄nuŒ
 ((1));

190 
__END_NAMESPACE_STD


192 #i‡
deföed
 
__GLIBC_HAVE_LONG_LONG
 && deföed 
__USE_BSD


194 
__exãnsi⁄__


195 
	$°πoq
 (c⁄° *
__ª°ri˘
 
__≈å
,

196 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

197 
__THROW
 
	`__n⁄nuŒ
 ((1));

199 
__exãnsi⁄__


200 
	$°πouq
 (c⁄° *
__ª°ri˘
 
__≈å
,

201 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

202 
__THROW
 
	`__n⁄nuŒ
 ((1));

205 #i‡
deföed
 
__USE_ISOC99
 || (deföed 
__GLIBC_HAVE_LONG_LONG
 && deföed 
__USE_MISC
)

206 
__BEGIN_NAMESPACE_C99


208 
__exãnsi⁄__


209 
	$°πﬁl
 (c⁄° *
__ª°ri˘
 
__≈å
,

210 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

211 
__THROW
 
	`__n⁄nuŒ
 ((1));

213 
__exãnsi⁄__


214 
	$°πouŒ
 (c⁄° *
__ª°ri˘
 
__≈å
,

215 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

216 
__THROW
 
	`__n⁄nuŒ
 ((1));

217 
__END_NAMESPACE_C99


221 #ifde‡
__USE_GNU


235 
	~<xloˇÀ.h
>

239 
	$°πﬁ_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

240 **
__ª°ri˘
 
__íd±r
, 
__ba£
,

241 
__loˇÀ_t
 
__loc
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 4));

243 
	$°πoul_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

244 **
__ª°ri˘
 
__íd±r
,

245 
__ba£
, 
__loˇÀ_t
 
__loc
)

246 
__THROW
 
	`__n⁄nuŒ
 ((1, 4));

248 
__exãnsi⁄__


249 
	$°πﬁl_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

250 **
__ª°ri˘
 
__íd±r
, 
__ba£
,

251 
__loˇÀ_t
 
__loc
)

252 
__THROW
 
	`__n⁄nuŒ
 ((1, 4));

254 
__exãnsi⁄__


255 
	$°πouŒ_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

256 **
__ª°ri˘
 
__íd±r
,

257 
__ba£
, 
__loˇÀ_t
 
__loc
)

258 
__THROW
 
	`__n⁄nuŒ
 ((1, 4));

260 
	$°πod_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

261 **
__ª°ri˘
 
__íd±r
, 
__loˇÀ_t
 
__loc
)

262 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

264 
	$°πof_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

265 **
__ª°ri˘
 
__íd±r
, 
__loˇÀ_t
 
__loc
)

266 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

268 
	$°πﬁd_l
 (c⁄° *
__ª°ri˘
 
__≈å
,

269 **
__ª°ri˘
 
__íd±r
,

270 
__loˇÀ_t
 
__loc
)

271 
__THROW
 
	`__n⁄nuŒ
 ((1, 3));

275 #ifde‡
__USE_EXTERN_INLINES


276 
__BEGIN_NAMESPACE_STD


277 
__exã∫_ölöe
 

278 
	`__NTH
 (
	$©oi
 (c⁄° *
__≈å
))

280  (Ë
	`°πﬁ
 (
__≈å
, (**Ë
NULL
, 10);

281 
	}
}

282 
__exã∫_ölöe
 

283 
__NTH
 (
	$©ﬁ
 (c⁄° *
__≈å
))

285  
	`°πﬁ
 (
__≈å
, (**Ë
NULL
, 10);

286 
	}
}

287 
	g__END_NAMESPACE_STD


289 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_ISOC99


290 
__BEGIN_NAMESPACE_C99


291 
__exãnsi⁄__
 
__exã∫_ölöe
 

292 
__NTH
 (
	$©ﬁl
 (c⁄° *
__≈å
))

294  
	`°πﬁl
 (
__≈å
, (**Ë
NULL
, 10);

295 
	}
}

296 
	g__END_NAMESPACE_C99


301 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN_EXTENDED


305 *
	$l64a
 (
__n
Ë
__THROW
 
__wur
;

308 
	$a64l
 (c⁄° *
__s
)

309 
__THROW
 
__©åibuã_puª__
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

313 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_BSD


314 
	~<sys/ty≥s.h
>

321 
	$øndom
 (Ë
__THROW
;

324 
	$§™dom
 (
__£ed
Ë
__THROW
;

330 *
	$öô°©e
 (
__£ed
, *
__°©ebuf
,

331 
size_t
 
__°©ñí
Ë
__THROW
 
	`__n⁄nuŒ
 ((2));

335 *
	$£t°©e
 (*
__°©ebuf
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

338 #ifde‡
__USE_MISC


343 
	søndom_d©a


345 
öt32_t
 *
Âå
;

346 
öt32_t
 *
Ωå
;

347 
öt32_t
 *
°©e
;

348 
ønd_ty≥
;

349 
ønd_deg
;

350 
ønd_£p
;

351 
öt32_t
 *
íd_±r
;

354 
	$øndom_r
 (
øndom_d©a
 *
__ª°ri˘
 
__buf
,

355 
öt32_t
 *
__ª°ri˘
 
__ªsu…
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

357 
	$§™dom_r
 (
__£ed
, 
øndom_d©a
 *
__buf
)

358 
__THROW
 
	`__n⁄nuŒ
 ((2));

360 
	$öô°©e_r
 (
__£ed
, *
__ª°ri˘
 
__°©ebuf
,

361 
size_t
 
__°©ñí
,

362 
øndom_d©a
 *
__ª°ri˘
 
__buf
)

363 
__THROW
 
	`__n⁄nuŒ
 ((2, 4));

365 
	$£t°©e_r
 (*
__ª°ri˘
 
__°©ebuf
,

366 
øndom_d©a
 *
__ª°ri˘
 
__buf
)

367 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

372 
__BEGIN_NAMESPACE_STD


374 
	$ønd
 (Ë
__THROW
;

376 
	$§™d
 (
__£ed
Ë
__THROW
;

377 
__END_NAMESPACE_STD


379 #ifde‡
__USE_POSIX


381 
	$ønd_r
 (*
__£ed
Ë
__THROW
;

385 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN


389 
	$dønd48
 (Ë
__THROW
;

390 
	$î™d48
 (
__xsubi
[3]Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

393 
	$Ã™d48
 (Ë
__THROW
;

394 
	$ƒ™d48
 (
__xsubi
[3])

395 
__THROW
 
	`__n⁄nuŒ
 ((1));

398 
	$mønd48
 (Ë
__THROW
;

399 
	$jønd48
 (
__xsubi
[3])

400 
__THROW
 
	`__n⁄nuŒ
 ((1));

403 
	$§™d48
 (
__£edvÆ
Ë
__THROW
;

404 *
	$£ed48
 (
__£ed16v
[3])

405 
__THROW
 
	`__n⁄nuŒ
 ((1));

406 
	$lc⁄g48
 (
__∑øm
[7]Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

408 #ifde‡
__USE_MISC


412 
	sdønd48_d©a


414 
__x
[3];

415 
__ﬁd_x
[3];

416 
__c
;

417 
__öô
;

418 
__a
;

422 
	$dønd48_r
 (
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

423 *
__ª°ri˘
 
__ªsu…
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

424 
	$î™d48_r
 (
__xsubi
[3],

425 
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

426 *
__ª°ri˘
 
__ªsu…
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

429 
	$Ã™d48_r
 (
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

430 *
__ª°ri˘
 
__ªsu…
)

431 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

432 
	$ƒ™d48_r
 (
__xsubi
[3],

433 
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

434 *
__ª°ri˘
 
__ªsu…
)

435 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

438 
	$mønd48_r
 (
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

439 *
__ª°ri˘
 
__ªsu…
)

440 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

441 
	$jønd48_r
 (
__xsubi
[3],

442 
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

443 *
__ª°ri˘
 
__ªsu…
)

444 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

447 
	$§™d48_r
 (
__£edvÆ
, 
dønd48_d©a
 *
__buf„r
)

448 
__THROW
 
	`__n⁄nuŒ
 ((2));

450 
	$£ed48_r
 (
__£ed16v
[3],

451 
dønd48_d©a
 *
__buf„r
Ë
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

453 
	$lc⁄g48_r
 (
__∑øm
[7],

454 
dønd48_d©a
 *
__buf„r
)

455 
__THROW
 
	`__n⁄nuŒ
 ((1, 2));

461 #i‚de‡
__mÆloc_™d_ˇŒoc_deföed


462 
	#__mÆloc_™d_ˇŒoc_deföed


	)

463 
__BEGIN_NAMESPACE_STD


465 *
	$mÆloc
 (
size_t
 
__size
Ë
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

467 *
	$ˇŒoc
 (
size_t
 
__nmemb
, size_à
__size
)

468 
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

469 
__END_NAMESPACE_STD


472 #i‚de‡
__√ed_mÆloc_™d_ˇŒoc


473 
__BEGIN_NAMESPACE_STD


479 *
	$ªÆloc
 (*
__±r
, 
size_t
 
__size
)

480 
__THROW
 
__©åibuã_w¨n_unu£d_ªsu…__
;

482 
	$‰ì
 (*
__±r
Ë
__THROW
;

483 
__END_NAMESPACE_STD


485 #ifdef 
__USE_MISC


487 
	$c‰ì
 (*
__±r
Ë
__THROW
;

490 #i‡
deföed
 
__USE_GNU
 || deföed 
__USE_BSD
 || deföed 
__USE_MISC


491 
	~<Æloˇ.h
>

494 #i‡(
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K
) \

495 || 
deföed
 
__USE_BSD


497 *
	$vÆloc
 (
size_t
 
__size
Ë
__THROW
 
__©åibuã_mÆloc__
 
__wur
;

500 #ifde‡
__USE_XOPEN2K


502 
	$posix_memÆign
 (**
__mem±r
, 
size_t
 
__Æignmít
, size_à
__size
)

503 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

506 #ifde‡
__USE_ISOC11


508 *
	$Æig√d_Æloc
 (
size_t
 
__Æignmít
, size_à
__size
)

509 
__THROW
 
__wur
 
	`__©åibuã__
 ((
__mÆloc__
, 
	`__Æloc_size__
 (2)));

512 
__BEGIN_NAMESPACE_STD


514 
	$ab‹t
 (Ë
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

518 
	`©exô
 ((*
__func
Ë()Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

520 #i‡
deföed
 
__USE_ISOC11
 || deföed 
__USE_ISOCXX11


522 #ifde‡
__˝lu•lus


523 "C++" 
	`©_quick_exô
 ((*
__func
) ())

524 
__THROW
 
	`__asm
 ("©_quick_exô"Ë
	`__n⁄nuŒ
 ((1));

526 
	`©_quick_exô
 ((*
__func
Ë()Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

529 
__END_NAMESPACE_STD


531 #ifdef 
__USE_MISC


534 
	`⁄_exô
 ((*
__func
Ë(
__°©us
, *
__¨g
), *__arg)

535 
__THROW
 
	`__n⁄nuŒ
 ((1));

538 
__BEGIN_NAMESPACE_STD


542 
	$exô
 (
__°©us
Ë
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

544 #i‡
deföed
 
__USE_ISOC11
 || deföed 
__USE_ISOCXX11


548 
	$quick_exô
 (
__°©us
Ë
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

550 
__END_NAMESPACE_STD


552 #ifde‡
__USE_ISOC99


553 
__BEGIN_NAMESPACE_C99


556 
	$_Exô
 (
__°©us
Ë
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

557 
__END_NAMESPACE_C99


561 
__BEGIN_NAMESPACE_STD


563 *
	$gëív
 (c⁄° *
__«me
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

564 
__END_NAMESPACE_STD


566 #ifde‡
__USE_GNU


569 *
	$£cuª_gëív
 (c⁄° *
__«me
)

570 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

573 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN


577 
	$puãnv
 (*
__°rög
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

580 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN2K


583 
	$£ãnv
 (c⁄° *
__«me
, c⁄° *
__vÆue
, 
__ª∂a˚
)

584 
__THROW
 
	`__n⁄nuŒ
 ((2));

587 
	$un£ãnv
 (c⁄° *
__«me
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

590 #ifdef 
__USE_MISC


594 
	$˛óªnv
 (Ë
__THROW
;

598 #i‡
deföed
 
__USE_MISC
 \

599 || (
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K8
)

605 *
	$mkãmp
 (*
__ãm∂©e
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

608 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED
 \

609 || 
deföed
 
__USE_XOPEN2K8


618 #i‚de‡
__USE_FILE_OFFSET64


619 
	$mk°emp
 (*
__ãm∂©e
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

621 #ifde‡
__REDIRECT


622 
	`__REDIRECT
 (
mk°emp
, (*
__ãm∂©e
), 
mk°emp64
)

623 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

625 
	#mk°emp
 
mk°emp64


	)

628 #ifde‡
__USE_LARGEFILE64


629 
	$mk°emp64
 (*
__ãm∂©e
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

633 #ifde‡
__USE_MISC


640 #i‚de‡
__USE_FILE_OFFSET64


641 
	$mk°emps
 (*
__ãm∂©e
, 
__suffixÀn
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

643 #ifde‡
__REDIRECT


644 
	`__REDIRECT
 (
mk°emps
, (*
__ãm∂©e
, 
__suffixÀn
),

645 
mk°emps64
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

647 
	#mk°emps
 
mk°emps64


	)

650 #ifde‡
__USE_LARGEFILE64


651 
	$mk°emps64
 (*
__ãm∂©e
, 
__suffixÀn
)

652 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

656 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN2K8


662 *
	$mkdãmp
 (*
__ãm∂©e
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

665 #ifde‡
__USE_GNU


672 #i‚de‡
__USE_FILE_OFFSET64


673 
	$mko°emp
 (*
__ãm∂©e
, 
__Êags
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

675 #ifde‡
__REDIRECT


676 
	`__REDIRECT
 (
mko°emp
, (*
__ãm∂©e
, 
__Êags
), 
mko°emp64
)

677 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

679 
	#mko°emp
 
mko°emp64


	)

682 #ifde‡
__USE_LARGEFILE64


683 
	$mko°emp64
 (*
__ãm∂©e
, 
__Êags
Ë
	`__n⁄nuŒ
 ((1)Ë
__wur
;

692 #i‚de‡
__USE_FILE_OFFSET64


693 
	$mko°emps
 (*
__ãm∂©e
, 
__suffixÀn
, 
__Êags
)

694 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

696 #ifde‡
__REDIRECT


697 
	`__REDIRECT
 (
mko°emps
, (*
__ãm∂©e
, 
__suffixÀn
,

698 
__Êags
), 
mko°emps64
)

699 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

701 
	#mko°emps
 
mko°emps64


	)

704 #ifde‡
__USE_LARGEFILE64


705 
	$mko°emps64
 (*
__ãm∂©e
, 
__suffixÀn
, 
__Êags
)

706 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

711 
__BEGIN_NAMESPACE_STD


716 
	$sy°em
 (c⁄° *
__comm™d
Ë
__wur
;

717 
__END_NAMESPACE_STD


720 #ifdef 
__USE_GNU


723 *
	$ˇn⁄iˇlize_fûe_«me
 (c⁄° *
__«me
)

724 
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

727 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


733 *
	$ªÆ∑th
 (c⁄° *
__ª°ri˘
 
__«me
,

734 *
__ª°ri˘
 
__ªsﬁved
Ë
__THROW
 
__wur
;

739 #i‚de‡
__COMPAR_FN_T


740 
	#__COMPAR_FN_T


	)

741 (*
	t__com∑r_‚_t
) (const *, const *);

743 #ifdef 
__USE_GNU


744 
__com∑r_‚_t
 
	tcom∑ris⁄_‚_t
;

747 #ifde‡
__USE_GNU


748 (*
	t__com∑r_d_‚_t
) (const *, const *, *);

751 
__BEGIN_NAMESPACE_STD


754 *
	$b£¨ch
 (c⁄° *
__key
, c⁄° *
__ba£
,

755 
size_t
 
__nmemb
, size_à
__size
, 
__com∑r_‚_t
 
__com∑r
)

756 
	`__n⁄nuŒ
 ((1, 2, 5)Ë
__wur
;

760 
	$qs‹t
 (*
__ba£
, 
size_t
 
__nmemb
, size_à
__size
,

761 
__com∑r_‚_t
 
__com∑r
Ë
	`__n⁄nuŒ
 ((1, 4));

762 #ifde‡
__USE_GNU


763 
	$qs‹t_r
 (*
__ba£
, 
size_t
 
__nmemb
, size_à
__size
,

764 
__com∑r_d_‚_t
 
__com∑r
, *
__¨g
)

765 
	`__n⁄nuŒ
 ((1, 4));

770 
	$abs
 (
__x
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

771 
	$œbs
 (
__x
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

772 
__END_NAMESPACE_STD


774 #ifde‡
__USE_ISOC99


775 
__exãnsi⁄__
 
	$Œabs
 (
__x
)

776 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

780 
__BEGIN_NAMESPACE_STD


784 
div_t
 
	$div
 (
__numî
, 
__díom
)

785 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

786 
ldiv_t
 
	$ldiv
 (
__numî
, 
__díom
)

787 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

788 
__END_NAMESPACE_STD


790 #ifde‡
__USE_ISOC99


791 
__BEGIN_NAMESPACE_C99


792 
__exãnsi⁄__
 
Œdiv_t
 
	$Œdiv
 (
__numî
,

793 
__díom
)

794 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
)Ë
__wur
;

795 
__END_NAMESPACE_C99


799 #i‡(
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_XOPEN2K8
) \

800 || 
deföed
 
__USE_SVID


807 *
	$ecvt
 (
__vÆue
, 
__ndigô
, *
__ª°ri˘
 
__de˝t
,

808 *
__ª°ri˘
 
__sign
Ë
__THROW
 
	`__n⁄nuŒ
 ((3, 4)Ë
__wur
;

813 *
	$fcvt
 (
__vÆue
, 
__ndigô
, *
__ª°ri˘
 
__de˝t
,

814 *
__ª°ri˘
 
__sign
Ë
__THROW
 
	`__n⁄nuŒ
 ((3, 4)Ë
__wur
;

819 *
	$gcvt
 (
__vÆue
, 
__ndigô
, *
__buf
)

820 
__THROW
 
	`__n⁄nuŒ
 ((3)Ë
__wur
;

823 #ifde‡
__USE_MISC


825 *
	$qecvt
 (
__vÆue
, 
__ndigô
,

826 *
__ª°ri˘
 
__de˝t
, *__ª°ri˘ 
__sign
)

827 
__THROW
 
	`__n⁄nuŒ
 ((3, 4)Ë
__wur
;

828 *
	$qfcvt
 (
__vÆue
, 
__ndigô
,

829 *
__ª°ri˘
 
__de˝t
, *__ª°ri˘ 
__sign
)

830 
__THROW
 
	`__n⁄nuŒ
 ((3, 4)Ë
__wur
;

831 *
	$qgcvt
 (
__vÆue
, 
__ndigô
, *
__buf
)

832 
__THROW
 
	`__n⁄nuŒ
 ((3)Ë
__wur
;

837 
	$ecvt_r
 (
__vÆue
, 
__ndigô
, *
__ª°ri˘
 
__de˝t
,

838 *
__ª°ri˘
 
__sign
, *__ª°ri˘ 
__buf
,

839 
size_t
 
__Àn
Ë
__THROW
 
	`__n⁄nuŒ
 ((3, 4, 5));

840 
	$fcvt_r
 (
__vÆue
, 
__ndigô
, *
__ª°ri˘
 
__de˝t
,

841 *
__ª°ri˘
 
__sign
, *__ª°ri˘ 
__buf
,

842 
size_t
 
__Àn
Ë
__THROW
 
	`__n⁄nuŒ
 ((3, 4, 5));

844 
	$qecvt_r
 (
__vÆue
, 
__ndigô
,

845 *
__ª°ri˘
 
__de˝t
, *__ª°ri˘ 
__sign
,

846 *
__ª°ri˘
 
__buf
, 
size_t
 
__Àn
)

847 
__THROW
 
	`__n⁄nuŒ
 ((3, 4, 5));

848 
	$qfcvt_r
 (
__vÆue
, 
__ndigô
,

849 *
__ª°ri˘
 
__de˝t
, *__ª°ri˘ 
__sign
,

850 *
__ª°ri˘
 
__buf
, 
size_t
 
__Àn
)

851 
__THROW
 
	`__n⁄nuŒ
 ((3, 4, 5));

855 
__BEGIN_NAMESPACE_STD


858 
	$mbÀn
 (c⁄° *
__s
, 
size_t
 
__n
Ë
__THROW
 
__wur
;

861 
	$mbtowc
 (
wch¨_t
 *
__ª°ri˘
 
__pwc
,

862 c⁄° *
__ª°ri˘
 
__s
, 
size_t
 
__n
Ë
__THROW
 
__wur
;

865 
	$w˘omb
 (*
__s
, 
wch¨_t
 
__wch¨
Ë
__THROW
 
__wur
;

869 
size_t
 
	$mb°owcs
 (
wch¨_t
 *
__ª°ri˘
 
__pwcs
,

870 c⁄° *
__ª°ri˘
 
__s
, 
size_t
 
__n
Ë
__THROW
;

872 
size_t
 
	$wc°ombs
 (*
__ª°ri˘
 
__s
,

873 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__pwcs
, 
size_t
 
__n
)

874 
__THROW
;

875 
__END_NAMESPACE_STD


878 #ifde‡
__USE_SVID


883 
	$Ωm©ch
 (c⁄° *
__ª•⁄£
Ë
__THROW
 
	`__n⁄nuŒ
 ((1)Ë
__wur
;

887 #i‡
deföed
 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_XOPEN2K8


894 
	$gësub›t
 (**
__ª°ri˘
 
__›ti⁄p
,

895 *c⁄° *
__ª°ri˘
 
__tokís
,

896 **
__ª°ri˘
 
__vÆuï
)

897 
__THROW
 
	`__n⁄nuŒ
 ((1, 2, 3)Ë
__wur
;

901 #ifde‡
__USE_XOPEN


903 
	$£tkey
 (c⁄° *
__key
Ë
__THROW
 
	`__n⁄nuŒ
 ((1));

909 #ifde‡
__USE_XOPEN2KXSI


911 
	$posix_›í±
 (
__oÊag
Ë
__wur
;

914 #ifde‡
__USE_XOPEN


919 
	$gø¡±
 (
__fd
Ë
__THROW
;

923 
	$u∆ock±
 (
__fd
Ë
__THROW
;

928 *
	$±¢ame
 (
__fd
Ë
__THROW
 
__wur
;

931 #ifde‡
__USE_GNU


935 
	$±¢ame_r
 (
__fd
, *
__buf
, 
size_t
 
__buÊí
)

936 
__THROW
 
	`__n⁄nuŒ
 ((2));

939 
	`gë±
 ();

942 #ifde‡
__USE_BSD


946 
	$gëlﬂdavg
 (
__lﬂdavg
[], 
__√Àm
)

947 
__THROW
 
	`__n⁄nuŒ
 ((1));

950 
	~<bôs/°dlib-Êﬂt.h
>

953 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__f‹tify_fun˘i⁄


954 
	~<bôs/°dlib.h
>

956 #ifde‡
__LDBL_COMPAT


957 
	~<bôs/°dlib-ldbl.h
>

961 #unde‡
__√ed_mÆloc_™d_ˇŒoc


963 
__END_DECLS


	@/usr/include/alloca.h

18 #i‚def 
_ALLOCA_H


19 
	#_ALLOCA_H
 1

	)

21 
	~<„©uªs.h
>

23 
	#__√ed_size_t


	)

24 
	~<°ddef.h
>

26 
	g__BEGIN_DECLS


29 #unde‡
Æloˇ


32 *
	$Æloˇ
 (
size_t
 
__size
Ë
__THROW
;

34 #ifdef 
__GNUC__


35 
	#Æloˇ
(
size
Ë
	`__buûtö_Æloˇ
 (size)

	)

38 
__END_DECLS


	@/usr/include/asm-generic/posix_types.h

1 #i‚de‡
__ASM_GENERIC_POSIX_TYPES_H


2 
	#__ASM_GENERIC_POSIX_TYPES_H


	)

4 
	~<asm/bô•îl⁄g.h
>

13 #i‚de‡
__kî√l_l⁄g_t


14 
	t__kî√l_l⁄g_t
;

15 
	t__kî√l_ul⁄g_t
;

18 #i‚de‡
__kî√l_öo_t


19 
__kî√l_ul⁄g_t
 
	t__kî√l_öo_t
;

22 #i‚de‡
__kî√l_mode_t


23 
	t__kî√l_mode_t
;

26 #i‚de‡
__kî√l_pid_t


27 
	t__kî√l_pid_t
;

30 #i‚de‡
__kî√l_ùc_pid_t


31 
	t__kî√l_ùc_pid_t
;

34 #i‚de‡
__kî√l_uid_t


35 
	t__kî√l_uid_t
;

36 
	t__kî√l_gid_t
;

39 #i‚de‡
__kî√l_su£c⁄ds_t


40 
__kî√l_l⁄g_t
 
	t__kî√l_su£c⁄ds_t
;

43 #i‚de‡
__kî√l_daddr_t


44 
	t__kî√l_daddr_t
;

47 #i‚de‡
__kî√l_uid32_t


48 
	t__kî√l_uid32_t
;

49 
	t__kî√l_gid32_t
;

52 #i‚de‡
__kî√l_ﬁd_uid_t


53 
__kî√l_uid_t
 
	t__kî√l_ﬁd_uid_t
;

54 
__kî√l_gid_t
 
	t__kî√l_ﬁd_gid_t
;

57 #i‚de‡
__kî√l_ﬁd_dev_t


58 
	t__kî√l_ﬁd_dev_t
;

65 #i‚de‡
__kî√l_size_t


66 #i‡
__BITS_PER_LONG
 != 64

67 
	t__kî√l_size_t
;

68 
	t__kî√l_ssize_t
;

69 
	t__kî√l_±rdiff_t
;

71 
__kî√l_ul⁄g_t
 
	t__kî√l_size_t
;

72 
__kî√l_l⁄g_t
 
	t__kî√l_ssize_t
;

73 
__kî√l_l⁄g_t
 
	t__kî√l_±rdiff_t
;

77 #i‚de‡
__kî√l_fsid_t


79 
	mvÆ
[2];

80 } 
	t__kî√l_fsid_t
;

86 
__kî√l_l⁄g_t
 
	t__kî√l_off_t
;

87 
	t__kî√l_loff_t
;

88 
__kî√l_l⁄g_t
 
	t__kî√l_time_t
;

89 
__kî√l_l⁄g_t
 
	t__kî√l_˛ock_t
;

90 
	t__kî√l_timî_t
;

91 
	t__kî√l_˛ockid_t
;

92 * 
	t__kî√l_ˇddr_t
;

93 
	t__kî√l_uid16_t
;

94 
	t__kî√l_gid16_t
;

	@/usr/include/asm/bitsperlong.h

1 #i‚de‡
__ASM_X86_BITSPERLONG_H


2 
	#__ASM_X86_BITSPERLONG_H


	)

4 #ifde‡
__x86_64__


5 
	#__BITS_PER_LONG
 64

	)

7 
	#__BITS_PER_LONG
 32

	)

10 
	~<asm-gíîic/bô•îl⁄g.h
>

	@/usr/include/bits/byteswap.h

19 #i‡!
deföed
 
_BYTESWAP_H
 && !deföed 
_NETINET_IN_H
 && !deföed 
_ENDIAN_H


23 #i‚de‡
_BITS_BYTESWAP_H


24 
	#_BITS_BYTESWAP_H
 1

	)

26 
	~<„©uªs.h
>

27 
	~<bôs/ty≥s.h
>

28 
	~<bôs/w‹dsize.h
>

31 
	#__bsw≠_c⁄°™t_16
(
x
) \

32 ((Ë((((
x
Ë>> 8Ë& 0xffË| (((xË& 0xffË<< 8)))

	)

35 
	~<bôs/byãsw≠-16.h
>

38 
	#__bsw≠_c⁄°™t_32
(
x
) \

39 ((((
x
) & 0xff000000) >> 24) | (((x) & 0x00ff0000) >> 8) | \

40 (((
x
Ë& 0x0000ff00Ë<< 8Ë| (((xË& 0x000000ffË<< 24))

	)

42 #ifde‡
__GNUC__


43 #i‡
__GNUC_PREREQ
 (4, 3)

44 
__ölöe
 

45 
	$__bsw≠_32
 (
__bsx
)

47  
	`__buûtö_bsw≠32
 (
__bsx
);

48 
	}
}

49 #ñi‡
__GNUC__
 >= 2

50 #i‡
__WORDSIZE
 =64 || (
deföed
 
__i486__
 || deföed 
__≥¡ium__
 \

51 || 
deföed
 
	g__≥¡ium¥o__
 || deföed 
	g__≥¡ium4__
 \

52 || 
deföed
 
	g__k8__
 || deföed 
	g__©hl⁄__
 \

53 || 
deföed
 
	g__k6__
 || deföed 
	g__noc⁄a__
 \

54 || 
deföed
 
	g__c‹e2__
 || deföed 
	g__geode__
 \

55 || 
deföed
 
	g__amdÁm10__
)

58 
	#__bsw≠_32
(
x
) \

59 (
__exãnsi⁄__
 \

60 ({ 
__v
, 
__x
 = (
x
); \

61 i‡(
	`__buûtö_c⁄°™t_p
 (
__x
)) \

62 
__v
 = 
	`__bsw≠_c⁄°™t_32
 (
__x
); \

64 
	`__asm__
 ("bsw≠ %0" : "Ù" (
__v
Ë: "0" (
__x
)); \

65 
__v
; }))

	)

67 
	#__bsw≠_32
(
x
) \

68 (
__exãnsi⁄__
 \

69 ({ 
__v
, 
__x
 = (
x
); \

70 i‡(
	`__buûtö_c⁄°™t_p
 (
__x
)) \

71 
__v
 = 
	`__bsw≠_c⁄°™t_32
 (
__x
); \

73 
	`__asm__
 ("rorw $8, %w0;" \

76 : "Ù" (
__v
) \

77 : "0" (
__x
) \

79 
__v
; }))

	)

82 
	#__bsw≠_32
(
x
) \

83 (
__exãnsi⁄__
 \

84 ({ 
__x
 = (
x
); 
	`__bsw≠_c⁄°™t_32
 (__x); }))

	)

87 
__ölöe
 

88 
	$__bsw≠_32
 (
__bsx
)

90  
	`__bsw≠_c⁄°™t_32
 (
__bsx
);

91 
	}
}

95 #i‡
__GNUC_PREREQ
 (2, 0)

97 
	#__bsw≠_c⁄°™t_64
(
x
) \

98 (
	`__exãnsi⁄__
 ((((
x
) & 0xff00000000000000ull) >> 56) \

99 | (((
x
) & 0x00ff000000000000ull) >> 40) \

100 | (((
x
) & 0x0000ff0000000000ull) >> 24) \

101 | (((
x
) & 0x000000ff00000000ull) >> 8) \

102 | (((
x
) & 0x00000000ff000000ull) << 8) \

103 | (((
x
) & 0x0000000000ff0000ull) << 24) \

104 | (((
x
) & 0x000000000000ff00ull) << 40) \

105 | (((
x
Ë& 0x00000000000000ffuŒË<< 56)))

	)

107 #i‡
__GNUC_PREREQ
 (4, 3)

108 
__ölöe
 
__uöt64_t


109 
	$__bsw≠_64
 (
__uöt64_t
 
__bsx
)

111  
	`__buûtö_bsw≠64
 (
__bsx
);

112 
	}
}

113 #ñi‡
__WORDSIZE
 == 64

114 
	#__bsw≠_64
(
x
) \

115 (
__exãnsi⁄__
 \

116 ({ 
__uöt64_t
 
__v
, 
__x
 = (
x
); \

117 i‡(
	`__buûtö_c⁄°™t_p
 (
__x
)) \

118 
__v
 = 
	`__bsw≠_c⁄°™t_64
 (
__x
); \

120 
	`__asm__
 ("bsw≠ %q0" : "Ù" (
__v
Ë: "0" (
__x
)); \

121 
__v
; }))

	)

123 
	#__bsw≠_64
(
x
) \

124 (
__exãnsi⁄__
 \

125 ({ uni⁄ { 
__exãnsi⁄__
 
__uöt64_t
 
__Œ
; \

126 
__l
[2]; } 
__w
, 
__r
; \

127 i‡(
	`__buûtö_c⁄°™t_p
 (
x
)) \

128 
__r
.
__Œ
 = 
	`__bsw≠_c⁄°™t_64
 (
x
); \

131 
__w
.
__Œ
 = (
x
); \

132 
__r
.
__l
[0] = 
	`__bsw≠_32
 (
__w
.__l[1]); \

133 
__r
.
__l
[1] = 
	`__bsw≠_32
 (
__w
.__l[0]); \

135 
__r
.
__Œ
; }))

	)

137 #ñi‡
__GLIBC_HAVE_LONG_LONG


138 
	#__bsw≠_c⁄°™t_64
(
x
) \

139 ((((
x
) & 0xff00000000000000ull) >> 56) \

140 | (((
x
) & 0x00ff000000000000ull) >> 40) \

141 | (((
x
) & 0x0000ff0000000000ull) >> 24) \

142 | (((
x
) & 0x000000ff00000000ull) >> 8) \

143 | (((
x
) & 0x00000000ff000000ull) << 8) \

144 | (((
x
) & 0x0000000000ff0000ull) << 24) \

145 | (((
x
) & 0x000000000000ff00ull) << 40) \

146 | (((
x
Ë& 0x00000000000000ffuŒË<< 56))

	)

148 
__ölöe
 
__uöt64_t


149 
	$__bsw≠_64
 (
__uöt64_t
 
__bsx
)

151  
	`__bsw≠_c⁄°™t_64
 (
__bsx
);

152 
	}
}

	@/usr/include/bits/endian.h

3 #i‚de‡
_ENDIAN_H


7 
	#__BYTE_ORDER
 
__LITTLE_ENDIAN


	)

	@/usr/include/bits/stdlib-float.h

19 #i‚de‡
_STDLIB_H


23 #ifde‡
__USE_EXTERN_INLINES


24 
__BEGIN_NAMESPACE_STD


25 
__exã∫_ölöe
 

26 
__NTH
 (
	$©of
 (c⁄° *
__≈å
))

28  
	`°πod
 (
__≈å
, (**Ë
NULL
);

29 
	}
}

30 
	g__END_NAMESPACE_STD


	@/usr/include/bits/stdlib-ldbl.h

19 #i‚de‡
_STDLIB_H


23 #ifdef 
__USE_ISOC99


24 
__BEGIN_NAMESPACE_C99


25 
	$__LDBL_REDIR1_DECL
 (
°πﬁd
, 
°πod
)

26 
__END_NAMESPACE_C99


29 #ifde‡
__USE_GNU


30 
	$__LDBL_REDIR1_DECL
 (
°πﬁd_l
, 
°πod_l
)

33 #ifde‡
__USE_MISC


34 
	$__LDBL_REDIR1_DECL
 (
qecvt
, 
ecvt
)

35 
	$__LDBL_REDIR1_DECL
 (
qfcvt
, 
fcvt
)

36 
	$__LDBL_REDIR1_DECL
 (
qgcvt
, 
gcvt
)

37 
	$__LDBL_REDIR1_DECL
 (
qecvt_r
, 
ecvt_r
)

38 
	$__LDBL_REDIR1_DECL
 (
qfcvt_r
, 
fcvt_r
)

	@/usr/include/bits/stdlib.h

19 #i‚de‡
_STDLIB_H


23 *
	$__ªÆ∑th_chk
 (c⁄° *
__ª°ri˘
 
__«me
,

24 *
__ª°ri˘
 
__ªsﬁved
,

25 
size_t
 
__ªsﬁvedÀn
Ë
__THROW
 
__wur
;

26 *
	`__REDIRECT_NTH
 (
__ªÆ∑th_Æüs
,

27 (c⁄° *
__ª°ri˘
 
__«me
,

28 *
__ª°ri˘
 
__ªsﬁved
), 
ªÆ∑th
Ë
__wur
;

29 *
	`__REDIRECT_NTH
 (
__ªÆ∑th_chk_w¨n
,

30 (c⁄° *
__ª°ri˘
 
__«me
,

31 *
__ª°ri˘
 
__ªsﬁved
,

32 
size_t
 
__ªsﬁvedÀn
), 
__ªÆ∑th_chk
Ë
__wur


33 
	`__w¨«âr
 ("secondárgument ofÑealpath must beÉither NULL orát "

36 
__f‹tify_fun˘i⁄
 
__wur
 *

37 
	`__NTH
 (
	$ªÆ∑th
 (c⁄° *
__ª°ri˘
 
__«me
, *__ª°ri˘ 
__ªsﬁved
))

39 i‡(
	`__bos
 (
__ªsﬁved
Ë!(
size_t
) -1)

41 #i‡
deföed
 
_LIBC_LIMITS_H_
 && deföed 
PATH_MAX


42 i‡(
	`__bos
 (
__ªsﬁved
Ë< 
PATH_MAX
)

43  
	`__ªÆ∑th_chk_w¨n
 (
__«me
, 
__ªsﬁved
, 
	`__bos
 (__resolved));

45  
	`__ªÆ∑th_chk
 (
__«me
, 
__ªsﬁved
, 
	`__bos
 (__resolved));

48  
	`__ªÆ∑th_Æüs
 (
__«me
, 
__ªsﬁved
);

49 
	}
}

52 
	$__±¢ame_r_chk
 (
__fd
, *
__buf
, 
size_t
 
__buÊí
,

53 
size_t
 
__ƒól
Ë
__THROW
 
	`__n⁄nuŒ
 ((2));

54 
	`__REDIRECT_NTH
 (
__±¢ame_r_Æüs
, (
__fd
, *
__buf
,

55 
size_t
 
__buÊí
), 
±¢ame_r
)

56 
	`__n⁄nuŒ
 ((2));

57 
	`__REDIRECT_NTH
 (
__±¢ame_r_chk_w¨n
,

58 (
__fd
, *
__buf
, 
size_t
 
__buÊí
,

59 
size_t
 
__ƒól
), 
__±¢ame_r_chk
)

60 
	`__n⁄nuŒ
 ((2)Ë
	`__w¨«âr
 ("ptsname_r called with buflen biggerÅhan "

63 
__f‹tify_fun˘i⁄
 

64 
	`__NTH
 (
	$±¢ame_r
 (
__fd
, *
__buf
, 
size_t
 
__buÊí
))

66 i‡(
	`__bos
 (
__buf
Ë!(
size_t
) -1)

68 i‡(!
	`__buûtö_c⁄°™t_p
 (
__buÊí
))

69  
	`__±¢ame_r_chk
 (
__fd
, 
__buf
, 
__buÊí
, 
	`__bos
 (__buf));

70 i‡(
__buÊí
 > 
	`__bos
 (
__buf
))

71  
	`__±¢ame_r_chk_w¨n
 (
__fd
, 
__buf
, 
__buÊí
, 
	`__bos
 (__buf));

73  
	`__±¢ame_r_Æüs
 (
__fd
, 
__buf
, 
__buÊí
);

74 
	}
}

77 
	$__w˘omb_chk
 (*
__s
, 
wch¨_t
 
__wch¨
, 
size_t
 
__buÊí
)

78 
__THROW
 
__wur
;

79 
	`__REDIRECT_NTH
 (
__w˘omb_Æüs
, (*
__s
, 
wch¨_t
 
__wch¨
),

80 
w˘omb
Ë
__wur
;

82 
__f‹tify_fun˘i⁄
 
__wur
 

83 
	`__NTH
 (
	$w˘omb
 (*
__s
, 
wch¨_t
 
__wch¨
))

88 
	#__STDLIB_MB_LEN_MAX
 16

	)

89 #i‡
deföed
 
MB_LEN_MAX
 && MB_LEN_MAX !
__STDLIB_MB_LEN_MAX


92 i‡(
	`__bos
 (
__s
Ë!(
size_t
Ë-1 && 
__STDLIB_MB_LEN_MAX
 > __bos (__s))

93  
	`__w˘omb_chk
 (
__s
, 
__wch¨
, 
	`__bos
 (__s));

94  
	`__w˘omb_Æüs
 (
__s
, 
__wch¨
);

95 
	}
}

98 
size_t
 
	$__mb°owcs_chk
 (
wch¨_t
 *
__ª°ri˘
 
__d°
,

99 c⁄° *
__ª°ri˘
 
__§c
,

100 
size_t
 
__Àn
, size_à
__d°Àn
Ë
__THROW
;

101 
size_t
 
	`__REDIRECT_NTH
 (
__mb°owcs_Æüs
,

102 (
wch¨_t
 *
__ª°ri˘
 
__d°
,

103 c⁄° *
__ª°ri˘
 
__§c
,

104 
size_t
 
__Àn
), 
mb°owcs
);

105 
size_t
 
	`__REDIRECT_NTH
 (
__mb°owcs_chk_w¨n
,

106 (
wch¨_t
 *
__ª°ri˘
 
__d°
,

107 c⁄° *
__ª°ri˘
 
__§c
,

108 
size_t
 
__Àn
, size_à
__d°Àn
), 
__mb°owcs_chk
)

109 
	`__w¨«âr
 ("mbstowcs called with dst buffer smallerÅhanÜen "

112 
__f‹tify_fun˘i⁄
 
size_t


113 
	`__NTH
 (
	$mb°owcs
 (
wch¨_t
 *
__ª°ri˘
 
__d°
, c⁄° *__ª°ri˘ 
__§c
,

114 
size_t
 
__Àn
))

116 i‡(
	`__bos
 (
__d°
Ë!(
size_t
) -1)

118 i‡(!
	`__buûtö_c⁄°™t_p
 (
__Àn
))

119  
	`__mb°owcs_chk
 (
__d°
, 
__§c
, 
__Àn
,

120 
	`__bos
 (
__d°
Ë/  (
wch¨_t
));

122 i‡(
__Àn
 > 
	`__bos
 (
__d°
Ë/  (
wch¨_t
))

123  
	`__mb°owcs_chk_w¨n
 (
__d°
, 
__§c
, 
__Àn
,

124 
	`__bos
 (
__d°
Ë/  (
wch¨_t
));

126  
	`__mb°owcs_Æüs
 (
__d°
, 
__§c
, 
__Àn
);

127 
	}
}

130 
size_t
 
	$__wc°ombs_chk
 (*
__ª°ri˘
 
__d°
,

131 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
,

132 
size_t
 
__Àn
, size_à
__d°Àn
Ë
__THROW
;

133 
size_t
 
	`__REDIRECT_NTH
 (
__wc°ombs_Æüs
,

134 (*
__ª°ri˘
 
__d°
,

135 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
,

136 
size_t
 
__Àn
), 
wc°ombs
);

137 
size_t
 
	`__REDIRECT_NTH
 (
__wc°ombs_chk_w¨n
,

138 (*
__ª°ri˘
 
__d°
,

139 c⁄° 
wch¨_t
 *
__ª°ri˘
 
__§c
,

140 
size_t
 
__Àn
, size_à
__d°Àn
), 
__wc°ombs_chk
)

141 
	`__w¨«âr
 ("wcstombs called with dst buffer smallerÅhanÜen");

143 
__f‹tify_fun˘i⁄
 
size_t


144 
	`__NTH
 (
	$wc°ombs
 (*
__ª°ri˘
 
__d°
, c⁄° 
wch¨_t
 *__ª°ri˘ 
__§c
,

145 
size_t
 
__Àn
))

147 i‡(
	`__bos
 (
__d°
Ë!(
size_t
) -1)

149 i‡(!
	`__buûtö_c⁄°™t_p
 (
__Àn
))

150  
	`__wc°ombs_chk
 (
__d°
, 
__§c
, 
__Àn
, 
	`__bos
 (__dst));

151 i‡(
__Àn
 > 
	`__bos
 (
__d°
))

152  
	`__wc°ombs_chk_w¨n
 (
__d°
, 
__§c
, 
__Àn
, 
	`__bos
 (__dst));

154  
	`__wc°ombs_Æüs
 (
__d°
, 
__§c
, 
__Àn
);

155 
	}
}

	@/usr/include/bits/typesizes.h

19 #i‚de‡
_BITS_TYPES_H


23 #i‚def 
_BITS_TYPESIZES_H


24 
	#_BITS_TYPESIZES_H
 1

	)

30 #i‡
deföed
 
__x86_64__
 && deföed 
__ILP32__


31 
	#__SYSCALL_SLONG_TYPE
 
__SQUAD_TYPE


	)

32 
	#__SYSCALL_ULONG_TYPE
 
__UQUAD_TYPE


	)

34 
	#__SYSCALL_SLONG_TYPE
 
__SLONGWORD_TYPE


	)

35 
	#__SYSCALL_ULONG_TYPE
 
__ULONGWORD_TYPE


	)

38 
	#__DEV_T_TYPE
 
__UQUAD_TYPE


	)

39 
	#__UID_T_TYPE
 
__U32_TYPE


	)

40 
	#__GID_T_TYPE
 
__U32_TYPE


	)

41 
	#__INO_T_TYPE
 
__SYSCALL_ULONG_TYPE


	)

42 
	#__INO64_T_TYPE
 
__UQUAD_TYPE


	)

43 
	#__MODE_T_TYPE
 
__U32_TYPE


	)

44 #ifde‡
__x86_64__


45 
	#__NLINK_T_TYPE
 
__SYSCALL_ULONG_TYPE


	)

46 
	#__FSWORD_T_TYPE
 
__SYSCALL_SLONG_TYPE


	)

48 
	#__NLINK_T_TYPE
 
__UWORD_TYPE


	)

49 
	#__FSWORD_T_TYPE
 
__SWORD_TYPE


	)

51 
	#__OFF_T_TYPE
 
__SYSCALL_SLONG_TYPE


	)

52 
	#__OFF64_T_TYPE
 
__SQUAD_TYPE


	)

53 
	#__PID_T_TYPE
 
__S32_TYPE


	)

54 
	#__RLIM_T_TYPE
 
__SYSCALL_ULONG_TYPE


	)

55 
	#__RLIM64_T_TYPE
 
__UQUAD_TYPE


	)

56 
	#__BLKCNT_T_TYPE
 
__SYSCALL_SLONG_TYPE


	)

57 
	#__BLKCNT64_T_TYPE
 
__SQUAD_TYPE


	)

58 
	#__FSBLKCNT_T_TYPE
 
__SYSCALL_ULONG_TYPE


	)

59 
	#__FSBLKCNT64_T_TYPE
 
__UQUAD_TYPE


	)

60 
	#__FSFILCNT_T_TYPE
 
__SYSCALL_ULONG_TYPE


	)

61 
	#__FSFILCNT64_T_TYPE
 
__UQUAD_TYPE


	)

62 
	#__ID_T_TYPE
 
__U32_TYPE


	)

63 
	#__CLOCK_T_TYPE
 
__SYSCALL_SLONG_TYPE


	)

64 
	#__TIME_T_TYPE
 
__SYSCALL_SLONG_TYPE


	)

65 
	#__USECONDS_T_TYPE
 
__U32_TYPE


	)

66 
	#__SUSECONDS_T_TYPE
 
__SYSCALL_SLONG_TYPE


	)

67 
	#__DADDR_T_TYPE
 
__S32_TYPE


	)

68 
	#__KEY_T_TYPE
 
__S32_TYPE


	)

69 
	#__CLOCKID_T_TYPE
 
__S32_TYPE


	)

70 
	#__TIMER_T_TYPE
 *

	)

71 
	#__BLKSIZE_T_TYPE
 
__SYSCALL_SLONG_TYPE


	)

72 
	#__FSID_T_TYPE
 såu˘ { 
__vÆ
[2]; }

	)

73 
	#__SSIZE_T_TYPE
 
__SWORD_TYPE


	)

75 #ifde‡
__x86_64__


79 
	#__OFF_T_MATCHES_OFF64_T
 1

	)

82 
	#__INO_T_MATCHES_INO64_T
 1

	)

86 
	#__FD_SETSIZE
 1024

	)

	@/usr/include/bits/waitflags.h

19 #i‡!
deföed
 
_SYS_WAIT_H
 && !deföed 
_STDLIB_H


25 
	#WNOHANG
 1

	)

26 
	#WUNTRACED
 2

	)

29 
	#WSTOPPED
 2

	)

30 
	#WEXITED
 4

	)

31 
	#WCONTINUED
 8

	)

32 
	#WNOWAIT
 0x01000000

	)

34 
	#__WNOTHREAD
 0x20000000

	)

36 
	#__WALL
 0x40000000

	)

37 
	#__WCLONE
 0x80000000

	)

	@/usr/include/bits/waitstatus.h

19 #i‡!
deföed
 
_SYS_WAIT_H
 && !deföed 
_STDLIB_H


28 
	#__WEXITSTATUS
(
°©us
Ë(((°©usË& 0xff00Ë>> 8)

	)

31 
	#__WTERMSIG
(
°©us
Ë((°©usË& 0x7f)

	)

34 
	#__WSTOPSIG
(
°©us
Ë
	`__WEXITSTATUS
(°©us)

	)

37 
	#__WIFEXITED
(
°©us
Ë(
	`__WTERMSIG
(°©usË=0)

	)

40 
	#__WIFSIGNALED
(
°©us
) \

41 (((sig√d Ë(((
°©us
Ë& 0x7fË+ 1Ë>> 1Ë> 0)

	)

44 
	#__WIFSTOPPED
(
°©us
Ë(((°©usË& 0xffË=0x7f)

	)

48 #ifde‡
WCONTINUED


49 
	#__WIFCONTINUED
(
°©us
Ë((°©usË=
__W_CONTINUED
)

	)

53 
	#__WCOREDUMP
(
°©us
Ë((°©usË& 
__WCOREFLAG
)

	)

56 
	#__W_EXITCODE
(
ªt
, 
sig
Ë(‘ëË<< 8 | (sig))

	)

57 
	#__W_STOPCODE
(
sig
Ë((sigË<< 8 | 0x7f)

	)

58 
	#__W_CONTINUED
 0xffff

	)

59 
	#__WCOREFLAG
 0x80

	)

62 #ifdef 
__USE_BSD


64 
	~<ídün.h
>

66 
	uwaô


68 
	mw_°©us
;

71 #if 
__BYTE_ORDER
 =
__LITTLE_ENDIAN


72 
	m__w_ãrmsig
:7;

73 
	m__w_c‹edump
:1;

74 
	m__w_ªtcode
:8;

77 #if 
__BYTE_ORDER
 =
__BIG_ENDIAN


79 
	m__w_ªtcode
:8;

80 
	m__w_c‹edump
:1;

81 
	m__w_ãrmsig
:7;

83 } 
	m__waô_ãrmö©ed
;

86 #if 
__BYTE_ORDER
 =
__LITTLE_ENDIAN


87 
	m__w_°›vÆ
:8;

88 
	m__w_°›sig
:8;

91 #if 
__BYTE_ORDER
 =
__BIG_ENDIAN


93 
	m__w_°›sig
:8;

94 
	m__w_°›vÆ
:8;

96 } 
	m__waô_°›≥d
;

99 
	#w_ãrmsig
 
__waô_ãrmö©ed
.
__w_ãrmsig


	)

100 
	#w_c‹edump
 
__waô_ãrmö©ed
.
__w_c‹edump


	)

101 
	#w_ªtcode
 
__waô_ãrmö©ed
.
__w_ªtcode


	)

102 
	#w_°›sig
 
__waô_°›≥d
.
__w_°›sig


	)

103 
	#w_°›vÆ
 
__waô_°›≥d
.
__w_°›vÆ


	)

	@/usr/include/sys/types.h

22 #i‚def 
_SYS_TYPES_H


23 
	#_SYS_TYPES_H
 1

	)

25 
	~<„©uªs.h
>

27 
	g__BEGIN_DECLS


29 
	~<bôs/ty≥s.h
>

31 #ifdef 
__USE_BSD


32 #i‚de‡
__u_ch¨_deföed


33 
__u_ch¨
 
	tu_ch¨
;

34 
__u_sh‹t
 
	tu_sh‹t
;

35 
__u_öt
 
	tu_öt
;

36 
__u_l⁄g
 
	tu_l⁄g
;

37 
__quad_t
 
	tquad_t
;

38 
__u_quad_t
 
	tu_quad_t
;

39 
__fsid_t
 
	tfsid_t
;

40 
	#__u_ch¨_deföed


	)

44 
__loff_t
 
	tloff_t
;

46 #i‚de‡
__öo_t_deföed


47 #i‚de‡
__USE_FILE_OFFSET64


48 
__öo_t
 
	töo_t
;

50 
__öo64_t
 
	töo_t
;

52 
	#__öo_t_deföed


	)

54 #i‡
deföed
 
__USE_LARGEFILE64
 && !deföed 
__öo64_t_deföed


55 
__öo64_t
 
	töo64_t
;

56 
	#__öo64_t_deföed


	)

59 #i‚de‡
__dev_t_deföed


60 
__dev_t
 
	tdev_t
;

61 
	#__dev_t_deföed


	)

64 #i‚de‡
__gid_t_deföed


65 
__gid_t
 
	tgid_t
;

66 
	#__gid_t_deföed


	)

69 #i‚de‡
__mode_t_deföed


70 
__mode_t
 
	tmode_t
;

71 
	#__mode_t_deföed


	)

74 #i‚de‡
__∆ök_t_deföed


75 
__∆ök_t
 
	t∆ök_t
;

76 
	#__∆ök_t_deföed


	)

79 #i‚de‡
__uid_t_deföed


80 
__uid_t
 
	tuid_t
;

81 
	#__uid_t_deföed


	)

84 #i‚de‡
__off_t_deföed


85 #i‚de‡
__USE_FILE_OFFSET64


86 
__off_t
 
	toff_t
;

88 
__off64_t
 
	toff_t
;

90 
	#__off_t_deföed


	)

92 #i‡
deföed
 
__USE_LARGEFILE64
 && !deföed 
__off64_t_deföed


93 
__off64_t
 
	toff64_t
;

94 
	#__off64_t_deföed


	)

97 #i‚de‡
__pid_t_deföed


98 
__pid_t
 
	tpid_t
;

99 
	#__pid_t_deföed


	)

102 #i‡(
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K8
) \

103 && !
deföed
 
__id_t_deföed


104 
__id_t
 
	tid_t
;

105 
	#__id_t_deföed


	)

108 #i‚de‡
__ssize_t_deföed


109 
__ssize_t
 
	tssize_t
;

110 
	#__ssize_t_deföed


	)

113 #ifdef 
__USE_BSD


114 #i‚de‡
__daddr_t_deföed


115 
__daddr_t
 
	tdaddr_t
;

116 
__ˇddr_t
 
	tˇddr_t
;

117 
	#__daddr_t_deföed


	)

121 #i‡(
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN
Ë&& !deföed 
__key_t_deföed


122 
__key_t
 
	tkey_t
;

123 
	#__key_t_deföed


	)

126 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_XOPEN2K8


127 
	#__√ed_˛ock_t


	)

129 
	#__√ed_time_t


	)

130 
	#__√ed_timî_t


	)

131 
	#__√ed_˛ockid_t


	)

132 
	~<time.h
>

134 #ifde‡
__USE_XOPEN


135 #i‚de‡
__u£c⁄ds_t_deföed


136 
__u£c⁄ds_t
 
	tu£c⁄ds_t
;

137 
	#__u£c⁄ds_t_deföed


	)

139 #i‚de‡
__su£c⁄ds_t_deföed


140 
__su£c⁄ds_t
 
	tsu£c⁄ds_t
;

141 
	#__su£c⁄ds_t_deföed


	)

145 
	#__√ed_size_t


	)

146 
	~<°ddef.h
>

148 #ifde‡
__USE_MISC


150 
	tul⁄g
;

151 
	tush‹t
;

152 
	tuöt
;

157 #i‡!
__GNUC_PREREQ
 (2, 7)

160 #i‚de‡
__öt8_t_deföed


161 
	#__öt8_t_deföed


	)

162 
	töt8_t
;

163 
	töt16_t
;

164 
	töt32_t
;

165 #i‡
__WORDSIZE
 == 64

166 
	töt64_t
;

167 #ñi‡
__GLIBC_HAVE_LONG_LONG


168 
__exãnsi⁄__
 
	töt64_t
;

173 
	tu_öt8_t
;

174 
	tu_öt16_t
;

175 
	tu_öt32_t
;

176 #i‡
__WORDSIZE
 == 64

177 
	tu_öt64_t
;

178 #ñi‡
__GLIBC_HAVE_LONG_LONG


179 
__exãnsi⁄__
 
	tu_öt64_t
;

182 
	tªgi°î_t
;

187 
	#__ötN_t
(
N
, 
MODE
) \

188 ##
	tN
##
	t_t
 
	t__©åibuã__
 ((
	t__mode__
 (
	tMODE
)))

	)

189 
	t__u_ötN_t
(
	tN
, 
	tMODE
) \

190 
	tu_öt
##
	tN
##
	t_t
 
	t__©åibuã__
 ((
	t__mode__
 (
	tMODE
)))

	)

192 #i‚de‡
	t__öt8_t_deföed


193 
	t__öt8_t_deföed


	)

194 
	t__ötN_t
 (8, 
	t__QI__
);

195 
__ötN_t
 (16, 
__HI__
);

196 
__ötN_t
 (32, 
__SI__
);

197 
__ötN_t
 (64, 
__DI__
);

200 
__u_ötN_t
 (8, 
__QI__
);

201 
__u_ötN_t
 (16, 
__HI__
);

202 
__u_ötN_t
 (32, 
__SI__
);

203 
__u_ötN_t
 (64, 
__DI__
);

205 
	tªgi°î_t
 
	t__©åibuã__
 ((
	t__mode__
 (
	t__w‹d__
)));

211 
	#__BIT_TYPES_DEFINED__
 1

	)

214 #ifdef 
__USE_BSD


216 
	~<ídün.h
>

219 
	~<sys/£À˘.h
>

222 
	~<sys/sysma¸os.h
>

226 #i‡(
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K8
) \

227 && !
deföed
 
__blksize_t_deföed


228 
__blksize_t
 
	tblksize_t
;

229 
	#__blksize_t_deföed


	)

233 #i‚de‡
__USE_FILE_OFFSET64


234 #i‚de‡
__blk˙t_t_deföed


235 
__blk˙t_t
 
	tblk˙t_t
;

236 
	#__blk˙t_t_deföed


	)

238 #i‚de‡
__fsblk˙t_t_deföed


239 
__fsblk˙t_t
 
	tfsblk˙t_t
;

240 
	#__fsblk˙t_t_deföed


	)

242 #i‚de‡
__fsfû˙t_t_deföed


243 
__fsfû˙t_t
 
	tfsfû˙t_t
;

244 
	#__fsfû˙t_t_deföed


	)

247 #i‚de‡
__blk˙t_t_deföed


248 
__blk˙t64_t
 
	tblk˙t_t
;

249 
	#__blk˙t_t_deföed


	)

251 #i‚de‡
__fsblk˙t_t_deföed


252 
__fsblk˙t64_t
 
	tfsblk˙t_t
;

253 
	#__fsblk˙t_t_deföed


	)

255 #i‚de‡
__fsfû˙t_t_deföed


256 
__fsfû˙t64_t
 
	tfsfû˙t_t
;

257 
	#__fsfû˙t_t_deföed


	)

261 #ifde‡
__USE_LARGEFILE64


262 
__blk˙t64_t
 
	tblk˙t64_t
;

263 
__fsblk˙t64_t
 
	tfsblk˙t64_t
;

264 
__fsfû˙t64_t
 
	tfsfû˙t64_t
;

269 #i‡
deföed
 
__USE_POSIX199506
 || deföed 
__USE_UNIX98


270 
	~<bôs/±hªadty≥s.h
>

273 
	g__END_DECLS


	@/usr/include/asm-generic/bitsperlong.h

1 #i‚de‡
__ASM_GENERIC_BITS_PER_LONG


2 
	#__ASM_GENERIC_BITS_PER_LONG


	)

11 #i‚de‡
__BITS_PER_LONG


12 
	#__BITS_PER_LONG
 32

	)

	@/usr/include/bits/byteswap-16.h

19 #i‚de‡
_BITS_BYTESWAP_H


23 #ifde‡
__GNUC__


24 #i‡
__GNUC__
 >= 2

25 
	#__bsw≠_16
(
x
) \

26 (
__exãnsi⁄__
 \

27 ({ 
__v
, 
__x
 = (Ë(
x
); \

28 i‡(
	`__buûtö_c⁄°™t_p
 (
__x
)) \

29 
__v
 = 
	`__bsw≠_c⁄°™t_16
 (
__x
); \

31 
	`__asm__
 ("rorw $8, %w0" \

32 : "Ù" (
__v
) \

33 : "0" (
__x
) \

35 
__v
; }))

	)

38 
	#__bsw≠_16
(
x
) \

39 (
__exãnsi⁄__
 \

40 ({ 
__x
 = (Ë(
x
); \

41 
	`__bsw≠_c⁄°™t_16
 (
__x
); }))

	)

44 
__ölöe
 

45 
	$__bsw≠_16
 (
__bsx
)

47  
	`__bsw≠_c⁄°™t_16
 (
__bsx
);

48 
	}
}

	@/usr/include/bits/pthreadtypes.h

18 #i‚de‡
_BITS_PTHREADTYPES_H


19 
	#_BITS_PTHREADTYPES_H
 1

	)

21 
	~<bôs/w‹dsize.h
>

23 #ifde‡
__x86_64__


24 #i‡
__WORDSIZE
 == 64

25 
	#__SIZEOF_PTHREAD_ATTR_T
 56

	)

26 
	#__SIZEOF_PTHREAD_MUTEX_T
 40

	)

27 
	#__SIZEOF_PTHREAD_MUTEXATTR_T
 4

	)

28 
	#__SIZEOF_PTHREAD_COND_T
 48

	)

29 
	#__SIZEOF_PTHREAD_CONDATTR_T
 4

	)

30 
	#__SIZEOF_PTHREAD_RWLOCK_T
 56

	)

31 
	#__SIZEOF_PTHREAD_RWLOCKATTR_T
 8

	)

32 
	#__SIZEOF_PTHREAD_BARRIER_T
 32

	)

33 
	#__SIZEOF_PTHREAD_BARRIERATTR_T
 4

	)

35 
	#__SIZEOF_PTHREAD_ATTR_T
 32

	)

36 
	#__SIZEOF_PTHREAD_MUTEX_T
 32

	)

37 
	#__SIZEOF_PTHREAD_MUTEXATTR_T
 4

	)

38 
	#__SIZEOF_PTHREAD_COND_T
 48

	)

39 
	#__SIZEOF_PTHREAD_CONDATTR_T
 4

	)

40 
	#__SIZEOF_PTHREAD_RWLOCK_T
 44

	)

41 
	#__SIZEOF_PTHREAD_RWLOCKATTR_T
 8

	)

42 
	#__SIZEOF_PTHREAD_BARRIER_T
 20

	)

43 
	#__SIZEOF_PTHREAD_BARRIERATTR_T
 4

	)

46 
	#__SIZEOF_PTHREAD_ATTR_T
 36

	)

47 
	#__SIZEOF_PTHREAD_MUTEX_T
 24

	)

48 
	#__SIZEOF_PTHREAD_MUTEXATTR_T
 4

	)

49 
	#__SIZEOF_PTHREAD_COND_T
 48

	)

50 
	#__SIZEOF_PTHREAD_CONDATTR_T
 4

	)

51 
	#__SIZEOF_PTHREAD_RWLOCK_T
 32

	)

52 
	#__SIZEOF_PTHREAD_RWLOCKATTR_T
 8

	)

53 
	#__SIZEOF_PTHREAD_BARRIER_T
 20

	)

54 
	#__SIZEOF_PTHREAD_BARRIERATTR_T
 4

	)

60 
	t±hªad_t
;

63 
	u±hªad_©å_t


65 
	m__size
[
__SIZEOF_PTHREAD_ATTR_T
];

66 
	m__Æign
;

68 #i‚de‡
__have_±hªad_©å_t


69 
±hªad_©å_t
 
	t±hªad_©å_t
;

70 
	#__have_±hªad_©å_t
 1

	)

74 #ifde‡
__x86_64__


75 
	s__±hªad_öã∫Æ_li°


77 
__±hªad_öã∫Æ_li°
 *
	m__¥ev
;

78 
__±hªad_öã∫Æ_li°
 *
	m__√xt
;

79 } 
	t__±hªad_li°_t
;

81 
	s__±hªad_öã∫Æ_¶i°


83 
__±hªad_öã∫Æ_¶i°
 *
	m__√xt
;

84 } 
	t__±hªad_¶i°_t
;

92 
	s__±hªad_muãx_s


94 
	m__lock
;

95 
	m__cou¡
;

96 
	m__ow√r
;

97 #ifde‡
__x86_64__


98 
	m__nu£rs
;

102 
	m__köd
;

103 #ifde‡
__x86_64__


104 
	m__•ös
;

105 
__±hªad_li°_t
 
	m__li°
;

106 
	#__PTHREAD_MUTEX_HAVE_PREV
 1

	)

108 
	m__nu£rs
;

109 
__exãnsi⁄__
 union

111 
	m__•ös
;

112 
__±hªad_¶i°_t
 
	m__li°
;

115 } 
	m__d©a
;

116 
	m__size
[
__SIZEOF_PTHREAD_MUTEX_T
];

117 
	m__Æign
;

118 } 
	t±hªad_muãx_t
;

122 
	m__size
[
__SIZEOF_PTHREAD_MUTEXATTR_T
];

123 
	m__Æign
;

124 } 
	t±hªad_muãx©å_t
;

133 
	m__lock
;

134 
	m__fuãx
;

135 
__exãnsi⁄__
 
	m__tŸÆ_£q
;

136 
__exãnsi⁄__
 
	m__wakeup_£q
;

137 
__exãnsi⁄__
 
	m__wokí_£q
;

138 *
	m__muãx
;

139 
	m__nwaôîs
;

140 
	m__brﬂdˇ°_£q
;

141 } 
	m__d©a
;

142 
	m__size
[
__SIZEOF_PTHREAD_COND_T
];

143 
__exãnsi⁄__
 
	m__Æign
;

144 } 
	t±hªad_c⁄d_t
;

148 
	m__size
[
__SIZEOF_PTHREAD_CONDATTR_T
];

149 
	m__Æign
;

150 } 
	t±hªad_c⁄d©å_t
;

154 
	t±hªad_key_t
;

158 
	t±hªad_⁄˚_t
;

161 #i‡
deföed
 
__USE_UNIX98
 || deföed 
__USE_XOPEN2K


166 #ifde‡
__x86_64__


169 
	m__lock
;

170 
	m__ƒ_ªadîs
;

171 
	m__ªadîs_wakeup
;

172 
	m__wrôî_wakeup
;

173 
	m__ƒ_ªadîs_queued
;

174 
	m__ƒ_wrôîs_queued
;

175 
	m__wrôî
;

176 
	m__sh¨ed
;

177 
	m__∑d1
;

178 
	m__∑d2
;

181 
	m__Êags
;

182 
	#__PTHREAD_RWLOCK_INT_FLAGS_SHARED
 1

	)

183 } 
	m__d©a
;

187 
	m__lock
;

188 
	m__ƒ_ªadîs
;

189 
	m__ªadîs_wakeup
;

190 
	m__wrôî_wakeup
;

191 
	m__ƒ_ªadîs_queued
;

192 
	m__ƒ_wrôîs_queued
;

195 
	m__Êags
;

196 
	m__sh¨ed
;

197 
	m__∑d1
;

198 
	m__∑d2
;

199 
	m__wrôî
;

200 } 
	m__d©a
;

202 
	m__size
[
__SIZEOF_PTHREAD_RWLOCK_T
];

203 
	m__Æign
;

204 } 
	t±hªad_rwlock_t
;

208 
	m__size
[
__SIZEOF_PTHREAD_RWLOCKATTR_T
];

209 
	m__Æign
;

210 } 
	t±hªad_rwlock©å_t
;

214 #ifde‡
__USE_XOPEN2K


216 vﬁ©ûê
	t±hªad_•ölock_t
;

223 
	m__size
[
__SIZEOF_PTHREAD_BARRIER_T
];

224 
	m__Æign
;

225 } 
	t±hªad_b¨rõr_t
;

229 
	m__size
[
__SIZEOF_PTHREAD_BARRIERATTR_T
];

230 
	m__Æign
;

231 } 
	t±hªad_b¨rõøâr_t
;

235 #i‚de‡
__x86_64__


237 
	#__˛ónup_f˘_©åibuã
 
	`__©åibuã__
 ((
	`__ªg∑rm__
 (1)))

	)

	@/usr/include/sys/select.h

21 #i‚de‡
_SYS_SELECT_H


22 
	#_SYS_SELECT_H
 1

	)

24 
	~<„©uªs.h
>

27 
	~<bôs/ty≥s.h
>

30 
	~<bôs/£À˘.h
>

33 
	~<bôs/sig£t.h
>

35 #i‚de‡
__sig£t_t_deföed


36 
	#__sig£t_t_deföed


	)

37 
__sig£t_t
 
	tsig£t_t
;

41 
	#__√ed_time_t


	)

42 
	#__√ed_time•ec


	)

43 
	~<time.h
>

44 
	#__√ed_timevÆ


	)

45 
	~<bôs/time.h
>

47 #i‚de‡
__su£c⁄ds_t_deföed


48 
__su£c⁄ds_t
 
	tsu£c⁄ds_t
;

49 
	#__su£c⁄ds_t_deföed


	)

54 
	t__fd_mask
;

57 #unde‡
__NFDBITS


59 
	#__NFDBITS
 (8 * (Ë (
__fd_mask
))

	)

60 
	#__FD_ELT
(
d
Ë((dË/ 
__NFDBITS
)

	)

61 
	#__FD_MASK
(
d
Ë((
__fd_mask
Ë1 << ((dË% 
__NFDBITS
))

	)

68 #ifde‡
__USE_XOPEN


69 
__fd_mask
 
	mfds_bôs
[
__FD_SETSIZE
 / 
__NFDBITS
];

70 
	#__FDS_BITS
(
£t
Ë((£t)->
fds_bôs
)

	)

72 
__fd_mask
 
	m__fds_bôs
[
__FD_SETSIZE
 / 
__NFDBITS
];

73 
	#__FDS_BITS
(
£t
Ë((£t)->
__fds_bôs
)

	)

75 } 
	tfd_£t
;

78 
	#FD_SETSIZE
 
__FD_SETSIZE


	)

80 #ifde‡
__USE_MISC


82 
__fd_mask
 
	tfd_mask
;

85 
	#NFDBITS
 
__NFDBITS


	)

90 
	#FD_SET
(
fd
, 
fd£ç
Ë
	`__FD_SET
 (fd, fd£ç)

	)

91 
	#FD_CLR
(
fd
, 
fd£ç
Ë
	`__FD_CLR
 (fd, fd£ç)

	)

92 
	#FD_ISSET
(
fd
, 
fd£ç
Ë
	`__FD_ISSET
 (fd, fd£ç)

	)

93 
	#FD_ZERO
(
fd£ç
Ë
	`__FD_ZERO
 (fd£ç)

	)

96 
__BEGIN_DECLS


106 
£À˘
 (
__nfds
, 
fd_£t
 *
__ª°ri˘
 
__ªadfds
,

107 
fd_£t
 *
__ª°ri˘
 
__wrôefds
,

108 
fd_£t
 *
__ª°ri˘
 
__ex˚±fds
,

109 
timevÆ
 *
__ª°ri˘
 
__timeout
);

111 #ifde‡
__USE_XOPEN2K


118 
p£À˘
 (
__nfds
, 
fd_£t
 *
__ª°ri˘
 
__ªadfds
,

119 
fd_£t
 *
__ª°ri˘
 
__wrôefds
,

120 
fd_£t
 *
__ª°ri˘
 
__ex˚±fds
,

121 c⁄° 
time•ec
 *
__ª°ri˘
 
__timeout
,

122 c⁄° 
__sig£t_t
 *
__ª°ri˘
 
__sigmask
);

127 #i‡
__USE_FORTIFY_LEVEL
 > 0 && 
deföed
 
__GNUC__


128 
	~<bôs/£À˘2.h
>

131 
	g__END_DECLS


	@/usr/include/sys/sysmacros.h

20 #i‚de‡
_SYS_SYSMACROS_H


21 
	#_SYS_SYSMACROS_H
 1

	)

23 
	~<„©uªs.h
>

28 #ifde‡
__GLIBC_HAVE_LONG_LONG


29 
__BEGIN_DECLS


31 
__exãnsi⁄__


32 
	$gnu_dev_maj‹
 (
__dev
)

33 
__THROW
 
__©åibuã_c⁄°__
;

34 
__exãnsi⁄__


35 
	$gnu_dev_mö‹
 (
__dev
)

36 
__THROW
 
__©åibuã_c⁄°__
;

37 
__exãnsi⁄__


38 
	$gnu_dev_makedev
 (
__maj‹
,

39 
__mö‹
)

40 
__THROW
 
__©åibuã_c⁄°__
;

42 #i‡
deföed
 
__GNUC__
 && __GNUC__ >2 && deföed 
__USE_EXTERN_INLINES


43 
__exãnsi⁄__
 
__exã∫_ölöe
 
__©åibuã_c⁄°__
 

44 
	`__NTH
 (
	$gnu_dev_maj‹
 (
__dev
))

46  ((
__dev
 >> 8) & 0xfff) | (() (__dev >> 32) & ~0xfff);

47 
	}
}

49 
__exãnsi⁄__
 
__exã∫_ölöe
 
__©åibuã_c⁄°__
 

50 
__NTH
 (
	$gnu_dev_mö‹
 (
__dev
))

52  (
__dev
 & 0xff) | (() (__dev >> 12) & ~0xff);

53 
	}
}

55 
__exãnsi⁄__
 
__exã∫_ölöe
 
__©åibuã_c⁄°__
 

56 
__NTH
 (
	$gnu_dev_makedev
 (
__maj‹
, 
__mö‹
))

58  ((
__mö‹
 & 0xffË| ((
__maj‹
 & 0xfff) << 8)

59 | (((Ë(
__mö‹
 & ~0xff)) << 12)

60 | (((Ë(
__maj‹
 & ~0xfff)) << 32));

61 
	}
}

63 
	g__END_DECLS


66 
	#maj‹
(
dev
Ë
	`gnu_dev_maj‹
 (dev)

	)

67 
	#mö‹
(
dev
Ë
	`gnu_dev_mö‹
 (dev)

	)

68 
	#makedev
(
maj
, 
mö
Ë
	`gnu_dev_makedev
 (maj, mö)

	)

	@/usr/include/time.h

22 #i‚def 
_TIME_H


24 #i‡(! 
deföed
 
__√ed_time_t
 && !deföed 
__√ed_˛ock_t
 && \

25 ! 
deföed
 
	g__√ed_time•ec
)

26 
	#_TIME_H
 1

	)

27 
	~<„©uªs.h
>

29 
	g__BEGIN_DECLS


33 #ifdef 
_TIME_H


35 
	#__√ed_size_t


	)

36 
	#__√ed_NULL


	)

37 
	~<°ddef.h
>

41 
	~<bôs/time.h
>

44 #i‡!
deföed
 
__STRICT_ANSI__
 && !deföed 
__USE_XOPEN2K


45 #i‚de‡
CLK_TCK


46 
	#CLK_TCK
 
CLOCKS_PER_SEC


	)

52 #i‡!
deföed
 
__˛ock_t_deföed
 && (deföed 
_TIME_H
 || deföed 
__√ed_˛ock_t
)

53 
	#__˛ock_t_deföed
 1

	)

55 
	~<bôs/ty≥s.h
>

57 
__BEGIN_NAMESPACE_STD


59 
__˛ock_t
 
	t˛ock_t
;

60 
	g__END_NAMESPACE_STD


61 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_POSIX
 || deföed 
__USE_MISC


62 
	$__USING_NAMESPACE_STD
(
˛ock_t
)

66 #unde‡
__√ed_˛ock_t


68 #i‡!
deföed
 
__time_t_deföed
 && (deföed 
_TIME_H
 || deföed 
__√ed_time_t
)

69 
	#__time_t_deföed
 1

	)

71 
	~<bôs/ty≥s.h
>

73 
__BEGIN_NAMESPACE_STD


75 
__time_t
 
	ttime_t
;

76 
__END_NAMESPACE_STD


77 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC
 || deföed 
__USE_SVID


78 
	$__USING_NAMESPACE_STD
(
time_t
)

82 #unde‡
__√ed_time_t


84 #i‡!
deföed
 
__˛ockid_t_deföed
 && \

85 ((
deföed
 
_TIME_H
 && deföed 
__USE_POSIX199309
Ë|| deföed 
__√ed_˛ockid_t
)

86 
	#__˛ockid_t_deföed
 1

	)

88 
	~<bôs/ty≥s.h
>

91 
__˛ockid_t
 
	t˛ockid_t
;

94 #unde‡
__˛ockid_time_t


96 #i‡!
deföed
 
__timî_t_deföed
 && \

97 ((
deföed
 
_TIME_H
 && deföed 
__USE_POSIX199309
Ë|| deföed 
__√ed_timî_t
)

98 
	#__timî_t_deföed
 1

	)

100 
	~<bôs/ty≥s.h
>

103 
__timî_t
 
	ttimî_t
;

106 #unde‡
__√ed_timî_t


109 #i‡(!
deföed
 
__time•ec_deföed
 \

110 && ((
deföed
 
_TIME_H
 \

111 && (
deföed
 
__USE_POSIX199309
 || deföed 
__USE_MISC
 \

112 || 
deföed
 
__USE_ISOC11
)) \

113 || 
deföed
 
__√ed_time•ec
))

114 
	#__time•ec_deföed
 1

	)

116 
	~<bôs/ty≥s.h
>

120 
	stime•ec


122 
__time_t
 
tv_£c
;

123 
__sysˇŒ_¶⁄g_t
 
tv_n£c
;

127 #unde‡
__√ed_time•ec


130 #ifdef 
_TIME_H


131 
__BEGIN_NAMESPACE_STD


133 
	stm


135 
tm_£c
;

136 
tm_mö
;

137 
tm_hour
;

138 
tm_mday
;

139 
tm_m⁄
;

140 
tm_yór
;

141 
tm_wday
;

142 
tm_yday
;

143 
tm_isd°
;

145 #ifdef 
__USE_BSD


146 
tm_gmtoff
;

147 c⁄° *
tm_z⁄e
;

149 
__tm_gmtoff
;

150 c⁄° *
__tm_z⁄e
;

153 
__END_NAMESPACE_STD


154 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_POSIX
 || deföed 
__USE_MISC


155 
	$__USING_NAMESPACE_STD
(
tm
)

159 #ifde‡
__USE_POSIX199309


161 
	sôimî•ec


163 
time•ec
 
ô_öãrvÆ
;

164 
time•ec
 
ô_vÆue
;

168 
sigevít
;

172 #ifde‡
__USE_XOPEN2K


173 #i‚de‡
__pid_t_deföed


174 
__pid_t
 
	tpid_t
;

175 
	#__pid_t_deföed


	)

180 #ifde‡
__USE_ISOC11


182 
	#TIME_UTC
 1

	)

186 
__BEGIN_NAMESPACE_STD


189 
˛ock_t
 
	$˛ock
 (Ë
__THROW
;

192 
time_t
 
	$time
 (
time_t
 *
__timî
Ë
__THROW
;

195 
	$dif·ime
 (
time_t
 
__time1
,Åime_à
__time0
)

196 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

199 
time_t
 
	$mktime
 (
tm
 *
__ç
Ë
__THROW
;

205 
size_t
 
	$°r·ime
 (*
__ª°ri˘
 
__s
, 
size_t
 
__maxsize
,

206 c⁄° *
__ª°ri˘
 
__f‹m©
,

207 c⁄° 
tm
 *
__ª°ri˘
 
__ç
Ë
__THROW
;

208 
__END_NAMESPACE_STD


210 #ifde‡
__USE_XOPEN


213 *
	$°Ωtime
 (c⁄° *
__ª°ri˘
 
__s
,

214 c⁄° *
__ª°ri˘
 
__fmt
, 
tm
 *
__ç
)

215 
__THROW
;

218 #ifde‡
__USE_XOPEN2K8


221 
	~<xloˇÀ.h
>

223 
size_t
 
	$°r·ime_l
 (*
__ª°ri˘
 
__s
, 
size_t
 
__maxsize
,

224 c⁄° *
__ª°ri˘
 
__f‹m©
,

225 c⁄° 
tm
 *
__ª°ri˘
 
__ç
,

226 
__loˇÀ_t
 
__loc
Ë
__THROW
;

229 #ifde‡
__USE_GNU


230 *
	$°Ωtime_l
 (c⁄° *
__ª°ri˘
 
__s
,

231 c⁄° *
__ª°ri˘
 
__fmt
, 
tm
 *
__ç
,

232 
__loˇÀ_t
 
__loc
Ë
__THROW
;

236 
__BEGIN_NAMESPACE_STD


239 
tm
 *
	$gmtime
 (c⁄° 
time_t
 *
__timî
Ë
__THROW
;

243 
tm
 *
	$loˇ…ime
 (c⁄° 
time_t
 *
__timî
Ë
__THROW
;

244 
__END_NAMESPACE_STD


246 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


249 
tm
 *
	$gmtime_r
 (c⁄° 
time_t
 *
__ª°ri˘
 
__timî
,

250 
tm
 *
__ª°ri˘
 
__ç
Ë
__THROW
;

254 
tm
 *
	$loˇ…ime_r
 (c⁄° 
time_t
 *
__ª°ri˘
 
__timî
,

255 
tm
 *
__ª°ri˘
 
__ç
Ë
__THROW
;

258 
__BEGIN_NAMESPACE_STD


261 *
	$as˘ime
 (c⁄° 
tm
 *
__ç
Ë
__THROW
;

264 *
	$˘ime
 (c⁄° 
time_t
 *
__timî
Ë
__THROW
;

265 
__END_NAMESPACE_STD


267 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


272 *
	$as˘ime_r
 (c⁄° 
tm
 *
__ª°ri˘
 
__ç
,

273 *
__ª°ri˘
 
__buf
Ë
__THROW
;

276 *
	$˘ime_r
 (c⁄° 
time_t
 *
__ª°ri˘
 
__timî
,

277 *
__ª°ri˘
 
__buf
Ë
__THROW
;

282 *
__tz«me
[2];

283 
__daylight
;

284 
__timez⁄e
;

287 #ifdef 
__USE_POSIX


289 *
tz«me
[2];

293 
	$tz£t
 (Ë
__THROW
;

296 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN


297 
daylight
;

298 
timez⁄e
;

301 #ifde‡
__USE_SVID


304 
	$°ime
 (c⁄° 
time_t
 *
__whí
Ë
__THROW
;

310 
	#__i¶óp
(
yór
) \

311 ((
yór
Ë% 4 =0 && ((yórË% 100 !0 || (yórË% 400 =0))

	)

314 #ifde‡
__USE_MISC


319 
time_t
 
	$timegm
 (
tm
 *
__ç
Ë
__THROW
;

322 
time_t
 
	$timñoˇl
 (
tm
 *
__ç
Ë
__THROW
;

325 
	$dysize
 (
__yór
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

329 #ifde‡
__USE_POSIX199309


334 
	`«no¶ìp
 (c⁄° 
time•ec
 *
__ªque°ed_time
,

335 
time•ec
 *
__ªmaöög
);

339 
	$˛ock_gëªs
 (
˛ockid_t
 
__˛ock_id
, 
time•ec
 *
__ªs
Ë
__THROW
;

342 
	$˛ock_gëtime
 (
˛ockid_t
 
__˛ock_id
, 
time•ec
 *
__ç
Ë
__THROW
;

345 
	$˛ock_£âime
 (
˛ockid_t
 
__˛ock_id
, c⁄° 
time•ec
 *
__ç
)

346 
__THROW
;

348 #ifde‡
__USE_XOPEN2K


353 
	`˛ock_«no¶ìp
 (
˛ockid_t
 
__˛ock_id
, 
__Êags
,

354 c⁄° 
time•ec
 *
__ªq
,

355 
time•ec
 *
__ªm
);

358 
	$˛ock_gë˝u˛ockid
 (
pid_t
 
__pid
, 
˛ockid_t
 *
__˛ock_id
Ë
__THROW
;

363 
	$timî_¸óã
 (
˛ockid_t
 
__˛ock_id
,

364 
sigevít
 *
__ª°ri˘
 
__evp
,

365 
timî_t
 *
__ª°ri˘
 
__timîid
Ë
__THROW
;

368 
	$timî_dñëe
 (
timî_t
 
__timîid
Ë
__THROW
;

371 
	$timî_£âime
 (
timî_t
 
__timîid
, 
__Êags
,

372 c⁄° 
ôimî•ec
 *
__ª°ri˘
 
__vÆue
,

373 
ôimî•ec
 *
__ª°ri˘
 
__ovÆue
Ë
__THROW
;

376 
	$timî_gëtime
 (
timî_t
 
__timîid
, 
ôimî•ec
 *
__vÆue
)

377 
__THROW
;

380 
	$timî_gëovîrun
 (
timî_t
 
__timîid
Ë
__THROW
;

384 #ifde‡
__USE_ISOC11


386 
	$time•ec_gë
 (
time•ec
 *
__ts
, 
__ba£
)

387 
__THROW
 
	`__n⁄nuŒ
 ((1));

391 #ifde‡
__USE_XOPEN_EXTENDED


403 
gëd©e_îr
;

412 
tm
 *
	`gëd©e
 (c⁄° *
__°rög
);

415 #ifde‡
__USE_GNU


426 
	`gëd©e_r
 (c⁄° *
__ª°ri˘
 
__°rög
,

427 
tm
 *
__ª°ri˘
 
__ªsbuÂ
);

430 
__END_DECLS


	@/usr/include/bits/select.h

18 #i‚de‡
_SYS_SELECT_H


22 
	~<bôs/w‹dsize.h
>

25 #i‡
deföed
 
__GNUC__
 && __GNUC__ >= 2

27 #i‡
__WORDSIZE
 == 64

28 
	#__FD_ZERO_STOS
 "°osq"

	)

30 
	#__FD_ZERO_STOS
 "°o¶"

	)

33 
	#__FD_ZERO
(
fd•
) \

35 
__d0
, 
__d1
; \

36 
__asm__
 
	`__vﬁ©ûe__
 ("˛d;Ñï; " 
__FD_ZERO_STOS
 \

37 : "=c" (
__d0
), "=D" (
__d1
) \

38 : "a" (0), "0" ( (
fd_£t
) \

39 /  (
__fd_mask
)), \

40 "1" (&
	`__FDS_BITS
 (
fd•
)[0]) \

42 } 0)

	)

48 
	#__FD_ZERO
(
£t
) \

50 
__i
; \

51 
fd_£t
 *
__¨r
 = (
£t
); \

52 
__i
 = 0; __ò<  (
fd_£t
Ë/  (
__fd_mask
); ++__i) \

53 
	`__FDS_BITS
 (
__¨r
)[
__i
] = 0; \

54 } 0)

	)

58 
	#__FD_SET
(
d
, 
£t
) \

59 ((Ë(
	`__FDS_BITS
 (
£t
)[
	`__FD_ELT
 (
d
)] |
	`__FD_MASK
 (d)))

	)

60 
	#__FD_CLR
(
d
, 
£t
) \

61 ((Ë(
	`__FDS_BITS
 (
£t
)[
	`__FD_ELT
 (
d
)] &~
	`__FD_MASK
 (d)))

	)

62 
	#__FD_ISSET
(
d
, 
£t
) \

63 ((
	`__FDS_BITS
 (
£t
)[
	`__FD_ELT
 (
d
)] & 
	`__FD_MASK
 (d)Ë!0)

	)

	@/usr/include/bits/select2.h

19 #i‚de‡
_SYS_SELECT_H


24 
__fdñt_chk
 (
__d
);

25 
	$__fdñt_w¨n
 (
__d
)

26 
	`__w¨«âr
 ("bit outside of fd_set selected");

27 #unde‡
__FD_ELT


28 
	#__FD_ELT
(
d
) \

29 
__exãnsi⁄__
 \

30 ({ 
__d
 = (
d
); \

31 (
	`__buûtö_c⁄°™t_p
 (
__d
) \

32 ? (0 <
__d
 && __d < 
__FD_SETSIZE
 \

33 ? (
__d
 / 
__NFDBITS
) \

34 : 
	`__fdñt_w¨n
 (
__d
)) \

35 : 
	`__fdñt_chk
 (
__d
)); 
	}
})

	)

	@/usr/include/bits/sigset.h

20 #i‚def 
_SIGSET_H_ty≥s


21 
	#_SIGSET_H_ty≥s
 1

	)

23 
	t__sig_©omic_t
;

27 
	#_SIGSET_NWORDS
 (1024 / (8 *  ()))

	)

30 
	m__vÆ
[
_SIGSET_NWORDS
];

31 } 
	t__sig£t_t
;

42 #i‡!
deföed
 
_SIGSET_H_‚s
 && deföed 
_SIGNAL_H


43 
	#_SIGSET_H_‚s
 1

	)

45 #i‚de‡
_EXTERN_INLINE


46 
	#_EXTERN_INLINE
 
__exã∫_ölöe


	)

50 
	#__sigmask
(
sig
) \

51 (((Ë1Ë<< (((
sig
Ë- 1Ë% (8 *  ())))

	)

54 
	#__sigw‹d
(
sig
Ë(((sigË- 1Ë/ (8 *  ()))

	)

56 #i‡
deföed
 
__GNUC__
 && __GNUC__ >= 2

57 
	#__sigem±y£t
(
£t
) \

58 (
	`__exãnsi⁄__
 ({ 
__˙t
 = 
_SIGSET_NWORDS
; \

59 
sig£t_t
 *
__£t
 = (
£t
); \

60 --
__˙t
 >0Ë
__£t
->
__vÆ
[__cnt] = 0; \

61 0; }))

	)

62 
	#__sigfûl£t
(
£t
) \

63 (
	`__exãnsi⁄__
 ({ 
__˙t
 = 
_SIGSET_NWORDS
; \

64 
sig£t_t
 *
__£t
 = (
£t
); \

65 --
__˙t
 >0Ë
__£t
->
__vÆ
[__cnt] = ~0UL; \

66 0; }))

	)

68 #ifde‡
__USE_GNU


72 
	#__sigi£m±y£t
(
£t
) \

73 (
	`__exãnsi⁄__
 ({ 
__˙t
 = 
_SIGSET_NWORDS
; \

74 c⁄° 
sig£t_t
 *
__£t
 = (
£t
); \

75 
__ªt
 = 
__£t
->
__vÆ
[--
__˙t
]; \

76 !
__ªt
 && --
__˙t
 >= 0) \

77 
__ªt
 = 
__£t
->
__vÆ
[
__˙t
]; \

78 
__ªt
 =0; }))

	)

79 
	#__sig™d£t
(
de°
, 
À·
, 
right
) \

80 (
	`__exãnsi⁄__
 ({ 
__˙t
 = 
_SIGSET_NWORDS
; \

81 
sig£t_t
 *
__de°
 = (
de°
); \

82 c⁄° 
sig£t_t
 *
__À·
 = (
À·
); \

83 c⁄° 
sig£t_t
 *
__right
 = (
right
); \

84 --
__˙t
 >= 0) \

85 
__de°
->
__vÆ
[
__˙t
] = (
__À·
->__val[__cnt] \

86 & 
__right
->
__vÆ
[
__˙t
]); \

87 0; }))

	)

88 
	#__sig‹£t
(
de°
, 
À·
, 
right
) \

89 (
	`__exãnsi⁄__
 ({ 
__˙t
 = 
_SIGSET_NWORDS
; \

90 
sig£t_t
 *
__de°
 = (
de°
); \

91 c⁄° 
sig£t_t
 *
__À·
 = (
À·
); \

92 c⁄° 
sig£t_t
 *
__right
 = (
right
); \

93 --
__˙t
 >= 0) \

94 
__de°
->
__vÆ
[
__˙t
] = (
__À·
->__val[__cnt] \

95 | 
__right
->
__vÆ
[
__˙t
]); \

96 0; }))

	)

103 
__sigismembî
 (c⁄° 
__sig£t_t
 *, );

104 
__sigadd£t
 (
__sig£t_t
 *, );

105 
__sigdñ£t
 (
__sig£t_t
 *, );

107 #ifde‡
__USE_EXTERN_INLINES


108 
	#__SIGSETFN
(
NAME
, 
BODY
, 
CONST
) \

109 
_EXTERN_INLINE
 \

110 
	`NAME
 (
CONST
 
__sig£t_t
 *
__£t
, 
__sig
) \

112 
__mask
 = 
	`__sigmask
 (
__sig
); \

113 
__w‹d
 = 
	`__sigw‹d
 (
__sig
); \

114  
BODY
; \

115 }

	)

117 
__SIGSETFN
 (
__sigismembî
, (
__£t
->
__vÆ
[
__w‹d
] & 
__mask
) ? 1 : 0, const)

118 
__SIGSETFN
 (
__sigadd£t
, ((
__£t
->
__vÆ
[
__w‹d
] |
__mask
), 0), )

119 
__SIGSETFN
 (
__sigdñ£t
, ((
__£t
->
__vÆ
[
__w‹d
] &~
__mask
), 0), )

121 #unde‡
__SIGSETFN


	@/usr/include/bits/time.h

23 #i‡
deföed
 
__√ed_timevÆ
 || deföed 
__USE_GNU


24 #i‚de‡
_STRUCT_TIMEVAL


25 
	#_STRUCT_TIMEVAL
 1

	)

26 
	~<bôs/ty≥s.h
>

30 
	stimevÆ


32 
__time_t
 
	mtv_£c
;

33 
__su£c⁄ds_t
 
	mtv_u£c
;

38 #i‚de‡
__√ed_timevÆ


39 #i‚de‡
_BITS_TIME_H


40 
	#_BITS_TIME_H
 1

	)

48 
	#CLOCKS_PER_SEC
 1000000l

	)

50 #i‡(!
deföed
 
__STRICT_ANSI__
 || deföed 
__USE_POSIX
) \

51 && !
deföed
 
	g__USE_XOPEN2K


54 
	~<bôs/ty≥s.h
>

55 
__sysc⁄f
 ();

56 
	#CLK_TCK
 ((
__˛ock_t
Ë
	`__sysc⁄f
 (2)Ë

	)

59 #ifde‡
__USE_POSIX199309


61 
	#CLOCK_REALTIME
 0

	)

63 
	#CLOCK_MONOTONIC
 1

	)

65 
	#CLOCK_PROCESS_CPUTIME_ID
 2

	)

67 
	#CLOCK_THREAD_CPUTIME_ID
 3

	)

69 
	#CLOCK_MONOTONIC_RAW
 4

	)

71 
	#CLOCK_REALTIME_COARSE
 5

	)

73 
	#CLOCK_MONOTONIC_COARSE
 6

	)

75 
	#CLOCK_BOOTTIME
 7

	)

77 
	#CLOCK_REALTIME_ALARM
 8

	)

79 
	#CLOCK_BOOTTIME_ALARM
 9

	)

82 
	#TIMER_ABSTIME
 1

	)

85 #ifde‡
__USE_GNU


86 
	~<bôs/timex.h
>

88 
__BEGIN_DECLS


91 
	$˛ock_adjtime
 (
__˛ockid_t
 
__˛ock_id
, 
timex
 *
__utx
Ë
__THROW
;

93 
__END_DECLS


99 #unde‡
__√ed_timevÆ


	@/usr/include/bits/timex.h

18 #i‚def 
_BITS_TIMEX_H


19 
	#_BITS_TIMEX_H
 1

	)

21 
	~<bôs/ty≥s.h
>

25 
	stimex


27 
	mmodes
;

28 
__sysˇŒ_¶⁄g_t
 
	moff£t
;

29 
__sysˇŒ_¶⁄g_t
 
	m‰eq
;

30 
__sysˇŒ_¶⁄g_t
 
	mmaxîr‹
;

31 
__sysˇŒ_¶⁄g_t
 
	me°îr‹
;

32 
	m°©us
;

33 
__sysˇŒ_¶⁄g_t
 
	mc⁄°™t
;

34 
__sysˇŒ_¶⁄g_t
 
	m¥ecisi⁄
;

35 
__sysˇŒ_¶⁄g_t
 
	mtﬁî™˚
;

36 
timevÆ
 
	mtime
;

37 
__sysˇŒ_¶⁄g_t
 
	mtick
;

38 
__sysˇŒ_¶⁄g_t
 
	mµs‰eq
;

39 
__sysˇŒ_¶⁄g_t
 
	mjôãr
;

40 
	mshi·
;

41 
__sysˇŒ_¶⁄g_t
 
	m°abû
;

42 
__sysˇŒ_¶⁄g_t
 
	mjô˙t
;

43 
__sysˇŒ_¶⁄g_t
 
	mˇl˙t
;

44 
__sysˇŒ_¶⁄g_t
 
	mîr˙t
;

45 
__sysˇŒ_¶⁄g_t
 
	m°b˙t
;

47 
	mèi
;

56 
	#ADJ_OFFSET
 0x0001

	)

57 
	#ADJ_FREQUENCY
 0x0002

	)

58 
	#ADJ_MAXERROR
 0x0004

	)

59 
	#ADJ_ESTERROR
 0x0008

	)

60 
	#ADJ_STATUS
 0x0010

	)

61 
	#ADJ_TIMECONST
 0x0020

	)

62 
	#ADJ_TAI
 0x0080

	)

63 
	#ADJ_MICRO
 0x1000

	)

64 
	#ADJ_NANO
 0x2000

	)

65 
	#ADJ_TICK
 0x4000

	)

66 
	#ADJ_OFFSET_SINGLESHOT
 0x8001

	)

67 
	#ADJ_OFFSET_SS_READ
 0xa001

	)

70 
	#MOD_OFFSET
 
ADJ_OFFSET


	)

71 
	#MOD_FREQUENCY
 
ADJ_FREQUENCY


	)

72 
	#MOD_MAXERROR
 
ADJ_MAXERROR


	)

73 
	#MOD_ESTERROR
 
ADJ_ESTERROR


	)

74 
	#MOD_STATUS
 
ADJ_STATUS


	)

75 
	#MOD_TIMECONST
 
ADJ_TIMECONST


	)

76 
	#MOD_CLKB
 
ADJ_TICK


	)

77 
	#MOD_CLKA
 
ADJ_OFFSET_SINGLESHOT


	)

78 
	#MOD_TAI
 
ADJ_TAI


	)

79 
	#MOD_MICRO
 
ADJ_MICRO


	)

80 
	#MOD_NANO
 
ADJ_NANO


	)

84 
	#STA_PLL
 0x0001

	)

85 
	#STA_PPSFREQ
 0x0002

	)

86 
	#STA_PPSTIME
 0x0004

	)

87 
	#STA_FLL
 0x0008

	)

89 
	#STA_INS
 0x0010

	)

90 
	#STA_DEL
 0x0020

	)

91 
	#STA_UNSYNC
 0x0040

	)

92 
	#STA_FREQHOLD
 0x0080

	)

94 
	#STA_PPSSIGNAL
 0x0100

	)

95 
	#STA_PPSJITTER
 0x0200

	)

96 
	#STA_PPSWANDER
 0x0400

	)

97 
	#STA_PPSERROR
 0x0800

	)

99 
	#STA_CLOCKERR
 0x1000

	)

100 
	#STA_NANO
 0x2000

	)

101 
	#STA_MODE
 0x4000

	)

102 
	#STA_CLK
 0x8000

	)

105 
	#STA_RONLY
 (
STA_PPSSIGNAL
 | 
STA_PPSJITTER
 | 
STA_PPSWANDER
 | \

106 
STA_PPSERROR
 | 
STA_CLOCKERR
 | 
STA_NANO
 | 
STA_MODE
 | 
STA_CLK
)

	)

	@
1
.
1
/usr/include
223
5954
buffer/buffer_description.h
buffer/buffer_queue.c
buffer/buffer_queue.h
buffer/data_types.h
buffer/kernel_operations.h
buffer/swap_buffer.mod.c
buffer/swap_buffer_errors.h
buffer/swap_buffer_module.c
buffer/swap_buffer_module.h
buffer/swap_buffer_to_buffer_queue.h
driver/app_manage.h
driver/device_driver.c
driver/device_driver.h
driver/device_driver_to_driver_to_buffer.h
driver/driver_defs.h
driver/driver_to_buffer.c
driver/driver_to_buffer.h
driver/driver_to_msg.h
driver/kernel_operations.h
driver/swap_debugfs.c
driver/swap_debugfs.h
driver/swap_driver.mod.c
driver/swap_driver_errors.h
driver/swap_driver_module.c
driver/swap_ioctl.h
driver/us_interaction.c
driver/us_interaction.h
driver/us_interaction_msg.h
energy/debugfs_energy.c
energy/debugfs_energy.h
energy/energy.c
energy/energy.h
energy/energy_module.c
energy/lcd/lcd_base.c
energy/lcd/lcd_base.h
energy/lcd/lcd_debugfs.c
energy/lcd/lcd_debugfs.h
energy/lcd/maru.c
energy/lcd/s6e8aa0.c
energy/lcd/s6e8aa0_panel.c
energy/rational_debugfs.c
energy/rational_debugfs.h
energy/swap_energy.mod.c
energy/tm_stat.h
kprobe/arch/asm-arm/dbi_kprobes.c
kprobe/arch/asm-arm/dbi_kprobes.h
kprobe/arch/asm-arm/trampoline_arm.h
kprobe/arch/asm-mips/dbi_kprobes.c
kprobe/arch/asm-mips/dbi_kprobes.h
kprobe/arch/asm-x86/dbi_kprobes.c
kprobe/arch/asm-x86/dbi_kprobes.h
kprobe/arch/asm-x86/dbi_kprobes_deps.c
kprobe/dbi_insn_slots.c
kprobe/dbi_insn_slots.h
kprobe/dbi_kdebug.h
kprobe/dbi_kprobes.c
kprobe/dbi_kprobes.h
kprobe/dbi_kprobes_deps.c
kprobe/dbi_kprobes_deps.h
kprobe/swap_kprobe.mod.c
ks_features/features_data.c
ks_features/ks_features.c
ks_features/ks_features.h
ks_features/swap_ks_features.mod.c
ks_features/syscall_list.h
ks_manager/ks_manager.c
ks_manager/ks_manager.h
ks_manager/swap_ks_manager.mod.c
ksyms/ksyms.c
ksyms/ksyms.h
ksyms/ksyms_init.h
ksyms/ksyms_module.c
ksyms/no_ksyms.c
parser/features.c
parser/features.h
parser/msg_buf.c
parser/msg_buf.h
parser/msg_cmd.c
parser/msg_cmd.h
parser/msg_parser.c
parser/msg_parser.h
parser/parser_defs.h
parser/swap_message_parser.mod.c
parser/swap_msg_parser.c
parser/us_inst.c
parser/us_inst.h
sampler/kernel_operations.h
sampler/sampler_hrtimer.c
sampler/sampler_timer.c
sampler/sampler_timers.h
sampler/swap_sampler.mod.c
sampler/swap_sampler_errors.h
sampler/swap_sampler_module.c
sampler/swap_sampler_module.h
uprobe/arch/asm-arm/swap_uprobes.c
uprobe/arch/asm-arm/swap_uprobes.h
uprobe/arch/asm-arm/trampoline_thumb.h
uprobe/arch/asm-x86/swap_uprobes.c
uprobe/arch/asm-x86/swap_uprobes.h
uprobe/swap_uprobe.mod.c
uprobe/swap_uprobes.c
uprobe/swap_uprobes.h
us_manager/debugfs_us_manager.c
us_manager/debugfs_us_manager.h
us_manager/helper.c
us_manager/helper.h
us_manager/img/img_file.c
us_manager/img/img_file.h
us_manager/img/img_ip.c
us_manager/img/img_ip.h
us_manager/img/img_proc.c
us_manager/img/img_proc.h
us_manager/pf/pf_group.c
us_manager/pf/pf_group.h
us_manager/pf/proc_filters.c
us_manager/pf/proc_filters.h
us_manager/sspt/ip.c
us_manager/sspt/ip.h
us_manager/sspt/sspt.h
us_manager/sspt/sspt_debug.h
us_manager/sspt/sspt_feature.c
us_manager/sspt/sspt_feature.h
us_manager/sspt/sspt_file.c
us_manager/sspt/sspt_file.h
us_manager/sspt/sspt_page.c
us_manager/sspt/sspt_page.h
us_manager/sspt/sspt_proc.c
us_manager/sspt/sspt_proc.h
us_manager/swap_us_manager.mod.c
us_manager/us_manager.c
us_manager/us_manager.h
us_manager/us_manager_common.h
us_manager/us_slot_manager.c
us_manager/us_slot_manager.h
writer/debugfs_writer.c
writer/debugfs_writer.h
writer/event_filter.c
writer/event_filter.h
writer/kernel_operations.h
writer/kernel_operations_arm.c
writer/kernel_operations_x86.c
writer/swap_writer.mod.c
writer/swap_writer_errors.h
writer/swap_writer_module.c
writer/swap_writer_module.h
/usr/include/asm/errno.h
/usr/include/asm/fcntl.h
/usr/include/asm/ptrace.h
/usr/include/features.h
/usr/include/linux/connector.h
/usr/include/linux/errno.h
/usr/include/linux/fb.h
/usr/include/linux/fs.h
/usr/include/linux/ioctl.h
/usr/include/linux/kernel.h
/usr/include/linux/magic.h
/usr/include/linux/mempolicy.h
/usr/include/linux/mman.h
/usr/include/linux/sched.h
/usr/include/linux/string.h
/usr/include/linux/time.h
/usr/include/linux/types.h
/usr/include/linux/version.h
/usr/include/linux/wait.h
/usr/include/asm-generic/errno.h
/usr/include/asm-generic/fcntl.h
/usr/include/asm/ioctl.h
/usr/include/asm/mman.h
/usr/include/asm/processor-flags.h
/usr/include/asm/ptrace-abi.h
/usr/include/asm/types.h
/usr/include/gnu/stubs.h
/usr/include/linux/i2c.h
/usr/include/linux/limits.h
/usr/include/linux/posix_types.h
/usr/include/linux/sysinfo.h
/usr/include/stdc-predef.h
/usr/include/string.h
/usr/include/sys/cdefs.h
/usr/include/asm-generic/errno-base.h
/usr/include/asm-generic/ioctl.h
/usr/include/asm-generic/mman.h
/usr/include/asm-generic/types.h
/usr/include/asm/posix_types.h
/usr/include/bits/string.h
/usr/include/bits/string2.h
/usr/include/bits/string3.h
/usr/include/bits/wordsize.h
/usr/include/gnu/stubs-32.h
/usr/include/gnu/stubs-64.h
/usr/include/linux/stddef.h
/usr/include/xlocale.h
/usr/include/asm-generic/int-ll64.h
/usr/include/asm-generic/mman-common.h
/usr/include/asm/posix_types_32.h
/usr/include/asm/posix_types_64.h
/usr/include/asm/posix_types_x32.h
/usr/include/bits/types.h
/usr/include/endian.h
/usr/include/stdlib.h
/usr/include/alloca.h
/usr/include/asm-generic/posix_types.h
/usr/include/asm/bitsperlong.h
/usr/include/bits/byteswap.h
/usr/include/bits/endian.h
/usr/include/bits/stdlib-float.h
/usr/include/bits/stdlib-ldbl.h
/usr/include/bits/stdlib.h
/usr/include/bits/typesizes.h
/usr/include/bits/waitflags.h
/usr/include/bits/waitstatus.h
/usr/include/sys/types.h
/usr/include/asm-generic/bitsperlong.h
/usr/include/bits/byteswap-16.h
/usr/include/bits/pthreadtypes.h
/usr/include/sys/select.h
/usr/include/sys/sysmacros.h
/usr/include/time.h
/usr/include/bits/select.h
/usr/include/bits/select2.h
/usr/include/bits/sigset.h
/usr/include/bits/time.h
/usr/include/bits/timex.h
